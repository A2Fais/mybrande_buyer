(function(){const L=document.createElement("link").relList;if(L&&L.supports&&L.supports("modulepreload"))return;for(const K of document.querySelectorAll('link[rel="modulepreload"]'))V(K);new MutationObserver(K=>{for(const Z of K)if(Z.type==="childList")for(const Q of Z.addedNodes)Q.tagName==="LINK"&&Q.rel==="modulepreload"&&V(Q)}).observe(document,{childList:!0,subtree:!0});function G(K){const Z={};return K.integrity&&(Z.integrity=K.integrity),K.referrerPolicy&&(Z.referrerPolicy=K.referrerPolicy),K.crossOrigin==="use-credentials"?Z.credentials="include":K.crossOrigin==="anonymous"?Z.credentials="omit":Z.credentials="same-origin",Z}function V(K){if(K.ep)return;K.ep=!0;const Z=G(K);fetch(K.href,Z)}})();const editor_style="",details_style="";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(X){return X&&X.__esModule&&Object.prototype.hasOwnProperty.call(X,"default")?X.default:X}function getAugmentedNamespace(X){if(X.__esModule)return X;var L=X.default;if(typeof L=="function"){var G=function V(){return this instanceof V?Reflect.construct(L,arguments,this.constructor):L.apply(this,arguments)};G.prototype=L.prototype}else G={};return Object.defineProperty(G,"__esModule",{value:!0}),Object.keys(X).forEach(function(V){var K=Object.getOwnPropertyDescriptor(X,V);Object.defineProperty(G,V,K.get?K:{enumerable:!0,get:function(){return X[V]}})}),G}var fabric$1={};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(X){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var L=L||{version:"5.3.0"};if(X.fabric=L,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?L.document=document:L.document=document.implementation.createHTMLDocument(""),L.window=window;else{var G=require$$2,V=new G.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;L.document=V.document,L.jsdomImplForWrapper=require$$2.implForWrapper,L.nodeCanvas=require$$2.Canvas,L.window=V,DOMParser=L.window.DOMParser}L.isTouchSupported="ontouchstart"in L.window||"ontouchstart"in L.document||L.window&&L.window.navigator&&L.window.navigator.maxTouchPoints>0,L.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",L.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],L.DPI=96,L.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",L.commaWsp="(?:\\s+,?\\s*|,\\s*)",L.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,L.reNonWord=/[ \n\.,;!\?\-]/,L.fontPaths={},L.iMatrix=[1,0,0,1,0,0],L.svgNS="http://www.w3.org/2000/svg",L.perfLimitSizeTotal=2097152,L.maxCacheSideLimit=4096,L.minCacheSideLimit=256,L.charWidthsCache={},L.textureSize=2048,L.disableStyleCopyPaste=!1,L.enableGLFiltering=!0,L.devicePixelRatio=L.window.devicePixelRatio||L.window.webkitDevicePixelRatio||L.window.mozDevicePixelRatio||1,L.browserShadowBlurConstant=1,L.arcToSegmentsCache={},L.boundsOfCurveCache={},L.cachesBoundsOfCurve=!0,L.forceGLPutImageData=!1,L.initFilterBackend=function(){if(L.enableGLFiltering&&L.isWebglSupported&&L.isWebglSupported(L.textureSize))return console.log("max texture size: "+L.maxTextureSize),new L.WebglFilterBackend({tileSize:L.textureSize});if(L.Canvas2dFilterBackend)return new L.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=L),function(){function B(l,p){if(this.__eventListeners[l]){var F=this.__eventListeners[l];p?F[F.indexOf(p)]=!1:L.util.array.fill(F,!1)}}function E(l,p){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var F in l)this.on(F,l[F]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(p);return this}function M(l,p){var F=(function(){p.apply(this,arguments),this.off(l,F)}).bind(this);this.on(l,F)}function R(l,p){if(arguments.length===1)for(var F in l)M.call(this,F,l[F]);else M.call(this,l,p);return this}function o(l,p){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)B.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var F in l)B.call(this,F,l[F]);else B.call(this,l,p);return this}function S(l,p){if(!this.__eventListeners)return this;var F=this.__eventListeners[l];if(!F)return this;for(var O=0,q=F.length;O<q;O++)F[O]&&F[O].call(this,p||{});return this.__eventListeners[l]=F.filter(function(W){return W!==!1}),this}L.Observable={fire:S,on:E,once:R,off:o}}(),L.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var B=0,E=arguments.length;B<E;B++)this._onObjectAdded(arguments[B]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(B,E,M){var R=this._objects;return M?R[E]=B:R.splice(E,0,B),this._onObjectAdded&&this._onObjectAdded(B),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var B=this._objects,E,M=!1,R=0,o=arguments.length;R<o;R++)E=B.indexOf(arguments[R]),E!==-1&&(M=!0,B.splice(E,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[R]));return this.renderOnAddRemove&&M&&this.requestRenderAll(),this},forEachObject:function(B,E){for(var M=this.getObjects(),R=0,o=M.length;R<o;R++)B.call(E,M[R],R,M);return this},getObjects:function(B){return typeof B>"u"?this._objects.concat():this._objects.filter(function(E){return E.type===B})},item:function(B){return this._objects[B]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(B,E){return this._objects.indexOf(B)>-1?!0:E?this._objects.some(function(M){return typeof M.contains=="function"&&M.contains(B,!0)}):!1},complexity:function(){return this._objects.reduce(function(B,E){return B+=E.complexity?E.complexity():0,B},0)}},L.CommonMethods={_setOptions:function(B){for(var E in B)this.set(E,B[E])},_initGradient:function(B,E){B&&B.colorStops&&!(B instanceof L.Gradient)&&this.set(E,new L.Gradient(B))},_initPattern:function(B,E,M){B&&B.source&&!(B instanceof L.Pattern)?this.set(E,new L.Pattern(B,M)):M&&M()},_setObject:function(B){for(var E in B)this._set(E,B[E])},set:function(B,E){return typeof B=="object"?this._setObject(B):this._set(B,E),this},_set:function(B,E){this[B]=E},toggle:function(B){var E=this.get(B);return typeof E=="boolean"&&this.set(B,!E),this},get:function(B){return this[B]}},function(B){var E=Math.sqrt,M=Math.atan2,R=Math.pow,o=Math.PI/180,S=Math.PI/2;L.util={cos:function(l){if(l===0)return 1;l<0&&(l=-l);var p=l/S;switch(p){case 1:case 3:return 0;case 2:return-1}return Math.cos(l)},sin:function(l){if(l===0)return 0;var p=l/S,F=1;switch(l<0&&(F=-1),p){case 1:return F;case 2:return 0;case 3:return-F}return Math.sin(l)},removeFromArray:function(l,p){var F=l.indexOf(p);return F!==-1&&l.splice(F,1),l},getRandomInt:function(l,p){return Math.floor(Math.random()*(p-l+1))+l},degreesToRadians:function(l){return l*o},radiansToDegrees:function(l){return l/o},rotatePoint:function(l,p,F){var O=new L.Point(l.x-p.x,l.y-p.y),q=L.util.rotateVector(O,F);return new L.Point(q.x,q.y).addEquals(p)},rotateVector:function(l,p){var F=L.util.sin(p),O=L.util.cos(p),q=l.x*O-l.y*F,W=l.x*F+l.y*O;return{x:q,y:W}},createVector:function(l,p){return new L.Point(p.x-l.x,p.y-l.y)},calcAngleBetweenVectors:function(l,p){return Math.acos((l.x*p.x+l.y*p.y)/(Math.hypot(l.x,l.y)*Math.hypot(p.x,p.y)))},getHatVector:function(l){return new L.Point(l.x,l.y).multiply(1/Math.hypot(l.x,l.y))},getBisector:function(l,p,F){var O=L.util.createVector(l,p),q=L.util.createVector(l,F),W=L.util.calcAngleBetweenVectors(O,q),U=L.util.calcAngleBetweenVectors(L.util.rotateVector(O,W),q),Y=W*(U===0?1:-1)/2;return{vector:L.util.getHatVector(L.util.rotateVector(O,Y)),angle:W}},projectStrokeOnPoints:function(l,p,F){var O=[],q=p.strokeWidth/2,W=p.strokeUniform?new L.Point(1/p.scaleX,1/p.scaleY):new L.Point(1,1),U=function(Y){var J=q/Math.hypot(Y.x,Y.y);return new L.Point(Y.x*J*W.x,Y.y*J*W.y)};return l.length<=1||l.forEach(function(Y,J){var te=new L.Point(Y.x,Y.y),oe,fe;J===0?(fe=l[J+1],oe=F?U(L.util.createVector(fe,te)).addEquals(te):l[l.length-1]):J===l.length-1?(oe=l[J-1],fe=F?U(L.util.createVector(oe,te)).addEquals(te):l[0]):(oe=l[J-1],fe=l[J+1]);var be=L.util.getBisector(te,oe,fe),Re=be.vector,Fe=be.angle,Me,Be;if(p.strokeLineJoin==="miter"&&(Me=-q/Math.sin(Fe/2),Be=new L.Point(Re.x*Me*W.x,Re.y*Me*W.y),Math.hypot(Be.x,Be.y)/q<=p.strokeMiterLimit)){O.push(te.add(Be)),O.push(te.subtract(Be));return}Me=-q*Math.SQRT2,Be=new L.Point(Re.x*Me*W.x,Re.y*Me*W.y),O.push(te.add(Be)),O.push(te.subtract(Be))}),O},transformPoint:function(l,p,F){return F?new L.Point(p[0]*l.x+p[2]*l.y,p[1]*l.x+p[3]*l.y):new L.Point(p[0]*l.x+p[2]*l.y+p[4],p[1]*l.x+p[3]*l.y+p[5])},makeBoundingBoxFromPoints:function(l,p){if(p)for(var F=0;F<l.length;F++)l[F]=L.util.transformPoint(l[F],p);var O=[l[0].x,l[1].x,l[2].x,l[3].x],q=L.util.array.min(O),W=L.util.array.max(O),U=W-q,Y=[l[0].y,l[1].y,l[2].y,l[3].y],J=L.util.array.min(Y),te=L.util.array.max(Y),oe=te-J;return{left:q,top:J,width:U,height:oe}},invertTransform:function(l){var p=1/(l[0]*l[3]-l[1]*l[2]),F=[p*l[3],-p*l[1],-p*l[2],p*l[0]],O=L.util.transformPoint({x:l[4],y:l[5]},F,!0);return F[4]=-O.x,F[5]=-O.y,F},toFixed:function(l,p){return parseFloat(Number(l).toFixed(p))},parseUnit:function(l,p){var F=/\D{0,2}$/.exec(l),O=parseFloat(l);switch(p||(p=L.Text.DEFAULT_SVG_FONT_SIZE),F[0]){case"mm":return O*L.DPI/25.4;case"cm":return O*L.DPI/2.54;case"in":return O*L.DPI;case"pt":return O*L.DPI/72;case"pc":return O*L.DPI/72*12;case"em":return O*p;default:return O}},falseFunction:function(){return!1},getKlass:function(l,p){return l=L.util.string.camelize(l.charAt(0).toUpperCase()+l.slice(1)),L.util.resolveNamespace(p)[l]},getSvgAttributes:function(l){var p=["instantiated_by_use","style","id","class"];switch(l){case"linearGradient":p=p.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":p=p.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":p=p.concat(["offset","stop-color","stop-opacity"]);break}return p},resolveNamespace:function(l){if(!l)return L;var p=l.split("."),F=p.length,O,q=B||L.window;for(O=0;O<F;++O)q=q[p[O]];return q},loadImage:function(l,p,F,O){if(!l){p&&p.call(F,l);return}var q=L.util.createImage(),W=function(){p&&p.call(F,q,!1),q=q.onload=q.onerror=null};q.onload=W,q.onerror=function(){L.log("Error loading "+q.src),p&&p.call(F,null,!0),q=q.onload=q.onerror=null},l.indexOf("data")!==0&&O!==void 0&&O!==null&&(q.crossOrigin=O),l.substring(0,14)==="data:image/svg"&&(q.onload=null,L.util.loadImageInDom(q,W)),q.src=l},loadImageInDom:function(l,p){var F=L.document.createElement("div");F.style.width=F.style.height="1px",F.style.left=F.style.top="-100%",F.style.position="absolute",F.appendChild(l),L.document.querySelector("body").appendChild(F),l.onload=function(){p(),F.parentNode.removeChild(F),F=null}},enlivenObjects:function(l,p,F,O){l=l||[];var q=[],W=0,U=l.length;function Y(){++W===U&&p&&p(q.filter(function(J){return J}))}if(!U){p&&p(q);return}l.forEach(function(J,te){if(!J||!J.type){Y();return}var oe=L.util.getKlass(J.type,F);oe.fromObject(J,function(fe,be){be||(q[te]=fe),O&&O(J,fe,be),Y()})})},enlivenObjectEnlivables:function(l,p,F){var O=L.Object.ENLIVEN_PROPS.filter(function(q){return!!l[q]});L.util.enlivenObjects(O.map(function(q){return l[q]}),function(q){var W={};O.forEach(function(U,Y){W[U]=q[Y],p&&(p[U]=q[Y])}),F&&F(W)})},enlivenPatterns:function(l,p){l=l||[];function F(){++q===W&&p&&p(O)}var O=[],q=0,W=l.length;if(!W){p&&p(O);return}l.forEach(function(U,Y){U&&U.source?new L.Pattern(U,function(J){O[Y]=J,F()}):(O[Y]=U,F())})},groupSVGElements:function(l,p,F){var O;return l&&l.length===1?(typeof F<"u"&&(l[0].sourcePath=F),l[0]):(p&&(p.width&&p.height?p.centerPoint={x:p.width/2,y:p.height/2}:(delete p.width,delete p.height)),O=new L.Group(l,p),typeof F<"u"&&(O.sourcePath=F),O)},populateWithProperties:function(l,p,F){if(F&&Array.isArray(F))for(var O=0,q=F.length;O<q;O++)F[O]in l&&(p[F[O]]=l[F[O]])},createCanvasElement:function(){return L.document.createElement("canvas")},copyCanvasElement:function(l){var p=L.util.createCanvasElement();return p.width=l.width,p.height=l.height,p.getContext("2d").drawImage(l,0,0),p},toDataURL:function(l,p,F){return l.toDataURL("image/"+p,F)},createImage:function(){return L.document.createElement("img")},multiplyTransformMatrices:function(l,p,F){return[l[0]*p[0]+l[2]*p[1],l[1]*p[0]+l[3]*p[1],l[0]*p[2]+l[2]*p[3],l[1]*p[2]+l[3]*p[3],F?0:l[0]*p[4]+l[2]*p[5]+l[4],F?0:l[1]*p[4]+l[3]*p[5]+l[5]]},qrDecompose:function(l){var p=M(l[1],l[0]),F=R(l[0],2)+R(l[1],2),O=E(F),q=(l[0]*l[3]-l[2]*l[1])/O,W=M(l[0]*l[2]+l[1]*l[3],F);return{angle:p/o,scaleX:O,scaleY:q,skewX:W/o,skewY:0,translateX:l[4],translateY:l[5]}},calcRotateMatrix:function(l){if(!l.angle)return L.iMatrix.concat();var p=L.util.degreesToRadians(l.angle),F=L.util.cos(p),O=L.util.sin(p);return[F,O,-O,F,0,0]},calcDimensionsMatrix:function(l){var p=typeof l.scaleX>"u"?1:l.scaleX,F=typeof l.scaleY>"u"?1:l.scaleY,O=[l.flipX?-p:p,0,0,l.flipY?-F:F,0,0],q=L.util.multiplyTransformMatrices,W=L.util.degreesToRadians;return l.skewX&&(O=q(O,[1,0,Math.tan(W(l.skewX)),1],!0)),l.skewY&&(O=q(O,[1,Math.tan(W(l.skewY)),0,1],!0)),O},composeMatrix:function(l){var p=[1,0,0,1,l.translateX||0,l.translateY||0],F=L.util.multiplyTransformMatrices;return l.angle&&(p=F(p,L.util.calcRotateMatrix(l))),(l.scaleX!==1||l.scaleY!==1||l.skewX||l.skewY||l.flipX||l.flipY)&&(p=F(p,L.util.calcDimensionsMatrix(l))),p},resetObjectTransform:function(l){l.scaleX=1,l.scaleY=1,l.skewX=0,l.skewY=0,l.flipX=!1,l.flipY=!1,l.rotate(0)},saveObjectTransform:function(l){return{scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,angle:l.angle,left:l.left,flipX:l.flipX,flipY:l.flipY,top:l.top}},isTransparent:function(l,p,F,O){O>0&&(p>O?p-=O:p=0,F>O?F-=O:F=0);var q=!0,W,U,Y=l.getImageData(p,F,O*2||1,O*2||1),J=Y.data.length;for(W=3;W<J&&(U=Y.data[W],q=U<=0,q!==!1);W+=4);return Y=null,q},parsePreserveAspectRatioAttribute:function(l){var p="meet",F="Mid",O="Mid",q=l.split(" "),W;return q&&q.length&&(p=q.pop(),p!=="meet"&&p!=="slice"?(W=p,p="meet"):q.length&&(W=q.pop())),F=W!=="none"?W.slice(1,4):"none",O=W!=="none"?W.slice(5,8):"none",{meetOrSlice:p,alignX:F,alignY:O}},clearFabricFontCache:function(l){l=(l||"").toLowerCase(),l?L.charWidthsCache[l]&&delete L.charWidthsCache[l]:L.charWidthsCache={}},limitDimsByArea:function(l,p){var F=Math.sqrt(p*l),O=Math.floor(p/F);return{x:Math.floor(F),y:O}},capValue:function(l,p,F){return Math.max(l,Math.min(p,F))},findScaleToFit:function(l,p){return Math.min(p.width/l.width,p.height/l.height)},findScaleToCover:function(l,p){return Math.max(p.width/l.width,p.height/l.height)},matrixToSVG:function(l){return"matrix("+l.map(function(p){return L.util.toFixed(p,L.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(l,p){var F=L.util.invertTransform(p),O=L.util.multiplyTransformMatrices(F,l.calcOwnMatrix());L.util.applyTransformToObject(l,O)},addTransformToObject:function(l,p){L.util.applyTransformToObject(l,L.util.multiplyTransformMatrices(p,l.calcOwnMatrix()))},applyTransformToObject:function(l,p){var F=L.util.qrDecompose(p),O=new L.Point(F.translateX,F.translateY);l.flipX=!1,l.flipY=!1,l.set("scaleX",F.scaleX),l.set("scaleY",F.scaleY),l.skewX=F.skewX,l.skewY=F.skewY,l.angle=F.angle,l.setPositionByOrigin(O,"center","center")},sizeAfterTransform:function(l,p,F){var O=l/2,q=p/2,W=[{x:-O,y:-q},{x:O,y:-q},{x:-O,y:q},{x:O,y:q}],U=L.util.calcDimensionsMatrix(F),Y=L.util.makeBoundingBoxFromPoints(W,U);return{x:Y.width,y:Y.height}},mergeClipPaths:function(l,p){var F=l,O=p;F.inverted&&!O.inverted&&(F=p,O=l),L.util.applyTransformToObject(O,L.util.multiplyTransformMatrices(L.util.invertTransform(F.calcTransformMatrix()),O.calcTransformMatrix()));var q=F.inverted&&O.inverted;return q&&(F.inverted=O.inverted=!1),new L.Group([F],{clipPath:O,inverted:q})},hasStyleChanged:function(l,p,F){return F=F||!1,l.fill!==p.fill||l.stroke!==p.stroke||l.strokeWidth!==p.strokeWidth||l.fontSize!==p.fontSize||l.fontFamily!==p.fontFamily||l.fontWeight!==p.fontWeight||l.fontStyle!==p.fontStyle||l.textBackgroundColor!==p.textBackgroundColor||l.deltaY!==p.deltaY||F&&(l.overline!==p.overline||l.underline!==p.underline||l.linethrough!==p.linethrough)},stylesToArray:function(F,p){for(var F=L.util.object.clone(F,!0),O=p.split(`
`),q=-1,W={},U=[],Y=0;Y<O.length;Y++){if(!F[Y]){q+=O[Y].length;continue}for(var J=0;J<O[Y].length;J++){q++;var te=F[Y][J];if(te&&Object.keys(te).length>0){var oe=L.util.hasStyleChanged(W,te,!0);oe?U.push({start:q,end:q+1,style:te}):U[U.length-1].end++}W=te||{}}}return U},stylesFromArray:function(l,p){if(!Array.isArray(l))return l;for(var F=p.split(`
`),O=-1,q=0,W={},U=0;U<F.length;U++)for(var Y=0;Y<F[U].length;Y++)O++,l[q]&&l[q].start<=O&&O<l[q].end&&(W[U]=W[U]||{},W[U][Y]=Object.assign({},l[q].style),O===l[q].end-1&&q++);return W}}}(X),function(){var B=Array.prototype.join,E={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},M={m:"l",M:"L"};function R(ie,ue,he,ce,me,ae,ne,ge,ve,xe,ye){var Ae=L.util.cos(ie),De=L.util.sin(ie),He=L.util.cos(ue),Se=L.util.sin(ue),pe=he*me*He-ce*ae*Se+ne,Ee=ce*me*He+he*ae*Se+ge,ke=xe+ve*(-he*me*De-ce*ae*Ae),Ce=ye+ve*(-ce*me*De+he*ae*Ae),Pe=pe+ve*(he*me*Se+ce*ae*He),Ne=Ee+ve*(ce*me*Se-he*ae*He);return["C",ke,Ce,Pe,Ne,pe,Ee]}function o(ie,ue,he,ce,me,ae,ne){var ge=Math.PI,ve=ne*ge/180,xe=L.util.sin(ve),ye=L.util.cos(ve),Ae=0,De=0;he=Math.abs(he),ce=Math.abs(ce);var He=-ye*ie*.5-xe*ue*.5,Se=-ye*ue*.5+xe*ie*.5,pe=he*he,Ee=ce*ce,ke=Se*Se,Ce=He*He,Pe=pe*Ee-pe*ke-Ee*Ce,Ne=0;if(Pe<0){var Qe=Math.sqrt(1-Pe/(pe*Ee));he*=Qe,ce*=Qe}else Ne=(me===ae?-1:1)*Math.sqrt(Pe/(pe*ke+Ee*Ce));var Ge=Ne*he*Se/ce,Te=-Ne*ce*He/he,$e=ye*Ge-xe*Te+ie*.5,et=xe*Ge+ye*Te+ue*.5,it=S(1,0,(He-Ge)/he,(Se-Te)/ce),ct=S((He-Ge)/he,(Se-Te)/ce,(-He-Ge)/he,(-Se-Te)/ce);ae===0&&ct>0?ct-=2*ge:ae===1&&ct<0&&(ct+=2*ge);for(var nt=Math.ceil(Math.abs(ct/ge*2)),ut=[],st=ct/nt,pt=8/3*Math.sin(st/4)*Math.sin(st/4)/Math.sin(st/2),_t=it+st,se=0;se<nt;se++)ut[se]=R(it,_t,ye,xe,he,ce,$e,et,pt,Ae,De),Ae=ut[se][5],De=ut[se][6],it=_t,_t+=st;return ut}function S(ie,ue,he,ce){var me=Math.atan2(ue,ie),ae=Math.atan2(ce,he);return ae>=me?ae-me:2*Math.PI-(me-ae)}function l(ie,ue,he,ce,me,ae,ne,ge){var ve;if(L.cachesBoundsOfCurve&&(ve=B.call(arguments),L.boundsOfCurveCache[ve]))return L.boundsOfCurveCache[ve];var xe=Math.sqrt,ye=Math.min,Ae=Math.max,De=Math.abs,He=[],Se=[[],[]],pe,Ee,ke,Ce,Pe,Ne,Qe,Ge;Ee=6*ie-12*he+6*me,pe=-3*ie+9*he-9*me+3*ne,ke=3*he-3*ie;for(var Te=0;Te<2;++Te){if(Te>0&&(Ee=6*ue-12*ce+6*ae,pe=-3*ue+9*ce-9*ae+3*ge,ke=3*ce-3*ue),De(pe)<1e-12){if(De(Ee)<1e-12)continue;Ce=-ke/Ee,0<Ce&&Ce<1&&He.push(Ce);continue}Qe=Ee*Ee-4*ke*pe,!(Qe<0)&&(Ge=xe(Qe),Pe=(-Ee+Ge)/(2*pe),0<Pe&&Pe<1&&He.push(Pe),Ne=(-Ee-Ge)/(2*pe),0<Ne&&Ne<1&&He.push(Ne))}for(var $e,et,it=He.length,ct=it,nt;it--;)Ce=He[it],nt=1-Ce,$e=nt*nt*nt*ie+3*nt*nt*Ce*he+3*nt*Ce*Ce*me+Ce*Ce*Ce*ne,Se[0][it]=$e,et=nt*nt*nt*ue+3*nt*nt*Ce*ce+3*nt*Ce*Ce*ae+Ce*Ce*Ce*ge,Se[1][it]=et;Se[0][ct]=ie,Se[1][ct]=ue,Se[0][ct+1]=ne,Se[1][ct+1]=ge;var ut=[{x:ye.apply(null,Se[0]),y:ye.apply(null,Se[1])},{x:Ae.apply(null,Se[0]),y:Ae.apply(null,Se[1])}];return L.cachesBoundsOfCurve&&(L.boundsOfCurveCache[ve]=ut),ut}function p(ie,ue,he){for(var ce=he[1],me=he[2],ae=he[3],ne=he[4],ge=he[5],ve=he[6],xe=he[7],ye=o(ve-ie,xe-ue,ce,me,ne,ge,ae),Ae=0,De=ye.length;Ae<De;Ae++)ye[Ae][1]+=ie,ye[Ae][2]+=ue,ye[Ae][3]+=ie,ye[Ae][4]+=ue,ye[Ae][5]+=ie,ye[Ae][6]+=ue;return ye}function F(ie){var ue=0,he=0,ce=ie.length,me=0,ae=0,ne,ge,ve,xe=[],ye,Ae,De;for(ge=0;ge<ce;++ge){switch(ve=!1,ne=ie[ge].slice(0),ne[0]){case"l":ne[0]="L",ne[1]+=ue,ne[2]+=he;case"L":ue=ne[1],he=ne[2];break;case"h":ne[1]+=ue;case"H":ne[0]="L",ne[2]=he,ue=ne[1];break;case"v":ne[1]+=he;case"V":ne[0]="L",he=ne[1],ne[1]=ue,ne[2]=he;break;case"m":ne[0]="M",ne[1]+=ue,ne[2]+=he;case"M":ue=ne[1],he=ne[2],me=ne[1],ae=ne[2];break;case"c":ne[0]="C",ne[1]+=ue,ne[2]+=he,ne[3]+=ue,ne[4]+=he,ne[5]+=ue,ne[6]+=he;case"C":Ae=ne[3],De=ne[4],ue=ne[5],he=ne[6];break;case"s":ne[0]="S",ne[1]+=ue,ne[2]+=he,ne[3]+=ue,ne[4]+=he;case"S":ye==="C"?(Ae=2*ue-Ae,De=2*he-De):(Ae=ue,De=he),ue=ne[3],he=ne[4],ne[0]="C",ne[5]=ne[3],ne[6]=ne[4],ne[3]=ne[1],ne[4]=ne[2],ne[1]=Ae,ne[2]=De,Ae=ne[3],De=ne[4];break;case"q":ne[0]="Q",ne[1]+=ue,ne[2]+=he,ne[3]+=ue,ne[4]+=he;case"Q":Ae=ne[1],De=ne[2],ue=ne[3],he=ne[4];break;case"t":ne[0]="T",ne[1]+=ue,ne[2]+=he;case"T":ye==="Q"?(Ae=2*ue-Ae,De=2*he-De):(Ae=ue,De=he),ne[0]="Q",ue=ne[1],he=ne[2],ne[1]=Ae,ne[2]=De,ne[3]=ue,ne[4]=he;break;case"a":ne[0]="A",ne[6]+=ue,ne[7]+=he;case"A":ve=!0,xe=xe.concat(p(ue,he,ne)),ue=ne[6],he=ne[7];break;case"z":case"Z":ue=me,he=ae;break}ve||xe.push(ne),ye=ne[0]}return xe}function O(ie,ue,he,ce){return Math.sqrt((he-ie)*(he-ie)+(ce-ue)*(ce-ue))}function q(ie){return ie*ie*ie}function W(ie){return 3*ie*ie*(1-ie)}function U(ie){return 3*ie*(1-ie)*(1-ie)}function Y(ie){return(1-ie)*(1-ie)*(1-ie)}function J(ie,ue,he,ce,me,ae,ne,ge){return function(ve){var xe=q(ve),ye=W(ve),Ae=U(ve),De=Y(ve);return{x:ne*xe+me*ye+he*Ae+ie*De,y:ge*xe+ae*ye+ce*Ae+ue*De}}}function te(ie,ue,he,ce,me,ae,ne,ge){return function(ve){var xe=1-ve,ye=3*xe*xe*(he-ie)+6*xe*ve*(me-he)+3*ve*ve*(ne-me),Ae=3*xe*xe*(ce-ue)+6*xe*ve*(ae-ce)+3*ve*ve*(ge-ae);return Math.atan2(Ae,ye)}}function oe(ie){return ie*ie}function fe(ie){return 2*ie*(1-ie)}function be(ie){return(1-ie)*(1-ie)}function Re(ie,ue,he,ce,me,ae){return function(ne){var ge=oe(ne),ve=fe(ne),xe=be(ne);return{x:me*ge+he*ve+ie*xe,y:ae*ge+ce*ve+ue*xe}}}function Fe(ie,ue,he,ce,me,ae){return function(ne){var ge=1-ne,ve=2*ge*(he-ie)+2*ne*(me-he),xe=2*ge*(ce-ue)+2*ne*(ae-ce);return Math.atan2(xe,ve)}}function Me(ie,ue,he){var ce={x:ue,y:he},me,ae=0,ne;for(ne=1;ne<=100;ne+=1)me=ie(ne/100),ae+=O(ce.x,ce.y,me.x,me.y),ce=me;return ae}function Be(ie,ue){for(var he=0,ce=0,me=ie.iterator,ae={x:ie.x,y:ie.y},ne,ge,ve=.01,xe=ie.angleFinder,ye;ce<ue&&ve>1e-4;)ne=me(he),ye=he,ge=O(ae.x,ae.y,ne.x,ne.y),ge+ce>ue?(he-=ve,ve/=2):(ae=ne,he+=ve,ce+=ge);return ne.angle=xe(ye),ne}function Ie(ie){for(var ue=0,he=ie.length,ce,me=0,ae=0,ne=0,ge=0,ve=[],xe,ye,Ae,De=0;De<he;De++){switch(ce=ie[De],ye={x:me,y:ae,command:ce[0]},ce[0]){case"M":ye.length=0,ne=me=ce[1],ge=ae=ce[2];break;case"L":ye.length=O(me,ae,ce[1],ce[2]),me=ce[1],ae=ce[2];break;case"C":xe=J(me,ae,ce[1],ce[2],ce[3],ce[4],ce[5],ce[6]),Ae=te(me,ae,ce[1],ce[2],ce[3],ce[4],ce[5],ce[6]),ye.iterator=xe,ye.angleFinder=Ae,ye.length=Me(xe,me,ae),me=ce[5],ae=ce[6];break;case"Q":xe=Re(me,ae,ce[1],ce[2],ce[3],ce[4]),Ae=Fe(me,ae,ce[1],ce[2],ce[3],ce[4]),ye.iterator=xe,ye.angleFinder=Ae,ye.length=Me(xe,me,ae),me=ce[3],ae=ce[4];break;case"Z":case"z":ye.destX=ne,ye.destY=ge,ye.length=O(me,ae,ne,ge),me=ne,ae=ge;break}ue+=ye.length,ve.push(ye)}return ve.push({length:ue,x:me,y:ae}),ve}function je(ie,ue,he){he||(he=Ie(ie));for(var ce=0;ue-he[ce].length>0&&ce<he.length-2;)ue-=he[ce].length,ce++;var me=he[ce],ae=ue/me.length,ne=me.command,ge=ie[ce],ve;switch(ne){case"M":return{x:me.x,y:me.y,angle:0};case"Z":case"z":return ve=new L.Point(me.x,me.y).lerp(new L.Point(me.destX,me.destY),ae),ve.angle=Math.atan2(me.destY-me.y,me.destX-me.x),ve;case"L":return ve=new L.Point(me.x,me.y).lerp(new L.Point(ge[1],ge[2]),ae),ve.angle=Math.atan2(ge[2]-me.y,ge[1]-me.x),ve;case"C":return Be(me,ue);case"Q":return Be(me,ue)}}function Xe(ie){var ue=[],he=[],ce,me,ae=L.rePathCommand,ne="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",ge="("+ne+")"+L.commaWsp,ve="([01])"+L.commaWsp+"?",xe=ge+"?"+ge+"?"+ge+ve+ve+ge+"?("+ne+")",ye=new RegExp(xe,"g"),Ae,De,He;if(!ie||!ie.match)return ue;He=ie.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Se=0,pe,Ee=He.length;Se<Ee;Se++){ce=He[Se],De=ce.slice(1).trim(),he.length=0;var ke=ce.charAt(0);if(pe=[ke],ke.toLowerCase()==="a")for(var Ce;Ce=ye.exec(De);)for(var Pe=1;Pe<Ce.length;Pe++)he.push(Ce[Pe]);else for(;Ae=ae.exec(De);)he.push(Ae[0]);for(var Pe=0,Ne=he.length;Pe<Ne;Pe++)me=parseFloat(he[Pe]),isNaN(me)||pe.push(me);var Qe=E[ke.toLowerCase()],Ge=M[ke]||ke;if(pe.length-1>Qe)for(var Te=1,$e=pe.length;Te<$e;Te+=Qe)ue.push([ke].concat(pe.slice(Te,Te+Qe))),ke=Ge;else ue.push(pe)}return ue}function ze(ie,ue){var he=[],ce,me=new L.Point(ie[0].x,ie[0].y),ae=new L.Point(ie[1].x,ie[1].y),ne=ie.length,ge=1,ve=0,xe=ne>2;for(ue=ue||0,xe&&(ge=ie[2].x<ae.x?-1:ie[2].x===ae.x?0:1,ve=ie[2].y<ae.y?-1:ie[2].y===ae.y?0:1),he.push(["M",me.x-ge*ue,me.y-ve*ue]),ce=1;ce<ne;ce++){if(!me.eq(ae)){var ye=me.midPointFrom(ae);he.push(["Q",me.x,me.y,ye.x,ye.y])}me=ie[ce],ce+1<ie.length&&(ae=ie[ce+1])}return xe&&(ge=me.x>ie[ce-2].x?1:me.x===ie[ce-2].x?0:-1,ve=me.y>ie[ce-2].y?1:me.y===ie[ce-2].y?0:-1),he.push(["L",me.x+ge*ue,me.y+ve*ue]),he}function Ue(ie,ue,he){return he&&(ue=L.util.multiplyTransformMatrices(ue,[1,0,0,1,-he.x,-he.y])),ie.map(function(ce){for(var me=ce.slice(0),ae={},ne=1;ne<ce.length-1;ne+=2)ae.x=ce[ne],ae.y=ce[ne+1],ae=L.util.transformPoint(ae,ue),me[ne]=ae.x,me[ne+1]=ae.y;return me})}L.util.joinPath=function(ie){return ie.map(function(ue){return ue.join(" ")}).join(" ")},L.util.parsePath=Xe,L.util.makePathSimpler=F,L.util.getSmoothPathFromPoints=ze,L.util.getPathSegmentsInfo=Ie,L.util.getBoundsOfCurve=l,L.util.getPointOnPath=je,L.util.transformPath=Ue}(),function(){var B=Array.prototype.slice;function E(l,p){for(var F=B.call(arguments,2),O=[],q=0,W=l.length;q<W;q++)O[q]=F.length?l[q][p].apply(l[q],F):l[q][p].call(l[q]);return O}function M(l,p){return S(l,p,function(F,O){return F>=O})}function R(l,p){return S(l,p,function(F,O){return F<O})}function o(l,p){for(var F=l.length;F--;)l[F]=p;return l}function S(l,p,F){if(!(!l||l.length===0)){var O=l.length-1,q=p?l[O][p]:l[O];if(p)for(;O--;)F(l[O][p],q)&&(q=l[O][p]);else for(;O--;)F(l[O],q)&&(q=l[O]);return q}}L.util.array={fill:o,invoke:E,min:R,max:M}}(),function(){function B(M,R,o){if(o)if(!L.isLikelyNode&&R instanceof Element)M=R;else if(R instanceof Array){M=[];for(var S=0,l=R.length;S<l;S++)M[S]=B({},R[S],o)}else if(R&&typeof R=="object")for(var p in R)p==="canvas"||p==="group"?M[p]=null:R.hasOwnProperty(p)&&(M[p]=B({},R[p],o));else M=R;else for(var p in R)M[p]=R[p];return M}function E(M,R){return B({},M,R)}L.util.object={extend:B,clone:E},L.util.object.extend(L.util,L.Observable)}(),function(){function B(S){return S.replace(/-+(.)?/g,function(l,p){return p?p.toUpperCase():""})}function E(S,l){return S.charAt(0).toUpperCase()+(l?S.slice(1):S.slice(1).toLowerCase())}function M(S){return S.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function R(S){var l=0,p,F=[];for(l=0,p;l<S.length;l++)(p=o(S,l))!==!1&&F.push(p);return F}function o(S,l){var p=S.charCodeAt(l);if(isNaN(p))return"";if(p<55296||p>57343)return S.charAt(l);if(55296<=p&&p<=56319){if(S.length<=l+1)throw"High surrogate without following low surrogate";var F=S.charCodeAt(l+1);if(56320>F||F>57343)throw"High surrogate without following low surrogate";return S.charAt(l)+S.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var O=S.charCodeAt(l-1);if(55296>O||O>56319)throw"Low surrogate without preceding high surrogate";return!1}L.util.string={camelize:B,capitalize:E,escapeXml:M,graphemeSplit:R}}(),function(){var B=Array.prototype.slice,E=function(){},M=function(){for(var p in{toString:1})if(p==="toString")return!1;return!0}(),R=function(p,F,O){for(var q in F)q in p.prototype&&typeof p.prototype[q]=="function"&&(F[q]+"").indexOf("callSuper")>-1?p.prototype[q]=function(W){return function(){var U=this.constructor.superclass;this.constructor.superclass=O;var Y=F[W].apply(this,arguments);if(this.constructor.superclass=U,W!=="initialize")return Y}}(q):p.prototype[q]=F[q],M&&(F.toString!==Object.prototype.toString&&(p.prototype.toString=F.toString),F.valueOf!==Object.prototype.valueOf&&(p.prototype.valueOf=F.valueOf))};function o(){}function S(p){for(var F=null,O=this;O.constructor.superclass;){var q=O.constructor.superclass.prototype[p];if(O[p]!==q){F=q;break}O=O.constructor.superclass.prototype}return F?arguments.length>1?F.apply(this,B.call(arguments,1)):F.call(this):console.log("tried to callSuper "+p+", method not found in prototype chain",this)}function l(){var p=null,F=B.call(arguments,0);typeof F[0]=="function"&&(p=F.shift());function O(){this.initialize.apply(this,arguments)}O.superclass=p,O.subclasses=[],p&&(o.prototype=p.prototype,O.prototype=new o,p.subclasses.push(O));for(var q=0,W=F.length;q<W;q++)R(O,F[q],p);return O.prototype.initialize||(O.prototype.initialize=E),O.prototype.constructor=O,O.prototype.callSuper=S,O}L.util.createClass=l}(),function(){var B=!!L.document.createElement("div").attachEvent,E=["touchstart","touchmove","touchend"];L.util.addListener=function(R,o,S,l){R&&R.addEventListener(o,S,B?!1:l)},L.util.removeListener=function(R,o,S,l){R&&R.removeEventListener(o,S,B?!1:l)};function M(R){var o=R.changedTouches;return o&&o[0]?o[0]:R}L.util.getPointer=function(R){var o=R.target,S=L.util.getScrollLeftTop(o),l=M(R);return{x:l.clientX+S.left,y:l.clientY+S.top}},L.util.isTouchEvent=function(R){return E.indexOf(R.type)>-1||R.pointerType==="touch"}}(),function(){function B(l,p){var F=l.style;if(!F)return l;if(typeof p=="string")return l.style.cssText+=";"+p,p.indexOf("opacity")>-1?S(l,p.match(/opacity:\s*(\d?\.?\d*)/)[1]):l;for(var O in p)if(O==="opacity")S(l,p[O]);else{var q=O==="float"||O==="cssFloat"?typeof F.styleFloat>"u"?"cssFloat":"styleFloat":O;F.setProperty(q,p[O])}return l}var E=L.document.createElement("div"),M=typeof E.style.opacity=="string",R=typeof E.style.filter=="string",o=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,S=function(l){return l};M?S=function(l,p){return l.style.opacity=p,l}:R&&(S=function(l,p){var F=l.style;return l.currentStyle&&!l.currentStyle.hasLayout&&(F.zoom=1),o.test(F.filter)?(p=p>=.9999?"":"alpha(opacity="+p*100+")",F.filter=F.filter.replace(o,p)):F.filter+=" alpha(opacity="+p*100+")",l}),L.util.setStyle=B}(),function(){var B=Array.prototype.slice;function E(Y){return typeof Y=="string"?L.document.getElementById(Y):Y}var M,R=function(Y){return B.call(Y,0)};try{M=R(L.document.childNodes)instanceof Array}catch{}M||(R=function(Y){for(var J=new Array(Y.length),te=Y.length;te--;)J[te]=Y[te];return J});function o(Y,J){var te=L.document.createElement(Y);for(var oe in J)oe==="class"?te.className=J[oe]:oe==="for"?te.htmlFor=J[oe]:te.setAttribute(oe,J[oe]);return te}function S(Y,J){Y&&(" "+Y.className+" ").indexOf(" "+J+" ")===-1&&(Y.className+=(Y.className?" ":"")+J)}function l(Y,J,te){return typeof J=="string"&&(J=o(J,te)),Y.parentNode&&Y.parentNode.replaceChild(J,Y),J.appendChild(Y),J}function p(Y){for(var J=0,te=0,oe=L.document.documentElement,fe=L.document.body||{scrollLeft:0,scrollTop:0};Y&&(Y.parentNode||Y.host)&&(Y=Y.parentNode||Y.host,Y===L.document?(J=fe.scrollLeft||oe.scrollLeft||0,te=fe.scrollTop||oe.scrollTop||0):(J+=Y.scrollLeft||0,te+=Y.scrollTop||0),!(Y.nodeType===1&&Y.style.position==="fixed")););return{left:J,top:te}}function F(Y){var J,te=Y&&Y.ownerDocument,oe={left:0,top:0},fe={left:0,top:0},be,Re={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!te)return fe;for(var Fe in Re)fe[Re[Fe]]+=parseInt(O(Y,Fe),10)||0;return J=te.documentElement,typeof Y.getBoundingClientRect<"u"&&(oe=Y.getBoundingClientRect()),be=p(Y),{left:oe.left+be.left-(J.clientLeft||0)+fe.left,top:oe.top+be.top-(J.clientTop||0)+fe.top}}var O;L.document.defaultView&&L.document.defaultView.getComputedStyle?O=function(Y,J){var te=L.document.defaultView.getComputedStyle(Y,null);return te?te[J]:void 0}:O=function(Y,J){var te=Y.style[J];return!te&&Y.currentStyle&&(te=Y.currentStyle[J]),te},function(){var Y=L.document.documentElement.style,J="userSelect"in Y?"userSelect":"MozUserSelect"in Y?"MozUserSelect":"WebkitUserSelect"in Y?"WebkitUserSelect":"KhtmlUserSelect"in Y?"KhtmlUserSelect":"";function te(fe){return typeof fe.onselectstart<"u"&&(fe.onselectstart=L.util.falseFunction),J?fe.style[J]="none":typeof fe.unselectable=="string"&&(fe.unselectable="on"),fe}function oe(fe){return typeof fe.onselectstart<"u"&&(fe.onselectstart=null),J?fe.style[J]="":typeof fe.unselectable=="string"&&(fe.unselectable=""),fe}L.util.makeElementUnselectable=te,L.util.makeElementSelectable=oe}();function q(Y){var J=L.jsdomImplForWrapper(Y);return J._canvas||J._image}function W(Y){if(L.isLikelyNode){var J=L.jsdomImplForWrapper(Y);J&&(J._image=null,J._canvas=null,J._currentSrc=null,J._attributes=null,J._classList=null)}}function U(Y,J){Y.imageSmoothingEnabled=Y.imageSmoothingEnabled||Y.webkitImageSmoothingEnabled||Y.mozImageSmoothingEnabled||Y.msImageSmoothingEnabled||Y.oImageSmoothingEnabled,Y.imageSmoothingEnabled=J}L.util.setImageSmoothing=U,L.util.getById=E,L.util.toArray=R,L.util.addClass=S,L.util.makeElement=o,L.util.wrapElement=l,L.util.getScrollLeftTop=p,L.util.getElementOffset=F,L.util.getNodeCanvas=q,L.util.cleanUpJsdomNode=W}(),function(){function B(R,o){return R+(/\?/.test(R)?"&":"?")+o}function E(){}function M(R,o){o||(o={});var S=o.method?o.method.toUpperCase():"GET",l=o.onComplete||function(){},p=new L.window.XMLHttpRequest,F=o.body||o.parameters;return p.onreadystatechange=function(){p.readyState===4&&(l(p),p.onreadystatechange=E)},S==="GET"&&(F=null,typeof o.parameters=="string"&&(R=B(R,o.parameters))),p.open(S,R,!0),(S==="POST"||S==="PUT")&&p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.send(F),p}L.util.request=M}(),L.log=console.log,L.warn=console.warn,function(){var B=L.util.object.extend,E=L.util.object.clone,M=[];L.util.object.extend(M,{cancelAll:function(){var q=this.splice(0);return q.forEach(function(W){W.cancel()}),q},cancelByCanvas:function(q){if(!q)return[];var W=this.filter(function(U){return typeof U.target=="object"&&U.target.canvas===q});return W.forEach(function(U){U.cancel()}),W},cancelByTarget:function(q){var W=this.findAnimationsByTarget(q);return W.forEach(function(U){U.cancel()}),W},findAnimationIndex:function(q){return this.indexOf(this.findAnimation(q))},findAnimation:function(q){return this.find(function(W){return W.cancel===q})},findAnimationsByTarget:function(q){return q?this.filter(function(W){return W.target===q}):[]}});function R(){return!1}function o(q,W,U,Y){return-U*Math.cos(q/Y*(Math.PI/2))+U+W}function S(q){q||(q={});var W=!1,U,Y=function(){var J=L.runningAnimations.indexOf(U);return J>-1&&L.runningAnimations.splice(J,1)[0]};return U=B(E(q),{cancel:function(){return W=!0,Y()},currentValue:"startValue"in q?q.startValue:0,completionRate:0,durationRate:0}),L.runningAnimations.push(U),F(function(J){var te=J||+new Date,oe=q.duration||500,fe=te+oe,be,Re=q.onChange||R,Fe=q.abort||R,Me=q.onComplete||R,Be=q.easing||o,Ie="startValue"in q?q.startValue.length>0:!1,je="startValue"in q?q.startValue:0,Xe="endValue"in q?q.endValue:100,ze=q.byValue||(Ie?je.map(function(Ue,ie){return Xe[ie]-je[ie]}):Xe-je);q.onStart&&q.onStart(),function Ue(ie){be=ie||+new Date;var ue=be>fe?oe:be-te,he=ue/oe,ce=Ie?je.map(function(ae,ne){return Be(ue,je[ne],ze[ne],oe)}):Be(ue,je,ze,oe),me=Math.abs(Ie?(ce[0]-je[0])/ze[0]:(ce-je)/ze);if(U.currentValue=Ie?ce.slice():ce,U.completionRate=me,U.durationRate=he,!W){if(Fe(ce,me,he)){Y();return}if(be>fe){U.currentValue=Ie?Xe.slice():Xe,U.completionRate=1,U.durationRate=1,Re(Ie?Xe.slice():Xe,1,1),Me(Xe,1,1),Y();return}else Re(ce,me,he),F(Ue)}}(te)}),U.cancel}var l=L.window.requestAnimationFrame||L.window.webkitRequestAnimationFrame||L.window.mozRequestAnimationFrame||L.window.oRequestAnimationFrame||L.window.msRequestAnimationFrame||function(q){return L.window.setTimeout(q,1e3/60)},p=L.window.cancelAnimationFrame||L.window.clearTimeout;function F(){return l.apply(L.window,arguments)}function O(){return p.apply(L.window,arguments)}L.util.animate=S,L.util.requestAnimFrame=F,L.util.cancelAnimFrame=O,L.runningAnimations=M}(),function(){function B(M,R,o){var S="rgba("+parseInt(M[0]+o*(R[0]-M[0]),10)+","+parseInt(M[1]+o*(R[1]-M[1]),10)+","+parseInt(M[2]+o*(R[2]-M[2]),10);return S+=","+(M&&R?parseFloat(M[3]+o*(R[3]-M[3])):1),S+=")",S}function E(M,R,o,S){var l=new L.Color(M).getSource(),p=new L.Color(R).getSource(),F=S.onComplete,O=S.onChange;return S=S||{},L.util.animate(L.util.object.extend(S,{duration:o||500,startValue:l,endValue:p,byValue:p,easing:function(q,W,U,Y){var J=S.colorEasing?S.colorEasing(q,Y):1-Math.cos(q/Y*(Math.PI/2));return B(W,U,J)},onComplete:function(q,W,U){if(F)return F(B(p,p,0),W,U)},onChange:function(q,W,U){if(O){if(Array.isArray(q))return O(B(q,q,0),W,U);O(q,W,U)}}}))}L.util.animateColor=E}(),function(){function B(ie,ue,he,ce){return ie<Math.abs(ue)?(ie=ue,ce=he/4):ue===0&&ie===0?ce=he/(2*Math.PI)*Math.asin(1):ce=he/(2*Math.PI)*Math.asin(ue/ie),{a:ie,c:ue,p:he,s:ce}}function E(ie,ue,he){return ie.a*Math.pow(2,10*(ue-=1))*Math.sin((ue*he-ie.s)*(2*Math.PI)/ie.p)}function M(ie,ue,he,ce){return he*((ie=ie/ce-1)*ie*ie+1)+ue}function R(ie,ue,he,ce){return ie/=ce/2,ie<1?he/2*ie*ie*ie+ue:he/2*((ie-=2)*ie*ie+2)+ue}function o(ie,ue,he,ce){return he*(ie/=ce)*ie*ie*ie+ue}function S(ie,ue,he,ce){return-he*((ie=ie/ce-1)*ie*ie*ie-1)+ue}function l(ie,ue,he,ce){return ie/=ce/2,ie<1?he/2*ie*ie*ie*ie+ue:-he/2*((ie-=2)*ie*ie*ie-2)+ue}function p(ie,ue,he,ce){return he*(ie/=ce)*ie*ie*ie*ie+ue}function F(ie,ue,he,ce){return he*((ie=ie/ce-1)*ie*ie*ie*ie+1)+ue}function O(ie,ue,he,ce){return ie/=ce/2,ie<1?he/2*ie*ie*ie*ie*ie+ue:he/2*((ie-=2)*ie*ie*ie*ie+2)+ue}function q(ie,ue,he,ce){return-he*Math.cos(ie/ce*(Math.PI/2))+he+ue}function W(ie,ue,he,ce){return he*Math.sin(ie/ce*(Math.PI/2))+ue}function U(ie,ue,he,ce){return-he/2*(Math.cos(Math.PI*ie/ce)-1)+ue}function Y(ie,ue,he,ce){return ie===0?ue:he*Math.pow(2,10*(ie/ce-1))+ue}function J(ie,ue,he,ce){return ie===ce?ue+he:he*(-Math.pow(2,-10*ie/ce)+1)+ue}function te(ie,ue,he,ce){return ie===0?ue:ie===ce?ue+he:(ie/=ce/2,ie<1?he/2*Math.pow(2,10*(ie-1))+ue:he/2*(-Math.pow(2,-10*--ie)+2)+ue)}function oe(ie,ue,he,ce){return-he*(Math.sqrt(1-(ie/=ce)*ie)-1)+ue}function fe(ie,ue,he,ce){return he*Math.sqrt(1-(ie=ie/ce-1)*ie)+ue}function be(ie,ue,he,ce){return ie/=ce/2,ie<1?-he/2*(Math.sqrt(1-ie*ie)-1)+ue:he/2*(Math.sqrt(1-(ie-=2)*ie)+1)+ue}function Re(ie,ue,he,ce){var me=1.70158,ae=0,ne=he;if(ie===0)return ue;if(ie/=ce,ie===1)return ue+he;ae||(ae=ce*.3);var ge=B(ne,he,ae,me);return-E(ge,ie,ce)+ue}function Fe(ie,ue,he,ce){var me=1.70158,ae=0,ne=he;if(ie===0)return ue;if(ie/=ce,ie===1)return ue+he;ae||(ae=ce*.3);var ge=B(ne,he,ae,me);return ge.a*Math.pow(2,-10*ie)*Math.sin((ie*ce-ge.s)*(2*Math.PI)/ge.p)+ge.c+ue}function Me(ie,ue,he,ce){var me=1.70158,ae=0,ne=he;if(ie===0)return ue;if(ie/=ce/2,ie===2)return ue+he;ae||(ae=ce*(.3*1.5));var ge=B(ne,he,ae,me);return ie<1?-.5*E(ge,ie,ce)+ue:ge.a*Math.pow(2,-10*(ie-=1))*Math.sin((ie*ce-ge.s)*(2*Math.PI)/ge.p)*.5+ge.c+ue}function Be(ie,ue,he,ce,me){return me===void 0&&(me=1.70158),he*(ie/=ce)*ie*((me+1)*ie-me)+ue}function Ie(ie,ue,he,ce,me){return me===void 0&&(me=1.70158),he*((ie=ie/ce-1)*ie*((me+1)*ie+me)+1)+ue}function je(ie,ue,he,ce,me){return me===void 0&&(me=1.70158),ie/=ce/2,ie<1?he/2*(ie*ie*(((me*=1.525)+1)*ie-me))+ue:he/2*((ie-=2)*ie*(((me*=1.525)+1)*ie+me)+2)+ue}function Xe(ie,ue,he,ce){return he-ze(ce-ie,0,he,ce)+ue}function ze(ie,ue,he,ce){return(ie/=ce)<1/2.75?he*(7.5625*ie*ie)+ue:ie<2/2.75?he*(7.5625*(ie-=1.5/2.75)*ie+.75)+ue:ie<2.5/2.75?he*(7.5625*(ie-=2.25/2.75)*ie+.9375)+ue:he*(7.5625*(ie-=2.625/2.75)*ie+.984375)+ue}function Ue(ie,ue,he,ce){return ie<ce/2?Xe(ie*2,0,he,ce)*.5+ue:ze(ie*2-ce,0,he,ce)*.5+he*.5+ue}L.util.ease={easeInQuad:function(ie,ue,he,ce){return he*(ie/=ce)*ie+ue},easeOutQuad:function(ie,ue,he,ce){return-he*(ie/=ce)*(ie-2)+ue},easeInOutQuad:function(ie,ue,he,ce){return ie/=ce/2,ie<1?he/2*ie*ie+ue:-he/2*(--ie*(ie-2)-1)+ue},easeInCubic:function(ie,ue,he,ce){return he*(ie/=ce)*ie*ie+ue},easeOutCubic:M,easeInOutCubic:R,easeInQuart:o,easeOutQuart:S,easeInOutQuart:l,easeInQuint:p,easeOutQuint:F,easeInOutQuint:O,easeInSine:q,easeOutSine:W,easeInOutSine:U,easeInExpo:Y,easeOutExpo:J,easeInOutExpo:te,easeInCirc:oe,easeOutCirc:fe,easeInOutCirc:be,easeInElastic:Re,easeOutElastic:Fe,easeInOutElastic:Me,easeInBack:Be,easeOutBack:Ie,easeInOutBack:je,easeInBounce:Xe,easeOutBounce:ze,easeInOutBounce:Ue}}(),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.util.object.clone,o=E.util.toFixed,S=E.util.parseUnit,l=E.util.multiplyTransformMatrices,p=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],F=["symbol","image","marker","pattern","view","svg"],O=["pattern","defs","symbol","metadata","clipPath","mask","desc"],q=["symbol","g","a","svg","clipPath","defs"],W={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},U={stroke:"strokeOpacity",fill:"fillOpacity"},Y="font-size",J="clip-path";E.svgValidTagNamesRegEx=fe(p),E.svgViewBoxElementsRegEx=fe(F),E.svgInvalidAncestorsRegEx=fe(O),E.svgValidParentsRegEx=fe(q),E.cssRules={},E.gradientDefs={},E.clipPaths={};function te(ae){return ae in W?W[ae]:ae}function oe(ae,ne,ge,ve){var xe=Array.isArray(ne),ye;if((ae==="fill"||ae==="stroke")&&ne==="none")ne="";else{if(ae==="strokeUniform")return ne==="non-scaling-stroke";if(ae==="strokeDashArray")ne==="none"?ne=null:ne=ne.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(ae==="transformMatrix")ge&&ge.transformMatrix?ne=l(ge.transformMatrix,E.parseTransformAttribute(ne)):ne=E.parseTransformAttribute(ne);else if(ae==="visible")ne=ne!=="none"&&ne!=="hidden",ge&&ge.visible===!1&&(ne=!1);else if(ae==="opacity")ne=parseFloat(ne),ge&&typeof ge.opacity<"u"&&(ne*=ge.opacity);else if(ae==="textAnchor")ne=ne==="start"?"left":ne==="end"?"right":"center";else if(ae==="charSpacing")ye=S(ne,ve)/ve*1e3;else if(ae==="paintFirst"){var Ae=ne.indexOf("fill"),De=ne.indexOf("stroke"),ne="fill";(Ae>-1&&De>-1&&De<Ae||Ae===-1&&De>-1)&&(ne="stroke")}else{if(ae==="href"||ae==="xlink:href"||ae==="font")return ne;if(ae==="imageSmoothing")return ne==="optimizeQuality";ye=xe?ne.map(S):S(ne,ve)}}return!xe&&isNaN(ye)?ne:ye}function fe(ae){return new RegExp("^("+ae.join("|")+")\\b","i")}function be(ae){for(var ne in U)if(!(typeof ae[U[ne]]>"u"||ae[ne]==="")){if(typeof ae[ne]>"u"){if(!E.Object.prototype[ne])continue;ae[ne]=E.Object.prototype[ne]}if(ae[ne].indexOf("url(")!==0){var ge=new E.Color(ae[ne]);ae[ne]=ge.setAlpha(o(ge.getAlpha()*ae[U[ne]],2)).toRgba()}}return ae}function Re(ae,ne){var ge,ve=[],xe,ye,Ae;for(ye=0,Ae=ne.length;ye<Ae;ye++)ge=ne[ye],xe=ae.getElementsByTagName(ge),ve=ve.concat(Array.prototype.slice.call(xe));return ve}E.parseTransformAttribute=function(){function ae(Te,$e){var et=E.util.cos($e[0]),it=E.util.sin($e[0]),ct=0,nt=0;$e.length===3&&(ct=$e[1],nt=$e[2]),Te[0]=et,Te[1]=it,Te[2]=-it,Te[3]=et,Te[4]=ct-(et*ct-it*nt),Te[5]=nt-(it*ct+et*nt)}function ne(Te,$e){var et=$e[0],it=$e.length===2?$e[1]:$e[0];Te[0]=et,Te[3]=it}function ge(Te,$e,et){Te[et]=Math.tan(E.util.degreesToRadians($e[0]))}function ve(Te,$e){Te[4]=$e[0],$e.length===2&&(Te[5]=$e[1])}var xe=E.iMatrix,ye=E.reNum,Ae=E.commaWsp,De="(?:(skewX)\\s*\\(\\s*("+ye+")\\s*\\))",He="(?:(skewY)\\s*\\(\\s*("+ye+")\\s*\\))",Se="(?:(rotate)\\s*\\(\\s*("+ye+")(?:"+Ae+"("+ye+")"+Ae+"("+ye+"))?\\s*\\))",pe="(?:(scale)\\s*\\(\\s*("+ye+")(?:"+Ae+"("+ye+"))?\\s*\\))",Ee="(?:(translate)\\s*\\(\\s*("+ye+")(?:"+Ae+"("+ye+"))?\\s*\\))",ke="(?:(matrix)\\s*\\(\\s*("+ye+")"+Ae+"("+ye+")"+Ae+"("+ye+")"+Ae+"("+ye+")"+Ae+"("+ye+")"+Ae+"("+ye+")\\s*\\))",Ce="(?:"+ke+"|"+Ee+"|"+pe+"|"+Se+"|"+De+"|"+He+")",Pe="(?:"+Ce+"(?:"+Ae+"*"+Ce+")*)",Ne="^\\s*(?:"+Pe+"?)\\s*$",Qe=new RegExp(Ne),Ge=new RegExp(Ce,"g");return function(Te){var $e=xe.concat(),et=[];if(!Te||Te&&!Qe.test(Te))return $e;Te.replace(Ge,function(ct){var nt=new RegExp(Ce).exec(ct).filter(function(pt){return!!pt}),ut=nt[1],st=nt.slice(2).map(parseFloat);switch(ut){case"translate":ve($e,st);break;case"rotate":st[0]=E.util.degreesToRadians(st[0]),ae($e,st);break;case"scale":ne($e,st);break;case"skewX":ge($e,st,2);break;case"skewY":ge($e,st,1);break;case"matrix":$e=st;break}et.push($e.concat()),$e=xe.concat()});for(var it=et[0];et.length>1;)et.shift(),it=E.util.multiplyTransformMatrices(it,et[0]);return it}}();function Fe(ae,ne){var ge,ve;ae.replace(/;\s*$/,"").split(";").forEach(function(xe){var ye=xe.split(":");ge=ye[0].trim().toLowerCase(),ve=ye[1].trim(),ne[ge]=ve})}function Me(ae,ne){var ge,ve;for(var xe in ae)typeof ae[xe]>"u"||(ge=xe.toLowerCase(),ve=ae[xe],ne[ge]=ve)}function Be(ae,ne){var ge={};for(var ve in E.cssRules[ne])if(Ie(ae,ve.split(" ")))for(var xe in E.cssRules[ne][ve])ge[xe]=E.cssRules[ne][ve][xe];return ge}function Ie(ae,ne){var ge,ve=!0;return ge=Xe(ae,ne.pop()),ge&&ne.length&&(ve=je(ae,ne)),ge&&ve&&ne.length===0}function je(ae,ne){for(var ge,ve=!0;ae.parentNode&&ae.parentNode.nodeType===1&&ne.length;)ve&&(ge=ne.pop()),ae=ae.parentNode,ve=Xe(ae,ge);return ne.length===0}function Xe(ae,ne){var ge=ae.nodeName,ve=ae.getAttribute("class"),xe=ae.getAttribute("id"),ye,Ae;if(ye=new RegExp("^"+ge,"i"),ne=ne.replace(ye,""),xe&&ne.length&&(ye=new RegExp("#"+xe+"(?![a-zA-Z\\-]+)","i"),ne=ne.replace(ye,"")),ve&&ne.length)for(ve=ve.split(" "),Ae=ve.length;Ae--;)ye=new RegExp("\\."+ve[Ae]+"(?![a-zA-Z\\-]+)","i"),ne=ne.replace(ye,"");return ne.length===0}function ze(ae,ne){var ge;if(ae.getElementById&&(ge=ae.getElementById(ne)),ge)return ge;var ve,xe,ye,Ae=ae.getElementsByTagName("*");for(xe=0,ye=Ae.length;xe<ye;xe++)if(ve=Ae[xe],ne===ve.getAttribute("id"))return ve}function Ue(ae){for(var ne=Re(ae,["use","svg:use"]),ge=0;ne.length&&ge<ne.length;){var ve=ne[ge],xe=ve.getAttribute("xlink:href")||ve.getAttribute("href");if(xe===null)return;var ye=xe.slice(1),Ae=ve.getAttribute("x")||0,De=ve.getAttribute("y")||0,He=ze(ae,ye).cloneNode(!0),Se=(He.getAttribute("transform")||"")+" translate("+Ae+", "+De+")",pe,Ee=ne.length,ke,Ce,Pe,Ne,Qe=E.svgNS;if(ue(He),/^svg$/i.test(He.nodeName)){var Ge=He.ownerDocument.createElementNS(Qe,"g");for(Ce=0,Pe=He.attributes,Ne=Pe.length;Ce<Ne;Ce++)ke=Pe.item(Ce),Ge.setAttributeNS(Qe,ke.nodeName,ke.nodeValue);for(;He.firstChild;)Ge.appendChild(He.firstChild);He=Ge}for(Ce=0,Pe=ve.attributes,Ne=Pe.length;Ce<Ne;Ce++)ke=Pe.item(Ce),!(ke.nodeName==="x"||ke.nodeName==="y"||ke.nodeName==="xlink:href"||ke.nodeName==="href")&&(ke.nodeName==="transform"?Se=ke.nodeValue+" "+Se:He.setAttribute(ke.nodeName,ke.nodeValue));He.setAttribute("transform",Se),He.setAttribute("instantiated_by_use","1"),He.removeAttribute("id"),pe=ve.parentNode,pe.replaceChild(He,ve),ne.length===Ee&&ge++}}var ie=new RegExp("^\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*$");function ue(ae){if(!E.svgViewBoxElementsRegEx.test(ae.nodeName))return{};var ne=ae.getAttribute("viewBox"),ge=1,ve=1,xe=0,ye=0,Ae,De,He,Se,pe=ae.getAttribute("width"),Ee=ae.getAttribute("height"),ke=ae.getAttribute("x")||0,Ce=ae.getAttribute("y")||0,Pe=ae.getAttribute("preserveAspectRatio")||"",Ne=!ne||!(ne=ne.match(ie)),Qe=!pe||!Ee||pe==="100%"||Ee==="100%",Ge=Ne&&Qe,Te={},$e="",et=0,it=0;if(Te.width=0,Te.height=0,Te.toBeParsed=Ge,Ne&&(ke||Ce)&&ae.parentNode&&ae.parentNode.nodeName!=="#document"&&($e=" translate("+S(ke)+" "+S(Ce)+") ",He=(ae.getAttribute("transform")||"")+$e,ae.setAttribute("transform",He),ae.removeAttribute("x"),ae.removeAttribute("y")),Ge)return Te;if(Ne)return Te.width=S(pe),Te.height=S(Ee),Te;if(xe=-parseFloat(ne[1]),ye=-parseFloat(ne[2]),Ae=parseFloat(ne[3]),De=parseFloat(ne[4]),Te.minX=xe,Te.minY=ye,Te.viewBoxWidth=Ae,Te.viewBoxHeight=De,Qe?(Te.width=Ae,Te.height=De):(Te.width=S(pe),Te.height=S(Ee),ge=Te.width/Ae,ve=Te.height/De),Pe=E.util.parsePreserveAspectRatioAttribute(Pe),Pe.alignX!=="none"&&(Pe.meetOrSlice==="meet"&&(ve=ge=ge>ve?ve:ge),Pe.meetOrSlice==="slice"&&(ve=ge=ge>ve?ge:ve),et=Te.width-Ae*ge,it=Te.height-De*ge,Pe.alignX==="Mid"&&(et/=2),Pe.alignY==="Mid"&&(it/=2),Pe.alignX==="Min"&&(et=0),Pe.alignY==="Min"&&(it=0)),ge===1&&ve===1&&xe===0&&ye===0&&ke===0&&Ce===0)return Te;if((ke||Ce)&&ae.parentNode.nodeName!=="#document"&&($e=" translate("+S(ke)+" "+S(Ce)+") "),He=$e+" matrix("+ge+" 0 0 "+ve+" "+(xe*ge+et)+" "+(ye*ve+it)+") ",ae.nodeName==="svg"){for(Se=ae.ownerDocument.createElementNS(E.svgNS,"g");ae.firstChild;)Se.appendChild(ae.firstChild);ae.appendChild(Se)}else Se=ae,Se.removeAttribute("x"),Se.removeAttribute("y"),He=Se.getAttribute("transform")+He;return Se.setAttribute("transform",He),Te}function he(ae,ne){for(;ae&&(ae=ae.parentNode);)if(ae.nodeName&&ne.test(ae.nodeName.replace("svg:",""))&&!ae.getAttribute("instantiated_by_use"))return!0;return!1}E.parseSVGDocument=function(ae,ne,ge,ve){if(ae){Ue(ae);var xe=E.Object.__uid++,ye,Ae,De=ue(ae),He=E.util.toArray(ae.getElementsByTagName("*"));if(De.crossOrigin=ve&&ve.crossOrigin,De.svgUid=xe,He.length===0&&E.isLikelyNode){He=ae.selectNodes('//*[name(.)!="svg"]');var Se=[];for(ye=0,Ae=He.length;ye<Ae;ye++)Se[ye]=He[ye];He=Se}var pe=He.filter(function(ke){return ue(ke),E.svgValidTagNamesRegEx.test(ke.nodeName.replace("svg:",""))&&!he(ke,E.svgInvalidAncestorsRegEx)});if(!pe||pe&&!pe.length){ne&&ne([],{});return}var Ee={};He.filter(function(ke){return ke.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ke){var Ce=ke.getAttribute("id");Ee[Ce]=E.util.toArray(ke.getElementsByTagName("*")).filter(function(Pe){return E.svgValidTagNamesRegEx.test(Pe.nodeName.replace("svg:",""))})}),E.gradientDefs[xe]=E.getGradientDefs(ae),E.cssRules[xe]=E.getCSSRules(ae),E.clipPaths[xe]=Ee,E.parseElements(pe,function(ke,Ce){ne&&(ne(ke,De,Ce,He),delete E.gradientDefs[xe],delete E.cssRules[xe],delete E.clipPaths[xe])},R(De),ge,ve)}};function ce(ae,ne){var ge=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],ve="xlink:href",xe=ne.getAttribute(ve).slice(1),ye=ze(ae,xe);if(ye&&ye.getAttribute(ve)&&ce(ae,ye),ge.forEach(function(De){ye&&!ne.hasAttribute(De)&&ye.hasAttribute(De)&&ne.setAttribute(De,ye.getAttribute(De))}),!ne.children.length)for(var Ae=ye.cloneNode(!0);Ae.firstChild;)ne.appendChild(Ae.firstChild);ne.removeAttribute(ve)}var me=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+E.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+E.reNum+"))?\\s+(.*)");M(E,{parseFontDeclaration:function(ae,ne){var ge=ae.match(me);if(ge){var ve=ge[1],xe=ge[3],ye=ge[4],Ae=ge[5],De=ge[6];ve&&(ne.fontStyle=ve),xe&&(ne.fontWeight=isNaN(parseFloat(xe))?xe:parseFloat(xe)),ye&&(ne.fontSize=S(ye)),De&&(ne.fontFamily=De),Ae&&(ne.lineHeight=Ae==="normal"?1:Ae)}},getGradientDefs:function(ae){var ne=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],ge=Re(ae,ne),ve,xe=0,ye={};for(xe=ge.length;xe--;)ve=ge[xe],ve.getAttribute("xlink:href")&&ce(ae,ve),ye[ve.getAttribute("id")]=ve;return ye},parseAttributes:function(ae,ne,ge){if(ae){var ve,xe={},ye,Ae;typeof ge>"u"&&(ge=ae.getAttribute("svgUid")),ae.parentNode&&E.svgValidParentsRegEx.test(ae.parentNode.nodeName)&&(xe=E.parseAttributes(ae.parentNode,ne,ge));var De=ne.reduce(function(Pe,Ne){return ve=ae.getAttribute(Ne),ve&&(Pe[Ne]=ve),Pe},{}),He=M(Be(ae,ge),E.parseStyleAttribute(ae));De=M(De,He),He[J]&&ae.setAttribute(J,He[J]),ye=Ae=xe.fontSize||E.Text.DEFAULT_SVG_FONT_SIZE,De[Y]&&(De[Y]=ye=S(De[Y],Ae));var Se,pe,Ee={};for(var ke in De)Se=te(ke),pe=oe(Se,De[ke],xe,ye),Ee[Se]=pe;Ee&&Ee.font&&E.parseFontDeclaration(Ee.font,Ee);var Ce=M(xe,Ee);return E.svgValidParentsRegEx.test(ae.nodeName)?Ce:be(Ce)}},parseElements:function(ae,ne,ge,ve,xe){new E.ElementsParser(ae,ne,ge,ve,xe).parse()},parseStyleAttribute:function(ae){var ne={},ge=ae.getAttribute("style");return ge&&(typeof ge=="string"?Fe(ge,ne):Me(ge,ne)),ne},parsePointsAttribute:function(ae){if(!ae)return null;ae=ae.replace(/,/g," ").trim(),ae=ae.split(/\s+/);var ne=[],ge,ve;for(ge=0,ve=ae.length;ge<ve;ge+=2)ne.push({x:parseFloat(ae[ge]),y:parseFloat(ae[ge+1])});return ne},getCSSRules:function(ae){var ne=ae.getElementsByTagName("style"),ge,ve,xe={},ye;for(ge=0,ve=ne.length;ge<ve;ge++){var Ae=ne[ge].textContent;Ae=Ae.replace(/\/\*[\s\S]*?\*\//g,""),Ae.trim()!==""&&(ye=Ae.split("}"),ye=ye.filter(function(De){return De.trim()}),ye.forEach(function(De){var He=De.split("{"),Se={},pe=He[1].trim(),Ee=pe.split(";").filter(function(Ne){return Ne.trim()});for(ge=0,ve=Ee.length;ge<ve;ge++){var ke=Ee[ge].split(":"),Ce=ke[0].trim(),Pe=ke[1].trim();Se[Ce]=Pe}De=He[0].trim(),De.split(",").forEach(function(Ne){Ne=Ne.replace(/^svg/i,"").trim(),Ne!==""&&(xe[Ne]?E.util.object.extend(xe[Ne],Se):xe[Ne]=E.util.object.clone(Se))})}))}return xe},loadSVGFromURL:function(ae,ne,ge,ve){ae=ae.replace(/^\n\s*/,"").trim(),new E.util.request(ae,{method:"get",onComplete:xe});function xe(ye){var Ae=ye.responseXML;if(!Ae||!Ae.documentElement)return ne&&ne(null),!1;E.parseSVGDocument(Ae.documentElement,function(De,He,Se,pe){ne&&ne(De,He,Se,pe)},ge,ve)}},loadSVGFromString:function(ae,ne,ge,ve){var xe=new E.window.DOMParser,ye=xe.parseFromString(ae.trim(),"text/xml");E.parseSVGDocument(ye.documentElement,function(Ae,De,He,Se){ne(Ae,De,He,Se)},ge,ve)}})}(X),L.ElementsParser=function(B,E,M,R,o,S){this.elements=B,this.callback=E,this.options=M,this.reviver=R,this.svgUid=M&&M.svgUid||0,this.parsingOptions=o,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=S},function(B){B.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},B.createObjects=function(){var E=this;this.elements.forEach(function(M,R){M.setAttribute("svgUid",E.svgUid),E.createObject(M,R)})},B.findTag=function(E){return L[L.util.string.capitalize(E.tagName.replace("svg:",""))]},B.createObject=function(E,M){var R=this.findTag(E);if(R&&R.fromElement)try{R.fromElement(E,this.createCallback(M,E),this.options)}catch(o){L.log(o)}else this.checkIfDone()},B.createCallback=function(E,M){var R=this;return function(o){var S;R.resolveGradient(o,M,"fill"),R.resolveGradient(o,M,"stroke"),o instanceof L.Image&&o._originalElement&&(S=o.parsePreserveAspectRatioAttribute(M)),o._removeTransformMatrix(S),R.resolveClipPath(o,M),R.reviver&&R.reviver(M,o),R.instances[E]=o,R.checkIfDone()}},B.extractPropertyDefinition=function(E,M,R){var o=E[M],S=this.regexUrl;if(S.test(o)){S.lastIndex=0;var l=S.exec(o)[1];return S.lastIndex=0,L[R][this.svgUid][l]}},B.resolveGradient=function(E,M,R){var o=this.extractPropertyDefinition(E,R,"gradientDefs");if(o){var S=M.getAttribute(R+"-opacity"),l=L.Gradient.fromElement(o,E,S,this.options);E.set(R,l)}},B.createClipPathCallback=function(E,M){return function(R){R._removeTransformMatrix(),R.fillRule=R.clipRule,M.push(R)}},B.resolveClipPath=function(E,M){var R=this.extractPropertyDefinition(E,"clipPath","clipPaths"),o,S,l,p,F,O;if(R){p=[],l=L.util.invertTransform(E.calcTransformMatrix());for(var q=R[0].parentNode,W=M;W.parentNode&&W.getAttribute("clip-path")!==E.clipPath;)W=W.parentNode;W.parentNode.appendChild(q);for(var U=0;U<R.length;U++)o=R[U],S=this.findTag(o),S.fromElement(o,this.createClipPathCallback(E,p),this.options);p.length===1?R=p[0]:R=new L.Group(p),F=L.util.multiplyTransformMatrices(l,R.calcTransformMatrix()),R.clipPath&&this.resolveClipPath(R,W);var O=L.util.qrDecompose(F);R.flipX=!1,R.flipY=!1,R.set("scaleX",O.scaleX),R.set("scaleY",O.scaleY),R.angle=O.angle,R.skewX=O.skewX,R.skewY=0,R.setPositionByOrigin({x:O.translateX,y:O.translateY},"center","center"),E.clipPath=R}else delete E.clipPath},B.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(E){return E!=null}),this.callback(this.instances,this.elements))}}(L.ElementsParser.prototype),function(B){var E=B.fabric||(B.fabric={});if(E.Point){E.warn("fabric.Point is already defined");return}E.Point=M;function M(R,o){this.x=R,this.y=o}M.prototype={type:"point",constructor:M,add:function(R){return new M(this.x+R.x,this.y+R.y)},addEquals:function(R){return this.x+=R.x,this.y+=R.y,this},scalarAdd:function(R){return new M(this.x+R,this.y+R)},scalarAddEquals:function(R){return this.x+=R,this.y+=R,this},subtract:function(R){return new M(this.x-R.x,this.y-R.y)},subtractEquals:function(R){return this.x-=R.x,this.y-=R.y,this},scalarSubtract:function(R){return new M(this.x-R,this.y-R)},scalarSubtractEquals:function(R){return this.x-=R,this.y-=R,this},multiply:function(R){return new M(this.x*R,this.y*R)},multiplyEquals:function(R){return this.x*=R,this.y*=R,this},divide:function(R){return new M(this.x/R,this.y/R)},divideEquals:function(R){return this.x/=R,this.y/=R,this},eq:function(R){return this.x===R.x&&this.y===R.y},lt:function(R){return this.x<R.x&&this.y<R.y},lte:function(R){return this.x<=R.x&&this.y<=R.y},gt:function(R){return this.x>R.x&&this.y>R.y},gte:function(R){return this.x>=R.x&&this.y>=R.y},lerp:function(R,o){return typeof o>"u"&&(o=.5),o=Math.max(Math.min(1,o),0),new M(this.x+(R.x-this.x)*o,this.y+(R.y-this.y)*o)},distanceFrom:function(R){var o=this.x-R.x,S=this.y-R.y;return Math.sqrt(o*o+S*S)},midPointFrom:function(R){return this.lerp(R)},min:function(R){return new M(Math.min(this.x,R.x),Math.min(this.y,R.y))},max:function(R){return new M(Math.max(this.x,R.x),Math.max(this.y,R.y))},toString:function(){return this.x+","+this.y},setXY:function(R,o){return this.x=R,this.y=o,this},setX:function(R){return this.x=R,this},setY:function(R){return this.y=R,this},setFromPoint:function(R){return this.x=R.x,this.y=R.y,this},swap:function(R){var o=this.x,S=this.y;this.x=R.x,this.y=R.y,R.x=o,R.y=S},clone:function(){return new M(this.x,this.y)}}}(X),function(B){var E=B.fabric||(B.fabric={});if(E.Intersection){E.warn("fabric.Intersection is already defined");return}function M(R){this.status=R,this.points=[]}E.Intersection=M,E.Intersection.prototype={constructor:M,appendPoint:function(R){return this.points.push(R),this},appendPoints:function(R){return this.points=this.points.concat(R),this}},E.Intersection.intersectLineLine=function(R,o,S,l){var p,F=(l.x-S.x)*(R.y-S.y)-(l.y-S.y)*(R.x-S.x),O=(o.x-R.x)*(R.y-S.y)-(o.y-R.y)*(R.x-S.x),q=(l.y-S.y)*(o.x-R.x)-(l.x-S.x)*(o.y-R.y);if(q!==0){var W=F/q,U=O/q;0<=W&&W<=1&&0<=U&&U<=1?(p=new M("Intersection"),p.appendPoint(new E.Point(R.x+W*(o.x-R.x),R.y+W*(o.y-R.y)))):p=new M}else F===0||O===0?p=new M("Coincident"):p=new M("Parallel");return p},E.Intersection.intersectLinePolygon=function(R,o,S){var l=new M,p=S.length,F,O,q,W;for(W=0;W<p;W++)F=S[W],O=S[(W+1)%p],q=M.intersectLineLine(R,o,F,O),l.appendPoints(q.points);return l.points.length>0&&(l.status="Intersection"),l},E.Intersection.intersectPolygonPolygon=function(R,o){var S=new M,l=R.length,p;for(p=0;p<l;p++){var F=R[p],O=R[(p+1)%l],q=M.intersectLinePolygon(F,O,o);S.appendPoints(q.points)}return S.points.length>0&&(S.status="Intersection"),S},E.Intersection.intersectPolygonRectangle=function(R,o,S){var l=o.min(S),p=o.max(S),F=new E.Point(p.x,l.y),O=new E.Point(l.x,p.y),q=M.intersectLinePolygon(l,F,R),W=M.intersectLinePolygon(F,p,R),U=M.intersectLinePolygon(p,O,R),Y=M.intersectLinePolygon(O,l,R),J=new M;return J.appendPoints(q.points),J.appendPoints(W.points),J.appendPoints(U.points),J.appendPoints(Y.points),J.points.length>0&&(J.status="Intersection"),J}}(X),function(B){var E=B.fabric||(B.fabric={});if(E.Color){E.warn("fabric.Color is already defined.");return}function M(o){o?this._tryParsingColor(o):this.setSource([0,0,0,1])}E.Color=M,E.Color.prototype={_tryParsingColor:function(o){var S;o in M.colorNameMap&&(o=M.colorNameMap[o]),o==="transparent"&&(S=[255,255,255,0]),S||(S=M.sourceFromHex(o)),S||(S=M.sourceFromRgb(o)),S||(S=M.sourceFromHsl(o)),S||(S=[0,0,0,1]),S&&this.setSource(S)},_rgbToHsl:function(o,S,l){o/=255,S/=255,l/=255;var p,F,O,q=E.util.array.max([o,S,l]),W=E.util.array.min([o,S,l]);if(O=(q+W)/2,q===W)p=F=0;else{var U=q-W;switch(F=O>.5?U/(2-q-W):U/(q+W),q){case o:p=(S-l)/U+(S<l?6:0);break;case S:p=(l-o)/U+2;break;case l:p=(o-S)/U+4;break}p/=6}return[Math.round(p*360),Math.round(F*100),Math.round(O*100)]},getSource:function(){return this._source},setSource:function(o){this._source=o},toRgb:function(){var o=this.getSource();return"rgb("+o[0]+","+o[1]+","+o[2]+")"},toRgba:function(){var o=this.getSource();return"rgba("+o[0]+","+o[1]+","+o[2]+","+o[3]+")"},toHsl:function(){var o=this.getSource(),S=this._rgbToHsl(o[0],o[1],o[2]);return"hsl("+S[0]+","+S[1]+"%,"+S[2]+"%)"},toHsla:function(){var o=this.getSource(),S=this._rgbToHsl(o[0],o[1],o[2]);return"hsla("+S[0]+","+S[1]+"%,"+S[2]+"%,"+o[3]+")"},toHex:function(){var o=this.getSource(),S,l,p;return S=o[0].toString(16),S=S.length===1?"0"+S:S,l=o[1].toString(16),l=l.length===1?"0"+l:l,p=o[2].toString(16),p=p.length===1?"0"+p:p,S.toUpperCase()+l.toUpperCase()+p.toUpperCase()},toHexa:function(){var o=this.getSource(),S;return S=Math.round(o[3]*255),S=S.toString(16),S=S.length===1?"0"+S:S,this.toHex()+S.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(o){var S=this.getSource();return S[3]=o,this.setSource(S),this},toGrayscale:function(){var o=this.getSource(),S=parseInt((o[0]*.3+o[1]*.59+o[2]*.11).toFixed(0),10),l=o[3];return this.setSource([S,S,S,l]),this},toBlackWhite:function(o){var S=this.getSource(),l=(S[0]*.3+S[1]*.59+S[2]*.11).toFixed(0),p=S[3];return o=o||127,l=Number(l)<Number(o)?0:255,this.setSource([l,l,l,p]),this},overlayWith:function(o){o instanceof M||(o=new M(o));var S=[],l=this.getAlpha(),p=.5,F=this.getSource(),O=o.getSource(),q;for(q=0;q<3;q++)S.push(Math.round(F[q]*(1-p)+O[q]*p));return S[3]=l,this.setSource(S),this}},E.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,E.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,E.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,E.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function R(o,S,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?o+(S-o)*6*l:l<1/2?S:l<2/3?o+(S-o)*(2/3-l)*6:o}E.Color.fromRgb=function(o){return M.fromSource(M.sourceFromRgb(o))},E.Color.sourceFromRgb=function(o){var S=o.match(M.reRGBa);if(S){var l=parseInt(S[1],10)/(/%$/.test(S[1])?100:1)*(/%$/.test(S[1])?255:1),p=parseInt(S[2],10)/(/%$/.test(S[2])?100:1)*(/%$/.test(S[2])?255:1),F=parseInt(S[3],10)/(/%$/.test(S[3])?100:1)*(/%$/.test(S[3])?255:1);return[parseInt(l,10),parseInt(p,10),parseInt(F,10),S[4]?parseFloat(S[4]):1]}},E.Color.fromRgba=M.fromRgb,E.Color.fromHsl=function(o){return M.fromSource(M.sourceFromHsl(o))},E.Color.sourceFromHsl=function(o){var S=o.match(M.reHSLa);if(S){var l=(parseFloat(S[1])%360+360)%360/360,p=parseFloat(S[2])/(/%$/.test(S[2])?100:1),F=parseFloat(S[3])/(/%$/.test(S[3])?100:1),O,q,W;if(p===0)O=q=W=F;else{var U=F<=.5?F*(p+1):F+p-F*p,Y=F*2-U;O=R(Y,U,l+1/3),q=R(Y,U,l),W=R(Y,U,l-1/3)}return[Math.round(O*255),Math.round(q*255),Math.round(W*255),S[4]?parseFloat(S[4]):1]}},E.Color.fromHsla=M.fromHsl,E.Color.fromHex=function(o){return M.fromSource(M.sourceFromHex(o))},E.Color.sourceFromHex=function(o){if(o.match(M.reHex)){var S=o.slice(o.indexOf("#")+1),l=S.length===3||S.length===4,p=S.length===8||S.length===4,F=l?S.charAt(0)+S.charAt(0):S.substring(0,2),O=l?S.charAt(1)+S.charAt(1):S.substring(2,4),q=l?S.charAt(2)+S.charAt(2):S.substring(4,6),W=p?l?S.charAt(3)+S.charAt(3):S.substring(6,8):"FF";return[parseInt(F,16),parseInt(O,16),parseInt(q,16),parseFloat((parseInt(W,16)/255).toFixed(2))]}},E.Color.fromSource=function(o){var S=new M;return S.setSource(o),S}}(X),function(B){var E=B.fabric||(B.fabric={}),M=["e","se","s","sw","w","nw","n","ne","e"],R=["ns","nesw","ew","nwse"],o={},S="left",l="top",p="right",F="bottom",O="center",q={top:F,bottom:l,left:p,right:S,center:O},W=E.util.radiansToDegrees,U=Math.sign||function(Se){return(Se>0)-(Se<0)||+Se};function Y(Se,pe){var Ee=Se.angle+W(Math.atan2(pe.y,pe.x))+360;return Math.round(Ee%360/45)}function J(Se,pe){var Ee=pe.transform.target,ke=Ee.canvas,Ce=E.util.object.clone(pe);Ce.target=Ee,ke&&ke.fire("object:"+Se,Ce),Ee.fire(Se,pe)}function te(Se,pe){var Ee=pe.canvas,ke=Ee.uniScaleKey,Ce=Se[ke];return Ee.uniformScaling&&!Ce||!Ee.uniformScaling&&Ce}function oe(Se){return Se.originX===O&&Se.originY===O}function fe(Se,pe,Ee){var ke=Se.lockScalingX,Ce=Se.lockScalingY;return!!(ke&&Ce||!pe&&(ke||Ce)&&Ee||ke&&pe==="x"||Ce&&pe==="y")}function be(Se,pe,Ee){var ke="not-allowed",Ce=te(Se,Ee),Pe="";if(pe.x!==0&&pe.y===0?Pe="x":pe.x===0&&pe.y!==0&&(Pe="y"),fe(Ee,Pe,Ce))return ke;var Ne=Y(Ee,pe);return M[Ne]+"-resize"}function Re(Se,pe,Ee){var ke="not-allowed";if(pe.x!==0&&Ee.lockSkewingY||pe.y!==0&&Ee.lockSkewingX)return ke;var Ce=Y(Ee,pe)%4;return R[Ce]+"-resize"}function Fe(Se,pe,Ee){return Se[Ee.canvas.altActionKey]?o.skewCursorStyleHandler(Se,pe,Ee):o.scaleCursorStyleHandler(Se,pe,Ee)}function Me(Se,pe,Ee){var ke=Se[Ee.canvas.altActionKey];if(pe.x===0)return ke?"skewX":"scaleY";if(pe.y===0)return ke?"skewY":"scaleX"}function Be(Se,pe,Ee){return Ee.lockRotation?"not-allowed":pe.cursorStyle}function Ie(Se,pe,Ee,ke){return{e:Se,transform:pe,pointer:{x:Ee,y:ke}}}function je(Se){return function(pe,Ee,ke,Ce){var Pe=Ee.target,Ne=Pe.getCenterPoint(),Qe=Pe.translateToOriginPoint(Ne,Ee.originX,Ee.originY),Ge=Se(pe,Ee,ke,Ce);return Pe.setPositionByOrigin(Qe,Ee.originX,Ee.originY),Ge}}function Xe(Se,pe){return function(Ee,ke,Ce,Pe){var Ne=pe(Ee,ke,Ce,Pe);return Ne&&J(Se,Ie(Ee,ke,Ce,Pe)),Ne}}function ze(Se,pe,Ee,ke,Ce){var Pe=Se.target,Ne=Pe.controls[Se.corner],Qe=Pe.canvas.getZoom(),Ge=Pe.padding/Qe,Te=Pe.toLocalPoint(new E.Point(ke,Ce),pe,Ee);return Te.x>=Ge&&(Te.x-=Ge),Te.x<=-Ge&&(Te.x+=Ge),Te.y>=Ge&&(Te.y-=Ge),Te.y<=Ge&&(Te.y+=Ge),Te.x-=Ne.offsetX,Te.y-=Ne.offsetY,Te}function Ue(Se){return Se.flipX!==Se.flipY}function ie(Se,pe,Ee,ke,Ce){if(Se[pe]!==0){var Pe=Se._getTransformedDimensions()[ke],Ne=Ce/Pe*Se[Ee];Se.set(Ee,Ne)}}function ue(Se,pe,Ee,ke){var Ce=pe.target,Pe=Ce._getTransformedDimensions(0,Ce.skewY),Ne=ze(pe,pe.originX,pe.originY,Ee,ke),Qe=Math.abs(Ne.x*2)-Pe.x,Ge=Ce.skewX,Te;Qe<2?Te=0:(Te=W(Math.atan2(Qe/Ce.scaleX,Pe.y/Ce.scaleY)),pe.originX===S&&pe.originY===F&&(Te=-Te),pe.originX===p&&pe.originY===l&&(Te=-Te),Ue(Ce)&&(Te=-Te));var $e=Ge!==Te;if($e){var et=Ce._getTransformedDimensions().y;Ce.set("skewX",Te),ie(Ce,"skewY","scaleY","y",et)}return $e}function he(Se,pe,Ee,ke){var Ce=pe.target,Pe=Ce._getTransformedDimensions(Ce.skewX,0),Ne=ze(pe,pe.originX,pe.originY,Ee,ke),Qe=Math.abs(Ne.y*2)-Pe.y,Ge=Ce.skewY,Te;Qe<2?Te=0:(Te=W(Math.atan2(Qe/Ce.scaleY,Pe.x/Ce.scaleX)),pe.originX===S&&pe.originY===F&&(Te=-Te),pe.originX===p&&pe.originY===l&&(Te=-Te),Ue(Ce)&&(Te=-Te));var $e=Ge!==Te;if($e){var et=Ce._getTransformedDimensions().x;Ce.set("skewY",Te),ie(Ce,"skewX","scaleX","x",et)}return $e}function ce(Se,pe,Ee,ke){var Ce=pe.target,Pe=Ce.skewX,Ne,Qe=pe.originY;if(Ce.lockSkewingX)return!1;if(Pe===0){var Ge=ze(pe,O,O,Ee,ke);Ge.x>0?Ne=S:Ne=p}else Pe>0&&(Ne=Qe===l?S:p),Pe<0&&(Ne=Qe===l?p:S),Ue(Ce)&&(Ne=Ne===S?p:S);pe.originX=Ne;var Te=Xe("skewing",je(ue));return Te(Se,pe,Ee,ke)}function me(Se,pe,Ee,ke){var Ce=pe.target,Pe=Ce.skewY,Ne,Qe=pe.originX;if(Ce.lockSkewingY)return!1;if(Pe===0){var Ge=ze(pe,O,O,Ee,ke);Ge.y>0?Ne=l:Ne=F}else Pe>0&&(Ne=Qe===S?l:F),Pe<0&&(Ne=Qe===S?F:l),Ue(Ce)&&(Ne=Ne===l?F:l);pe.originY=Ne;var Te=Xe("skewing",je(he));return Te(Se,pe,Ee,ke)}function ae(Se,pe,Ee,ke){var Ce=pe,Pe=Ce.target,Ne=Pe.translateToOriginPoint(Pe.getCenterPoint(),Ce.originX,Ce.originY);if(Pe.lockRotation)return!1;var Qe=Math.atan2(Ce.ey-Ne.y,Ce.ex-Ne.x),Ge=Math.atan2(ke-Ne.y,Ee-Ne.x),Te=W(Ge-Qe+Ce.theta),$e=!0;if(Pe.snapAngle>0){var et=Pe.snapAngle,it=Pe.snapThreshold||et,ct=Math.ceil(Te/et)*et,nt=Math.floor(Te/et)*et;Math.abs(Te-nt)<it?Te=nt:Math.abs(Te-ct)<it&&(Te=ct)}return Te<0&&(Te=360+Te),Te%=360,$e=Pe.angle!==Te,Pe.angle=Te,$e}function ne(Se,pe,Ee,ke,Ce){Ce=Ce||{};var Pe=pe.target,Ne=Pe.lockScalingX,Qe=Pe.lockScalingY,Ge=Ce.by,Te,$e,et,it,ct=te(Se,Pe),nt=fe(Pe,Ge,ct),ut,st,pt=pe.gestureScale;if(nt)return!1;if(pt)$e=pe.scaleX*pt,et=pe.scaleY*pt;else{if(Te=ze(pe,pe.originX,pe.originY,Ee,ke),ut=Ge!=="y"?U(Te.x):1,st=Ge!=="x"?U(Te.y):1,pe.signX||(pe.signX=ut),pe.signY||(pe.signY=st),Pe.lockScalingFlip&&(pe.signX!==ut||pe.signY!==st))return!1;if(it=Pe._getTransformedDimensions(),ct&&!Ge){var _t=Math.abs(Te.x)+Math.abs(Te.y),se=pe.original,de=Math.abs(it.x*se.scaleX/Pe.scaleX)+Math.abs(it.y*se.scaleY/Pe.scaleY),Le=_t/de;$e=se.scaleX*Le,et=se.scaleY*Le}else $e=Math.abs(Te.x*Pe.scaleX/it.x),et=Math.abs(Te.y*Pe.scaleY/it.y);oe(pe)&&($e*=2,et*=2),pe.signX!==ut&&Ge!=="y"&&(pe.originX=q[pe.originX],$e*=-1,pe.signX=ut),pe.signY!==st&&Ge!=="x"&&(pe.originY=q[pe.originY],et*=-1,pe.signY=st)}var we=Pe.scaleX,We=Pe.scaleY;return Ge?(Ge==="x"&&Pe.set("scaleX",$e),Ge==="y"&&Pe.set("scaleY",et)):(!Ne&&Pe.set("scaleX",$e),!Qe&&Pe.set("scaleY",et)),we!==Pe.scaleX||We!==Pe.scaleY}function ge(Se,pe,Ee,ke){return ne(Se,pe,Ee,ke)}function ve(Se,pe,Ee,ke){return ne(Se,pe,Ee,ke,{by:"x"})}function xe(Se,pe,Ee,ke){return ne(Se,pe,Ee,ke,{by:"y"})}function ye(Se,pe,Ee,ke){return Se[pe.target.canvas.altActionKey]?o.skewHandlerX(Se,pe,Ee,ke):o.scalingY(Se,pe,Ee,ke)}function Ae(Se,pe,Ee,ke){return Se[pe.target.canvas.altActionKey]?o.skewHandlerY(Se,pe,Ee,ke):o.scalingX(Se,pe,Ee,ke)}function De(Se,pe,Ee,ke){var Ce=pe.target,Pe=ze(pe,pe.originX,pe.originY,Ee,ke),Ne=Ce.strokeWidth/(Ce.strokeUniform?Ce.scaleX:1),Qe=oe(pe)?2:1,Ge=Ce.width,Te=Math.abs(Pe.x*Qe/Ce.scaleX)-Ne;return Ce.set("width",Math.max(Te,0)),Ge!==Te}function He(Se,pe,Ee,ke){var Ce=pe.target,Pe=Ee-pe.offsetX,Ne=ke-pe.offsetY,Qe=!Ce.get("lockMovementX")&&Ce.left!==Pe,Ge=!Ce.get("lockMovementY")&&Ce.top!==Ne;return Qe&&Ce.set("left",Pe),Ge&&Ce.set("top",Ne),(Qe||Ge)&&J("moving",Ie(Se,pe,Ee,ke)),Qe||Ge}o.scaleCursorStyleHandler=be,o.skewCursorStyleHandler=Re,o.scaleSkewCursorStyleHandler=Fe,o.rotationWithSnapping=Xe("rotating",je(ae)),o.scalingEqually=Xe("scaling",je(ge)),o.scalingX=Xe("scaling",je(ve)),o.scalingY=Xe("scaling",je(xe)),o.scalingYOrSkewingX=ye,o.scalingXOrSkewingY=Ae,o.changeWidth=Xe("resizing",je(De)),o.skewHandlerX=ce,o.skewHandlerY=me,o.dragHandler=He,o.scaleOrSkewActionName=Me,o.rotationStyleHandler=Be,o.fireEvent=J,o.wrapWithFixedAnchor=je,o.wrapWithFireEvent=Xe,o.getLocalPoint=ze,E.controlsUtils=o}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.degreesToRadians,R=E.controlsUtils;function o(l,p,F,O,q){O=O||{};var W=this.sizeX||O.cornerSize||q.cornerSize,U=this.sizeY||O.cornerSize||q.cornerSize,Y=typeof O.transparentCorners<"u"?O.transparentCorners:q.transparentCorners,J=Y?"stroke":"fill",te=!Y&&(O.cornerStrokeColor||q.cornerStrokeColor),oe=p,fe=F,be;l.save(),l.fillStyle=O.cornerColor||q.cornerColor,l.strokeStyle=O.cornerStrokeColor||q.cornerStrokeColor,W>U?(be=W,l.scale(1,U/W),fe=F*W/U):U>W?(be=U,l.scale(W/U,1),oe=p*U/W):be=W,l.lineWidth=1,l.beginPath(),l.arc(oe,fe,be/2,0,2*Math.PI,!1),l[J](),te&&l.stroke(),l.restore()}function S(l,p,F,O,q){O=O||{};var W=this.sizeX||O.cornerSize||q.cornerSize,U=this.sizeY||O.cornerSize||q.cornerSize,Y=typeof O.transparentCorners<"u"?O.transparentCorners:q.transparentCorners,J=Y?"stroke":"fill",te=!Y&&(O.cornerStrokeColor||q.cornerStrokeColor),oe=W/2,fe=U/2;l.save(),l.fillStyle=O.cornerColor||q.cornerColor,l.strokeStyle=O.cornerStrokeColor||q.cornerStrokeColor,l.lineWidth=1,l.translate(p,F),l.rotate(M(q.angle)),l[J+"Rect"](-oe,-fe,W,U),te&&l.strokeRect(-oe,-fe,W,U),l.restore()}R.renderCircleControl=o,R.renderSquareControl=S}(X),function(B){var E=B.fabric||(B.fabric={});function M(R){for(var o in R)this[o]=R[o]}E.Control=M,E.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(R,o){return o.cursorStyle},getActionName:function(R,o){return o.actionName},getVisibility:function(R,o){var S=R._controlsVisibility;return S&&typeof S[o]<"u"?S[o]:this.visible},setVisibility:function(R){this.visible=R},positionHandler:function(R,o){var S=E.util.transformPoint({x:this.x*R.x+this.offsetX,y:this.y*R.y+this.offsetY},o);return S},calcCornerCoords:function(R,o,S,l,p){var F,O,q,W,U=p?this.touchSizeX:this.sizeX,Y=p?this.touchSizeY:this.sizeY;if(U&&Y&&U!==Y){var J=Math.atan2(Y,U),te=Math.sqrt(U*U+Y*Y)/2,oe=J-E.util.degreesToRadians(R),fe=Math.PI/2-J-E.util.degreesToRadians(R);F=te*E.util.cos(oe),O=te*E.util.sin(oe),q=te*E.util.cos(fe),W=te*E.util.sin(fe)}else{var be=U&&Y?U:o;te=be*.7071067812;var oe=E.util.degreesToRadians(45-R);F=q=te*E.util.cos(oe),O=W=te*E.util.sin(oe)}return{tl:{x:S-W,y:l-q},tr:{x:S+F,y:l-O},bl:{x:S-F,y:l+O},br:{x:S+W,y:l+q}}},render:function(R,o,S,l,p){switch(l=l||{},l.cornerStyle||p.cornerStyle){case"circle":E.controlsUtils.renderCircleControl.call(this,R,o,S,l,p);break;default:E.controlsUtils.renderSquareControl.call(this,R,o,S,l,p)}}}}(X),function(){function B(S,l){var p=S.getAttribute("style"),F=S.getAttribute("offset")||0,O,q,W,U;if(F=parseFloat(F)/(/%$/.test(F)?100:1),F=F<0?0:F>1?1:F,p){var Y=p.split(/\s*;\s*/);for(Y[Y.length-1]===""&&Y.pop(),U=Y.length;U--;){var J=Y[U].split(/\s*:\s*/),te=J[0].trim(),oe=J[1].trim();te==="stop-color"?O=oe:te==="stop-opacity"&&(W=oe)}}return O||(O=S.getAttribute("stop-color")||"rgb(0,0,0)"),W||(W=S.getAttribute("stop-opacity")),O=new L.Color(O),q=O.getAlpha(),W=isNaN(parseFloat(W))?1:parseFloat(W),W*=q*l,{offset:F,color:O.toRgb(),opacity:W}}function E(S){return{x1:S.getAttribute("x1")||0,y1:S.getAttribute("y1")||0,x2:S.getAttribute("x2")||"100%",y2:S.getAttribute("y2")||0}}function M(S){return{x1:S.getAttribute("fx")||S.getAttribute("cx")||"50%",y1:S.getAttribute("fy")||S.getAttribute("cy")||"50%",r1:0,x2:S.getAttribute("cx")||"50%",y2:S.getAttribute("cy")||"50%",r2:S.getAttribute("r")||"50%"}}var R=L.util.object.clone;L.Gradient=L.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(S){S||(S={}),S.coords||(S.coords={});var l,p=this;Object.keys(S).forEach(function(F){p[F]=S[F]}),this.id?this.id+="_"+L.Object.__uid++:this.id=L.Object.__uid++,l={x1:S.coords.x1||0,y1:S.coords.y1||0,x2:S.coords.x2||0,y2:S.coords.y2||0},this.type==="radial"&&(l.r1=S.coords.r1||0,l.r2=S.coords.r2||0),this.coords=l,this.colorStops=S.colorStops.slice()},addColorStop:function(S){for(var l in S){var p=new L.Color(S[l]);this.colorStops.push({offset:parseFloat(l),color:p.toRgb(),opacity:p.getAlpha()})}return this},toObject:function(S){var l={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return L.util.populateWithProperties(this,l,S),l},toSVG:function(S,q){var p=R(this.coords,!0),F,O,q=q||{},W,U,Y=R(this.colorStops,!0),J=p.r1>p.r2,te=this.gradientTransform?this.gradientTransform.concat():L.iMatrix.concat(),oe=-this.offsetX,fe=-this.offsetY,be=!!q.additionalTransform,Re=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(Y.sort(function(je,Xe){return je.offset-Xe.offset}),Re==="objectBoundingBox"?(oe/=S.width,fe/=S.height):(oe+=S.width/2,fe+=S.height/2),S.type==="path"&&this.gradientUnits!=="percentage"&&(oe-=S.pathOffset.x,fe-=S.pathOffset.y),te[4]-=oe,te[5]-=fe,U='id="SVGID_'+this.id+'" gradientUnits="'+Re+'"',U+=' gradientTransform="'+(be?q.additionalTransform+" ":"")+L.util.matrixToSVG(te)+'" ',this.type==="linear"?W=["<linearGradient ",U,' x1="',p.x1,'" y1="',p.y1,'" x2="',p.x2,'" y2="',p.y2,`">
`]:this.type==="radial"&&(W=["<radialGradient ",U,' cx="',J?p.x1:p.x2,'" cy="',J?p.y1:p.y2,'" r="',J?p.r1:p.r2,'" fx="',J?p.x2:p.x1,'" fy="',J?p.y2:p.y1,`">
`]),this.type==="radial"){if(J)for(Y=Y.concat(),Y.reverse(),F=0,O=Y.length;F<O;F++)Y[F].offset=1-Y[F].offset;var Fe=Math.min(p.r1,p.r2);if(Fe>0){var Me=Math.max(p.r1,p.r2),Be=Fe/Me;for(F=0,O=Y.length;F<O;F++)Y[F].offset+=Be*(1-Y[F].offset)}}for(F=0,O=Y.length;F<O;F++){var Ie=Y[F];W.push("<stop ",'offset="',Ie.offset*100+"%",'" style="stop-color:',Ie.color,typeof Ie.opacity<"u"?";stop-opacity: "+Ie.opacity:";",`"/>
`)}return W.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),W.join("")},toLive:function(S){var l,p=L.util.object.clone(this.coords),F,O;if(this.type){for(this.type==="linear"?l=S.createLinearGradient(p.x1,p.y1,p.x2,p.y2):this.type==="radial"&&(l=S.createRadialGradient(p.x1,p.y1,p.r1,p.x2,p.y2,p.r2)),F=0,O=this.colorStops.length;F<O;F++){var q=this.colorStops[F].color,W=this.colorStops[F].opacity,U=this.colorStops[F].offset;typeof W<"u"&&(q=new L.Color(q).setAlpha(W).toRgba()),l.addColorStop(U,q)}return l}}}),L.util.object.extend(L.Gradient,{fromElement:function(S,l,p,F){var O=parseFloat(p)/(/%$/.test(p)?100:1);O=O<0?0:O>1?1:O,isNaN(O)&&(O=1);var q=S.getElementsByTagName("stop"),W,U=S.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",Y=S.getAttribute("gradientTransform")||"",J=[],te,oe,fe=0,be=0,Re;for(S.nodeName==="linearGradient"||S.nodeName==="LINEARGRADIENT"?(W="linear",te=E(S)):(W="radial",te=M(S)),oe=q.length;oe--;)J.push(B(q[oe],O));Re=L.parseTransformAttribute(Y),o(l,te,F,U),U==="pixels"&&(fe=-l.left,be=-l.top);var Fe=new L.Gradient({id:S.getAttribute("id"),type:W,coords:te,colorStops:J,gradientUnits:U,gradientTransform:Re,offsetX:fe,offsetY:be});return Fe}});function o(S,l,p,F){var O,q;Object.keys(l).forEach(function(W){O=l[W],O==="Infinity"?q=1:O==="-Infinity"?q=0:(q=parseFloat(l[W],10),typeof O=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(O)&&(q*=.01,F==="pixels"&&((W==="x1"||W==="x2"||W==="r2")&&(q*=p.viewBoxWidth||p.width),(W==="y1"||W==="y2")&&(q*=p.viewBoxHeight||p.height)))),l[W]=q})}}(),function(){var B=L.util.toFixed;L.Pattern=L.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(E,M){if(E||(E={}),this.id=L.Object.__uid++,this.setOptions(E),!E.source||E.source&&typeof E.source!="string"){M&&M(this);return}else{var R=this;this.source=L.util.createImage(),L.util.loadImage(E.source,function(o,S){R.source=o,M&&M(R,S)},null,this.crossOrigin)}},toObject:function(E){var M=L.Object.NUM_FRACTION_DIGITS,R,o;return typeof this.source.src=="string"?R=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(R=this.source.toDataURL()),o={type:"pattern",source:R,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:B(this.offsetX,M),offsetY:B(this.offsetY,M),patternTransform:this.patternTransform?this.patternTransform.concat():null},L.util.populateWithProperties(this,o,E),o},toSVG:function(E){var M=typeof this.source=="function"?this.source():this.source,R=M.width/E.width,o=M.height/E.height,S=this.offsetX/E.width,l=this.offsetY/E.height,p="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(o=1,l&&(o+=Math.abs(l))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(R=1,S&&(R+=Math.abs(S))),M.src?p=M.src:M.toDataURL&&(p=M.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+S+'" y="'+l+'" width="'+R+'" height="'+o+`">
<image x="0" y="0" width="`+M.width+'" height="'+M.height+'" xlink:href="'+p+`"></image>
</pattern>
`},setOptions:function(E){for(var M in E)this[M]=E[M]},toLive:function(E){var M=this.source;return!M||typeof M.src<"u"&&(!M.complete||M.naturalWidth===0||M.naturalHeight===0)?"":E.createPattern(M,this.repeat)}})}(),function(B){var E=B.fabric||(B.fabric={}),M=E.util.toFixed;if(E.Shadow){E.warn("fabric.Shadow is already defined.");return}E.Shadow=E.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(R){typeof R=="string"&&(R=this._parseShadow(R));for(var o in R)this[o]=R[o];this.id=E.Object.__uid++},_parseShadow:function(R){var o=R.trim(),S=E.Shadow.reOffsetsAndBlur.exec(o)||[],l=o.replace(E.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:l.trim(),offsetX:parseFloat(S[1],10)||0,offsetY:parseFloat(S[2],10)||0,blur:parseFloat(S[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(R){var o=40,S=40,l=E.Object.NUM_FRACTION_DIGITS,p=E.util.rotateVector({x:this.offsetX,y:this.offsetY},E.util.degreesToRadians(-R.angle)),F=20,O=new E.Color(this.color);return R.width&&R.height&&(o=M((Math.abs(p.x)+this.blur)/R.width,l)*100+F,S=M((Math.abs(p.y)+this.blur)/R.height,l)*100+F),R.flipX&&(p.x*=-1),R.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+S+'%" height="'+(100+2*S)+'%" x="-'+o+'%" width="'+(100+2*o)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+M(this.blur?this.blur/2:0,l)+`"></feGaussianBlur>
	<feOffset dx="`+M(p.x,l)+'" dy="'+M(p.y,l)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+O.toRgb()+'" flood-opacity="'+O.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var R={},o=E.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(S){this[S]!==o[S]&&(R[S]=this[S])},this),R}}),E.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(X),function(){if(L.StaticCanvas){L.warn("fabric.StaticCanvas is already defined.");return}var B=L.util.object.extend,E=L.util.getElementOffset,M=L.util.removeFromArray,R=L.util.toFixed,o=L.util.transformPoint,S=L.util.invertTransform,l=L.util.getNodeCanvas,p=L.util.createCanvasElement,F=new Error("Could not initialize `canvas` element");L.StaticCanvas=L.util.createClass(L.CommonMethods,{initialize:function(O,q){q||(q={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(O,q)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:L.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(O,q){var W=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(O),this._initOptions(q),this.interactive||this._initRetinaScaling(),q.overlayImage&&this.setOverlayImage(q.overlayImage,W),q.backgroundImage&&this.setBackgroundImage(q.backgroundImage,W),q.backgroundColor&&this.setBackgroundColor(q.backgroundColor,W),q.overlayColor&&this.setOverlayColor(q.overlayColor,W),this.calcOffset()},_isRetinaScaling:function(){return L.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,L.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var O=L.devicePixelRatio;this.__initRetinaScaling(O,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(O,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(O,q,W){q.setAttribute("width",this.width*O),q.setAttribute("height",this.height*O),W.scale(O,O)},calcOffset:function(){return this._offset=E(this.lowerCanvasEl),this},setOverlayImage:function(O,q,W){return this.__setBgOverlayImage("overlayImage",O,q,W)},setBackgroundImage:function(O,q,W){return this.__setBgOverlayImage("backgroundImage",O,q,W)},setOverlayColor:function(O,q){return this.__setBgOverlayColor("overlayColor",O,q)},setBackgroundColor:function(O,q){return this.__setBgOverlayColor("backgroundColor",O,q)},__setBgOverlayImage:function(O,q,W,U){return typeof q=="string"?L.util.loadImage(q,function(Y,J){if(Y){var te=new L.Image(Y,U);this[O]=te,te.canvas=this}W&&W(Y,J)},this,U&&U.crossOrigin):(U&&q.setOptions(U),this[O]=q,q&&(q.canvas=this),W&&W(q,!1)),this},__setBgOverlayColor:function(O,q,W){return this[O]=q,this._initGradient(q,O),this._initPattern(q,O,W),this},_createCanvasElement:function(){var O=p();if(!O||(O.style||(O.style={}),typeof O.getContext>"u"))throw F;return O},_initOptions:function(O){var q=this.lowerCanvasEl;this._setOptions(O),this.width=this.width||parseInt(q.width,10)||0,this.height=this.height||parseInt(q.height,10)||0,this.lowerCanvasEl.style&&(q.width=this.width,q.height=this.height,q.style.width=this.width+"px",q.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(O){O&&O.getContext?this.lowerCanvasEl=O:this.lowerCanvasEl=L.util.getById(O)||this._createCanvasElement(),L.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(O,q){return this.setDimensions({width:O},q)},setHeight:function(O,q){return this.setDimensions({height:O},q)},setDimensions:function(O,q){var W;q=q||{};for(var U in O)W=O[U],q.cssOnly||(this._setBackstoreDimension(U,O[U]),W+="px",this.hasLostContext=!0),q.backstoreOnly||this._setCssDimension(U,W);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),q.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(O,q){return this.lowerCanvasEl[O]=q,this.upperCanvasEl&&(this.upperCanvasEl[O]=q),this.cacheCanvasEl&&(this.cacheCanvasEl[O]=q),this[O]=q,this},_setCssDimension:function(O,q){return this.lowerCanvasEl.style[O]=q,this.upperCanvasEl&&(this.upperCanvasEl.style[O]=q),this.wrapperEl&&(this.wrapperEl.style[O]=q),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(O){var q=this._activeObject,W=this.backgroundImage,U=this.overlayImage,Y,J,te;for(this.viewportTransform=O,J=0,te=this._objects.length;J<te;J++)Y=this._objects[J],Y.group||Y.setCoords(!0);return q&&q.setCoords(),W&&W.setCoords(!0),U&&U.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(O,q){var W=O,U=this.viewportTransform.slice(0);O=o(O,S(this.viewportTransform)),U[0]=q,U[3]=q;var Y=o(O,U);return U[4]+=W.x-Y.x,U[5]+=W.y-Y.y,this.setViewportTransform(U)},setZoom:function(O){return this.zoomToPoint(new L.Point(0,0),O),this},absolutePan:function(O){var q=this.viewportTransform.slice(0);return q[4]=-O.x,q[5]=-O.y,this.setViewportTransform(q)},relativePan:function(O){return this.absolutePan(new L.Point(-O.x-this.viewportTransform[4],-O.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(O){this.stateful&&O.setupState(),O._set("canvas",this),O.setCoords(),this.fire("object:added",{target:O}),O.fire("added")},_onObjectRemoved:function(O){this.fire("object:removed",{target:O}),O.fire("removed"),delete O.canvas},clearContext:function(O){return O.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var O=this.contextContainer;return this.renderCanvas(O,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=L.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var O={},q=this.width,W=this.height,U=S(this.viewportTransform);return O.tl=o({x:0,y:0},U),O.br=o({x:q,y:W},U),O.tr=new L.Point(O.br.x,O.tl.y),O.bl=new L.Point(O.tl.x,O.br.y),this.vptCoords=O,O},cancelRequestedRender:function(){this.isRendering&&(L.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(O,q){var W=this.viewportTransform,U=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(O),L.util.setImageSmoothing(O,this.imageSmoothingEnabled),this.fire("before:render",{ctx:O}),this._renderBackground(O),O.save(),O.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._renderObjects(O,q),O.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(O),U&&(U.canvas=this,U.shouldCache(),U._transformDone=!0,U.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(O)),this._renderOverlay(O),this.controlsAboveOverlay&&this.interactive&&this.drawControls(O),this.fire("after:render",{ctx:O})},drawClipPathOnCanvas:function(O){var q=this.viewportTransform,W=this.clipPath;O.save(),O.transform(q[0],q[1],q[2],q[3],q[4],q[5]),O.globalCompositeOperation="destination-in",W.transform(O),O.scale(1/W.zoomX,1/W.zoomY),O.drawImage(W._cacheCanvas,-W.cacheTranslationX,-W.cacheTranslationY),O.restore()},_renderObjects:function(O,q){var W,U;for(W=0,U=q.length;W<U;++W)q[W]&&q[W].render(O)},_renderBackgroundOrOverlay:function(O,q){var W=this[q+"Color"],U=this[q+"Image"],Y=this.viewportTransform,J=this[q+"Vpt"];if(!(!W&&!U)){if(W){O.save(),O.beginPath(),O.moveTo(0,0),O.lineTo(this.width,0),O.lineTo(this.width,this.height),O.lineTo(0,this.height),O.closePath(),O.fillStyle=W.toLive?W.toLive(O,this):W,J&&O.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),O.transform(1,0,0,1,W.offsetX||0,W.offsetY||0);var te=W.gradientTransform||W.patternTransform;te&&O.transform(te[0],te[1],te[2],te[3],te[4],te[5]),O.fill(),O.restore()}U&&(O.save(),J&&O.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),U.render(O),O.restore())}},_renderBackground:function(O){this._renderBackgroundOrOverlay(O,"background")},_renderOverlay:function(O){this._renderBackgroundOrOverlay(O,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new L.Point(this.width/2,this.height/2)},centerObjectH:function(O){return this._centerObject(O,new L.Point(this.getCenterPoint().x,O.getCenterPoint().y))},centerObjectV:function(O){return this._centerObject(O,new L.Point(O.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(O){var q=this.getCenterPoint();return this._centerObject(O,q)},viewportCenterObject:function(O){var q=this.getVpCenter();return this._centerObject(O,q)},viewportCenterObjectH:function(O){var q=this.getVpCenter();return this._centerObject(O,new L.Point(q.x,O.getCenterPoint().y)),this},viewportCenterObjectV:function(O){var q=this.getVpCenter();return this._centerObject(O,new L.Point(O.getCenterPoint().x,q.y))},getVpCenter:function(){var O=this.getCenterPoint(),q=S(this.viewportTransform);return o(O,q)},_centerObject:function(O,q){return O.setPositionByOrigin(q,"center","center"),O.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(O){return this.toDatalessObject(O)},toObject:function(O){return this._toObjectMethod("toObject",O)},toDatalessObject:function(O){return this._toObjectMethod("toDatalessObject",O)},_toObjectMethod:function(O,q){var W=this.clipPath,U={version:L.version,objects:this._toObjects(O,q)};return W&&!W.excludeFromExport&&(U.clipPath=this._toObject(this.clipPath,O,q)),B(U,this.__serializeBgOverlay(O,q)),L.util.populateWithProperties(this,U,q),U},_toObjects:function(O,q){return this._objects.filter(function(W){return!W.excludeFromExport}).map(function(W){return this._toObject(W,O,q)},this)},_toObject:function(O,q,W){var U;this.includeDefaultValues||(U=O.includeDefaultValues,O.includeDefaultValues=!1);var Y=O[q](W);return this.includeDefaultValues||(O.includeDefaultValues=U),Y},__serializeBgOverlay:function(O,q){var W={},U=this.backgroundImage,Y=this.overlayImage,J=this.backgroundColor,te=this.overlayColor;return J&&J.toObject?J.excludeFromExport||(W.background=J.toObject(q)):J&&(W.background=J),te&&te.toObject?te.excludeFromExport||(W.overlay=te.toObject(q)):te&&(W.overlay=te),U&&!U.excludeFromExport&&(W.backgroundImage=this._toObject(U,O,q)),Y&&!Y.excludeFromExport&&(W.overlayImage=this._toObject(Y,O,q)),W},svgViewportTransformation:!0,toSVG:function(O,q){O||(O={}),O.reviver=q;var W=[];return this._setSVGPreamble(W,O),this._setSVGHeader(W,O),this.clipPath&&W.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(W,"background"),this._setSVGBgOverlayImage(W,"backgroundImage",q),this._setSVGObjects(W,q),this.clipPath&&W.push(`</g>
`),this._setSVGBgOverlayColor(W,"overlay"),this._setSVGBgOverlayImage(W,"overlayImage",q),W.push("</svg>"),W.join("")},_setSVGPreamble:function(O,q){q.suppressPreamble||O.push('<?xml version="1.0" encoding="',q.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(O,q){var W=q.width||this.width,U=q.height||this.height,Y,J='viewBox="0 0 '+this.width+" "+this.height+'" ',te=L.Object.NUM_FRACTION_DIGITS;q.viewBox?J='viewBox="'+q.viewBox.x+" "+q.viewBox.y+" "+q.viewBox.width+" "+q.viewBox.height+'" ':this.svgViewportTransformation&&(Y=this.viewportTransform,J='viewBox="'+R(-Y[4]/Y[0],te)+" "+R(-Y[5]/Y[3],te)+" "+R(this.width/Y[0],te)+" "+R(this.height/Y[3],te)+'" '),O.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',W,'" ','height="',U,'" ',J,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",L.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(q),`</defs>
`)},createSVGClipPathMarkup:function(O){var q=this.clipPath;return q?(q.clipPathId="CLIPPATH_"+L.Object.__uid++,'<clipPath id="'+q.clipPathId+`" >
`+this.clipPath.toClipPathSVG(O.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var O=this,q=["background","overlay"].map(function(W){var U=O[W+"Color"];if(U&&U.toLive){var Y=O[W+"Vpt"],J=O.viewportTransform,te={width:O.width/(Y?J[0]:1),height:O.height/(Y?J[3]:1)};return U.toSVG(te,{additionalTransform:Y?L.util.matrixToSVG(J):""})}});return q.join("")},createSVGFontFacesMarkup:function(){var O="",q={},W,U,Y,J,te,oe,fe,be,Re,Fe=L.fontPaths,Me=[];for(this._objects.forEach(function Ie(je){Me.push(je),je._objects&&je._objects.forEach(Ie)}),be=0,Re=Me.length;be<Re;be++)if(W=Me[be],U=W.fontFamily,!(W.type.indexOf("text")===-1||q[U]||!Fe[U])&&(q[U]=!0,!!W.styles)){Y=W.styles;for(te in Y){J=Y[te];for(fe in J)oe=J[fe],U=oe.fontFamily,!q[U]&&Fe[U]&&(q[U]=!0)}}for(var Be in q)O+=[`		@font-face {
`,"			font-family: '",Be,`';
`,"			src: url('",Fe[Be],`');
`,`		}
`].join("");return O&&(O=['	<style type="text/css">',`<![CDATA[
`,O,"]]>",`</style>
`].join("")),O},_setSVGObjects:function(O,q){var W,U,Y,J=this._objects;for(U=0,Y=J.length;U<Y;U++)W=J[U],!W.excludeFromExport&&this._setSVGObject(O,W,q)},_setSVGObject:function(O,q,W){O.push(q.toSVG(W))},_setSVGBgOverlayImage:function(O,q,W){this[q]&&!this[q].excludeFromExport&&this[q].toSVG&&O.push(this[q].toSVG(W))},_setSVGBgOverlayColor:function(O,q){var W=this[q+"Color"],U=this.viewportTransform,Y=this.width,J=this.height;if(W)if(W.toLive){var te=W.repeat,oe=L.util.invertTransform(U),fe=this[q+"Vpt"],be=fe?L.util.matrixToSVG(oe):"";O.push('<rect transform="'+be+" translate(",Y/2,",",J/2,')"',' x="',W.offsetX-Y/2,'" y="',W.offsetY-J/2,'" ','width="',te==="repeat-y"||te==="no-repeat"?W.source.width:Y,'" height="',te==="repeat-x"||te==="no-repeat"?W.source.height:J,'" fill="url(#SVGID_'+W.id+')"',`></rect>
`)}else O.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',W,'"',`></rect>
`)},sendToBack:function(O){if(!O)return this;var q=this._activeObject,W,U,Y;if(O===q&&O.type==="activeSelection")for(Y=q._objects,W=Y.length;W--;)U=Y[W],M(this._objects,U),this._objects.unshift(U);else M(this._objects,O),this._objects.unshift(O);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(O){if(!O)return this;var q=this._activeObject,W,U,Y;if(O===q&&O.type==="activeSelection")for(Y=q._objects,W=0;W<Y.length;W++)U=Y[W],M(this._objects,U),this._objects.push(U);else M(this._objects,O),this._objects.push(O);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(O,q){if(!O)return this;var W=this._activeObject,U,Y,J,te,oe,fe=0;if(O===W&&O.type==="activeSelection")for(oe=W._objects,U=0;U<oe.length;U++)Y=oe[U],J=this._objects.indexOf(Y),J>0+fe&&(te=J-1,M(this._objects,Y),this._objects.splice(te,0,Y)),fe++;else J=this._objects.indexOf(O),J!==0&&(te=this._findNewLowerIndex(O,J,q),M(this._objects,O),this._objects.splice(te,0,O));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(O,q,W){var U,Y;if(W)for(U=q,Y=q-1;Y>=0;--Y){var J=O.intersectsWithObject(this._objects[Y])||O.isContainedWithinObject(this._objects[Y])||this._objects[Y].isContainedWithinObject(O);if(J){U=Y;break}}else U=q-1;return U},bringForward:function(O,q){if(!O)return this;var W=this._activeObject,U,Y,J,te,oe,fe=0;if(O===W&&O.type==="activeSelection")for(oe=W._objects,U=oe.length;U--;)Y=oe[U],J=this._objects.indexOf(Y),J<this._objects.length-1-fe&&(te=J+1,M(this._objects,Y),this._objects.splice(te,0,Y)),fe++;else J=this._objects.indexOf(O),J!==this._objects.length-1&&(te=this._findNewUpperIndex(O,J,q),M(this._objects,O),this._objects.splice(te,0,O));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(O,q,W){var U,Y,J;if(W)for(U=q,Y=q+1,J=this._objects.length;Y<J;++Y){var te=O.intersectsWithObject(this._objects[Y])||O.isContainedWithinObject(this._objects[Y])||this._objects[Y].isContainedWithinObject(O);if(te){U=Y;break}}else U=q+1;return U},moveTo:function(O,q){return M(this._objects,O),this._objects.splice(q,0,O),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(L.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(O){O.dispose&&O.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),L.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),L.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),B(L.StaticCanvas.prototype,L.Observable),B(L.StaticCanvas.prototype,L.Collection),B(L.StaticCanvas.prototype,L.DataURLExporter),B(L.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(O){var q=p();if(!q||!q.getContext)return null;var W=q.getContext("2d");if(!W)return null;switch(O){case"setLineDash":return typeof W.setLineDash<"u";default:return null}}}),L.StaticCanvas.prototype.toJSON=L.StaticCanvas.prototype.toObject,L.isLikelyNode&&(L.StaticCanvas.prototype.createPNGStream=function(){var O=l(this.lowerCanvasEl);return O&&O.createPNGStream()},L.StaticCanvas.prototype.createJPEGStream=function(O){var q=l(this.lowerCanvasEl);return q&&q.createJPEGStream(O)})}(),L.BaseBrush=L.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(B){B.strokeStyle=this.color,B.lineWidth=this.width,B.lineCap=this.strokeLineCap,B.miterLimit=this.strokeMiterLimit,B.lineJoin=this.strokeLineJoin,B.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(B){var E=this.canvas.viewportTransform;B.save(),B.transform(E[0],E[1],E[2],E[3],E[4],E[5])},_setShadow:function(){if(this.shadow){var B=this.canvas,E=this.shadow,M=B.contextTop,R=B.getZoom();B&&B._isRetinaScaling()&&(R*=L.devicePixelRatio),M.shadowColor=E.color,M.shadowBlur=E.blur*R,M.shadowOffsetX=E.offsetX*R,M.shadowOffsetY=E.offsetY*R}},needsFullRender:function(){var B=new L.Color(this.color);return B.getAlpha()<1||!!this.shadow},_resetShadow:function(){var B=this.canvas.contextTop;B.shadowColor="",B.shadowBlur=B.shadowOffsetX=B.shadowOffsetY=0},_isOutSideCanvas:function(B){return B.x<0||B.x>this.canvas.getWidth()||B.y<0||B.y>this.canvas.getHeight()}}),function(){L.PencilBrush=L.util.createClass(L.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(B){this.canvas=B,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(B,E,M){var R=E.midPointFrom(M);return B.quadraticCurveTo(E.x,E.y,R.x,R.y),R},onMouseDown:function(B,E){this.canvas._isMainEvent(E.e)&&(this.drawStraightLine=E.e[this.straightLineKey],this._prepareForDrawing(B),this._captureDrawingPath(B),this._render())},onMouseMove:function(B,E){if(this.canvas._isMainEvent(E.e)&&(this.drawStraightLine=E.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(B))&&this._captureDrawingPath(B)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var M=this._points,R=M.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(o,M[R-2],M[R-1],!0),o.stroke(),o.restore()}},onMouseUp:function(B){return this.canvas._isMainEvent(B.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(B){var E=new L.Point(B.x,B.y);this._reset(),this._addPoint(E),this.canvas.contextTop.moveTo(E.x,E.y)},_addPoint:function(B){return this._points.length>1&&B.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(B),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(B){var E=new L.Point(B.x,B.y);return this._addPoint(E)},_render:function(B){var E,M,R=this._points[0],o=this._points[1];if(B=B||this.canvas.contextTop,this._saveAndTransform(B),B.beginPath(),this._points.length===2&&R.x===o.x&&R.y===o.y){var S=this.width/1e3;R=new L.Point(R.x,R.y),o=new L.Point(o.x,o.y),R.x-=S,o.x+=S}for(B.moveTo(R.x,R.y),E=1,M=this._points.length;E<M;E++)this._drawSegment(B,R,o),R=this._points[E],o=this._points[E+1];B.lineTo(R.x,R.y),B.stroke(),B.restore()},convertPointsToSVGPath:function(B){var E=this.width/1e3;return L.util.getSmoothPathFromPoints(B,E)},_isEmptySVGPath:function(B){var E=L.util.joinPath(B);return E==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(B){var E=new L.Path(B,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,E.shadow=new L.Shadow(this.shadow)),E},decimatePoints:function(B,E){if(B.length<=2)return B;var M=this.canvas.getZoom(),R=Math.pow(E/M,2),o,S=B.length-1,l=B[0],p=[l],F;for(o=1;o<S-1;o++)F=Math.pow(l.x-B[o].x,2)+Math.pow(l.y-B[o].y,2),F>=R&&(l=B[o],p.push(l));return p.push(B[S]),p},_finalizeAndAddPath:function(){var B=this.canvas.contextTop;B.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var E=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(E)){this.canvas.requestRenderAll();return}var M=this.createPath(E);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:M}),this.canvas.add(M),this.canvas.requestRenderAll(),M.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:M})}})}(),L.CircleBrush=L.util.createClass(L.BaseBrush,{width:10,initialize:function(B){this.canvas=B,this.points=[]},drawDot:function(B){var E=this.addPoint(B),M=this.canvas.contextTop;this._saveAndTransform(M),this.dot(M,E),M.restore()},dot:function(B,E){B.fillStyle=E.fill,B.beginPath(),B.arc(E.x,E.y,E.radius,0,Math.PI*2,!1),B.closePath(),B.fill()},onMouseDown:function(B){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(B)},_render:function(){var B=this.canvas.contextTop,E,M,R=this.points;for(this._saveAndTransform(B),E=0,M=R.length;E<M;E++)this.dot(B,R[E]);B.restore()},onMouseMove:function(B){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(B)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(B),this._render()):this.drawDot(B))},onMouseUp:function(){var B=this.canvas.renderOnAddRemove,E,M;this.canvas.renderOnAddRemove=!1;var R=[];for(E=0,M=this.points.length;E<M;E++){var o=this.points[E],S=new L.Circle({radius:o.radius,left:o.x,top:o.y,originX:"center",originY:"center",fill:o.fill});this.shadow&&(S.shadow=new L.Shadow(this.shadow)),R.push(S)}var l=new L.Group(R);l.canvas=this.canvas,this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=B,this.canvas.requestRenderAll()},addPoint:function(B){var E=new L.Point(B.x,B.y),M=L.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,R=new L.Color(this.color).setAlpha(L.util.getRandomInt(0,100)/100).toRgba();return E.radius=M,E.fill=R,this.points.push(E),E}}),L.SprayBrush=L.util.createClass(L.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(B){this.canvas=B,this.sprayChunks=[]},onMouseDown:function(B){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(B),this.render(this.sprayChunkPoints)},onMouseMove:function(B){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(B)||(this.addSprayChunk(B),this.render(this.sprayChunkPoints))},onMouseUp:function(){var B=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var E=[],M=0,R=this.sprayChunks.length;M<R;M++)for(var o=this.sprayChunks[M],S=0,l=o.length;S<l;S++){var p=new L.Rect({width:o[S].width,height:o[S].width,left:o[S].x+1,top:o[S].y+1,originX:"center",originY:"center",fill:this.color});E.push(p)}this.optimizeOverlapping&&(E=this._getOptimizedRects(E));var F=new L.Group(E);this.shadow&&F.set("shadow",new L.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:F}),this.canvas.add(F),this.canvas.fire("path:created",{path:F}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=B,this.canvas.requestRenderAll()},_getOptimizedRects:function(B){var E={},M,R,o;for(R=0,o=B.length;R<o;R++)M=B[R].left+""+B[R].top,E[M]||(E[M]=B[R]);var S=[];for(M in E)S.push(E[M]);return S},render:function(B){var E=this.canvas.contextTop,M,R;for(E.fillStyle=this.color,this._saveAndTransform(E),M=0,R=B.length;M<R;M++){var o=B[M];typeof o.opacity<"u"&&(E.globalAlpha=o.opacity),E.fillRect(o.x,o.y,o.width,o.width)}E.restore()},_render:function(){var B=this.canvas.contextTop,E,M;for(B.fillStyle=this.color,this._saveAndTransform(B),E=0,M=this.sprayChunks.length;E<M;E++)this.render(this.sprayChunks[E]);B.restore()},addSprayChunk:function(B){this.sprayChunkPoints=[];var E,M,R,o=this.width/2,S;for(S=0;S<this.density;S++){E=L.util.getRandomInt(B.x-o,B.x+o),M=L.util.getRandomInt(B.y-o,B.y+o),this.dotWidthVariance?R=L.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):R=this.dotWidth;var l=new L.Point(E,M);l.width=R,this.randomOpacity&&(l.opacity=L.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(l)}this.sprayChunks.push(this.sprayChunkPoints)}}),L.PatternBrush=L.util.createClass(L.PencilBrush,{getPatternSrc:function(){var B=20,E=5,M=L.util.createCanvasElement(),R=M.getContext("2d");return M.width=M.height=B+E,R.fillStyle=this.color,R.beginPath(),R.arc(B/2,B/2,B/2,0,Math.PI*2,!1),R.closePath(),R.fill(),M},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(B){return B.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(B){this.callSuper("_setBrushStyles",B),B.strokeStyle=this.getPattern(B)},createPath:function(B){var E=this.callSuper("createPath",B),M=E._getLeftTopCoords().scalarAdd(E.strokeWidth/2);return E.stroke=new L.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-M.x,offsetY:-M.y}),E}}),function(){var B=L.util.getPointer,E=L.util.degreesToRadians,M=L.util.isTouchEvent;L.Canvas=L.util.createClass(L.StaticCanvas,{initialize:function(o,S){S||(S={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(o,S),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=L.PencilBrush&&new L.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var o=this.getActiveObjects(),S,l,p;if(o.length>0&&!this.preserveObjectStacking){l=[],p=[];for(var F=0,O=this._objects.length;F<O;F++)S=this._objects[F],o.indexOf(S)===-1?l.push(S):p.push(S);o.length>1&&(this._activeObject._objects=p),l.push.apply(l,p)}else l=this._objects;return l},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var o=this.contextContainer;return this.renderCanvas(o,this._chooseObjectsToRender()),this},renderTopLayer:function(o){o.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(o),this.contextTopDirty=!0),o.restore()},renderTop:function(){var o=this.contextTop;return this.clearContext(o),this.renderTopLayer(o),this.fire("after:render"),this},_normalizePointer:function(o,S){var l=o.calcTransformMatrix(),p=L.util.invertTransform(l),F=this.restorePointerVpt(S);return L.util.transformPoint(F,p)},isTargetTransparent:function(o,S,l){if(o.shouldCache()&&o._cacheCanvas&&o!==this._activeObject){var p=this._normalizePointer(o,{x:S,y:l}),F=Math.max(o.cacheTranslationX+p.x*o.zoomX,0),O=Math.max(o.cacheTranslationY+p.y*o.zoomY,0),Y=L.util.isTransparent(o._cacheContext,Math.round(F),Math.round(O),this.targetFindTolerance);return Y}var q=this.contextCache,W=o.selectionBackgroundColor,U=this.viewportTransform;o.selectionBackgroundColor="",this.clearContext(q),q.save(),q.transform(U[0],U[1],U[2],U[3],U[4],U[5]),o.render(q),q.restore(),o.selectionBackgroundColor=W;var Y=L.util.isTransparent(q,S,l,this.targetFindTolerance);return Y},_isSelectionKeyPressed:function(o){var S=!1;return Array.isArray(this.selectionKey)?S=!!this.selectionKey.find(function(l){return o[l]===!0}):S=o[this.selectionKey],S},_shouldClearSelection:function(o,S){var l=this.getActiveObjects(),p=this._activeObject;return!S||S&&p&&l.length>1&&l.indexOf(S)===-1&&p!==S&&!this._isSelectionKeyPressed(o)||S&&!S.evented||S&&!S.selectable&&p&&p!==S},_shouldCenterTransform:function(o,S,l){if(o){var p;return S==="scale"||S==="scaleX"||S==="scaleY"||S==="resizing"?p=this.centeredScaling||o.centeredScaling:S==="rotate"&&(p=this.centeredRotation||o.centeredRotation),p?!l:l}},_getOriginFromCorner:function(o,S){var l={x:o.originX,y:o.originY};return S==="ml"||S==="tl"||S==="bl"?l.x="right":(S==="mr"||S==="tr"||S==="br")&&(l.x="left"),S==="tl"||S==="mt"||S==="tr"?l.y="bottom":(S==="bl"||S==="mb"||S==="br")&&(l.y="top"),l},_getActionFromCorner:function(o,S,l,p){if(!S||!o)return"drag";var F=p.controls[S];return F.getActionName(l,F,p)},_setupCurrentTransform:function(o,S,l){if(S){var p=this.getPointer(o),F=S.__corner,O=S.controls[F],q=l&&F?O.getActionHandler(o,S,O):L.controlsUtils.dragHandler,W=this._getActionFromCorner(l,F,o,S),U=this._getOriginFromCorner(S,F),Y=o[this.centeredKey],J={target:S,action:W,actionHandler:q,corner:F,scaleX:S.scaleX,scaleY:S.scaleY,skewX:S.skewX,skewY:S.skewY,offsetX:p.x-S.left,offsetY:p.y-S.top,originX:U.x,originY:U.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:E(S.angle),width:S.width*S.scaleX,shiftKey:o.shiftKey,altKey:Y,original:L.util.saveObjectTransform(S)};this._shouldCenterTransform(S,W,Y)&&(J.originX="center",J.originY="center"),J.original.originX=U.x,J.original.originY=U.y,this._currentTransform=J,this._beforeTransform(o)}},setCursor:function(o){this.upperCanvasEl.style.cursor=o},_drawSelection:function(o){var S=this._groupSelector,l=new L.Point(S.ex,S.ey),p=L.util.transformPoint(l,this.viewportTransform),F=new L.Point(S.ex+S.left,S.ey+S.top),O=L.util.transformPoint(F,this.viewportTransform),q=Math.min(p.x,O.x),W=Math.min(p.y,O.y),U=Math.max(p.x,O.x),Y=Math.max(p.y,O.y),J=this.selectionLineWidth/2;this.selectionColor&&(o.fillStyle=this.selectionColor,o.fillRect(q,W,U-q,Y-W)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(o.lineWidth=this.selectionLineWidth,o.strokeStyle=this.selectionBorderColor,q+=J,W+=J,U-=J,Y-=J,L.Object.prototype._setLineDash.call(this,o,this.selectionDashArray),o.strokeRect(q,W,U-q,Y-W))},findTarget:function(o,S){if(!this.skipTargetFind){var l=!0,p=this.getPointer(o,l),F=this._activeObject,O=this.getActiveObjects(),q,W,U=M(o),Y=O.length>1&&!S||O.length===1;if(this.targets=[],Y&&F._findTargetCorner(p,U)||O.length>1&&!S&&F===this._searchPossibleTargets([F],p))return F;if(O.length===1&&F===this._searchPossibleTargets([F],p))if(this.preserveObjectStacking)q=F,W=this.targets,this.targets=[];else return F;var J=this._searchPossibleTargets(this._objects,p);return o[this.altSelectionKey]&&J&&q&&J!==q&&(J=q,this.targets=W),J}},_checkTarget:function(o,S,l){if(S&&S.visible&&S.evented&&S.containsPoint(o))if((this.perPixelTargetFind||S.perPixelTargetFind)&&!S.isEditing){var p=this.isTargetTransparent(S,l.x,l.y);if(!p)return!0}else return!0},_searchPossibleTargets:function(o,S){for(var l,p=o.length,F;p--;){var O=o[p],q=O.group?this._normalizePointer(O.group,S):S;if(this._checkTarget(q,O,S)){l=o[p],l.subTargetCheck&&l instanceof L.Group&&(F=this._searchPossibleTargets(l._objects,S),F&&this.targets.push(F));break}}return l},restorePointerVpt:function(o){return L.util.transformPoint(o,L.util.invertTransform(this.viewportTransform))},getPointer:function(o,S){if(this._absolutePointer&&!S)return this._absolutePointer;if(this._pointer&&S)return this._pointer;var l=B(o),p=this.upperCanvasEl,F=p.getBoundingClientRect(),O=F.width||0,q=F.height||0,W;(!O||!q)&&("top"in F&&"bottom"in F&&(q=Math.abs(F.top-F.bottom)),"right"in F&&"left"in F&&(O=Math.abs(F.right-F.left))),this.calcOffset(),l.x=l.x-this._offset.left,l.y=l.y-this._offset.top,S||(l=this.restorePointerVpt(l));var U=this.getRetinaScaling();return U!==1&&(l.x/=U,l.y/=U),O===0||q===0?W={width:1,height:1}:W={width:p.width/O,height:p.height/q},{x:l.x*W.width,y:l.y*W.height}},_createUpperCanvas:function(){var o=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),S=this.lowerCanvasEl,l=this.upperCanvasEl;l?l.className="":(l=this._createCanvasElement(),this.upperCanvasEl=l),L.util.addClass(l,"upper-canvas "+o),this.wrapperEl.appendChild(l),this._copyCanvasStyle(S,l),this._applyCanvasStyle(l),this.contextTop=l.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=L.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),L.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),L.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(o){var S=this.width||o.width,l=this.height||o.height;L.util.setStyle(o,{position:"absolute",width:S+"px",height:l+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),o.width=S,o.height=l,L.util.makeElementUnselectable(o)},_copyCanvasStyle:function(o,S){S.style.cssText=o.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var o=this._activeObject;return o?o.type==="activeSelection"&&o._objects?o._objects.slice(0):[o]:[]},_onObjectRemoved:function(o){o===this._activeObject&&(this.fire("before:selection:cleared",{target:o}),this._discardActiveObject(),this.fire("selection:cleared",{target:o}),o.fire("deselected")),o===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",o)},_fireSelectionEvents:function(o,S){var l=!1,p=this.getActiveObjects(),F=[],O=[];o.forEach(function(q){p.indexOf(q)===-1&&(l=!0,q.fire("deselected",{e:S,target:q}),O.push(q))}),p.forEach(function(q){o.indexOf(q)===-1&&(l=!0,q.fire("selected",{e:S,target:q}),F.push(q))}),o.length>0&&p.length>0?l&&this.fire("selection:updated",{e:S,selected:F,deselected:O}):p.length>0?this.fire("selection:created",{e:S,selected:F}):o.length>0&&this.fire("selection:cleared",{e:S,deselected:O})},setActiveObject:function(o,S){var l=this.getActiveObjects();return this._setActiveObject(o,S),this._fireSelectionEvents(l,S),this},_setActiveObject:function(o,S){return this._activeObject===o||!this._discardActiveObject(S,o)||o.onSelect({e:S})?!1:(this._activeObject=o,!0)},_discardActiveObject:function(o,S){var l=this._activeObject;if(l){if(l.onDeselect({e:o,object:S}))return!1;this._activeObject=null}return!0},discardActiveObject:function(o){var S=this.getActiveObjects(),l=this.getActiveObject();return S.length&&this.fire("before:selection:cleared",{target:l,e:o}),this._discardActiveObject(o),this._fireSelectionEvents(S,o),this},dispose:function(){var o=this.wrapperEl;return this.removeListeners(),o.removeChild(this.upperCanvasEl),o.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(S){L.util.cleanUpJsdomNode(this[S]),this[S]=void 0}).bind(this)),o.parentNode&&o.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,L.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(o){var S=this._activeObject;S&&S._renderControls(o)},_toObject:function(o,S,l){var p=this._realizeGroupTransformOnObject(o),F=this.callSuper("_toObject",o,S,l);return this._unwindGroupTransformOnObject(o,p),F},_realizeGroupTransformOnObject:function(o){if(o.group&&o.group.type==="activeSelection"&&this._activeObject===o.group){var S=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],l={};return S.forEach(function(p){l[p]=o[p]}),L.util.addTransformToObject(o,this._activeObject.calcOwnMatrix()),l}else return null},_unwindGroupTransformOnObject:function(o,S){S&&o.set(S)},_setSVGObject:function(o,S,l){var p=this._realizeGroupTransformOnObject(S);this.callSuper("_setSVGObject",o,S,l),this._unwindGroupTransformOnObject(S,p)},setViewportTransform:function(o){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),L.StaticCanvas.prototype.setViewportTransform.call(this,o)}});for(var R in L.StaticCanvas)R!=="prototype"&&(L.Canvas[R]=L.StaticCanvas[R])}(),function(){var B=L.util.addListener,E=L.util.removeListener,M=3,R=2,o=1,S={passive:!1};function l(p,F){return p.button&&p.button===F-1}L.util.object.extend(L.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(B,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(p,F){var O=this.upperCanvasEl,q=this._getEventPrefix();p(L.window,"resize",this._onResize),p(O,q+"down",this._onMouseDown),p(O,q+"move",this._onMouseMove,S),p(O,q+"out",this._onMouseOut),p(O,q+"enter",this._onMouseEnter),p(O,"wheel",this._onMouseWheel),p(O,"contextmenu",this._onContextMenu),p(O,"dblclick",this._onDoubleClick),p(O,"dragover",this._onDragOver),p(O,"dragenter",this._onDragEnter),p(O,"dragleave",this._onDragLeave),p(O,"drop",this._onDrop),this.enablePointerEvents||p(O,"touchstart",this._onTouchStart,S),typeof eventjs<"u"&&F in eventjs&&(eventjs[F](O,"gesture",this._onGesture),eventjs[F](O,"drag",this._onDrag),eventjs[F](O,"orientation",this._onOrientationChange),eventjs[F](O,"shake",this._onShake),eventjs[F](O,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(E,"remove");var p=this._getEventPrefix();E(L.document,p+"up",this._onMouseUp),E(L.document,"touchend",this._onTouchEnd,S),E(L.document,p+"move",this._onMouseMove,S),E(L.document,"touchmove",this._onMouseMove,S)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(p,F){this.__onTransformGesture&&this.__onTransformGesture(p,F)},_onDrag:function(p,F){this.__onDrag&&this.__onDrag(p,F)},_onMouseWheel:function(p){this.__onMouseWheel(p)},_onMouseOut:function(p){var F=this._hoveredTarget;this.fire("mouse:out",{target:F,e:p}),this._hoveredTarget=null,F&&F.fire("mouseout",{e:p});var O=this;this._hoveredTargets.forEach(function(q){O.fire("mouse:out",{target:F,e:p}),q&&F.fire("mouseout",{e:p})}),this._hoveredTargets=[]},_onMouseEnter:function(p){!this._currentTransform&&!this.findTarget(p)&&(this.fire("mouse:over",{target:null,e:p}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(p,F){this.__onOrientationChange&&this.__onOrientationChange(p,F)},_onShake:function(p,F){this.__onShake&&this.__onShake(p,F)},_onLongPress:function(p,F){this.__onLongPress&&this.__onLongPress(p,F)},_onDragOver:function(p){p.preventDefault();var F=this._simpleEventHandler("dragover",p);this._fireEnterLeaveEvents(F,p)},_onDrop:function(p){return this._simpleEventHandler("drop:before",p),this._simpleEventHandler("drop",p)},_onContextMenu:function(p){return this.stopContextMenu&&(p.stopPropagation(),p.preventDefault()),!1},_onDoubleClick:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"dblclick"),this._resetTransformEventData(p)},getPointerId:function(p){var F=p.changedTouches;return F?F[0]&&F[0].identifier:this.enablePointerEvents?p.pointerId:-1},_isMainEvent:function(p){return p.isPrimary===!0?!0:p.isPrimary===!1?!1:p.type==="touchend"&&p.touches.length===0?!0:p.changedTouches?p.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(p){p.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(p)),this.__onMouseDown(p),this._resetTransformEventData();var F=this.upperCanvasEl,O=this._getEventPrefix();B(L.document,"touchend",this._onTouchEnd,S),B(L.document,"touchmove",this._onMouseMove,S),E(F,O+"down",this._onMouseDown)},_onMouseDown:function(p){this.__onMouseDown(p),this._resetTransformEventData();var F=this.upperCanvasEl,O=this._getEventPrefix();E(F,O+"move",this._onMouseMove,S),B(L.document,O+"up",this._onMouseUp),B(L.document,O+"move",this._onMouseMove,S)},_onTouchEnd:function(p){if(!(p.touches.length>0)){this.__onMouseUp(p),this._resetTransformEventData(),this.mainTouchId=null;var F=this._getEventPrefix();E(L.document,"touchend",this._onTouchEnd,S),E(L.document,"touchmove",this._onMouseMove,S);var O=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){B(O.upperCanvasEl,F+"down",O._onMouseDown),O._willAddMouseDown=0},400)}},_onMouseUp:function(p){this.__onMouseUp(p),this._resetTransformEventData();var F=this.upperCanvasEl,O=this._getEventPrefix();this._isMainEvent(p)&&(E(L.document,O+"up",this._onMouseUp),E(L.document,O+"move",this._onMouseMove,S),B(F,O+"move",this._onMouseMove,S))},_onMouseMove:function(p){!this.allowTouchScrolling&&p.preventDefault&&p.preventDefault(),this.__onMouseMove(p)},_onResize:function(){this.calcOffset()},_shouldRender:function(p){var F=this._activeObject;return!!F!=!!p||F&&p&&F!==p?!0:(F&&F.isEditing,!1)},__onMouseUp:function(p){var F,O=this._currentTransform,q=this._groupSelector,W=!1,U=!q||q.left===0&&q.top===0;if(this._cacheTransformEventData(p),F=this._target,this._handleEvent(p,"up:before"),l(p,M)){this.fireRightClick&&this._handleEvent(p,"up",M,U);return}if(l(p,R)){this.fireMiddleClick&&this._handleEvent(p,"up",R,U),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(p);return}if(this._isMainEvent(p)){if(O&&(this._finalizeCurrentTransform(p),W=O.actionPerformed),!U){var Y=F===this._activeObject;this._maybeGroupObjects(p),W||(W=this._shouldRender(F)||!Y&&F===this._activeObject)}var J,te;if(F){if(J=F._findTargetCorner(this.getPointer(p,!0),L.util.isTouchEvent(p)),F.selectable&&F!==this._activeObject&&F.activeOn==="up")this.setActiveObject(F,p),W=!0;else{var oe=F.controls[J],fe=oe&&oe.getMouseUpHandler(p,F,oe);fe&&(te=this.getPointer(p),fe(p,O,te.x,te.y))}F.isMoving=!1}if(O&&(O.target!==F||O.corner!==J)){var be=O.target&&O.target.controls[O.corner],Re=be&&be.getMouseUpHandler(p,F,oe);te=te||this.getPointer(p),Re&&Re(p,O,te.x,te.y)}this._setCursorFromEvent(p,F),this._handleEvent(p,"up",o,U),this._groupSelector=null,this._currentTransform=null,F&&(F.__corner=0),W?this.requestRenderAll():U||this.renderTop()}},_simpleEventHandler:function(p,F){var O=this.findTarget(F),q=this.targets,W={e:F,target:O,subTargets:q};if(this.fire(p,W),O&&O.fire(p,W),!q)return O;for(var U=0;U<q.length;U++)q[U].fire(p,W);return O},_handleEvent:function(p,F,O,q){var W=this._target,U=this.targets||[],Y={e:p,target:W,subTargets:U,button:O||o,isClick:q||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};F==="up"&&(Y.currentTarget=this.findTarget(p),Y.currentSubTargets=this.targets),this.fire("mouse:"+F,Y),W&&W.fire("mouse"+F,Y);for(var J=0;J<U.length;J++)U[J].fire("mouse"+F,Y)},_finalizeCurrentTransform:function(p){var F=this._currentTransform,O=F.target,q={e:p,target:O,transform:F,action:F.action};O._scaling&&(O._scaling=!1),O.setCoords(),(F.actionPerformed||this.stateful&&O.hasStateChanged())&&this._fire("modified",q)},_onMouseDownInDrawingMode:function(p){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(p).requestRenderAll();var F=this.getPointer(p);this.freeDrawingBrush.onMouseDown(F,{e:p,pointer:F}),this._handleEvent(p,"down")},_onMouseMoveInDrawingMode:function(p){if(this._isCurrentlyDrawing){var F=this.getPointer(p);this.freeDrawingBrush.onMouseMove(F,{e:p,pointer:F})}this.setCursor(this.freeDrawingCursor),this._handleEvent(p,"move")},_onMouseUpInDrawingMode:function(p){var F=this.getPointer(p);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:p,pointer:F}),this._handleEvent(p,"up")},__onMouseDown:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"down:before");var F=this._target;if(l(p,M)){this.fireRightClick&&this._handleEvent(p,"down",M);return}if(l(p,R)){this.fireMiddleClick&&this._handleEvent(p,"down",R);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(p);return}if(this._isMainEvent(p)&&!this._currentTransform){var O=this._pointer;this._previousPointer=O;var q=this._shouldRender(F),W=this._shouldGroup(p,F);if(this._shouldClearSelection(p,F)?this.discardActiveObject(p):W&&(this._handleGrouping(p,F),F=this._activeObject),this.selection&&(!F||!F.selectable&&!F.isEditing&&F!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),F){var U=F===this._activeObject;F.selectable&&F.activeOn==="down"&&this.setActiveObject(F,p);var Y=F._findTargetCorner(this.getPointer(p,!0),L.util.isTouchEvent(p));if(F.__corner=Y,F===this._activeObject&&(Y||!W)){this._setupCurrentTransform(p,F,U);var J=F.controls[Y],O=this.getPointer(p),te=J&&J.getMouseDownHandler(p,F,J);te&&te(p,this._currentTransform,O.x,O.y)}}this._handleEvent(p,"down"),(q||W)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(p){this._resetTransformEventData(),this._pointer=this.getPointer(p,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(p)||null},_beforeTransform:function(p){var F=this._currentTransform;this.stateful&&F.target.saveState(),this.fire("before:transform",{e:p,transform:F})},__onMouseMove:function(p){this._handleEvent(p,"move:before"),this._cacheTransformEventData(p);var F,O;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(p);return}if(this._isMainEvent(p)){var q=this._groupSelector;q?(O=this._absolutePointer,q.left=O.x-q.ex,q.top=O.y-q.ey,this.renderTop()):this._currentTransform?this._transformObject(p):(F=this.findTarget(p)||null,this._setCursorFromEvent(p,F),this._fireOverOutEvents(F,p)),this._handleEvent(p,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(p,F){var O=this._hoveredTarget,q=this._hoveredTargets,W=this.targets,U=Math.max(q.length,W.length);this.fireSyntheticInOutEvents(p,F,{oldTarget:O,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var Y=0;Y<U;Y++)this.fireSyntheticInOutEvents(W[Y],F,{oldTarget:q[Y],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=p,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(p,F){var O=this._draggedoverTarget,q=this._hoveredTargets,W=this.targets,U=Math.max(q.length,W.length);this.fireSyntheticInOutEvents(p,F,{oldTarget:O,evtOut:"dragleave",evtIn:"dragenter"});for(var Y=0;Y<U;Y++)this.fireSyntheticInOutEvents(W[Y],F,{oldTarget:q[Y],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=p},fireSyntheticInOutEvents:function(p,F,O){var q,W,U=O.oldTarget,Y,J,te=U!==p,oe=O.canvasEvtIn,fe=O.canvasEvtOut;te&&(q={e:F,target:p,previousTarget:U},W={e:F,target:U,nextTarget:p}),J=p&&te,Y=U&&te,Y&&(fe&&this.fire(fe,W),U.fire(O.evtOut,W)),J&&(oe&&this.fire(oe,q),p.fire(O.evtIn,q))},__onMouseWheel:function(p){this._cacheTransformEventData(p),this._handleEvent(p,"wheel"),this._resetTransformEventData()},_transformObject:function(p){var F=this.getPointer(p),O=this._currentTransform;O.reset=!1,O.shiftKey=p.shiftKey,O.altKey=p[this.centeredKey],this._performTransformAction(p,O,F),O.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(p,F,O){var q=O.x,W=O.y,U=F.action,Y=!1,J=F.actionHandler;J&&(Y=J(p,F,q,W)),U==="drag"&&Y&&(F.target.isMoving=!0,this.setCursor(F.target.moveCursor||this.moveCursor)),F.actionPerformed=F.actionPerformed||Y},_fire:L.controlsUtils.fireEvent,_setCursorFromEvent:function(p,F){if(!F)return this.setCursor(this.defaultCursor),!1;var O=F.hoverCursor||this.hoverCursor,q=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,W=(!q||!q.contains(F))&&F._findTargetCorner(this.getPointer(p,!0));W?this.setCursor(this.getCornerCursor(W,F,p)):(F.subTargetCheck&&this.targets.concat().reverse().map(function(U){O=U.hoverCursor||O}),this.setCursor(O))},getCornerCursor:function(p,F,O){var q=F.controls[p];return q.cursorStyleHandler(O,q,F)}})}(),function(){var B=Math.min,E=Math.max;L.util.object.extend(L.Canvas.prototype,{_shouldGroup:function(M,R){var o=this._activeObject;return o&&this._isSelectionKeyPressed(M)&&R&&R.selectable&&this.selection&&(o!==R||o.type==="activeSelection")&&!R.onSelect({e:M})},_handleGrouping:function(M,R){var o=this._activeObject;o.__corner||R===o&&(R=this.findTarget(M,!0),!R||!R.selectable)||(o&&o.type==="activeSelection"?this._updateActiveSelection(R,M):this._createActiveSelection(R,M))},_updateActiveSelection:function(M,R){var o=this._activeObject,S=o._objects.slice(0);o.contains(M)?(o.removeWithUpdate(M),this._hoveredTarget=M,this._hoveredTargets=this.targets.concat(),o.size()===1&&this._setActiveObject(o.item(0),R)):(o.addWithUpdate(M),this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(S,R)},_createActiveSelection:function(M,R){var o=this.getActiveObjects(),S=this._createGroup(M);this._hoveredTarget=S,this._setActiveObject(S,R),this._fireSelectionEvents(o,R)},_createGroup:function(M){var R=this._objects,o=R.indexOf(this._activeObject)<R.indexOf(M),S=o?[this._activeObject,M]:[M,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new L.ActiveSelection(S,{canvas:this})},_groupSelectedObjects:function(M){var R=this._collectObjects(M),o;R.length===1?this.setActiveObject(R[0],M):R.length>1&&(o=new L.ActiveSelection(R.reverse(),{canvas:this}),this.setActiveObject(o,M))},_collectObjects:function(M){for(var R=[],o,S=this._groupSelector.ex,l=this._groupSelector.ey,p=S+this._groupSelector.left,F=l+this._groupSelector.top,O=new L.Point(B(S,p),B(l,F)),q=new L.Point(E(S,p),E(l,F)),W=!this.selectionFullyContained,U=S===p&&l===F,Y=this._objects.length;Y--&&(o=this._objects[Y],!(!(!o||!o.selectable||!o.visible)&&(W&&o.intersectsWithRect(O,q,!0)||o.isContainedWithinRect(O,q,!0)||W&&o.containsPoint(O,null,!0)||W&&o.containsPoint(q,null,!0))&&(R.push(o),U))););return R.length>1&&(R=R.filter(function(J){return!J.onSelect({e:M})})),R},_maybeGroupObjects:function(M){this.selection&&this._groupSelector&&this._groupSelectedObjects(M),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){L.util.object.extend(L.StaticCanvas.prototype,{toDataURL:function(B){B||(B={});var E=B.format||"png",M=B.quality||1,R=(B.multiplier||1)*(B.enableRetinaScaling?this.getRetinaScaling():1),o=this.toCanvasElement(R,B);return L.util.toDataURL(o,E,M)},toCanvasElement:function(B,E){B=B||1,E=E||{};var M=(E.width||this.width)*B,R=(E.height||this.height)*B,o=this.getZoom(),S=this.width,l=this.height,p=o*B,F=this.viewportTransform,O=(F[4]-(E.left||0))*B,q=(F[5]-(E.top||0))*B,W=this.interactive,U=[p,0,0,p,O,q],Y=this.enableRetinaScaling,J=L.util.createCanvasElement(),te=this.contextTop;return J.width=M,J.height=R,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=U,this.width=M,this.height=R,this.calcViewportBoundaries(),this.renderCanvas(J.getContext("2d"),this._objects),this.viewportTransform=F,this.width=S,this.height=l,this.calcViewportBoundaries(),this.interactive=W,this.enableRetinaScaling=Y,this.contextTop=te,J}})}(),L.util.object.extend(L.StaticCanvas.prototype,{loadFromJSON:function(B,E,M){if(B){var R=typeof B=="string"?JSON.parse(B):L.util.object.clone(B),o=this,S=R.clipPath,l=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete R.clipPath,this._enlivenObjects(R.objects,function(p){o.clear(),o._setBgOverlay(R,function(){S?o._enlivenObjects([S],function(F){o.clipPath=F[0],o.__setupCanvas.call(o,R,p,l,E)}):o.__setupCanvas.call(o,R,p,l,E)})},M),this}},__setupCanvas:function(B,E,M,R){var o=this;E.forEach(function(S,l){o.insertAt(S,l)}),this.renderOnAddRemove=M,delete B.objects,delete B.backgroundImage,delete B.overlayImage,delete B.background,delete B.overlay,this._setOptions(B),this.renderAll(),R&&R()},_setBgOverlay:function(B,E){var M={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!B.backgroundImage&&!B.overlayImage&&!B.background&&!B.overlay){E&&E();return}var R=function(){M.backgroundImage&&M.overlayImage&&M.backgroundColor&&M.overlayColor&&E&&E()};this.__setBgOverlay("backgroundImage",B.backgroundImage,M,R),this.__setBgOverlay("overlayImage",B.overlayImage,M,R),this.__setBgOverlay("backgroundColor",B.background,M,R),this.__setBgOverlay("overlayColor",B.overlay,M,R)},__setBgOverlay:function(B,E,M,R){var o=this;if(!E){M[B]=!0,R&&R();return}B==="backgroundImage"||B==="overlayImage"?L.util.enlivenObjects([E],function(S){o[B]=S[0],M[B]=!0,R&&R()}):this["set"+L.util.string.capitalize(B,!0)](E,function(){M[B]=!0,R&&R()})},_enlivenObjects:function(B,E,M){if(!B||B.length===0){E&&E([]);return}L.util.enlivenObjects(B,function(R){E&&E(R)},null,M)},_toDataURL:function(B,E){this.clone(function(M){E(M.toDataURL(B))})},_toDataURLWithMultiplier:function(B,E,M){this.clone(function(R){M(R.toDataURLWithMultiplier(B,E))})},clone:function(B,E){var M=JSON.stringify(this.toJSON(E));this.cloneWithoutData(function(R){R.loadFromJSON(M,function(){B&&B(R)})})},cloneWithoutData:function(B){var E=L.util.createCanvasElement();E.width=this.width,E.height=this.height;var M=new L.Canvas(E);this.backgroundImage?(M.setBackgroundImage(this.backgroundImage.src,function(){M.renderAll(),B&&B(M)}),M.backgroundImageOpacity=this.backgroundImageOpacity,M.backgroundImageStretch=this.backgroundImageStretch):B&&B(M)}}),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.util.object.clone,o=E.util.toFixed,S=E.util.string.capitalize,l=E.util.degreesToRadians,p=!E.isLikelyNode,F=2;E.Object||(E.Object=E.util.createClass(E.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(O){O&&this.setOptions(O)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=E.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(O){var q=E.perfLimitSizeTotal,W=O.width,U=O.height,Y=E.maxCacheSideLimit,J=E.minCacheSideLimit;if(W<=Y&&U<=Y&&W*U<=q)return W<J&&(O.width=J),U<J&&(O.height=J),O;var te=W/U,oe=E.util.limitDimsByArea(te,q),fe=E.util.capValue,be=fe(J,oe.x,Y),Re=fe(J,oe.y,Y);return W>be&&(O.zoomX/=W/be,O.width=be,O.capped=!0),U>Re&&(O.zoomY/=U/Re,O.height=Re,O.capped=!0),O},_getCacheCanvasDimensions:function(){var O=this.getTotalObjectScaling(),q=this._getTransformedDimensions(0,0),W=q.x*O.scaleX/this.scaleX,U=q.y*O.scaleY/this.scaleY;return{width:W+F,height:U+F,zoomX:O.scaleX,zoomY:O.scaleY,x:W,y:U}},_updateCacheCanvas:function(){var O=this.canvas;if(this.noScaleCache&&O&&O._currentTransform){var q=O._currentTransform.target,W=O._currentTransform.action;if(this===q&&W.slice&&W.slice(0,5)==="scale")return!1}var U=this._cacheCanvas,Y=this._limitCacheSize(this._getCacheCanvasDimensions()),J=E.minCacheSideLimit,te=Y.width,oe=Y.height,fe,be,Re=Y.zoomX,Fe=Y.zoomY,Me=te!==this.cacheWidth||oe!==this.cacheHeight,Be=this.zoomX!==Re||this.zoomY!==Fe,Ie=Me||Be,je=0,Xe=0,ze=!1;if(Me){var Ue=this._cacheCanvas.width,ie=this._cacheCanvas.height,ue=te>Ue||oe>ie,he=(te<Ue*.9||oe<ie*.9)&&Ue>J&&ie>J;ze=ue||he,ue&&!Y.capped&&(te>J||oe>J)&&(je=te*.1,Xe=oe*.1)}return this instanceof E.Text&&this.path&&(Ie=!0,ze=!0,je+=this.getHeightOfLine(0)*this.zoomX,Xe+=this.getHeightOfLine(0)*this.zoomY),Ie?(ze?(U.width=Math.ceil(te+je),U.height=Math.ceil(oe+Xe)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,U.width,U.height)),fe=Y.x/2,be=Y.y/2,this.cacheTranslationX=Math.round(U.width/2-fe)+fe,this.cacheTranslationY=Math.round(U.height/2-be)+be,this.cacheWidth=te,this.cacheHeight=oe,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(Re,Fe),this.zoomX=Re,this.zoomY=Fe,!0):!1},setOptions:function(O){this._setOptions(O),this._initGradient(O.fill,"fill"),this._initGradient(O.stroke,"stroke"),this._initPattern(O.fill,"fill"),this._initPattern(O.stroke,"stroke")},transform:function(O){var q=this.group&&!this.group._transformDone||this.group&&this.canvas&&O===this.canvas.contextTop,W=this.calcTransformMatrix(!q);O.transform(W[0],W[1],W[2],W[3],W[4],W[5])},toObject:function(O){var q=E.Object.NUM_FRACTION_DIGITS,W={type:this.type,version:E.version,originX:this.originX,originY:this.originY,left:o(this.left,q),top:o(this.top,q),width:o(this.width,q),height:o(this.height,q),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:o(this.strokeWidth,q),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:o(this.strokeMiterLimit,q),scaleX:o(this.scaleX,q),scaleY:o(this.scaleY,q),angle:o(this.angle,q),flipX:this.flipX,flipY:this.flipY,opacity:o(this.opacity,q),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:o(this.skewX,q),skewY:o(this.skewY,q)};return this.clipPath&&!this.clipPath.excludeFromExport&&(W.clipPath=this.clipPath.toObject(O),W.clipPath.inverted=this.clipPath.inverted,W.clipPath.absolutePositioned=this.clipPath.absolutePositioned),E.util.populateWithProperties(this,W,O),this.includeDefaultValues||(W=this._removeDefaultValues(W)),W},toDatalessObject:function(O){return this.toObject(O)},_removeDefaultValues:function(O){var q=E.util.getKlass(O.type).prototype,W=q.stateProperties;return W.forEach(function(U){U==="left"||U==="top"||(O[U]===q[U]&&delete O[U],Array.isArray(O[U])&&Array.isArray(q[U])&&O[U].length===0&&q[U].length===0&&delete O[U])}),O},toString:function(){return"#<fabric."+S(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var O=E.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(O.scaleX),scaleY:Math.abs(O.scaleY)}},getTotalObjectScaling:function(){var O=this.getObjectScaling(),q=O.scaleX,W=O.scaleY;if(this.canvas){var U=this.canvas.getZoom(),Y=this.canvas.getRetinaScaling();q*=U*Y,W*=U*Y}return{scaleX:q,scaleY:W}},getObjectOpacity:function(){var O=this.opacity;return this.group&&(O*=this.group.getObjectOpacity()),O},_set:function(O,q){var W=O==="scaleX"||O==="scaleY",U=this[O]!==q,Y=!1;return W&&(q=this._constrainScale(q)),O==="scaleX"&&q<0?(this.flipX=!this.flipX,q*=-1):O==="scaleY"&&q<0?(this.flipY=!this.flipY,q*=-1):O==="shadow"&&q&&!(q instanceof E.Shadow)?q=new E.Shadow(q):O==="dirty"&&this.group&&this.group.set("dirty",q),this[O]=q,U&&(Y=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(O)>-1?(this.dirty=!0,Y&&this.group.set("dirty",!0)):Y&&this.stateProperties.indexOf(O)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:E.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(O){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(O.save(),this._setupCompositeOperation(O),this.drawSelectionBackground(O),this.transform(O),this._setOpacity(O),this._setShadow(O,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(O)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(O),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),O.restore())},renderCache:function(O){O=O||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,O.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(O,q){if(O.save(),q.inverted?O.globalCompositeOperation="destination-out":O.globalCompositeOperation="destination-in",q.absolutePositioned){var W=E.util.invertTransform(this.calcTransformMatrix());O.transform(W[0],W[1],W[2],W[3],W[4],W[5])}q.transform(O),O.scale(1/q.zoomX,1/q.zoomY),O.drawImage(q._cacheCanvas,-q.cacheTranslationX,-q.cacheTranslationY),O.restore()},drawObject:function(O,q){var W=this.fill,U=this.stroke;q?(this.fill="black",this.stroke="",this._setClippingProperties(O)):this._renderBackground(O),this._render(O),this._drawClipPath(O,this.clipPath),this.fill=W,this.stroke=U},_drawClipPath:function(O,q){q&&(q.canvas=this.canvas,q.shouldCache(),q._transformDone=!0,q.renderCache({forClipping:!0}),this.drawClipPathOnCache(O,q))},drawCacheOnCanvas:function(O){O.scale(1/this.zoomX,1/this.zoomY),O.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(O){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!O&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!O){var q=this.cacheWidth/this.zoomX,W=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-q/2,-W/2,q,W)}return!0}return!1},_renderBackground:function(O){if(this.backgroundColor){var q=this._getNonTransformedDimensions();O.fillStyle=this.backgroundColor,O.fillRect(-q.x/2,-q.y/2,q.x,q.y),this._removeShadow(O)}},_setOpacity:function(O){this.group&&!this.group._transformDone?O.globalAlpha=this.getObjectOpacity():O.globalAlpha*=this.opacity},_setStrokeStyles:function(O,q){var W=q.stroke;W&&(O.lineWidth=q.strokeWidth,O.lineCap=q.strokeLineCap,O.lineDashOffset=q.strokeDashOffset,O.lineJoin=q.strokeLineJoin,O.miterLimit=q.strokeMiterLimit,W.toLive?W.gradientUnits==="percentage"||W.gradientTransform||W.patternTransform?this._applyPatternForTransformedGradient(O,W):(O.strokeStyle=W.toLive(O,this),this._applyPatternGradientTransform(O,W)):O.strokeStyle=q.stroke)},_setFillStyles:function(O,q){var W=q.fill;W&&(W.toLive?(O.fillStyle=W.toLive(O,this),this._applyPatternGradientTransform(O,q.fill)):O.fillStyle=W)},_setClippingProperties:function(O){O.globalAlpha=1,O.strokeStyle="transparent",O.fillStyle="#000000"},_setLineDash:function(O,q){!q||q.length===0||(1&q.length&&q.push.apply(q,q),O.setLineDash(q))},_renderControls:function(O,q){var W=this.getViewportTransform(),U=this.calcTransformMatrix(),Y,J,te;q=q||{},J=typeof q.hasBorders<"u"?q.hasBorders:this.hasBorders,te=typeof q.hasControls<"u"?q.hasControls:this.hasControls,U=E.util.multiplyTransformMatrices(W,U),Y=E.util.qrDecompose(U),O.save(),O.translate(Y.translateX,Y.translateY),O.lineWidth=1*this.borderScaleFactor,this.group||(O.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(Y.angle-=180),O.rotate(l(this.group?Y.angle:this.angle)),q.forActiveSelection||this.group?J&&this.drawBordersInGroup(O,Y,q):J&&this.drawBorders(O,q),te&&this.drawControls(O,q),O.restore()},_setShadow:function(O){if(this.shadow){var q=this.shadow,W=this.canvas,U,Y=W&&W.viewportTransform[0]||1,J=W&&W.viewportTransform[3]||1;q.nonScaling?U={scaleX:1,scaleY:1}:U=this.getObjectScaling(),W&&W._isRetinaScaling()&&(Y*=E.devicePixelRatio,J*=E.devicePixelRatio),O.shadowColor=q.color,O.shadowBlur=q.blur*E.browserShadowBlurConstant*(Y+J)*(U.scaleX+U.scaleY)/4,O.shadowOffsetX=q.offsetX*Y*U.scaleX,O.shadowOffsetY=q.offsetY*J*U.scaleY}},_removeShadow:function(O){this.shadow&&(O.shadowColor="",O.shadowBlur=O.shadowOffsetX=O.shadowOffsetY=0)},_applyPatternGradientTransform:function(O,q){if(!q||!q.toLive)return{offsetX:0,offsetY:0};var W=q.gradientTransform||q.patternTransform,U=-this.width/2+q.offsetX||0,Y=-this.height/2+q.offsetY||0;return q.gradientUnits==="percentage"?O.transform(this.width,0,0,this.height,U,Y):O.transform(1,0,0,1,U,Y),W&&O.transform(W[0],W[1],W[2],W[3],W[4],W[5]),{offsetX:U,offsetY:Y}},_renderPaintInOrder:function(O){this.paintFirst==="stroke"?(this._renderStroke(O),this._renderFill(O)):(this._renderFill(O),this._renderStroke(O))},_render:function(){},_renderFill:function(O){this.fill&&(O.save(),this._setFillStyles(O,this),this.fillRule==="evenodd"?O.fill("evenodd"):O.fill(),O.restore())},_renderStroke:function(O){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(O),O.save(),this.strokeUniform&&this.group){var q=this.getObjectScaling();O.scale(1/q.scaleX,1/q.scaleY)}else this.strokeUniform&&O.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(O,this.strokeDashArray),this._setStrokeStyles(O,this),O.stroke(),O.restore()}},_applyPatternForTransformedGradient:function(O,q){var W=this._limitCacheSize(this._getCacheCanvasDimensions()),U=E.util.createCanvasElement(),Y,J=this.canvas.getRetinaScaling(),te=W.x/this.scaleX/J,oe=W.y/this.scaleY/J;U.width=te,U.height=oe,Y=U.getContext("2d"),Y.beginPath(),Y.moveTo(0,0),Y.lineTo(te,0),Y.lineTo(te,oe),Y.lineTo(0,oe),Y.closePath(),Y.translate(te/2,oe/2),Y.scale(W.zoomX/this.scaleX/J,W.zoomY/this.scaleY/J),this._applyPatternGradientTransform(Y,q),Y.fillStyle=q.toLive(O),Y.fill(),O.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),O.scale(J*this.scaleX/W.zoomX,J*this.scaleY/W.zoomY),O.strokeStyle=Y.createPattern(U,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var O=E.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",O.scaleX),this.set("scaleY",O.scaleY),this.angle=O.angle,this.skewX=O.skewX,this.skewY=0}},_removeTransformMatrix:function(O){var q=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),q=E.util.transformPoint(q,this.transformMatrix)),this.transformMatrix=null,O&&(this.scaleX*=O.scaleX,this.scaleY*=O.scaleY,this.cropX=O.cropX,this.cropY=O.cropY,q.x+=O.offsetLeft,q.y+=O.offsetTop,this.width=O.width,this.height=O.height),this.setPositionByOrigin(q,"center","center")},clone:function(O,q){var W=this.toObject(q);this.constructor.fromObject?this.constructor.fromObject(W,O):E.Object._fromObject("Object",W,O)},cloneAsImage:function(O,q){var W=this.toCanvasElement(q);return O&&O(new E.Image(W)),this},toCanvasElement:function(O){O||(O={});var q=E.util,W=q.saveObjectTransform(this),U=this.group,Y=this.shadow,J=Math.abs,te=(O.multiplier||1)*(O.enableRetinaScaling?E.devicePixelRatio:1);delete this.group,O.withoutTransform&&q.resetObjectTransform(this),O.withoutShadow&&(this.shadow=null);var oe=E.util.createCanvasElement(),fe=this.getBoundingRect(!0,!0),be=this.shadow,Re,Fe={x:0,y:0},Me,Be,Ie;be&&(Me=be.blur,be.nonScaling?Re={scaleX:1,scaleY:1}:Re=this.getObjectScaling(),Fe.x=2*Math.round(J(be.offsetX)+Me)*J(Re.scaleX),Fe.y=2*Math.round(J(be.offsetY)+Me)*J(Re.scaleY)),Be=fe.width+Fe.x,Ie=fe.height+Fe.y,oe.width=Math.ceil(Be),oe.height=Math.ceil(Ie);var je=new E.StaticCanvas(oe,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});O.format==="jpeg"&&(je.backgroundColor="#fff"),this.setPositionByOrigin(new E.Point(je.width/2,je.height/2),"center","center");var Xe=this.canvas;je.add(this);var ze=je.toCanvasElement(te||1,O);return this.shadow=Y,this.set("canvas",Xe),U&&(this.group=U),this.set(W).setCoords(),je._objects=[],je.dispose(),je=null,ze},toDataURL:function(O){return O||(O={}),E.util.toDataURL(this.toCanvasElement(O),O.format||"png",O.quality||1)},isType:function(O){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===O},complexity:function(){return 1},toJSON:function(O){return this.toObject(O)},rotate:function(O){var q=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return q&&this._setOriginToCenter(),this.set("angle",O),q&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(O,q){q=q||this.canvas.getPointer(O);var W=new E.Point(q.x,q.y),U=this._getLeftTopCoords();return this.angle&&(W=E.util.rotatePoint(W,U,l(-this.angle))),{x:W.x-U.x,y:W.y-U.y}},_setupCompositeOperation:function(O){this.globalCompositeOperation&&(O.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){E.runningAnimations&&E.runningAnimations.cancelByTarget(this)}}),E.util.createAccessors&&E.util.createAccessors(E.Object),M(E.Object.prototype,E.Observable),E.Object.NUM_FRACTION_DIGITS=2,E.Object.ENLIVEN_PROPS=["clipPath"],E.Object._fromObject=function(O,q,W,U){var Y=E[O];q=R(q,!0),E.util.enlivenPatterns([q.fill,q.stroke],function(J){typeof J[0]<"u"&&(q.fill=J[0]),typeof J[1]<"u"&&(q.stroke=J[1]),E.util.enlivenObjectEnlivables(q,q,function(){var te=U?new Y(q[U],q):new Y(q);W&&W(te)})})},E.Object.__uid=0)}(X),function(){var B=L.util.degreesToRadians,E={left:-.5,center:0,right:.5},M={top:-.5,center:0,bottom:.5};L.util.object.extend(L.Object.prototype,{translateToGivenOrigin:function(R,o,S,l,p){var F=R.x,O=R.y,q,W,U;return typeof o=="string"?o=E[o]:o-=.5,typeof l=="string"?l=E[l]:l-=.5,q=l-o,typeof S=="string"?S=M[S]:S-=.5,typeof p=="string"?p=M[p]:p-=.5,W=p-S,(q||W)&&(U=this._getTransformedDimensions(),F=R.x+q*U.x,O=R.y+W*U.y),new L.Point(F,O)},translateToCenterPoint:function(R,o,S){var l=this.translateToGivenOrigin(R,o,S,"center","center");return this.angle?L.util.rotatePoint(l,R,B(this.angle)):l},translateToOriginPoint:function(R,o,S){var l=this.translateToGivenOrigin(R,"center","center",o,S);return this.angle?L.util.rotatePoint(l,R,B(this.angle)):l},getCenterPoint:function(){var R=new L.Point(this.left,this.top);return this.translateToCenterPoint(R,this.originX,this.originY)},getPointByOrigin:function(R,o){var S=this.getCenterPoint();return this.translateToOriginPoint(S,R,o)},toLocalPoint:function(R,o,S){var l=this.getCenterPoint(),p,F;return typeof o<"u"&&typeof S<"u"?p=this.translateToGivenOrigin(l,"center","center",o,S):p=new L.Point(this.left,this.top),F=new L.Point(R.x,R.y),this.angle&&(F=L.util.rotatePoint(F,l,-B(this.angle))),F.subtractEquals(p)},setPositionByOrigin:function(R,o,S){var l=this.translateToCenterPoint(R,o,S),p=this.translateToOriginPoint(l,this.originX,this.originY);this.set("left",p.x),this.set("top",p.y)},adjustPosition:function(R){var o=B(this.angle),S=this.getScaledWidth(),l=L.util.cos(o)*S,p=L.util.sin(o)*S,F,O;typeof this.originX=="string"?F=E[this.originX]:F=this.originX-.5,typeof R=="string"?O=E[R]:O=R-.5,this.left+=l*(O-F),this.top+=p*(O-F),this.setCoords(),this.originX=R},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var R=this.getCenterPoint();this.originX="center",this.originY="center",this.left=R.x,this.top=R.y},_resetOrigin:function(){var R=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=R.x,this.top=R.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function B(S){return[new L.Point(S.tl.x,S.tl.y),new L.Point(S.tr.x,S.tr.y),new L.Point(S.br.x,S.br.y),new L.Point(S.bl.x,S.bl.y)]}var E=L.util,M=E.degreesToRadians,R=E.multiplyTransformMatrices,o=E.transformPoint;E.object.extend(L.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(S,l){return l?S?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),S?this.aCoords:this.lineCoords)},getCoords:function(S,l){return B(this._getCoords(S,l))},intersectsWithRect:function(S,l,p,F){var O=this.getCoords(p,F),q=L.Intersection.intersectPolygonRectangle(O,S,l);return q.status==="Intersection"},intersectsWithObject:function(S,l,p){var F=L.Intersection.intersectPolygonPolygon(this.getCoords(l,p),S.getCoords(l,p));return F.status==="Intersection"||S.isContainedWithinObject(this,l,p)||this.isContainedWithinObject(S,l,p)},isContainedWithinObject:function(S,l,p){for(var F=this.getCoords(l,p),O=l?S.aCoords:S.lineCoords,q=0,W=S._getImageLines(O);q<4;q++)if(!S.containsPoint(F[q],W))return!1;return!0},isContainedWithinRect:function(S,l,p,F){var O=this.getBoundingRect(p,F);return O.left>=S.x&&O.left+O.width<=l.x&&O.top>=S.y&&O.top+O.height<=l.y},containsPoint:function(S,q,p,F){var O=this._getCoords(p,F),q=q||this._getImageLines(O),W=this._findCrossPoints(S,q);return W!==0&&W%2===1},isOnScreen:function(S){if(!this.canvas)return!1;var l=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br,F=this.getCoords(!0,S);return F.some(function(O){return O.x<=p.x&&O.x>=l.x&&O.y<=p.y&&O.y>=l.y})||this.intersectsWithRect(l,p,!0,S)?!0:this._containsCenterOfCanvas(l,p,S)},_containsCenterOfCanvas:function(S,l,p){var F={x:(S.x+l.x)/2,y:(S.y+l.y)/2};return!!this.containsPoint(F,null,!0,p)},isPartiallyOnScreen:function(S){if(!this.canvas)return!1;var l=this.canvas.vptCoords.tl,p=this.canvas.vptCoords.br;if(this.intersectsWithRect(l,p,!0,S))return!0;var F=this.getCoords(!0,S).every(function(O){return(O.x>=p.x||O.x<=l.x)&&(O.y>=p.y||O.y<=l.y)});return F&&this._containsCenterOfCanvas(l,p,S)},_getImageLines:function(S){var l={topline:{o:S.tl,d:S.tr},rightline:{o:S.tr,d:S.br},bottomline:{o:S.br,d:S.bl},leftline:{o:S.bl,d:S.tl}};return l},_findCrossPoints:function(S,l){var p,F,O,q,W,U=0,Y;for(var J in l)if(Y=l[J],!(Y.o.y<S.y&&Y.d.y<S.y)&&!(Y.o.y>=S.y&&Y.d.y>=S.y)&&(Y.o.x===Y.d.x&&Y.o.x>=S.x?W=Y.o.x:(p=0,F=(Y.d.y-Y.o.y)/(Y.d.x-Y.o.x),O=S.y-p*S.x,q=Y.o.y-F*Y.o.x,W=-(O-q)/(p-F)),W>=S.x&&(U+=1),U===2))break;return U},getBoundingRect:function(S,l){var p=this.getCoords(S,l);return E.makeBoundingBoxFromPoints(p)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(S){return Math.abs(S)<this.minScaleLimit?S<0?-this.minScaleLimit:this.minScaleLimit:S===0?1e-4:S},scale:function(S){return this._set("scaleX",S),this._set("scaleY",S),this.setCoords()},scaleToWidth:function(S,l){var p=this.getBoundingRect(l).width/this.getScaledWidth();return this.scale(S/this.width/p)},scaleToHeight:function(S,l){var p=this.getBoundingRect(l).height/this.getScaledHeight();return this.scale(S/this.height/p)},calcLineCoords:function(){var S=this.getViewportTransform(),l=this.padding,p=M(this.angle),F=E.cos(p),O=E.sin(p),q=F*l,W=O*l,U=q+W,Y=q-W,J=this.calcACoords(),te={tl:o(J.tl,S),tr:o(J.tr,S),bl:o(J.bl,S),br:o(J.br,S)};return l&&(te.tl.x-=Y,te.tl.y-=U,te.tr.x+=U,te.tr.y-=Y,te.bl.x-=U,te.bl.y+=Y,te.br.x+=Y,te.br.y+=U),te},calcOCoords:function(){var S=this._calcRotateMatrix(),l=this._calcTranslateMatrix(),p=this.getViewportTransform(),F=R(p,l),O=R(F,S),O=R(O,[1/p[0],0,0,1/p[3],0,0]),q=this._calculateCurrentDimensions(),W={};return this.forEachControl(function(U,Y,J){W[Y]=U.positionHandler(q,O,J)}),W},calcACoords:function(){var S=this._calcRotateMatrix(),l=this._calcTranslateMatrix(),p=R(l,S),F=this._getTransformedDimensions(),O=F.x/2,q=F.y/2;return{tl:o({x:-O,y:-q},p),tr:o({x:O,y:-q},p),bl:o({x:-O,y:q},p),br:o({x:O,y:q},p)}},setCoords:function(S){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),S?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return E.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var S=this.getCenterPoint();return[1,0,0,1,S.x,S.y]},transformMatrixKey:function(S){var l="_",p="";return!S&&this.group&&(p=this.group.transformMatrixKey(S)+l),p+this.top+l+this.left+l+this.scaleX+l+this.scaleY+l+this.skewX+l+this.skewY+l+this.angle+l+this.originX+l+this.originY+l+this.width+l+this.height+l+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(S){var l=this.calcOwnMatrix();if(S||!this.group)return l;var p=this.transformMatrixKey(S),F=this.matrixCache||(this.matrixCache={});return F.key===p?F.value:(this.group&&(l=R(this.group.calcTransformMatrix(!1),l)),F.key=p,F.value=l,l)},calcOwnMatrix:function(){var S=this.transformMatrixKey(!0),l=this.ownMatrixCache||(this.ownMatrixCache={});if(l.key===S)return l.value;var p=this._calcTranslateMatrix(),F={angle:this.angle,translateX:p[4],translateY:p[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return l.key=S,l.value=E.composeMatrix(F),l.value},_getNonTransformedDimensions:function(){var S=this.strokeWidth,l=this.width+S,p=this.height+S;return{x:l,y:p}},_getTransformedDimensions:function(S,l){typeof S>"u"&&(S=this.skewX),typeof l>"u"&&(l=this.skewY);var p,F,O,q=S===0&&l===0;if(this.strokeUniform?(F=this.width,O=this.height):(p=this._getNonTransformedDimensions(),F=p.x,O=p.y),q)return this._finalizeDimensions(F*this.scaleX,O*this.scaleY);var W=E.sizeAfterTransform(F,O,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:S,skewY:l});return this._finalizeDimensions(W.x,W.y)},_finalizeDimensions:function(S,l){return this.strokeUniform?{x:S+this.strokeWidth,y:l+this.strokeWidth}:{x:S,y:l}},_calculateCurrentDimensions:function(){var S=this.getViewportTransform(),l=this._getTransformedDimensions(),p=o(l,S,!0);return p.scalarAdd(2*this.padding)}})}(),L.util.object.extend(L.Object.prototype,{sendToBack:function(){return this.group?L.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?L.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(B){return this.group?L.StaticCanvas.prototype.sendBackwards.call(this.group,this,B):this.canvas&&this.canvas.sendBackwards(this,B),this},bringForward:function(B){return this.group?L.StaticCanvas.prototype.bringForward.call(this.group,this,B):this.canvas&&this.canvas.bringForward(this,B),this},moveTo:function(B){return this.group&&this.group.type!=="activeSelection"?L.StaticCanvas.prototype.moveTo.call(this.group,this,B):this.canvas&&this.canvas.moveTo(this,B),this}}),function(){function B(M,R){if(R){if(R.toLive)return M+": url(#SVGID_"+R.id+"); ";var o=new L.Color(R),S=M+": "+o.toRgb()+"; ",l=o.getAlpha();return l!==1&&(S+=M+"-opacity: "+l.toString()+"; "),S}else return M+": none; "}var E=L.util.toFixed;L.util.object.extend(L.Object.prototype,{getSvgStyles:function(M){var R=this.fillRule?this.fillRule:"nonzero",o=this.strokeWidth?this.strokeWidth:"0",S=this.strokeDashArray?this.strokeDashArray.join(" "):"none",l=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",F=this.strokeLineJoin?this.strokeLineJoin:"miter",O=this.strokeMiterLimit?this.strokeMiterLimit:"4",q=typeof this.opacity<"u"?this.opacity:"1",W=this.visible?"":" visibility: hidden;",U=M?"":this.getSvgFilter(),Y=B("fill",this.fill),J=B("stroke",this.stroke);return[J,"stroke-width: ",o,"; ","stroke-dasharray: ",S,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",l,"; ","stroke-linejoin: ",F,"; ","stroke-miterlimit: ",O,"; ",Y,"fill-rule: ",R,"; ","opacity: ",q,";",U,W].join("")},getSvgSpanStyles:function(M,R){var o="; ",l=M.fontFamily?"font-family: "+(M.fontFamily.indexOf("'")===-1&&M.fontFamily.indexOf('"')===-1?"'"+M.fontFamily+"'":M.fontFamily)+o:"",S=M.strokeWidth?"stroke-width: "+M.strokeWidth+o:"",l=l,p=M.fontSize?"font-size: "+M.fontSize+"px"+o:"",F=M.fontStyle?"font-style: "+M.fontStyle+o:"",O=M.fontWeight?"font-weight: "+M.fontWeight+o:"",q=M.fill?B("fill",M.fill):"",W=M.stroke?B("stroke",M.stroke):"",U=this.getSvgTextDecoration(M),Y=M.deltaY?"baseline-shift: "+-M.deltaY+"; ":"";return U&&(U="text-decoration: "+U+o),[W,S,l,p,F,O,U,q,Y,R?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(M){return["overline","underline","line-through"].filter(function(R){return M[R.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(M,R){var o=M?this.calcTransformMatrix():this.calcOwnMatrix(),S='transform="'+L.util.matrixToSVG(o);return S+(R||"")+'" '},_setSVGBg:function(M){if(this.backgroundColor){var R=L.Object.NUM_FRACTION_DIGITS;M.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',E(-this.width/2,R),'" y="',E(-this.height/2,R),'" width="',E(this.width,R),'" height="',E(this.height,R),`"></rect>
`)}},toSVG:function(M){return this._createBaseSVGMarkup(this._toSVG(M),{reviver:M})},toClipPathSVG:function(M){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(M),{reviver:M})},_createBaseClipPathSVGMarkup:function(M,R){R=R||{};var o=R.reviver,S=R.additionalTransform||"",l=[this.getSvgTransform(!0,S),this.getSvgCommons()].join(""),p=M.indexOf("COMMON_PARTS");return M[p]=l,o?o(M.join("")):M.join("")},_createBaseSVGMarkup:function(M,R){R=R||{};var o=R.noStyle,S=R.reviver,l=o?"":'style="'+this.getSvgStyles()+'" ',p=R.withShadow?'style="'+this.getSvgFilter()+'" ':"",F=this.clipPath,O=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",q=F&&F.absolutePositioned,W=this.stroke,U=this.fill,Y=this.shadow,J,te=[],oe,fe=M.indexOf("COMMON_PARTS"),be=R.additionalTransform;return F&&(F.clipPathId="CLIPPATH_"+L.Object.__uid++,oe='<clipPath id="'+F.clipPathId+`" >
`+F.toClipPathSVG(S)+`</clipPath>
`),q&&te.push("<g ",p,this.getSvgCommons(),` >
`),te.push("<g ",this.getSvgTransform(!1),q?"":p+this.getSvgCommons(),` >
`),J=[l,O,o?"":this.addPaintOrder()," ",be?'transform="'+be+'" ':""].join(""),M[fe]=J,U&&U.toLive&&te.push(U.toSVG(this)),W&&W.toLive&&te.push(W.toSVG(this)),Y&&te.push(Y.toSVG(this)),F&&te.push(oe),te.push(M.join("")),te.push(`</g>
`),q&&te.push(`</g>
`),S?S(te.join("")):te.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var B=L.util.object.extend,E="stateProperties";function M(o,S,l){var p={},F=!0;l.forEach(function(O){p[O]=o[O]}),B(o[S],p,F)}function R(o,S,l){if(o===S)return!0;if(Array.isArray(o)){if(!Array.isArray(S)||o.length!==S.length)return!1;for(var p=0,F=o.length;p<F;p++)if(!R(o[p],S[p]))return!1;return!0}else if(o&&typeof o=="object"){var O=Object.keys(o),q;if(!S||typeof S!="object"||!l&&O.length!==Object.keys(S).length)return!1;for(var p=0,F=O.length;p<F;p++)if(q=O[p],!(q==="canvas"||q==="group")&&!R(o[q],S[q]))return!1;return!0}}L.util.object.extend(L.Object.prototype,{hasStateChanged:function(o){o=o||E;var S="_"+o;return Object.keys(this[S]).length<this[o].length?!0:!R(this[S],this,!0)},saveState:function(o){var S=o&&o.propertySet||E,l="_"+S;return this[l]?(M(this,l,this[S]),o&&o.stateProperties&&M(this,l,o.stateProperties),this):this.setupState(o)},setupState:function(o){o=o||{};var S=o.propertySet||E;return o.propertySet=S,this["_"+S]={},this.saveState(o),this}})}(),function(){var B=L.util.degreesToRadians;L.util.object.extend(L.Object.prototype,{_findTargetCorner:function(E,M){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var R=E.x,o=E.y,S,l,p=Object.keys(this.oCoords),F=p.length-1,O;for(this.__corner=0;F>=0;F--)if(O=p[F],!!this.isControlVisible(O)&&(l=this._getImageLines(M?this.oCoords[O].touchCorner:this.oCoords[O].corner),S=this._findCrossPoints({x:R,y:o},l),S!==0&&S%2===1))return this.__corner=O,O;return!1},forEachControl:function(E){for(var M in this.controls)E(this.controls[M],M,this)},_setCornerCoords:function(){var E=this.oCoords;for(var M in E){var R=this.controls[M];E[M].corner=R.calcCornerCoords(this.angle,this.cornerSize,E[M].x,E[M].y,!1),E[M].touchCorner=R.calcCornerCoords(this.angle,this.touchCornerSize,E[M].x,E[M].y,!0)}},drawSelectionBackground:function(E){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;E.save();var M=this.getCenterPoint(),R=this._calculateCurrentDimensions(),o=this.canvas.viewportTransform;return E.translate(M.x,M.y),E.scale(1/o[0],1/o[3]),E.rotate(B(this.angle)),E.fillStyle=this.selectionBackgroundColor,E.fillRect(-R.x/2,-R.y/2,R.x,R.y),E.restore(),this},drawBorders:function(E,M){M=M||{};var R=this._calculateCurrentDimensions(),o=this.borderScaleFactor,S=R.x+o,l=R.y+o,p=typeof M.hasControls<"u"?M.hasControls:this.hasControls,F=!1;return E.save(),E.strokeStyle=M.borderColor||this.borderColor,this._setLineDash(E,M.borderDashArray||this.borderDashArray),E.strokeRect(-S/2,-l/2,S,l),p&&(E.beginPath(),this.forEachControl(function(O,q,W){O.withConnection&&O.getVisibility(W,q)&&(F=!0,E.moveTo(O.x*S,O.y*l),E.lineTo(O.x*S+O.offsetX,O.y*l+O.offsetY))}),F&&E.stroke()),E.restore(),this},drawBordersInGroup:function(E,M,R){R=R||{};var o=L.util.sizeAfterTransform(this.width,this.height,M),S=this.strokeWidth,l=this.strokeUniform,p=this.borderScaleFactor,F=o.x+S*(l?this.canvas.getZoom():M.scaleX)+p,O=o.y+S*(l?this.canvas.getZoom():M.scaleY)+p;return E.save(),this._setLineDash(E,R.borderDashArray||this.borderDashArray),E.strokeStyle=R.borderColor||this.borderColor,E.strokeRect(-F/2,-O/2,F,O),E.restore(),this},drawControls:function(E,M){M=M||{},E.save();var R=this.canvas.getRetinaScaling(),o,S;return E.setTransform(R,0,0,R,0,0),E.strokeStyle=E.fillStyle=M.cornerColor||this.cornerColor,this.transparentCorners||(E.strokeStyle=M.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(E,M.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(o=this.group.calcTransformMatrix()),this.forEachControl(function(l,p,F){S=F.oCoords[p],l.getVisibility(F,p)&&(o&&(S=L.util.transformPoint(S,o)),l.render(E,S.x,S.y,M,F))}),E.restore(),this},isControlVisible:function(E){return this.controls[E]&&this.controls[E].getVisibility(this,E)},setControlVisible:function(E,M){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[E]=M,this},setControlsVisibility:function(E){E||(E={});for(var M in E)this.setControlVisible(M,E[M]);return this},onDeselect:function(){},onSelect:function(){}})}(),L.util.object.extend(L.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(B,E){E=E||{};var M=function(){},R=E.onComplete||M,o=E.onChange||M,S=this;return L.util.animate({target:this,startValue:B.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(l){B.set("left",l),S.requestRenderAll(),o()},onComplete:function(){B.setCoords(),R()}})},fxCenterObjectV:function(B,E){E=E||{};var M=function(){},R=E.onComplete||M,o=E.onChange||M,S=this;return L.util.animate({target:this,startValue:B.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(l){B.set("top",l),S.requestRenderAll(),o()},onComplete:function(){B.setCoords(),R()}})},fxRemove:function(B,E){E=E||{};var M=function(){},R=E.onComplete||M,o=E.onChange||M,S=this;return L.util.animate({target:this,startValue:B.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(l){B.set("opacity",l),S.requestRenderAll(),o()},onComplete:function(){S.remove(B),R()}})}}),L.util.object.extend(L.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var B=[],E,M,R=[];for(E in arguments[0])B.push(E);for(var o=0,S=B.length;o<S;o++)E=B[o],M=o!==S-1,R.push(this._animate(E,arguments[0][E],arguments[1],M));return R}else return this._animate.apply(this,arguments)},_animate:function(B,E,M,R){var o=this,S;E=E.toString(),M?M=L.util.object.clone(M):M={},~B.indexOf(".")&&(S=B.split("."));var l=o.colorProperties.indexOf(B)>-1||S&&o.colorProperties.indexOf(S[1])>-1,p=S?this.get(S[0])[S[1]]:this.get(B);"from"in M||(M.from=p),l||(~E.indexOf("=")?E=p+parseFloat(E.replace("=","")):E=parseFloat(E));var F={target:this,startValue:M.from,endValue:E,byValue:M.by,easing:M.easing,duration:M.duration,abort:M.abort&&function(O,q,W){return M.abort.call(o,O,q,W)},onChange:function(O,q,W){S?o[S[0]][S[1]]=O:o.set(B,O),!R&&M.onChange&&M.onChange(O,q,W)},onComplete:function(O,q,W){R||(o.setCoords(),M.onComplete&&M.onComplete(O,q,W))}};return l?L.util.animateColor(F.startValue,F.endValue,F.duration,F):L.util.animate(F)}}),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.util.object.clone,o={x1:1,x2:1,y1:1,y2:1};if(E.Line){E.warn("fabric.Line is already defined");return}E.Line=E.util.createClass(E.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:E.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(l,p){l||(l=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",l[0]),this.set("y1",l[1]),this.set("x2",l[2]),this.set("y2",l[3]),this._setWidthHeight(p)},_setWidthHeight:function(l){l||(l={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in l?l.left:this._getLeftToOriginX(),this.top="top"in l?l.top:this._getTopToOriginY()},_set:function(l,p){return this.callSuper("_set",l,p),typeof o[l]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:S({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:S({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(l){l.beginPath();var p=this.calcLinePoints();l.moveTo(p.x1,p.y1),l.lineTo(p.x2,p.y2),l.lineWidth=this.strokeWidth;var F=l.strokeStyle;l.strokeStyle=this.stroke||l.fillStyle,this.stroke&&this._renderStroke(l),l.strokeStyle=F},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(l){return M(this.callSuper("toObject",l),this.calcLinePoints())},_getNonTransformedDimensions:function(){var l=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(l.y-=this.strokeWidth),this.height===0&&(l.x-=this.strokeWidth)),l},calcLinePoints:function(){var l=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,F=l*this.width*.5,O=p*this.height*.5,q=l*this.width*-.5,W=p*this.height*-.5;return{x1:F,x2:q,y1:O,y2:W}},_toSVG:function(){var l=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',l.x1,'" y1="',l.y1,'" x2="',l.x2,'" y2="',l.y2,`" />
`]}}),E.Line.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),E.Line.fromElement=function(l,p,F){F=F||{};var O=E.parseAttributes(l,E.Line.ATTRIBUTE_NAMES),q=[O.x1||0,O.y1||0,O.x2||0,O.y2||0];p(new E.Line(q,M(O,F)))},E.Line.fromObject=function(l,p){function F(q){delete q.points,p&&p(q)}var O=R(l,!0);O.points=[l.x1,l.y1,l.x2,l.y2],E.Object._fromObject("Line",O,F,"points")};function S(l,p){var F=l.origin,O=l.axis1,q=l.axis2,W=l.dimension,U=p.nearest,Y=p.center,J=p.farthest;return function(){switch(this.get(F)){case U:return Math.min(this.get(O),this.get(q));case Y:return Math.min(this.get(O),this.get(q))+.5*this.get(W);case J:return Math.max(this.get(O),this.get(q))}}}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.degreesToRadians;if(E.Circle){E.warn("fabric.Circle is already defined.");return}E.Circle=E.util.createClass(E.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:E.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(o,S){return this.callSuper("_set",o,S),o==="radius"&&this.setRadius(S),this},toObject:function(o){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(o))},_toSVG:function(){var o,S=0,l=0,p=(this.endAngle-this.startAngle)%360;if(p===0)o=["<circle ","COMMON_PARTS",'cx="'+S+'" cy="'+l+'" ','r="',this.radius,`" />
`];else{var F=M(this.startAngle),O=M(this.endAngle),q=this.radius,W=E.util.cos(F)*q,U=E.util.sin(F)*q,Y=E.util.cos(O)*q,J=E.util.sin(O)*q,te=p>180?"1":"0";o=['<path d="M '+W+" "+U," A "+q+" "+q," 0 ",+te+" 1"," "+Y+" "+J,'" ',"COMMON_PARTS",` />
`]}return o},_render:function(o){o.beginPath(),o.arc(0,0,this.radius,M(this.startAngle),M(this.endAngle),!1),this._renderPaintInOrder(o)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(o){return this.radius=o,this.set("width",o*2).set("height",o*2)}}),E.Circle.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),E.Circle.fromElement=function(o,S){var l=E.parseAttributes(o,E.Circle.ATTRIBUTE_NAMES);if(!R(l))throw new Error("value of `r` attribute is required and can not be negative");l.left=(l.left||0)-l.radius,l.top=(l.top||0)-l.radius,S(new E.Circle(l))};function R(o){return"radius"in o&&o.radius>=0}E.Circle.fromObject=function(o,S){E.Object._fromObject("Circle",o,S)}}(X),function(B){var E=B.fabric||(B.fabric={});if(E.Triangle){E.warn("fabric.Triangle is already defined");return}E.Triangle=E.util.createClass(E.Object,{type:"triangle",width:100,height:100,_render:function(M){var R=this.width/2,o=this.height/2;M.beginPath(),M.moveTo(-R,o),M.lineTo(0,-o),M.lineTo(R,o),M.closePath(),this._renderPaintInOrder(M)},_toSVG:function(){var M=this.width/2,R=this.height/2,o=[-M+" "+R,"0 "+-R,M+" "+R].join(",");return["<polygon ","COMMON_PARTS",'points="',o,'" />']}}),E.Triangle.fromObject=function(M,R){return E.Object._fromObject("Triangle",M,R)}}(X),function(B){var E=B.fabric||(B.fabric={}),M=Math.PI*2;if(E.Ellipse){E.warn("fabric.Ellipse is already defined.");return}E.Ellipse=E.util.createClass(E.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:E.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(R){this.callSuper("initialize",R),this.set("rx",R&&R.rx||0),this.set("ry",R&&R.ry||0)},_set:function(R,o){switch(this.callSuper("_set",R,o),R){case"rx":this.rx=o,this.set("width",o*2);break;case"ry":this.ry=o,this.set("height",o*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(R){return this.callSuper("toObject",["rx","ry"].concat(R))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(R){R.beginPath(),R.save(),R.transform(1,0,0,this.ry/this.rx,0,0),R.arc(0,0,this.rx,0,M,!1),R.restore(),this._renderPaintInOrder(R)}}),E.Ellipse.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),E.Ellipse.fromElement=function(R,o){var S=E.parseAttributes(R,E.Ellipse.ATTRIBUTE_NAMES);S.left=(S.left||0)-S.rx,S.top=(S.top||0)-S.ry,o(new E.Ellipse(S))},E.Ellipse.fromObject=function(R,o){E.Object._fromObject("Ellipse",R,o)}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend;if(E.Rect){E.warn("fabric.Rect is already defined");return}E.Rect=E.util.createClass(E.Object,{stateProperties:E.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:E.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(R){this.callSuper("initialize",R),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(R){var o=this.rx?Math.min(this.rx,this.width/2):0,S=this.ry?Math.min(this.ry,this.height/2):0,l=this.width,p=this.height,F=-this.width/2,O=-this.height/2,q=o!==0||S!==0,W=1-.5522847498;R.beginPath(),R.moveTo(F+o,O),R.lineTo(F+l-o,O),q&&R.bezierCurveTo(F+l-W*o,O,F+l,O+W*S,F+l,O+S),R.lineTo(F+l,O+p-S),q&&R.bezierCurveTo(F+l,O+p-W*S,F+l-W*o,O+p,F+l-o,O+p),R.lineTo(F+o,O+p),q&&R.bezierCurveTo(F+W*o,O+p,F,O+p-W*S,F,O+p-S),R.lineTo(F,O+S),q&&R.bezierCurveTo(F,O+W*S,F+W*o,O,F+o,O),R.closePath(),this._renderPaintInOrder(R)},toObject:function(R){return this.callSuper("toObject",["rx","ry"].concat(R))},_toSVG:function(){var R=-this.width/2,o=-this.height/2;return["<rect ","COMMON_PARTS",'x="',R,'" y="',o,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),E.Rect.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),E.Rect.fromElement=function(R,o,S){if(!R)return o(null);S=S||{};var l=E.parseAttributes(R,E.Rect.ATTRIBUTE_NAMES);l.left=l.left||0,l.top=l.top||0,l.height=l.height||0,l.width=l.width||0;var p=new E.Rect(M(S?E.util.object.clone(S):{},l));p.visible=p.visible&&p.width>0&&p.height>0,o(p)},E.Rect.fromObject=function(R,o){return E.Object._fromObject("Rect",R,o)}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.util.array.min,o=E.util.array.max,S=E.util.toFixed,l=E.util.projectStrokeOnPoints;if(E.Polyline){E.warn("fabric.Polyline is already defined");return}E.Polyline=E.util.createClass(E.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:E.Object.prototype.cacheProperties.concat("points"),initialize:function(p,F){F=F||{},this.points=p||[],this.callSuper("initialize",F),this._setPositionDimensions(F)},_projectStrokeOnPoints:function(){return l(this.points,this,!0)},_setPositionDimensions:function(p){var F=this._calcDimensions(p),O,q=this.exactBoundingBox?this.strokeWidth:0;this.width=F.width-q,this.height=F.height-q,p.fromSVG||(O=this.translateToGivenOrigin({x:F.left-this.strokeWidth/2+q/2,y:F.top-this.strokeWidth/2+q/2},"left","top",this.originX,this.originY)),typeof p.left>"u"&&(this.left=p.fromSVG?F.left:O.x),typeof p.top>"u"&&(this.top=p.fromSVG?F.top:O.y),this.pathOffset={x:F.left+this.width/2+q/2,y:F.top+this.height/2+q/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,F=R(p,"x")||0,O=R(p,"y")||0,q=o(p,"x")||0,W=o(p,"y")||0,U=q-F,Y=W-O;return{left:F,top:O,width:U,height:Y}},toObject:function(p){return M(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],F=this.pathOffset.x,O=this.pathOffset.y,q=E.Object.NUM_FRACTION_DIGITS,W=0,U=this.points.length;W<U;W++)p.push(S(this.points[W].x-F,q),",",S(this.points[W].y-O,q)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var F,O=this.points.length,q=this.pathOffset.x,W=this.pathOffset.y;if(!O||isNaN(this.points[O-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-q,this.points[0].y-W);for(var U=0;U<O;U++)F=this.points[U],p.lineTo(F.x-q,F.y-W);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),E.Polyline.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(),E.Polyline.fromElementGenerator=function(p){return function(F,O,q){if(!F)return O(null);q||(q={});var W=E.parsePointsAttribute(F.getAttribute("points")),U=E.parseAttributes(F,E[p].ATTRIBUTE_NAMES);U.fromSVG=!0,O(new E[p](W,M(U,q)))}},E.Polyline.fromElement=E.Polyline.fromElementGenerator("Polyline"),E.Polyline.fromObject=function(p,F){return E.Object._fromObject("Polyline",p,F,"points")}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.projectStrokeOnPoints;if(E.Polygon){E.warn("fabric.Polygon is already defined");return}E.Polygon=E.util.createClass(E.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return M(this.points,this)},_render:function(R){this.commonRender(R)&&(R.closePath(),this._renderPaintInOrder(R))}}),E.Polygon.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(),E.Polygon.fromElement=E.Polyline.fromElementGenerator("Polygon"),E.Polygon.fromObject=function(R,o){E.Object._fromObject("Polygon",R,o,"points")}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.array.min,R=E.util.array.max,o=E.util.object.extend,S=E.util.object.clone,l=E.util.toFixed;if(E.Path){E.warn("fabric.Path is already defined");return}E.Path=E.util.createClass(E.Object,{type:"path",path:null,cacheProperties:E.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:E.Object.prototype.stateProperties.concat("path"),initialize:function(p,F){F=S(F||{}),delete F.path,this.callSuper("initialize",F),this._setPath(p||[],F)},_setPath:function(p,F){this.path=E.util.makePathSimpler(Array.isArray(p)?p:E.util.parsePath(p)),E.Polyline.prototype._setPositionDimensions.call(this,F||{})},_renderPathCommands:function(p){var F,O=0,q=0,W=0,U=0,Y=0,J=0,te=-this.pathOffset.x,oe=-this.pathOffset.y;p.beginPath();for(var fe=0,be=this.path.length;fe<be;++fe)switch(F=this.path[fe],F[0]){case"L":W=F[1],U=F[2],p.lineTo(W+te,U+oe);break;case"M":W=F[1],U=F[2],O=W,q=U,p.moveTo(W+te,U+oe);break;case"C":W=F[5],U=F[6],Y=F[3],J=F[4],p.bezierCurveTo(F[1]+te,F[2]+oe,Y+te,J+oe,W+te,U+oe);break;case"Q":p.quadraticCurveTo(F[1]+te,F[2]+oe,F[3]+te,F[4]+oe),W=F[3],U=F[4],Y=F[1],J=F[2];break;case"z":case"Z":W=O,U=q,p.closePath();break}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return o(this.callSuper("toObject",p),{path:this.path.map(function(F){return F.slice()})})},toDatalessObject:function(p){var F=this.toObject(["sourcePath"].concat(p));return F.sourcePath&&delete F.path,F},_toSVG:function(){var p=E.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',p,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=E.Object.NUM_FRACTION_DIGITS;return" translate("+l(-this.pathOffset.x,p)+", "+l(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var F=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:F})},toSVG:function(p){var F=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:F})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p=[],F=[],O,q=0,W=0,U=0,Y=0,J,te=0,oe=this.path.length;te<oe;++te){switch(O=this.path[te],O[0]){case"L":U=O[1],Y=O[2],J=[];break;case"M":U=O[1],Y=O[2],q=U,W=Y,J=[];break;case"C":J=E.util.getBoundsOfCurve(U,Y,O[1],O[2],O[3],O[4],O[5],O[6]),U=O[5],Y=O[6];break;case"Q":J=E.util.getBoundsOfCurve(U,Y,O[1],O[2],O[1],O[2],O[3],O[4]),U=O[3],Y=O[4];break;case"z":case"Z":U=q,Y=W;break}J.forEach(function(Ie){p.push(Ie.x),F.push(Ie.y)}),p.push(U),F.push(Y)}var fe=M(p)||0,be=M(F)||0,Re=R(p)||0,Fe=R(F)||0,Me=Re-fe,Be=Fe-be;return{left:fe,top:be,width:Me,height:Be}}}),E.Path.fromObject=function(p,F){if(typeof p.sourcePath=="string"){var O=p.sourcePath;E.loadSVGFromURL(O,function(q){var W=q[0];W.setOptions(p),p.clipPath?E.util.enlivenObjects([p.clipPath],function(U){W.clipPath=U[0],F&&F(W)}):F&&F(W)})}else E.Object._fromObject("Path",p,F,"path")},E.Path.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(["d"]),E.Path.fromElement=function(p,F,O){var q=E.parseAttributes(p,E.Path.ATTRIBUTE_NAMES);q.fromSVG=!0,F(new E.Path(q.d,o(q,O)))}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.array.min,R=E.util.array.max;E.Group||(E.Group=E.util.createClass(E.Object,E.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(o,S,l){S=S||{},this._objects=[],l&&this.callSuper("initialize",S),this._objects=o||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(l)this._updateObjectsACoords();else{var F=S&&S.centerPoint;S.originX!==void 0&&(this.originX=S.originX),S.originY!==void 0&&(this.originY=S.originY),F||this._calcBounds(),this._updateObjectsCoords(F),delete S.centerPoint,this.callSuper("initialize",S)}this.setCoords()},_updateObjectsACoords:function(){for(var o=!0,S=this._objects.length;S--;)this._objects[S].setCoords(o)},_updateObjectsCoords:function(S){for(var S=S||this.getCenterPoint(),l=this._objects.length;l--;)this._updateObjectCoords(this._objects[l],S)},_updateObjectCoords:function(o,S){var l=o.left,p=o.top,F=!0;o.set({left:l-S.x,top:p-S.y}),o.group=this,o.setCoords(F)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(o){var S=!!this.group;return this._restoreObjectsState(),E.util.resetObjectTransform(this),o&&(S&&E.util.removeTransformFromObject(o,this.group.calcTransformMatrix()),this._objects.push(o),o.group=this,o._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,S?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(o){return this._restoreObjectsState(),E.util.resetObjectTransform(this),this.remove(o),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(o){this.dirty=!0,o.group=this,o._set("canvas",this.canvas)},_onObjectRemoved:function(o){this.dirty=!0,delete o.group},_set:function(o,S){var l=this._objects.length;if(this.useSetOnGroup)for(;l--;)this._objects[l].setOnGroup(o,S);if(o==="canvas")for(;l--;)this._objects[l]._set(o,S);E.Object.prototype._set.call(this,o,S)},toObject:function(o){var S=this.includeDefaultValues,l=this._objects.filter(function(F){return!F.excludeFromExport}).map(function(F){var O=F.includeDefaultValues;F.includeDefaultValues=S;var q=F.toObject(o);return F.includeDefaultValues=O,q}),p=E.Object.prototype.toObject.call(this,o);return p.objects=l,p},toDatalessObject:function(o){var S,l=this.sourcePath;if(l)S=l;else{var p=this.includeDefaultValues;S=this._objects.map(function(O){var q=O.includeDefaultValues;O.includeDefaultValues=p;var W=O.toDatalessObject(o);return O.includeDefaultValues=q,W})}var F=E.Object.prototype.toDatalessObject.call(this,o);return F.objects=S,F},render:function(o){this._transformDone=!0,this.callSuper("render",o),this._transformDone=!1},shouldCache:function(){var o=E.Object.prototype.shouldCache.call(this);if(o){for(var S=0,l=this._objects.length;S<l;S++)if(this._objects[S].willDrawShadow())return this.ownCaching=!1,!1}return o},willDrawShadow:function(){if(E.Object.prototype.willDrawShadow.call(this))return!0;for(var o=0,S=this._objects.length;o<S;o++)if(this._objects[o].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(o){for(var S=0,l=this._objects.length;S<l;S++)this._objects[S].render(o);this._drawClipPath(o,this.clipPath)},isCacheDirty:function(o){if(this.callSuper("isCacheDirty",o))return!0;if(!this.statefullCache)return!1;for(var S=0,l=this._objects.length;S<l;S++)if(this._objects[S].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,F=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-F/2,p,F)}return!0}return!1},_restoreObjectsState:function(){var o=this.calcOwnMatrix();return this._objects.forEach(function(S){E.util.addTransformToObject(S,o),delete S.group,S.setCoords()}),this},destroy:function(){return this._objects.forEach(function(o){o.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(o){o.dispose&&o.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var o=this._objects,S=this.canvas;this._objects=[];var l=this.toObject();delete l.objects;var p=new E.ActiveSelection([]);return p.set(l),p.type="activeSelection",S.remove(this),o.forEach(function(F){F.group=p,F.dirty=!0,S.add(F)}),p.canvas=S,p._objects=o,S._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var o=!0;return this.forEachObject(function(S){S.setCoords(o)}),this},_calcBounds:function(o){for(var S=[],l=[],p,F,O,q=["tr","br","bl","tl"],W=0,U=this._objects.length,Y,J=q.length;W<U;++W){for(p=this._objects[W],O=p.calcACoords(),Y=0;Y<J;Y++)F=q[Y],S.push(O[F].x),l.push(O[F].y);p.aCoords=O}this._getBounds(S,l,o)},_getBounds:function(o,S,l){var p=new E.Point(M(o),M(S)),F=new E.Point(R(o),R(S)),O=p.y||0,q=p.x||0,W=F.x-p.x||0,U=F.y-p.y||0;this.width=W,this.height=U,l||this.setPositionByOrigin({x:q,y:O},"left","top")},_toSVG:function(o){for(var S=["<g ","COMMON_PARTS",` >
`],l=0,p=this._objects.length;l<p;l++)S.push("		",this._objects[l].toSVG(o));return S.push(`</g>
`),S},getSvgStyles:function(){var o=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",S=this.visible?"":" visibility: hidden;";return[o,this.getSvgFilter(),S].join("")},toClipPathSVG:function(o){for(var S=[],l=0,p=this._objects.length;l<p;l++)S.push("	",this._objects[l].toClipPathSVG(o));return this._createBaseClipPathSVGMarkup(S,{reviver:o})}}),E.Group.fromObject=function(o,S){var l=o.objects,p=E.util.object.clone(o,!0);if(delete p.objects,typeof l=="string"){E.loadSVGFromURL(l,function(F){var O=E.util.groupSVGElements(F,o,l),q=p.clipPath;delete p.clipPath,O.set(p),q?E.util.enlivenObjects([q],function(W){O.clipPath=W[0],S&&S(O)}):S&&S(O)});return}E.util.enlivenObjects(l,function(F){E.util.enlivenObjectEnlivables(o,p,function(){S&&S(new E.Group(F,p,!0))})})})}(X),function(B){var E=B.fabric||(B.fabric={});E.ActiveSelection||(E.ActiveSelection=E.util.createClass(E.Group,{type:"activeSelection",initialize:function(M,R){R=R||{},this._objects=M||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;R.originX&&(this.originX=R.originX),R.originY&&(this.originY=R.originY),this._calcBounds(),this._updateObjectsCoords(),E.Object.prototype.initialize.call(this,R),this.setCoords()},toGroup:function(){var M=this._objects.concat();this._objects=[];var R=E.Object.prototype.toObject.call(this),o=new E.Group([]);if(delete R.type,o.set(R),M.forEach(function(l){l.canvas.remove(l),l.group=o}),o._objects=M,!this.canvas)return o;var S=this.canvas;return S.add(o),S._activeObject=o,o.setCoords(),o},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(M,R,o){M.save(),M.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",M,R),o=o||{},typeof o.hasControls>"u"&&(o.hasControls=!1),o.forActiveSelection=!0;for(var S=0,l=this._objects.length;S<l;S++)this._objects[S]._renderControls(M,o);M.restore()}}),E.ActiveSelection.fromObject=function(M,R){E.util.enlivenObjects(M.objects,function(o){delete M.objects,R&&R(new E.ActiveSelection(o,M,!0))})})}(X),function(B){var E=L.util.object.extend;if(B.fabric||(B.fabric={}),B.fabric.Image){L.warn("fabric.Image is already defined.");return}L.Image=L.util.createClass(L.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:L.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:L.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(M,R){R||(R={}),this.filters=[],this.cacheKey="texture"+L.Object.__uid++,this.callSuper("initialize",R),this._initElement(M,R)},getElement:function(){return this._element||{}},setElement:function(M,R){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=M,this._originalElement=M,this._initConfig(R),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(M){var R=L.filterBackend;R&&R.evictCachesForKey&&R.evictCachesForKey(M)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(M){L.util.cleanUpJsdomNode(this[M]),this[M]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var M=this.getElement();return{width:M.naturalWidth||M.width,height:M.naturalHeight||M.height}},_stroke:function(M){if(!(!this.stroke||this.strokeWidth===0)){var R=this.width/2,o=this.height/2;M.beginPath(),M.moveTo(-R,-o),M.lineTo(R,-o),M.lineTo(R,o),M.lineTo(-R,o),M.lineTo(-R,-o),M.closePath()}},toObject:function(M){var R=[];this.filters.forEach(function(S){S&&R.push(S.toObject())});var o=E(this.callSuper("toObject",["cropX","cropY"].concat(M)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:R});return this.resizeFilter&&(o.resizeFilter=this.resizeFilter.toObject()),o},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var M=[],R=[],o,S=this._element,l=-this.width/2,p=-this.height/2,F="",O="";if(!S)return[];if(this.hasCrop()){var q=L.Object.__uid++;M.push('<clipPath id="imageCrop_'+q+`">
`,'	<rect x="'+l+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),F=' clip-path="url(#imageCrop_'+q+')" '}if(this.imageSmoothing||(O='" image-rendering="optimizeSpeed'),R.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',l-this.cropX,'" y="',p-this.cropY,'" width="',S.width||S.naturalWidth,'" height="',S.height||S.height,O,'"',F,`></image>
`),this.stroke||this.strokeDashArray){var W=this.fill;this.fill=null,o=["	<rect ",'x="',l,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=W}return this.paintFirst!=="fill"?M=M.concat(o,R):M=M.concat(R,o),M},getSrc:function(M){var R=M?this._element:this._originalElement;return R?R.toDataURL?R.toDataURL():this.srcFromAttribute?R.getAttribute("src"):R.src:this.src||""},setSrc:function(M,R,o){return L.util.loadImage(M,function(S,l){this.setElement(S,o),this._setWidthHeight(),R&&R(this,l)},this,o&&o.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var M=this.resizeFilter,R=this.minimumScaleTrigger,o=this.getTotalObjectScaling(),S=o.scaleX,l=o.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!M||S>R&&l>R){this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=S,this._lastScaleY=l;return}L.filterBackend||(L.filterBackend=L.initFilterBackend());var F=L.util.createCanvasElement(),O=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,q=p.width,W=p.height;F.width=q,F.height=W,this._element=F,this._lastScaleX=M.scaleX=S,this._lastScaleY=M.scaleY=l,L.filterBackend.applyFilters([M],p,q,W,this._element,O),this._filterScalingX=F.width/this._originalElement.width,this._filterScalingY=F.height/this._originalElement.height},applyFilters:function(M){if(M=M||this.filters||[],M=M.filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),M.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var R=this._originalElement,o=R.naturalWidth||R.width,S=R.naturalHeight||R.height;if(this._element===this._originalElement){var l=L.util.createCanvasElement();l.width=o,l.height=S,this._element=l,this._filteredEl=l}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,o,S),this._lastScaleX=1,this._lastScaleY=1;return L.filterBackend||(L.filterBackend=L.initFilterBackend()),L.filterBackend.applyFilters(M,this._originalElement,o,S,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(M){L.util.setImageSmoothing(M,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(M),this._renderPaintInOrder(M)},drawCacheOnCanvas:function(M){L.util.setImageSmoothing(M,this.imageSmoothing),L.Object.prototype.drawCacheOnCanvas.call(this,M)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(M){var R=this._element;if(R){var o=this._filterScalingX,S=this._filterScalingY,l=this.width,p=this.height,F=Math.min,O=Math.max,q=O(this.cropX,0),W=O(this.cropY,0),U=R.naturalWidth||R.width,Y=R.naturalHeight||R.height,J=q*o,te=W*S,oe=F(l*o,U-J),fe=F(p*S,Y-te),be=-l/2,Re=-p/2,Fe=F(l,U/o-q),Me=F(p,Y/S-W);R&&M.drawImage(R,J,te,oe,fe,be,Re,Fe,Me)}},_needsResize:function(){var M=this.getTotalObjectScaling();return M.scaleX!==this._lastScaleX||M.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(M,R){this.setElement(L.util.getById(M),R),L.util.addClass(this.getElement(),L.Image.CSS_CANVAS)},_initConfig:function(M){M||(M={}),this.setOptions(M),this._setWidthHeight(M)},_initFilters:function(M,R){M&&M.length?L.util.enlivenObjects(M,function(o){R&&R(o)},"fabric.Image.filters"):R&&R()},_setWidthHeight:function(M){M||(M={});var R=this.getElement();this.width=M.width||R.naturalWidth||R.width||0,this.height=M.height||R.naturalHeight||R.height||0},parsePreserveAspectRatioAttribute:function(){var M=L.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),R=this._element.width,o=this._element.height,S=1,l=1,p=0,F=0,O=0,q=0,W,U=this.width,Y=this.height,J={width:U,height:Y};return M&&(M.alignX!=="none"||M.alignY!=="none")?(M.meetOrSlice==="meet"&&(S=l=L.util.findScaleToFit(this._element,J),W=(U-R*S)/2,M.alignX==="Min"&&(p=-W),M.alignX==="Max"&&(p=W),W=(Y-o*l)/2,M.alignY==="Min"&&(F=-W),M.alignY==="Max"&&(F=W)),M.meetOrSlice==="slice"&&(S=l=L.util.findScaleToCover(this._element,J),W=R-U/S,M.alignX==="Mid"&&(O=W/2),M.alignX==="Max"&&(O=W),W=o-Y/l,M.alignY==="Mid"&&(q=W/2),M.alignY==="Max"&&(q=W),R=U/S,o=Y/l)):(S=U/R,l=Y/o),{width:R,height:o,scaleX:S,scaleY:l,offsetLeft:p,offsetTop:F,cropX:O,cropY:q}}}),L.Image.CSS_CANVAS="canvas-img",L.Image.prototype.getSvgSrc=L.Image.prototype.getSrc,L.Image.fromObject=function(M,R){var o=L.util.object.clone(M);L.util.loadImage(o.src,function(S,l){if(l){R&&R(null,!0);return}L.Image.prototype._initFilters.call(o,o.filters,function(p){o.filters=p||[],L.Image.prototype._initFilters.call(o,[o.resizeFilter],function(F){o.resizeFilter=F[0],L.util.enlivenObjectEnlivables(o,o,function(){var O=new L.Image(S,o);R(O,!1)})})})},null,o.crossOrigin)},L.Image.fromURL=function(M,R,o){L.util.loadImage(M,function(S,l){R&&R(new L.Image(S,o),l)},null,o&&o.crossOrigin)},L.Image.ATTRIBUTE_NAMES=L.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),L.Image.fromElement=function(M,R,o){var S=L.parseAttributes(M,L.Image.ATTRIBUTE_NAMES);L.Image.fromURL(S["xlink:href"],R,E(o?L.util.object.clone(o):{},S))}}(X),L.util.object.extend(L.Object.prototype,{_getAngleValueForStraighten:function(){var B=this.angle%360;return B>0?Math.round((B-1)/90)*90:Math.round(B/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(B){B=B||{};var E=function(){},M=B.onComplete||E,R=B.onChange||E,o=this;return L.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(S){o.rotate(S),R()},onComplete:function(){o.setCoords(),M()}})}}),L.util.object.extend(L.StaticCanvas.prototype,{straightenObject:function(B){return B.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(B){return B.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function B(M,R){var o="precision "+R+` float;
void main(){}`,S=M.createShader(M.FRAGMENT_SHADER);return M.shaderSource(S,o),M.compileShader(S),!!M.getShaderParameter(S,M.COMPILE_STATUS)}L.isWebglSupported=function(M){if(L.isLikelyNode)return!1;M=M||L.WebglFilterBackend.prototype.tileSize;var R=document.createElement("canvas"),o=R.getContext("webgl")||R.getContext("experimental-webgl"),S=!1;if(o){L.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),S=L.maxTextureSize>=M;for(var l=["highp","mediump","lowp"],p=0;p<3;p++)if(B(o,l[p])){L.webGlPrecision=l[p];break}}return this.isSupported=S,S},L.WebglFilterBackend=E;function E(M){M&&M.tileSize&&(this.tileSize=M.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}E.prototype={tileSize:2048,resources:{},setupGLContext:function(M,R){this.dispose(),this.createWebGLCanvas(M,R),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(M,R)},chooseFastestCopyGLTo2DMethod:function(M,R){var o=typeof window.performance<"u",S;try{new ImageData(1,1),S=!0}catch{S=!1}var l=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(o&&S&&l&&p){var F=L.util.createCanvasElement(),O=new ArrayBuffer(M*R*4);if(L.forceGLPutImageData){this.imageBuffer=O,this.copyGLTo2D=Q;return}var q={imageBuffer:O,destinationWidth:M,destinationHeight:R,targetCanvas:F},W,U,Y;F.width=M,F.height=R,W=window.performance.now(),Z.call(q,this.gl,q),U=window.performance.now()-W,W=window.performance.now(),Q.call(q,this.gl,q),Y=window.performance.now()-W,U>Y?(this.imageBuffer=O,this.copyGLTo2D=Q):this.copyGLTo2D=Z}},createWebGLCanvas:function(M,R){var o=L.util.createCanvasElement();o.width=M,o.height=R;var S={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},l=o.getContext("webgl",S);l||(l=o.getContext("experimental-webgl",S)),l&&(l.clearColor(0,0,0,0),this.canvas=o,this.gl=l)},applyFilters:function(M,R,o,S,l,p){var F=this.gl,O;p&&(O=this.getCachedTexture(p,R));var q={originalWidth:R.width||R.originalWidth,originalHeight:R.height||R.originalHeight,sourceWidth:o,sourceHeight:S,destinationWidth:o,destinationHeight:S,context:F,sourceTexture:this.createTexture(F,o,S,!O&&R),targetTexture:this.createTexture(F,o,S),originalTexture:O||this.createTexture(F,o,S,!O&&R),passes:M.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:l},W=F.createFramebuffer();return F.bindFramebuffer(F.FRAMEBUFFER,W),M.forEach(function(U){U&&U.applyTo(q)}),K(q),this.copyGLTo2D(F,q),F.bindTexture(F.TEXTURE_2D,null),F.deleteTexture(q.sourceTexture),F.deleteTexture(q.targetTexture),F.deleteFramebuffer(W),l.getContext("2d").setTransform(1,0,0,1,0,0),q},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(M,R,o,S,l){var p=M.createTexture();return M.bindTexture(M.TEXTURE_2D,p),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,l||M.NEAREST),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,l||M.NEAREST),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),S?M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,S):M.texImage2D(M.TEXTURE_2D,0,M.RGBA,R,o,0,M.RGBA,M.UNSIGNED_BYTE,null),p},getCachedTexture:function(M,R){if(this.textureCache[M])return this.textureCache[M];var o=this.createTexture(this.gl,R.width,R.height,R);return this.textureCache[M]=o,o},evictCachesForKey:function(M){this.textureCache[M]&&(this.gl.deleteTexture(this.textureCache[M]),delete this.textureCache[M])},copyGLTo2D:Z,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var M=this.gl,R={renderer:"",vendor:""};if(!M)return R;var o=M.getExtension("WEBGL_debug_renderer_info");if(o){var S=M.getParameter(o.UNMASKED_RENDERER_WEBGL),l=M.getParameter(o.UNMASKED_VENDOR_WEBGL);S&&(R.renderer=S.toLowerCase()),l&&(R.vendor=l.toLowerCase())}return this.gpuInfo=R,R}}}();function K(B){var E=B.targetCanvas,M=E.width,R=E.height,o=B.destinationWidth,S=B.destinationHeight;(M!==o||R!==S)&&(E.width=o,E.height=S)}function Z(B,E){var M=B.canvas,R=E.targetCanvas,o=R.getContext("2d");o.translate(0,R.height),o.scale(1,-1);var S=M.height-R.height;o.drawImage(M,0,S,R.width,R.height,0,0,R.width,R.height)}function Q(B,E){var M=E.targetCanvas,R=M.getContext("2d"),o=E.destinationWidth,S=E.destinationHeight,l=o*S*4,p=new Uint8Array(this.imageBuffer,0,l),F=new Uint8ClampedArray(this.imageBuffer,0,l);B.readPixels(0,0,o,S,B.RGBA,B.UNSIGNED_BYTE,p);var O=new ImageData(F,o,S);R.putImageData(O,0,0)}(function(){var B=function(){};L.Canvas2dFilterBackend=E;function E(){}E.prototype={evictCachesForKey:B,dispose:B,clearWebGLCaches:B,resources:{},applyFilters:function(M,R,o,S,l){var p=l.getContext("2d");p.drawImage(R,0,0,o,S);var F=p.getImageData(0,0,o,S),O=p.getImageData(0,0,o,S),q={sourceWidth:o,sourceHeight:S,imageData:F,originalEl:R,originalImageData:O,canvasEl:l,ctx:p,filterBackend:this};return M.forEach(function(W){W.applyTo(q)}),(q.imageData.width!==o||q.imageData.height!==S)&&(l.width=q.imageData.width,l.height=q.imageData.height),p.putImageData(q.imageData,0,0),q}}})(),L.Image=L.Image||{},L.Image.filters=L.Image.filters||{},L.Image.filters.BaseFilter=L.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(B){B&&this.setOptions(B)},setOptions:function(B){for(var E in B)this[E]=B[E]},createProgram:function(B,E,M){E=E||this.fragmentSource,M=M||this.vertexSource,L.webGlPrecision!=="highp"&&(E=E.replace(/precision highp float/g,"precision "+L.webGlPrecision+" float"));var R=B.createShader(B.VERTEX_SHADER);if(B.shaderSource(R,M),B.compileShader(R),!B.getShaderParameter(R,B.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+B.getShaderInfoLog(R));var o=B.createShader(B.FRAGMENT_SHADER);if(B.shaderSource(o,E),B.compileShader(o),!B.getShaderParameter(o,B.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+B.getShaderInfoLog(o));var S=B.createProgram();if(B.attachShader(S,R),B.attachShader(S,o),B.linkProgram(S),!B.getProgramParameter(S,B.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+B.getProgramInfoLog(S));var l=this.getAttributeLocations(B,S),p=this.getUniformLocations(B,S)||{};return p.uStepW=B.getUniformLocation(S,"uStepW"),p.uStepH=B.getUniformLocation(S,"uStepH"),{program:S,attributeLocations:l,uniformLocations:p}},getAttributeLocations:function(B,E){return{aPosition:B.getAttribLocation(E,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(B,E,M){var R=E.aPosition,o=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,o),B.enableVertexAttribArray(R),B.vertexAttribPointer(R,2,B.FLOAT,!1,0,0),B.bufferData(B.ARRAY_BUFFER,M,B.STATIC_DRAW)},_setupFrameBuffer:function(B){var E=B.context,M,R;B.passes>1?(M=B.destinationWidth,R=B.destinationHeight,(B.sourceWidth!==M||B.sourceHeight!==R)&&(E.deleteTexture(B.targetTexture),B.targetTexture=B.filterBackend.createTexture(E,M,R)),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,B.targetTexture,0)):(E.bindFramebuffer(E.FRAMEBUFFER,null),E.finish())},_swapTextures:function(B){B.passes--,B.pass++;var E=B.targetTexture;B.targetTexture=B.sourceTexture,B.sourceTexture=E},isNeutralState:function(){var B=this.mainParameter,E=L.Image.filters[this.type].prototype;if(B)if(Array.isArray(E[B])){for(var M=E[B].length;M--;)if(this[B][M]!==E[B][M])return!1;return!0}else return E[B]===this[B];else return!1},applyTo:function(B){B.webgl?(this._setupFrameBuffer(B),this.applyToWebGL(B),this._swapTextures(B)):this.applyTo2d(B)},retrieveShader:function(B){return B.programCache.hasOwnProperty(this.type)||(B.programCache[this.type]=this.createProgram(B.context)),B.programCache[this.type]},applyToWebGL:function(B){var E=B.context,M=this.retrieveShader(B);B.pass===0&&B.originalTexture?E.bindTexture(E.TEXTURE_2D,B.originalTexture):E.bindTexture(E.TEXTURE_2D,B.sourceTexture),E.useProgram(M.program),this.sendAttributeData(E,M.attributeLocations,B.aPosition),E.uniform1f(M.uniformLocations.uStepW,1/B.sourceWidth),E.uniform1f(M.uniformLocations.uStepH,1/B.sourceHeight),this.sendUniformData(E,M.uniformLocations),E.viewport(0,0,B.destinationWidth,B.destinationHeight),E.drawArrays(E.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(B,E,M){B.activeTexture(M),B.bindTexture(B.TEXTURE_2D,E),B.activeTexture(B.TEXTURE0)},unbindAdditionalTexture:function(B,E){B.activeTexture(E),B.bindTexture(B.TEXTURE_2D,null),B.activeTexture(B.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(B){this[this.mainParameter]=B},sendUniformData:function(){},createHelpLayer:function(B){if(!B.helpLayer){var E=document.createElement("canvas");E.width=B.sourceWidth,E.height=B.sourceHeight,B.helpLayer=E}},toObject:function(){var B={type:this.type},E=this.mainParameter;return E&&(B[E]=this[E]),B},toJSON:function(){return this.toObject()}}),L.Image.filters.BaseFilter.fromObject=function(B,E){var M=new L.Image.filters[B.type](B);return E&&E(M),M},function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.ColorMatrix=R(M.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(o){this.callSuper("initialize",o),this.matrix=this.matrix.slice(0)},applyTo2d:function(o){var S=o.imageData,l=S.data,p=l.length,F=this.matrix,O,q,W,U,Y,J=this.colorsOnly;for(Y=0;Y<p;Y+=4)O=l[Y],q=l[Y+1],W=l[Y+2],J?(l[Y]=O*F[0]+q*F[1]+W*F[2]+F[4]*255,l[Y+1]=O*F[5]+q*F[6]+W*F[7]+F[9]*255,l[Y+2]=O*F[10]+q*F[11]+W*F[12]+F[14]*255):(U=l[Y+3],l[Y]=O*F[0]+q*F[1]+W*F[2]+U*F[3]+F[4]*255,l[Y+1]=O*F[5]+q*F[6]+W*F[7]+U*F[8]+F[9]*255,l[Y+2]=O*F[10]+q*F[11]+W*F[12]+U*F[13]+F[14]*255,l[Y+3]=O*F[15]+q*F[16]+W*F[17]+U*F[18]+F[19]*255)},getUniformLocations:function(o,S){return{uColorMatrix:o.getUniformLocation(S,"uColorMatrix"),uConstants:o.getUniformLocation(S,"uConstants")}},sendUniformData:function(o,S){var l=this.matrix,p=[l[0],l[1],l[2],l[3],l[5],l[6],l[7],l[8],l[10],l[11],l[12],l[13],l[15],l[16],l[17],l[18]],F=[l[4],l[9],l[14],l[19]];o.uniformMatrix4fv(S.uColorMatrix,!1,p),o.uniform4fv(S.uConstants,F)}}),E.Image.filters.ColorMatrix.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Brightness=R(M.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(o){if(this.brightness!==0){var S=o.imageData,l=S.data,p,F=l.length,O=Math.round(this.brightness*255);for(p=0;p<F;p+=4)l[p]=l[p]+O,l[p+1]=l[p+1]+O,l[p+2]=l[p+2]+O}},getUniformLocations:function(o,S){return{uBrightness:o.getUniformLocation(S,"uBrightness")}},sendUniformData:function(o,S){o.uniform1f(S.uBrightness,this.brightness)}}),E.Image.filters.Brightness.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.Convolute=o(R.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(S){var l=Math.sqrt(this.matrix.length),p=this.type+"_"+l+"_"+(this.opaque?1:0),F=this.fragmentSource[p];return S.programCache.hasOwnProperty(p)||(S.programCache[p]=this.createProgram(S.context,F)),S.programCache[p]},applyTo2d:function(S){var l=S.imageData,p=l.data,F=this.matrix,O=Math.round(Math.sqrt(F.length)),q=Math.floor(O/2),W=l.width,U=l.height,Y=S.ctx.createImageData(W,U),J=Y.data,te=this.opaque?1:0,oe,fe,be,Re,Fe,Me,Be,Ie,je,Xe,ze,Ue,ie;for(ze=0;ze<U;ze++)for(Xe=0;Xe<W;Xe++){for(Fe=(ze*W+Xe)*4,oe=0,fe=0,be=0,Re=0,ie=0;ie<O;ie++)for(Ue=0;Ue<O;Ue++)Be=ze+ie-q,Me=Xe+Ue-q,!(Be<0||Be>=U||Me<0||Me>=W)&&(Ie=(Be*W+Me)*4,je=F[ie*O+Ue],oe+=p[Ie]*je,fe+=p[Ie+1]*je,be+=p[Ie+2]*je,te||(Re+=p[Ie+3]*je));J[Fe]=oe,J[Fe+1]=fe,J[Fe+2]=be,te?J[Fe+3]=p[Fe+3]:J[Fe+3]=Re}S.imageData=Y},getUniformLocations:function(S,l){return{uMatrix:S.getUniformLocation(l,"uMatrix"),uOpaque:S.getUniformLocation(l,"uOpaque"),uHalfSize:S.getUniformLocation(l,"uHalfSize"),uSize:S.getUniformLocation(l,"uSize")}},sendUniformData:function(S,l){S.uniform1fv(l.uMatrix,this.matrix)},toObject:function(){return M(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),E.Image.filters.Convolute.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Grayscale=R(M.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(o){var S=o.imageData,l=S.data,p,F=l.length,O,q=this.mode;for(p=0;p<F;p+=4)q==="average"?O=(l[p]+l[p+1]+l[p+2])/3:q==="lightness"?O=(Math.min(l[p],l[p+1],l[p+2])+Math.max(l[p],l[p+1],l[p+2]))/2:q==="luminosity"&&(O=.21*l[p]+.72*l[p+1]+.07*l[p+2]),l[p]=O,l[p+1]=O,l[p+2]=O},retrieveShader:function(o){var S=this.type+"_"+this.mode;if(!o.programCache.hasOwnProperty(S)){var l=this.fragmentSource[this.mode];o.programCache[S]=this.createProgram(o.context,l)}return o.programCache[S]},getUniformLocations:function(o,S){return{uMode:o.getUniformLocation(S,"uMode")}},sendUniformData:function(o,S){var l=1;o.uniform1i(S.uMode,l)},isNeutralState:function(){return!1}}),E.Image.filters.Grayscale.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Invert=R(M.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(o){var S=o.imageData,l=S.data,p,F=l.length;for(p=0;p<F;p+=4)l[p]=255-l[p],l[p+1]=255-l[p+1],l[p+2]=255-l[p+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(o,S){return{uInvert:o.getUniformLocation(S,"uInvert")}},sendUniformData:function(o,S){o.uniform1i(S.uInvert,this.invert)}}),E.Image.filters.Invert.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.Noise=o(R.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(S){if(this.noise!==0){var l=S.imageData,p=l.data,F,O=p.length,q=this.noise,W;for(F=0,O=p.length;F<O;F+=4)W=(.5-Math.random())*q,p[F]+=W,p[F+1]+=W,p[F+2]+=W}},getUniformLocations:function(S,l){return{uNoise:S.getUniformLocation(l,"uNoise"),uSeed:S.getUniformLocation(l,"uSeed")}},sendUniformData:function(S,l){S.uniform1f(l.uNoise,this.noise/255),S.uniform1f(l.uSeed,Math.random())},toObject:function(){return M(this.callSuper("toObject"),{noise:this.noise})}}),E.Image.filters.Noise.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Pixelate=R(M.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(o){var S=o.imageData,l=S.data,p=S.height,F=S.width,O,q,W,U,Y,J,te,oe,fe,be,Re;for(q=0;q<p;q+=this.blocksize)for(W=0;W<F;W+=this.blocksize)for(O=q*4*F+W*4,U=l[O],Y=l[O+1],J=l[O+2],te=l[O+3],be=Math.min(q+this.blocksize,p),Re=Math.min(W+this.blocksize,F),oe=q;oe<be;oe++)for(fe=W;fe<Re;fe++)O=oe*4*F+fe*4,l[O]=U,l[O+1]=Y,l[O+2]=J,l[O+3]=te},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(o,S){return{uBlocksize:o.getUniformLocation(S,"uBlocksize"),uStepW:o.getUniformLocation(S,"uStepW"),uStepH:o.getUniformLocation(S,"uStepH")}},sendUniformData:function(o,S){o.uniform1f(S.uBlocksize,this.blocksize)}}),E.Image.filters.Pixelate.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.RemoveColor=o(R.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(S){var l=S.imageData,p=l.data,F,O=this.distance*255,q,W,U,Y=new E.Color(this.color).getSource(),J=[Y[0]-O,Y[1]-O,Y[2]-O],te=[Y[0]+O,Y[1]+O,Y[2]+O];for(F=0;F<p.length;F+=4)q=p[F],W=p[F+1],U=p[F+2],q>J[0]&&W>J[1]&&U>J[2]&&q<te[0]&&W<te[1]&&U<te[2]&&(p[F+3]=0)},getUniformLocations:function(S,l){return{uLow:S.getUniformLocation(l,"uLow"),uHigh:S.getUniformLocation(l,"uHigh")}},sendUniformData:function(S,l){var p=new E.Color(this.color).getSource(),F=parseFloat(this.distance),O=[0+p[0]/255-F,0+p[1]/255-F,0+p[2]/255-F,1],q=[p[0]/255+F,p[1]/255+F,p[2]/255+F,1];S.uniform4fv(l.uLow,O),S.uniform4fv(l.uHigh,q)},toObject:function(){return M(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),E.Image.filters.RemoveColor.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass,o={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var S in o)M[S]=R(M.ColorMatrix,{type:S,matrix:o[S],mainParameter:!1,colorsOnly:!0}),E.Image.filters[S].fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric,M=E.Image.filters,R=E.util.createClass;M.BlendColor=R(M.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(o){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[o]+`}
}`},retrieveShader:function(o){var S=this.type+"_"+this.mode,l;return o.programCache.hasOwnProperty(S)||(l=this.buildSource(this.mode),o.programCache[S]=this.createProgram(o.context,l)),o.programCache[S]},applyTo2d:function(o){var S=o.imageData,l=S.data,p=l.length,F,O,q,W,U,Y,J,te=1-this.alpha;J=new E.Color(this.color).getSource(),F=J[0]*this.alpha,O=J[1]*this.alpha,q=J[2]*this.alpha;for(var oe=0;oe<p;oe+=4)switch(W=l[oe],U=l[oe+1],Y=l[oe+2],this.mode){case"multiply":l[oe]=W*F/255,l[oe+1]=U*O/255,l[oe+2]=Y*q/255;break;case"screen":l[oe]=255-(255-W)*(255-F)/255,l[oe+1]=255-(255-U)*(255-O)/255,l[oe+2]=255-(255-Y)*(255-q)/255;break;case"add":l[oe]=W+F,l[oe+1]=U+O,l[oe+2]=Y+q;break;case"diff":case"difference":l[oe]=Math.abs(W-F),l[oe+1]=Math.abs(U-O),l[oe+2]=Math.abs(Y-q);break;case"subtract":l[oe]=W-F,l[oe+1]=U-O,l[oe+2]=Y-q;break;case"darken":l[oe]=Math.min(W,F),l[oe+1]=Math.min(U,O),l[oe+2]=Math.min(Y,q);break;case"lighten":l[oe]=Math.max(W,F),l[oe+1]=Math.max(U,O),l[oe+2]=Math.max(Y,q);break;case"overlay":l[oe]=F<128?2*W*F/255:255-2*(255-W)*(255-F)/255,l[oe+1]=O<128?2*U*O/255:255-2*(255-U)*(255-O)/255,l[oe+2]=q<128?2*Y*q/255:255-2*(255-Y)*(255-q)/255;break;case"exclusion":l[oe]=F+W-2*F*W/255,l[oe+1]=O+U-2*O*U/255,l[oe+2]=q+Y-2*q*Y/255;break;case"tint":l[oe]=F+W*te,l[oe+1]=O+U*te,l[oe+2]=q+Y*te}},getUniformLocations:function(o,S){return{uColor:o.getUniformLocation(S,"uColor")}},sendUniformData:function(o,S){var l=new E.Color(this.color).getSource();l[0]=this.alpha*l[0]/255,l[1]=this.alpha*l[1]/255,l[2]=this.alpha*l[2]/255,l[3]=this.alpha,o.uniform4fv(S.uColor,l)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),E.Image.filters.BlendColor.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric,M=E.Image.filters,R=E.util.createClass;M.BlendImage=R(M.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(o){var S=this.type+"_"+this.mode,l=this.fragmentSource[this.mode];return o.programCache.hasOwnProperty(S)||(o.programCache[S]=this.createProgram(o.context,l)),o.programCache[S]},applyToWebGL:function(o){var S=o.context,l=this.createTexture(o.filterBackend,this.image);this.bindAdditionalTexture(S,l,S.TEXTURE1),this.callSuper("applyToWebGL",o),this.unbindAdditionalTexture(S,S.TEXTURE1)},createTexture:function(o,S){return o.getCachedTexture(S.cacheKey,S._element)},calculateMatrix:function(){var o=this.image,S=o._element.width,l=o._element.height;return[1/o.scaleX,0,0,0,1/o.scaleY,0,-o.left/S,-o.top/l,1]},applyTo2d:function(o){var S=o.imageData,l=o.filterBackend.resources,p=S.data,F=p.length,O=S.width,q=S.height,W,U,Y,J,te,oe,fe,be,Re,Fe,Me=this.image,Be;l.blendImage||(l.blendImage=E.util.createCanvasElement()),Re=l.blendImage,Fe=Re.getContext("2d"),Re.width!==O||Re.height!==q?(Re.width=O,Re.height=q):Fe.clearRect(0,0,O,q),Fe.setTransform(Me.scaleX,0,0,Me.scaleY,Me.left,Me.top),Fe.drawImage(Me._element,0,0,O,q),Be=Fe.getImageData(0,0,O,q).data;for(var Ie=0;Ie<F;Ie+=4)switch(te=p[Ie],oe=p[Ie+1],fe=p[Ie+2],be=p[Ie+3],W=Be[Ie],U=Be[Ie+1],Y=Be[Ie+2],J=Be[Ie+3],this.mode){case"multiply":p[Ie]=te*W/255,p[Ie+1]=oe*U/255,p[Ie+2]=fe*Y/255,p[Ie+3]=be*J/255;break;case"mask":p[Ie+3]=J;break}},getUniformLocations:function(o,S){return{uTransformMatrix:o.getUniformLocation(S,"uTransformMatrix"),uImage:o.getUniformLocation(S,"uImage")}},sendUniformData:function(o,S){var l=this.calculateMatrix();o.uniform1i(S.uImage,1),o.uniformMatrix3fv(S.uTransformMatrix,!1,l)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),E.Image.filters.BlendImage.fromObject=function(o,S){E.Image.fromObject(o.image,function(l){var p=E.util.object.clone(o);p.image=l,S(new E.Image.filters.BlendImage(p))})}}(X),function(B){var E=B.fabric||(B.fabric={}),M=Math.pow,R=Math.floor,o=Math.sqrt,S=Math.abs,l=Math.round,p=Math.sin,F=Math.ceil,O=E.Image.filters,q=E.util.createClass;O.Resize=q(O.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(W,U){return{uDelta:W.getUniformLocation(U,"uDelta"),uTaps:W.getUniformLocation(U,"uTaps")}},sendUniformData:function(W,U){W.uniform2fv(U.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),W.uniform1fv(U.uTaps,this.taps)},retrieveShader:function(W){var U=this.getFilterWindow(),Y=this.type+"_"+U;if(!W.programCache.hasOwnProperty(Y)){var J=this.generateShader(U);W.programCache[Y]=this.createProgram(W.context,J)}return W.programCache[Y]},getFilterWindow:function(){var W=this.tempScale;return Math.ceil(this.lanczosLobes/W)},getTaps:function(){for(var W=this.lanczosCreate(this.lanczosLobes),U=this.tempScale,Y=this.getFilterWindow(),J=new Array(Y),te=1;te<=Y;te++)J[te-1]=W(te*U);return J},generateShader:function(J){for(var U=new Array(J),Y=this.fragmentSourceTOP,J,te=1;te<=J;te++)U[te-1]=te+".0 * uDelta";return Y+="uniform float uTaps["+J+`];
`,Y+=`void main() {
`,Y+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,Y+=`  float sum = 1.0;
`,U.forEach(function(oe,fe){Y+="  color += texture2D(uTexture, vTexCoord + "+oe+") * uTaps["+fe+`];
`,Y+="  color += texture2D(uTexture, vTexCoord - "+oe+") * uTaps["+fe+`];
`,Y+="  sum += 2.0 * uTaps["+fe+`];
`}),Y+=`  gl_FragColor = color / sum;
`,Y+="}",Y},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(W){W.webgl?(W.passes++,this.width=W.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=W.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),W.destinationWidth=this.dW,this._setupFrameBuffer(W),this.applyToWebGL(W),this._swapTextures(W),W.sourceWidth=W.destinationWidth,this.height=W.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),W.destinationHeight=this.dH,this._setupFrameBuffer(W),this.applyToWebGL(W),this._swapTextures(W),W.sourceHeight=W.destinationHeight):this.applyTo2d(W)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(W){return function(U){if(U>=W||U<=-W)return 0;if(U<11920929e-14&&U>-11920929e-14)return 1;U*=Math.PI;var Y=U/W;return p(U)/U*p(Y)/Y}},applyTo2d:function(W){var U=W.imageData,Y=this.scaleX,J=this.scaleY;this.rcpScaleX=1/Y,this.rcpScaleY=1/J;var te=U.width,oe=U.height,fe=l(te*Y),be=l(oe*J),Re;this.resizeType==="sliceHack"?Re=this.sliceByTwo(W,te,oe,fe,be):this.resizeType==="hermite"?Re=this.hermiteFastResize(W,te,oe,fe,be):this.resizeType==="bilinear"?Re=this.bilinearFiltering(W,te,oe,fe,be):this.resizeType==="lanczos"&&(Re=this.lanczosResize(W,te,oe,fe,be)),W.imageData=Re},sliceByTwo:function(W,U,Y,J,te){var oe=W.imageData,fe=.5,be=!1,Re=!1,Fe=U*fe,Me=Y*fe,Be=E.filterBackend.resources,Ie,je,Xe=0,ze=0,Ue=U,ie=0;for(Be.sliceByTwo||(Be.sliceByTwo=document.createElement("canvas")),Ie=Be.sliceByTwo,(Ie.width<U*1.5||Ie.height<Y)&&(Ie.width=U*1.5,Ie.height=Y),je=Ie.getContext("2d"),je.clearRect(0,0,U*1.5,Y),je.putImageData(oe,0,0),J=R(J),te=R(te);!be||!Re;)U=Fe,Y=Me,J<R(Fe*fe)?Fe=R(Fe*fe):(Fe=J,be=!0),te<R(Me*fe)?Me=R(Me*fe):(Me=te,Re=!0),je.drawImage(Ie,Xe,ze,U,Y,Ue,ie,Fe,Me),Xe=Ue,ze=ie,ie+=Me;return je.getImageData(Xe,ze,J,te)},lanczosResize:function(W,U,Y,J,te){function oe(he){var ce,me,ae,ne,ge,ve,xe,ye,Ae,De,He;for(ie.x=(he+.5)*Me,ue.x=R(ie.x),ce=0;ce<te;ce++){for(ie.y=(ce+.5)*Be,ue.y=R(ie.y),ge=0,ve=0,xe=0,ye=0,Ae=0,me=ue.x-Xe;me<=ue.x+Xe;me++)if(!(me<0||me>=U)){De=R(1e3*S(me-ie.x)),Ue[De]||(Ue[De]={});for(var Se=ue.y-ze;Se<=ue.y+ze;Se++)Se<0||Se>=Y||(He=R(1e3*S(Se-ie.y)),Ue[De][He]||(Ue[De][He]=Fe(o(M(De*Ie,2)+M(He*je,2))/1e3)),ae=Ue[De][He],ae>0&&(ne=(Se*U+me)*4,ge+=ae,ve+=ae*fe[ne],xe+=ae*fe[ne+1],ye+=ae*fe[ne+2],Ae+=ae*fe[ne+3]))}ne=(ce*J+he)*4,Re[ne]=ve/ge,Re[ne+1]=xe/ge,Re[ne+2]=ye/ge,Re[ne+3]=Ae/ge}return++he<J?oe(he):be}var fe=W.imageData.data,be=W.ctx.createImageData(J,te),Re=be.data,Fe=this.lanczosCreate(this.lanczosLobes),Me=this.rcpScaleX,Be=this.rcpScaleY,Ie=2/this.rcpScaleX,je=2/this.rcpScaleY,Xe=F(Me*this.lanczosLobes/2),ze=F(Be*this.lanczosLobes/2),Ue={},ie={},ue={};return oe(0)},bilinearFiltering:function(W,U,Y,J,te){var oe,fe,be,Re,Fe,Me,Be,Ie,je,Xe,ze,Ue,ie=0,ue,he=this.rcpScaleX,ce=this.rcpScaleY,me=4*(U-1),ae=W.imageData,ne=ae.data,ge=W.ctx.createImageData(J,te),ve=ge.data;for(Be=0;Be<te;Be++)for(Ie=0;Ie<J;Ie++)for(Fe=R(he*Ie),Me=R(ce*Be),je=he*Ie-Fe,Xe=ce*Be-Me,ue=4*(Me*U+Fe),ze=0;ze<4;ze++)oe=ne[ue+ze],fe=ne[ue+4+ze],be=ne[ue+me+ze],Re=ne[ue+me+4+ze],Ue=oe*(1-je)*(1-Xe)+fe*je*(1-Xe)+be*Xe*(1-je)+Re*je*Xe,ve[ie++]=Ue;return ge},hermiteFastResize:function(W,U,Y,J,te){for(var oe=this.rcpScaleX,fe=this.rcpScaleY,be=F(oe/2),Re=F(fe/2),Fe=W.imageData,Me=Fe.data,Be=W.ctx.createImageData(J,te),Ie=Be.data,je=0;je<te;je++)for(var Xe=0;Xe<J;Xe++){for(var ze=(Xe+je*J)*4,Ue=0,ie=0,ue=0,he=0,ce=0,me=0,ae=0,ne=(je+.5)*fe,ge=R(je*fe);ge<(je+1)*fe;ge++)for(var ve=S(ne-(ge+.5))/Re,xe=(Xe+.5)*oe,ye=ve*ve,Ae=R(Xe*oe);Ae<(Xe+1)*oe;Ae++){var De=S(xe-(Ae+.5))/be,He=o(ye+De*De);He>1&&He<-1||(Ue=2*He*He*He-3*He*He+1,Ue>0&&(De=4*(Ae+ge*U),ae+=Ue*Me[De+3],ue+=Ue,Me[De+3]<255&&(Ue=Ue*Me[De+3]/250),he+=Ue*Me[De],ce+=Ue*Me[De+1],me+=Ue*Me[De+2],ie+=Ue))}Ie[ze]=he/ie,Ie[ze+1]=ce/ie,Ie[ze+2]=me/ie,Ie[ze+3]=ae/ue}return Be},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),E.Image.filters.Resize.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Contrast=R(M.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(o){if(this.contrast!==0){var S=o.imageData,l,F,p=S.data,F=p.length,O=Math.floor(this.contrast*255),q=259*(O+255)/(255*(259-O));for(l=0;l<F;l+=4)p[l]=q*(p[l]-128)+128,p[l+1]=q*(p[l+1]-128)+128,p[l+2]=q*(p[l+2]-128)+128}},getUniformLocations:function(o,S){return{uContrast:o.getUniformLocation(S,"uContrast")}},sendUniformData:function(o,S){o.uniform1f(S.uContrast,this.contrast)}}),E.Image.filters.Contrast.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Saturation=R(M.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(o){if(this.saturation!==0){var S=o.imageData,l=S.data,p=l.length,F=-this.saturation,O,q;for(O=0;O<p;O+=4)q=Math.max(l[O],l[O+1],l[O+2]),l[O]+=q!==l[O]?(q-l[O])*F:0,l[O+1]+=q!==l[O+1]?(q-l[O+1])*F:0,l[O+2]+=q!==l[O+2]?(q-l[O+2])*F:0}},getUniformLocations:function(o,S){return{uSaturation:o.getUniformLocation(S,"uSaturation")}},sendUniformData:function(o,S){o.uniform1f(S.uSaturation,-this.saturation)}}),E.Image.filters.Saturation.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Vibrance=R(M.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(o){if(this.vibrance!==0){var S=o.imageData,l=S.data,p=l.length,F=-this.vibrance,O,q,W,U;for(O=0;O<p;O+=4)q=Math.max(l[O],l[O+1],l[O+2]),W=(l[O]+l[O+1]+l[O+2])/3,U=Math.abs(q-W)*2/255*F,l[O]+=q!==l[O]?(q-l[O])*U:0,l[O+1]+=q!==l[O+1]?(q-l[O+1])*U:0,l[O+2]+=q!==l[O+2]?(q-l[O+2])*U:0}},getUniformLocations:function(o,S){return{uVibrance:o.getUniformLocation(S,"uVibrance")}},sendUniformData:function(o,S){o.uniform1f(S.uVibrance,-this.vibrance)}}),E.Image.filters.Vibrance.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Blur=R(M.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(o){o.webgl?(this.aspectRatio=o.sourceWidth/o.sourceHeight,o.passes++,this._setupFrameBuffer(o),this.horizontal=!0,this.applyToWebGL(o),this._swapTextures(o),this._setupFrameBuffer(o),this.horizontal=!1,this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},applyTo2d:function(o){o.imageData=this.simpleBlur(o)},simpleBlur:function(o){var S=o.filterBackend.resources,l,p,F=o.imageData.width,O=o.imageData.height;S.blurLayer1||(S.blurLayer1=E.util.createCanvasElement(),S.blurLayer2=E.util.createCanvasElement()),l=S.blurLayer1,p=S.blurLayer2,(l.width!==F||l.height!==O)&&(p.width=l.width=F,p.height=l.height=O);var q=l.getContext("2d"),W=p.getContext("2d"),U=15,Y,J,te,oe,fe=this.blur*.06*.5;for(q.putImageData(o.imageData,0,0),W.clearRect(0,0,F,O),oe=-U;oe<=U;oe++)Y=(Math.random()-.5)/4,J=oe/U,te=fe*J*F+Y,W.globalAlpha=1-Math.abs(J),W.drawImage(l,te,Y),q.drawImage(p,0,0),W.globalAlpha=1,W.clearRect(0,0,p.width,p.height);for(oe=-U;oe<=U;oe++)Y=(Math.random()-.5)/4,J=oe/U,te=fe*J*O+Y,W.globalAlpha=1-Math.abs(J),W.drawImage(l,Y,te),q.drawImage(p,0,0),W.globalAlpha=1,W.clearRect(0,0,p.width,p.height);o.ctx.drawImage(l,0,0);var be=o.ctx.getImageData(0,0,l.width,l.height);return q.globalAlpha=1,q.clearRect(0,0,l.width,l.height),be},getUniformLocations:function(o,S){return{delta:o.getUniformLocation(S,"uDelta")}},sendUniformData:function(o,S){var l=this.chooseRightDelta();o.uniform2fv(S.delta,l)},chooseRightDelta:function(){var o=1,S=[0,0],l;return this.horizontal?this.aspectRatio>1&&(o=1/this.aspectRatio):this.aspectRatio<1&&(o=this.aspectRatio),l=o*this.blur*.12,this.horizontal?S[0]=l:S[1]=l,S}}),M.Blur.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Gamma=R(M.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(o){this.gamma=[1,1,1],M.BaseFilter.prototype.initialize.call(this,o)},applyTo2d:function(o){var S=o.imageData,l=S.data,p=this.gamma,F=l.length,O=1/p[0],q=1/p[1],W=1/p[2],U;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),U=0,F=256;U<F;U++)this.rVals[U]=Math.pow(U/255,O)*255,this.gVals[U]=Math.pow(U/255,q)*255,this.bVals[U]=Math.pow(U/255,W)*255;for(U=0,F=l.length;U<F;U+=4)l[U]=this.rVals[l[U]],l[U+1]=this.gVals[l[U+1]],l[U+2]=this.bVals[l[U+2]]},getUniformLocations:function(o,S){return{uGamma:o.getUniformLocation(S,"uGamma")}},sendUniformData:function(o,S){o.uniform3fv(S.uGamma,this.gamma)}}),E.Image.filters.Gamma.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.Composed=R(M.BaseFilter,{type:"Composed",subFilters:[],initialize:function(o){this.callSuper("initialize",o),this.subFilters=this.subFilters.slice(0)},applyTo:function(o){o.passes+=this.subFilters.length-1,this.subFilters.forEach(function(S){S.applyTo(o)})},toObject:function(){return E.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(o){return o.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(o){return!o.isNeutralState()})}}),E.Image.filters.Composed.fromObject=function(o,S){var l=o.subFilters||[],p=l.map(function(O){return new E.Image.filters[O.type](O)}),F=new E.Image.filters.Composed({subFilters:p});return S&&S(F),F}}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.Image.filters,R=E.util.createClass;M.HueRotation=R(M.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var o=this.rotation*Math.PI,S=E.util.cos(o),l=E.util.sin(o),p=1/3,F=Math.sqrt(p)*l,O=1-S;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=S+O/3,this.matrix[1]=p*O-F,this.matrix[2]=p*O+F,this.matrix[5]=p*O+F,this.matrix[6]=S+p*O,this.matrix[7]=p*O-F,this.matrix[10]=p*O-F,this.matrix[11]=p*O+F,this.matrix[12]=S+p*O},isNeutralState:function(o){return this.calculateMatrix(),M.BaseFilter.prototype.isNeutralState.call(this,o)},applyTo:function(o){this.calculateMatrix(),M.BaseFilter.prototype.applyTo.call(this,o)}}),E.Image.filters.HueRotation.fromObject=E.Image.filters.BaseFilter.fromObject}(X),function(B){var E=B.fabric||(B.fabric={}),M=E.util.object.clone;if(E.Text){E.warn("fabric.Text is already defined");return}var R="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");E.Text=E.util.createClass(E.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:E.Object.prototype.stateProperties.concat(R),cacheProperties:E.Object.prototype.cacheProperties.concat(R),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(o,S){this.styles=S?S.styles||{}:{},this.text=o,this.__skipDimension=!0,this.callSuper("initialize",S),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var o=this.path;o&&(o.segmentsInfo=E.util.getPathSegmentsInfo(o.path))},getMeasuringContext:function(){return E._measuringContext||(E._measuringContext=this.canvas&&this.canvas.contextCache||E.util.createCanvasElement().getContext("2d")),E._measuringContext},_splitText:function(){var o=this._splitTextIntoLines(this.text);return this.textLines=o.lines,this._textLines=o.graphemeLines,this._unwrappedTextLines=o._unwrappedLines,this._text=o.graphemeText,o},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var o,S,l,p,F,O,q,W=0,U=this._textLines.length;W<U;W++)if(!(this.textAlign!=="justify"&&(W===U-1||this.isEndOfWrapping(W)))&&(p=0,F=this._textLines[W],S=this.getLineWidth(W),S<this.width&&(q=this.textLines[W].match(this._reSpacesAndTabs)))){l=q.length,o=(this.width-S)/l;for(var Y=0,J=F.length;Y<=J;Y++)O=this.__charBounds[W][Y],this._reSpaceAndTab.test(F[Y])?(O.width+=o,O.kernedWidth+=o,O.left+=p,p+=o):O.left+=p}},isEndOfWrapping:function(o){return o===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var o=this.callSuper("_getCacheCanvasDimensions"),S=this.fontSize;return o.width+=S*o.zoomX,o.height+=S*o.zoomY,o},_render:function(o){var S=this.path;S&&!S.isNotVisible()&&S._render(o),this._setTextStyles(o),this._renderTextLinesBackground(o),this._renderTextDecoration(o,"underline"),this._renderText(o),this._renderTextDecoration(o,"overline"),this._renderTextDecoration(o,"linethrough")},_renderText:function(o){this.paintFirst==="stroke"?(this._renderTextStroke(o),this._renderTextFill(o)):(this._renderTextFill(o),this._renderTextStroke(o))},_setTextStyles:function(o,S,l){if(o.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":o.textBaseline="middle";break;case"ascender":o.textBaseline="top";break;case"descender":o.textBaseline="bottom";break}o.font=this._getFontDeclaration(S,l)},calcTextWidth:function(){for(var o=this.getLineWidth(0),S=1,l=this._textLines.length;S<l;S++){var p=this.getLineWidth(S);p>o&&(o=p)}return o},_renderTextLine:function(o,S,l,p,F,O){this._renderChars(o,S,l,p,F,O)},_renderTextLinesBackground:function(o){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var S,l,p=o.fillStyle,F,O,q=this._getLeftOffset(),W=this._getTopOffset(),U=0,Y=0,J,te,oe=this.path,fe,be=0,Re=this._textLines.length;be<Re;be++){if(S=this.getHeightOfLine(be),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",be)){W+=S;continue}F=this._textLines[be],l=this._getLineLeftOffset(be),Y=0,U=0,O=this.getValueOfPropertyAt(be,0,"textBackgroundColor");for(var Fe=0,Me=F.length;Fe<Me;Fe++)J=this.__charBounds[be][Fe],te=this.getValueOfPropertyAt(be,Fe,"textBackgroundColor"),oe?(o.save(),o.translate(J.renderLeft,J.renderTop),o.rotate(J.angle),o.fillStyle=te,te&&o.fillRect(-J.width/2,-S/this.lineHeight*(1-this._fontSizeFraction),J.width,S/this.lineHeight),o.restore()):te!==O?(fe=q+l+U,this.direction==="rtl"&&(fe=this.width-fe-Y),o.fillStyle=O,O&&o.fillRect(fe,W,Y,S/this.lineHeight),U=J.left,Y=J.width,O=te):Y+=J.kernedWidth;te&&!oe&&(fe=q+l+U,this.direction==="rtl"&&(fe=this.width-fe-Y),o.fillStyle=te,o.fillRect(fe,W,Y,S/this.lineHeight)),W+=S}o.fillStyle=p,this._removeShadow(o)}},getFontCache:function(o){var S=o.fontFamily.toLowerCase();E.charWidthsCache[S]||(E.charWidthsCache[S]={});var l=E.charWidthsCache[S],p=o.fontStyle.toLowerCase()+"_"+(o.fontWeight+"").toLowerCase();return l[p]||(l[p]={}),l[p]},_measureChar:function(o,S,l,p){var F=this.getFontCache(S),O=this._getFontDeclaration(S),q=this._getFontDeclaration(p),W=l+o,U=O===q,Y,J,te,oe=S.fontSize/this.CACHE_FONT_SIZE,fe;if(l&&F[l]!==void 0&&(te=F[l]),F[o]!==void 0&&(fe=Y=F[o]),U&&F[W]!==void 0&&(J=F[W],fe=J-te),Y===void 0||te===void 0||J===void 0){var be=this.getMeasuringContext();this._setTextStyles(be,S,!0)}return Y===void 0&&(fe=Y=be.measureText(o).width,F[o]=Y),te===void 0&&U&&l&&(te=be.measureText(l).width,F[l]=te),U&&J===void 0&&(J=be.measureText(W).width,F[W]=J,fe=J-te),{width:Y*oe,kernedWidth:fe*oe}},getHeightOfChar:function(o,S){return this.getValueOfPropertyAt(o,S,"fontSize")},measureLine:function(o){var S=this._measureLine(o);return this.charSpacing!==0&&(S.width-=this._getWidthOfCharSpacing()),S.width<0&&(S.width=0),S},_measureLine:function(o){var S=0,l,p,F=this._textLines[o],O,q,W=0,U=new Array(F.length),Y=0,J,te,oe=this.path,fe=this.pathSide==="right";for(this.__charBounds[o]=U,l=0;l<F.length;l++)p=F[l],q=this._getGraphemeBox(p,o,l,O),U[l]=q,S+=q.kernedWidth,O=p;if(U[l]={left:q?q.left+q.width:0,width:0,kernedWidth:0,height:this.fontSize},oe){switch(te=oe.segmentsInfo[oe.segmentsInfo.length-1].length,J=E.util.getPointOnPath(oe.path,0,oe.segmentsInfo),J.x+=oe.pathOffset.x,J.y+=oe.pathOffset.y,this.textAlign){case"left":Y=fe?te-S:0;break;case"center":Y=(te-S)/2;break;case"right":Y=fe?0:te-S;break}for(Y+=this.pathStartOffset*(fe?-1:1),l=fe?F.length-1:0;fe?l>=0:l<F.length;fe?l--:l++)q=U[l],Y>te?Y%=te:Y<0&&(Y+=te),this._setGraphemeOnPath(Y,q,J),Y+=q.kernedWidth}return{width:S,numOfSpaces:W}},_setGraphemeOnPath:function(o,S,l){var p=o+S.kernedWidth/2,F=this.path,O=E.util.getPointOnPath(F.path,p,F.segmentsInfo);S.renderLeft=O.x-l.x,S.renderTop=O.y-l.y,S.angle=O.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(o,S,l,p,F){var O=this.getCompleteStyleDeclaration(S,l),q=p?this.getCompleteStyleDeclaration(S,l-1):{},W=this._measureChar(o,O,p,q),U=W.kernedWidth,Y=W.width,J;this.charSpacing!==0&&(J=this._getWidthOfCharSpacing(),Y+=J,U+=J);var te={width:Y,left:0,height:O.fontSize,kernedWidth:U,deltaY:O.deltaY};if(l>0&&!F){var oe=this.__charBounds[S][l-1];te.left=oe.left+oe.width+W.kernedWidth-W.width}return te},getHeightOfLine:function(o){if(this.__lineHeights[o])return this.__lineHeights[o];for(var S=this._textLines[o],l=this.getHeightOfChar(o,0),p=1,F=S.length;p<F;p++)l=Math.max(this.getHeightOfChar(o,p),l);return this.__lineHeights[o]=l*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var o,S=0,l=0,p=this._textLines.length;l<p;l++)o=this.getHeightOfLine(l),S+=l===p-1?o/this.lineHeight:o;return S},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(o,S){o.save();for(var l=0,p=this._getLeftOffset(),F=this._getTopOffset(),O=0,q=this._textLines.length;O<q;O++){var W=this.getHeightOfLine(O),U=W/this.lineHeight,Y=this._getLineLeftOffset(O);this._renderTextLine(S,o,this._textLines[O],p+Y,F+l+U,O),l+=W}o.restore()},_renderTextFill:function(o){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(o,"fillText")},_renderTextStroke:function(o){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(o),o.save(),this._setLineDash(o,this.strokeDashArray),o.beginPath(),this._renderTextCommon(o,"strokeText"),o.closePath(),o.restore())},_renderChars:function(o,S,l,p,F,O){var q=this.getHeightOfLine(O),W=this.textAlign.indexOf("justify")!==-1,U,Y,J="",te,oe=0,fe,be=this.path,Re=!W&&this.charSpacing===0&&this.isEmptyStyles(O)&&!be,Fe=this.direction==="ltr",Me=this.direction==="ltr"?1:-1,Be,Ie=S.canvas.getAttribute("dir");if(S.save(),Ie!==this.direction&&(S.canvas.setAttribute("dir",Fe?"ltr":"rtl"),S.direction=Fe?"ltr":"rtl",S.textAlign=Fe?"left":"right"),F-=q*this._fontSizeFraction/this.lineHeight,Re){this._renderChar(o,S,O,0,l.join(""),p,F,q),S.restore();return}for(var je=0,Xe=l.length-1;je<=Xe;je++)fe=je===Xe||this.charSpacing||be,J+=l[je],te=this.__charBounds[O][je],oe===0?(p+=Me*(te.kernedWidth-te.width),oe+=te.width):oe+=te.kernedWidth,W&&!fe&&this._reSpaceAndTab.test(l[je])&&(fe=!0),fe||(U=U||this.getCompleteStyleDeclaration(O,je),Y=this.getCompleteStyleDeclaration(O,je+1),fe=E.util.hasStyleChanged(U,Y,!1)),fe&&(be?(S.save(),S.translate(te.renderLeft,te.renderTop),S.rotate(te.angle),this._renderChar(o,S,O,je,J,-oe/2,0,q),S.restore()):(Be=p,this._renderChar(o,S,O,je,J,Be,F,q)),J="",U=Y,p+=Me*oe,oe=0);S.restore()},_applyPatternGradientTransformText:function(o){var S=E.util.createCanvasElement(),l,p=this.width+this.strokeWidth,F=this.height+this.strokeWidth;return S.width=p,S.height=F,l=S.getContext("2d"),l.beginPath(),l.moveTo(0,0),l.lineTo(p,0),l.lineTo(p,F),l.lineTo(0,F),l.closePath(),l.translate(p/2,F/2),l.fillStyle=o.toLive(l),this._applyPatternGradientTransform(l,o),l.fill(),l.createPattern(S,"no-repeat")},handleFiller:function(o,S,l){var p,F;return l.toLive?l.gradientUnits==="percentage"||l.gradientTransform||l.patternTransform?(p=-this.width/2,F=-this.height/2,o.translate(p,F),o[S]=this._applyPatternGradientTransformText(l),{offsetX:p,offsetY:F}):(o[S]=l.toLive(o,this),this._applyPatternGradientTransform(o,l)):(o[S]=l,{offsetX:0,offsetY:0})},_setStrokeStyles:function(o,S){return o.lineWidth=S.strokeWidth,o.lineCap=this.strokeLineCap,o.lineDashOffset=this.strokeDashOffset,o.lineJoin=this.strokeLineJoin,o.miterLimit=this.strokeMiterLimit,this.handleFiller(o,"strokeStyle",S.stroke)},_setFillStyles:function(o,S){return this.handleFiller(o,"fillStyle",S.fill)},_renderChar:function(o,S,l,p,F,O,q){var W=this._getStyleDeclaration(l,p),U=this.getCompleteStyleDeclaration(l,p),Y=o==="fillText"&&U.fill,J=o==="strokeText"&&U.stroke&&U.strokeWidth,te,oe;!J&&!Y||(S.save(),Y&&(te=this._setFillStyles(S,U)),J&&(oe=this._setStrokeStyles(S,U)),S.font=this._getFontDeclaration(U),W&&W.textBackgroundColor&&this._removeShadow(S),W&&W.deltaY&&(q+=W.deltaY),Y&&S.fillText(F,O-te.offsetX,q-te.offsetY),J&&S.strokeText(F,O-oe.offsetX,q-oe.offsetY),S.restore())},setSuperscript:function(o,S){return this._setScript(o,S,this.superscript)},setSubscript:function(o,S){return this._setScript(o,S,this.subscript)},_setScript:function(o,S,l){var p=this.get2DCursorLocation(o,!0),F=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),O=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),q={fontSize:F*l.size,deltaY:O+F*l.baseline};return this.setSelectionStyles(q,o,S),this},_getLineLeftOffset:function(o){var S=this.getLineWidth(o),l=this.width-S,p=this.textAlign,F=this.direction,q,O=0,q=this.isEndOfWrapping(o);return p==="justify"||p==="justify-center"&&!q||p==="justify-right"&&!q||p==="justify-left"&&!q?0:(p==="center"&&(O=l/2),p==="right"&&(O=l),p==="justify-center"&&(O=l/2),p==="justify-right"&&(O=l),F==="rtl"&&(O-=l),O)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var o=this._forceClearCache;return o||(o=this.hasStateChanged("_dimensionAffectingProps")),o&&(this.dirty=!0,this._forceClearCache=!1),o},getLineWidth:function(o){if(this.__lineWidths[o]!==void 0)return this.__lineWidths[o];var S=this.measureLine(o),l=S.width;return this.__lineWidths[o]=l,l},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(o,S,l){var p=this._getStyleDeclaration(o,S);return p&&typeof p[l]<"u"?p[l]:this[l]},_renderTextDecoration:function(o,S){if(!(!this[S]&&!this.styleHas(S))){for(var l,p,F,O,q,W,U,Y,J=this._getLeftOffset(),te=this._getTopOffset(),oe,fe,be,Re,Fe,Me,Be,Ie,je=this.path,Xe=this._getWidthOfCharSpacing(),ze=this.offsets[S],Ue=0,ie=this._textLines.length;Ue<ie;Ue++){if(l=this.getHeightOfLine(Ue),!this[S]&&!this.styleHas(S,Ue)){te+=l;continue}U=this._textLines[Ue],Me=l/this.lineHeight,O=this._getLineLeftOffset(Ue),fe=0,be=0,Y=this.getValueOfPropertyAt(Ue,0,S),Ie=this.getValueOfPropertyAt(Ue,0,"fill"),oe=te+Me*(1-this._fontSizeFraction),p=this.getHeightOfChar(Ue,0),q=this.getValueOfPropertyAt(Ue,0,"deltaY");for(var ue=0,he=U.length;ue<he;ue++)if(Re=this.__charBounds[Ue][ue],Fe=this.getValueOfPropertyAt(Ue,ue,S),Be=this.getValueOfPropertyAt(Ue,ue,"fill"),F=this.getHeightOfChar(Ue,ue),W=this.getValueOfPropertyAt(Ue,ue,"deltaY"),je&&Fe&&Be)o.save(),o.fillStyle=Ie,o.translate(Re.renderLeft,Re.renderTop),o.rotate(Re.angle),o.fillRect(-Re.kernedWidth/2,ze*F+W,Re.kernedWidth,this.fontSize/15),o.restore();else if((Fe!==Y||Be!==Ie||F!==p||W!==q)&&be>0){var ce=J+O+fe;this.direction==="rtl"&&(ce=this.width-ce-be),Y&&Ie&&(o.fillStyle=Ie,o.fillRect(ce,oe+ze*p+q,be,this.fontSize/15)),fe=Re.left,be=Re.width,Y=Fe,Ie=Be,p=F,q=W}else be+=Re.kernedWidth;var ce=J+O+fe;this.direction==="rtl"&&(ce=this.width-ce-be),o.fillStyle=Be,Fe&&Be&&o.fillRect(ce,oe+ze*p+q,be-Xe,this.fontSize/15),te+=l}this._removeShadow(o)}},_getFontDeclaration:function(o,S){var l=o||this,p=this.fontFamily,F=E.Text.genericFonts.indexOf(p.toLowerCase())>-1,O=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||F?l.fontFamily:'"'+l.fontFamily+'"';return[E.isLikelyNode?l.fontWeight:l.fontStyle,E.isLikelyNode?l.fontStyle:l.fontWeight,S?this.CACHE_FONT_SIZE+"px":l.fontSize+"px",O].join(" ")},render:function(o){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",o)))},_splitTextIntoLines:function(o){for(var S=o.split(this._reNewline),l=new Array(S.length),p=[`
`],F=[],O=0;O<S.length;O++)l[O]=E.util.string.graphemeSplit(S[O]),F=F.concat(l[O],p);return F.pop(),{_unwrappedLines:l,lines:S,graphemeText:F,graphemeLines:l}},toObject:function(o){var S=R.concat(o),l=this.callSuper("toObject",S);return l.styles=E.util.stylesToArray(this.styles,this.text),l.path&&(l.path=this.path.toObject()),l},set:function(o,S){this.callSuper("set",o,S);var l=!1,p=!1;if(typeof o=="object")for(var F in o)F==="path"&&this.setPathInfo(),l=l||this._dimensionAffectingProps.indexOf(F)!==-1,p=p||F==="path";else l=this._dimensionAffectingProps.indexOf(o)!==-1,p=o==="path";return p&&this.setPathInfo(),l&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),E.Text.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),E.Text.DEFAULT_SVG_FONT_SIZE=16,E.Text.fromElement=function(o,S,l){if(!o)return S(null);var p=E.parseAttributes(o,E.Text.ATTRIBUTE_NAMES),F=p.textAnchor||"left";if(l=E.util.object.extend(l?M(l):{},p),l.top=l.top||0,l.left=l.left||0,p.textDecoration){var O=p.textDecoration;O.indexOf("underline")!==-1&&(l.underline=!0),O.indexOf("overline")!==-1&&(l.overline=!0),O.indexOf("line-through")!==-1&&(l.linethrough=!0),delete l.textDecoration}"dx"in p&&(l.left+=p.dx),"dy"in p&&(l.top+=p.dy),"fontSize"in l||(l.fontSize=E.Text.DEFAULT_SVG_FONT_SIZE);var q="";"textContent"in o?q=o.textContent:"firstChild"in o&&o.firstChild!==null&&"data"in o.firstChild&&o.firstChild.data!==null&&(q=o.firstChild.data),q=q.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var W=l.strokeWidth;l.strokeWidth=0;var U=new E.Text(q,l),Y=U.getScaledHeight()/U.height,J=(U.height+U.strokeWidth)*U.lineHeight-U.height,te=J*Y,oe=U.getScaledHeight()+te,fe=0;F==="center"&&(fe=U.getScaledWidth()/2),F==="right"&&(fe=U.getScaledWidth()),U.set({left:U.left-fe,top:U.top-(oe-U.fontSize*(.07+U._fontSizeFraction))/U.lineHeight,strokeWidth:typeof W<"u"?W:1}),S(U)},E.Text.fromObject=function(o,S){var l=M(o),p=o.path;return delete l.path,E.Object._fromObject("Text",l,function(F){F.styles=E.util.stylesFromArray(o.styles,o.text),p?E.Object._fromObject("Path",p,function(O){F.set("path",O),S(F)},"path"):S(F)},"text")},E.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],E.util.createAccessors&&E.util.createAccessors(E.Text)}(X),function(){L.util.object.extend(L.Text.prototype,{isEmptyStyles:function(B){if(!this.styles||typeof B<"u"&&!this.styles[B])return!0;var E=typeof B>"u"?this.styles:{line:this.styles[B]};for(var M in E)for(var R in E[M])for(var o in E[M][R])return!1;return!0},styleHas:function(B,E){if(!this.styles||!B||B===""||typeof E<"u"&&!this.styles[E])return!1;var M=typeof E>"u"?this.styles:{0:this.styles[E]};for(var R in M)for(var o in M[R])if(typeof M[R][o][B]<"u")return!0;return!1},cleanStyle:function(B){if(!this.styles||!B||B==="")return!1;var E=this.styles,M=0,R,o,S=!0,l=0,p;for(var F in E){R=0;for(var O in E[F]){var p=E[F][O],q=p.hasOwnProperty(B);M++,q?(o?p[B]!==o&&(S=!1):o=p[B],p[B]===this[B]&&delete p[B]):S=!1,Object.keys(p).length!==0?R++:delete E[F][O]}R===0&&delete E[F]}for(var W=0;W<this._textLines.length;W++)l+=this._textLines[W].length;S&&M===l&&(this[B]=o,this.removeStyle(B))},removeStyle:function(B){if(!(!this.styles||!B||B==="")){var E=this.styles,M,R,o;for(R in E){M=E[R];for(o in M)delete M[o][B],Object.keys(M[o]).length===0&&delete M[o];Object.keys(M).length===0&&delete E[R]}}},_extendStyles:function(B,E){var M=this.get2DCursorLocation(B);this._getLineStyle(M.lineIndex)||this._setLineStyle(M.lineIndex),this._getStyleDeclaration(M.lineIndex,M.charIndex)||this._setStyleDeclaration(M.lineIndex,M.charIndex,{}),L.util.object.extend(this._getStyleDeclaration(M.lineIndex,M.charIndex),E)},get2DCursorLocation:function(B,E){typeof B>"u"&&(B=this.selectionStart);for(var M=E?this._unwrappedTextLines:this._textLines,R=M.length,o=0;o<R;o++){if(B<=M[o].length)return{lineIndex:o,charIndex:B};B-=M[o].length+this.missingNewlineOffset(o)}return{lineIndex:o-1,charIndex:M[o-1].length<B?M[o-1].length:B}},getSelectionStyles:function(B,E,M){typeof B>"u"&&(B=this.selectionStart||0),typeof E>"u"&&(E=this.selectionEnd||B);for(var R=[],o=B;o<E;o++)R.push(this.getStyleAtPosition(o,M));return R},getStyleAtPosition:function(B,E){var M=this.get2DCursorLocation(B),R=E?this.getCompleteStyleDeclaration(M.lineIndex,M.charIndex):this._getStyleDeclaration(M.lineIndex,M.charIndex);return R||{}},setSelectionStyles:function(B,E,M){typeof E>"u"&&(E=this.selectionStart||0),typeof M>"u"&&(M=this.selectionEnd||E);for(var R=E;R<M;R++)this._extendStyles(R,B);return this._forceClearCache=!0,this},_getStyleDeclaration:function(B,E){var M=this.styles&&this.styles[B];return M?M[E]:null},getCompleteStyleDeclaration:function(B,E){for(var M=this._getStyleDeclaration(B,E)||{},R={},o,S=0;S<this._styleProperties.length;S++)o=this._styleProperties[S],R[o]=typeof M[o]>"u"?this[o]:M[o];return R},_setStyleDeclaration:function(B,E,M){this.styles[B][E]=M},_deleteStyleDeclaration:function(B,E){delete this.styles[B][E]},_getLineStyle:function(B){return!!this.styles[B]},_setLineStyle:function(B){this.styles[B]={}},_deleteLineStyle:function(B){delete this.styles[B]}})}(),function(){function B(E){E.textDecoration&&(E.textDecoration.indexOf("underline")>-1&&(E.underline=!0),E.textDecoration.indexOf("line-through")>-1&&(E.linethrough=!0),E.textDecoration.indexOf("overline")>-1&&(E.overline=!0),delete E.textDecoration)}L.IText=L.util.createClass(L.Text,L.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(E,M){this.callSuper("initialize",E,M),this.initBehavior()},setSelectionStart:function(E){E=Math.max(E,0),this._updateAndFire("selectionStart",E)},setSelectionEnd:function(E){E=Math.min(E,this.text.length),this._updateAndFire("selectionEnd",E)},_updateAndFire:function(E,M){this[E]!==M&&(this._fireSelectionChanged(),this[E]=M),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(E){this.clearContextTop(),this.callSuper("render",E),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(E){this.callSuper("_render",E)},clearContextTop:function(E){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var M=this.canvas.contextTop,R=this.canvas.viewportTransform;M.save(),M.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this.transform(M),this._clearTextArea(M),E||M.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var E=this._getCursorBoundaries(),M=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(E,M):this.renderSelection(E,M),M.restore()}},_clearTextArea:function(E){var M=this.width+4,R=this.height+4;E.clearRect(-M/2,-R/2,M,R)},_getCursorBoundaries:function(E){typeof E>"u"&&(E=this.selectionStart);var M=this._getLeftOffset(),R=this._getTopOffset(),o=this._getCursorBoundariesOffsets(E);return{left:M,top:R,leftOffset:o.left,topOffset:o.top}},_getCursorBoundariesOffsets:function(E){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var M,R,o,S=0,l=0,p,F=this.get2DCursorLocation(E);o=F.charIndex,R=F.lineIndex;for(var O=0;O<R;O++)S+=this.getHeightOfLine(O);M=this._getLineLeftOffset(R);var q=this.__charBounds[R][o];return q&&(l=q.left),this.charSpacing!==0&&o===this._textLines[R].length&&(l-=this._getWidthOfCharSpacing()),p={top:S,left:M+(l>0?l:0)},this.direction==="rtl"&&(p.left*=-1),this.cursorOffsetCache=p,this.cursorOffsetCache},renderCursor:function(E,M){var R=this.get2DCursorLocation(),o=R.lineIndex,S=R.charIndex>0?R.charIndex-1:0,l=this.getValueOfPropertyAt(o,S,"fontSize"),p=this.scaleX*this.canvas.getZoom(),F=this.cursorWidth/p,O=E.topOffset,q=this.getValueOfPropertyAt(o,S,"deltaY");O+=(1-this._fontSizeFraction)*this.getHeightOfLine(o)/this.lineHeight-l*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(E,M),M.fillStyle=this.cursorColor||this.getValueOfPropertyAt(o,S,"fill"),M.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,M.fillRect(E.left+E.leftOffset-F/2,O+E.top+q,F,l)},renderSelection:function(E,M){for(var R=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,o=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,S=this.textAlign.indexOf("justify")!==-1,l=this.get2DCursorLocation(R),p=this.get2DCursorLocation(o),F=l.lineIndex,O=p.lineIndex,q=l.charIndex<0?0:l.charIndex,W=p.charIndex<0?0:p.charIndex,U=F;U<=O;U++){var Y=this._getLineLeftOffset(U)||0,J=this.getHeightOfLine(U),te=0,oe=0,fe=0;if(U===F&&(oe=this.__charBounds[F][q].left),U>=F&&U<O)fe=S&&!this.isEndOfWrapping(U)?this.width:this.getLineWidth(U)||5;else if(U===O)if(W===0)fe=this.__charBounds[O][W].left;else{var be=this._getWidthOfCharSpacing();fe=this.__charBounds[O][W-1].left+this.__charBounds[O][W-1].width-be}te=J,(this.lineHeight<1||U===O&&this.lineHeight>1)&&(J/=this.lineHeight);var Re=E.left+Y+oe,Fe=fe-oe,Me=J,Be=0;this.inCompositionMode?(M.fillStyle=this.compositionColor||"black",Me=1,Be=J):M.fillStyle=this.selectionColor,this.direction==="rtl"&&(Re=this.width-Re-Fe),M.fillRect(Re,E.top+E.topOffset+Be,Fe,Me),E.topOffset+=te}},getCurrentCharFontSize:function(){var E=this._getCurrentCharIndex();return this.getValueOfPropertyAt(E.l,E.c,"fontSize")},getCurrentCharColor:function(){var E=this._getCurrentCharIndex();return this.getValueOfPropertyAt(E.l,E.c,"fill")},_getCurrentCharIndex:function(){var E=this.get2DCursorLocation(this.selectionStart,!0),M=E.charIndex>0?E.charIndex-1:0;return{l:E.lineIndex,c:M}}}),L.IText.fromObject=function(E,M){var R=L.util.stylesFromArray(E.styles,E.text),o=Object.assign({},E,{styles:R});if(B(o),o.styles)for(var S in o.styles)for(var l in o.styles[S])B(o.styles[S][l]);L.Object._fromObject("IText",o,M,"text")}}(),function(){var B=L.util.object.clone;L.util.object.extend(L.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var E=this;this.on("added",function(){var M=E.canvas;M&&(M._hasITextHandlers||(M._hasITextHandlers=!0,E._initCanvasHandlers(M)),M._iTextInstances=M._iTextInstances||[],M._iTextInstances.push(E))})},initRemovedHandler:function(){var E=this;this.on("removed",function(){var M=E.canvas;M&&(M._iTextInstances=M._iTextInstances||[],L.util.removeFromArray(M._iTextInstances,E),M._iTextInstances.length===0&&(M._hasITextHandlers=!1,E._removeCanvasHandlers(M)))})},_initCanvasHandlers:function(E){E._mouseUpITextHandler=function(){E._iTextInstances&&E._iTextInstances.forEach(function(M){M.__isMousedown=!1})},E.on("mouse:up",E._mouseUpITextHandler)},_removeCanvasHandlers:function(E){E.off("mouse:up",E._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(E,M,R,o){var S;return S={isAborted:!1,abort:function(){this.isAborted=!0}},E.animate("_currentCursorOpacity",M,{duration:R,onComplete:function(){S.isAborted||E[o]()},onChange:function(){E.canvas&&E.selectionStart===E.selectionEnd&&E.renderCursorOrSelection()},abort:function(){return S.isAborted}}),S},_onTickComplete:function(){var E=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){E._currentTickCompleteState=E._animateCursor(E,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(E){var M=this,R=E?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){M._tick()},R)},abortCursorAnimation:function(){var E=this._currentTickState||this._currentTickCompleteState,M=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,E&&M&&M.clearContext(M.contextTop||M.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(E){var M=0,R=E-1;if(this._reSpace.test(this._text[R]))for(;this._reSpace.test(this._text[R]);)M++,R--;for(;/\S/.test(this._text[R])&&R>-1;)M++,R--;return E-M},findWordBoundaryRight:function(E){var M=0,R=E;if(this._reSpace.test(this._text[R]))for(;this._reSpace.test(this._text[R]);)M++,R++;for(;/\S/.test(this._text[R])&&R<this._text.length;)M++,R++;return E+M},findLineBoundaryLeft:function(E){for(var M=0,R=E-1;!/\n/.test(this._text[R])&&R>-1;)M++,R--;return E-M},findLineBoundaryRight:function(E){for(var M=0,R=E;!/\n/.test(this._text[R])&&R<this._text.length;)M++,R++;return E+M},searchWordBoundary:function(E,M){for(var R=this._text,o=this._reSpace.test(R[E])?E-1:E,S=R[o],l=L.reNonWord;!l.test(S)&&o>0&&o<R.length;)o+=M,S=R[o];return l.test(S)&&(o+=M===1?0:1),o},selectWord:function(E){E=E||this.selectionStart;var M=this.searchWordBoundary(E,-1),R=this.searchWordBoundary(E,1);this.selectionStart=M,this.selectionEnd=R,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(E){E=E||this.selectionStart;var M=this.findLineBoundaryLeft(E),R=this.findLineBoundaryRight(E);return this.selectionStart=M,this.selectionEnd=R,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(E){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(E),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(E){E._iTextInstances&&E._iTextInstances.forEach(function(M){M.selected=!1,M.isEditing&&M.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(E){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var M=this.getSelectionStartFromPointer(E.e),R=this.selectionStart,o=this.selectionEnd;(M!==this.__selectionStartOnMouseDown||R===o)&&(R===M||o===M)||(M>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=M):(this.selectionStart=M,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==R||this.selectionEnd!==o)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(E,M,R){var o=R.slice(0,E),S=L.util.string.graphemeSplit(o).length;if(E===M)return{selectionStart:S,selectionEnd:S};var l=R.slice(E,M),p=L.util.string.graphemeSplit(l).length;return{selectionStart:S,selectionEnd:S+p}},fromGraphemeToStringSelection:function(E,M,R){var o=R.slice(0,E),S=o.join("").length;if(E===M)return{selectionStart:S,selectionEnd:S};var l=R.slice(E,M),p=l.join("").length;return{selectionStart:S,selectionEnd:S+p}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var E=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=E.selectionStart,this.hiddenTextarea.selectionEnd=E.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var E=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=E.selectionEnd,this.inCompositionMode||(this.selectionStart=E.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var E=this._calcTextareaPosition();this.hiddenTextarea.style.left=E.left,this.hiddenTextarea.style.top=E.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var E=this.inCompositionMode?this.compositionStart:this.selectionStart,M=this._getCursorBoundaries(E),R=this.get2DCursorLocation(E),o=R.lineIndex,S=R.charIndex,l=this.getValueOfPropertyAt(o,S,"fontSize")*this.lineHeight,p=M.leftOffset,F=this.calcTransformMatrix(),O={x:M.left+p,y:M.top+M.topOffset+l},q=this.canvas.getRetinaScaling(),W=this.canvas.upperCanvasEl,U=W.width/q,Y=W.height/q,J=U-l,te=Y-l,oe=W.clientWidth/U,fe=W.clientHeight/Y;return O=L.util.transformPoint(O,F),O=L.util.transformPoint(O,this.canvas.viewportTransform),O.x*=oe,O.y*=fe,O.x<0&&(O.x=0),O.x>J&&(O.x=J),O.y<0&&(O.y=0),O.y>te&&(O.y=te),O.x+=this.canvas._offset.left,O.y+=this.canvas._offset.top,{left:O.x+"px",top:O.y+"px",fontSize:l+"px",charHeight:l}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var E=this._textBeforeEdit!==this.text,M=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,M&&(M.blur&&M.blur(),M.parentNode&&M.parentNode.removeChild(M)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),E&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),E&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var E in this.styles)this._textLines[E]||delete this.styles[E]},removeStyleFromTo:function(E,M){var R=this.get2DCursorLocation(E,!0),o=this.get2DCursorLocation(M,!0),S=R.lineIndex,l=R.charIndex,p=o.lineIndex,F=o.charIndex,O,q;if(S!==p){if(this.styles[S])for(O=l;O<this._unwrappedTextLines[S].length;O++)delete this.styles[S][O];if(this.styles[p])for(O=F;O<this._unwrappedTextLines[p].length;O++)q=this.styles[p][O],q&&(this.styles[S]||(this.styles[S]={}),this.styles[S][l+O-F]=q);for(O=S+1;O<=p;O++)delete this.styles[O];this.shiftLineStyles(p,S-p)}else if(this.styles[S]){q=this.styles[S];var W=F-l,U,Y;for(O=l;O<F;O++)delete q[O];for(Y in this.styles[S])U=parseInt(Y,10),U>=F&&(q[U-W]=q[Y],delete q[Y])}},shiftLineStyles:function(E,M){var R=B(this.styles);for(var o in this.styles){var S=parseInt(o,10);S>E&&(this.styles[S+M]=R[S],R[S-M]||delete this.styles[S])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(E,M,R,o){var S,l={},p=!1,F=this._unwrappedTextLines[E].length===M;R||(R=1),this.shiftLineStyles(E,R),this.styles[E]&&(S=this.styles[E][M===0?M:M-1]);for(var O in this.styles[E]){var q=parseInt(O,10);q>=M&&(p=!0,l[q-M]=this.styles[E][O],F&&M===0||delete this.styles[E][O])}var W=!1;for(p&&!F&&(this.styles[E+R]=l,W=!0),W&&R--;R>0;)o&&o[R-1]?this.styles[E+R]={0:B(o[R-1])}:S?this.styles[E+R]={0:B(S)}:delete this.styles[E+R],R--;this._forceClearCache=!0},insertCharStyleObject:function(E,M,R,o){this.styles||(this.styles={});var S=this.styles[E],l=S?B(S):{};R||(R=1);for(var p in l){var F=parseInt(p,10);F>=M&&(S[F+R]=l[F],l[F-R]||delete S[F])}if(this._forceClearCache=!0,o){for(;R--;)Object.keys(o[R]).length&&(this.styles[E]||(this.styles[E]={}),this.styles[E][M+R]=B(o[R]));return}if(S)for(var O=S[M?M-1:1];O&&R--;)this.styles[E][M+R]=B(O)},insertNewStyleBlock:function(E,M,R){for(var o=this.get2DCursorLocation(M,!0),S=[0],l=0,p=0;p<E.length;p++)E[p]===`
`?(l++,S[l]=0):S[l]++;S[0]>0&&(this.insertCharStyleObject(o.lineIndex,o.charIndex,S[0],R),R=R&&R.slice(S[0]+1)),l&&this.insertNewlineStyleObject(o.lineIndex,o.charIndex+S[0],l);for(var p=1;p<l;p++)S[p]>0?this.insertCharStyleObject(o.lineIndex+p,0,S[p],R):R&&this.styles[o.lineIndex+p]&&R[0]&&(this.styles[o.lineIndex+p][0]=R[0]),R=R&&R.slice(S[p]+1);S[p]>0&&this.insertCharStyleObject(o.lineIndex+p,0,S[p],R)},setSelectionStartEndWithShift:function(E,M,R){R<=E?(M===E?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=E),this.selectionStart=R):R>E&&R<M?this._selectionDirection==="right"?this.selectionEnd=R:this.selectionStart=R:(M===E?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=M),this.selectionEnd=R)},setSelectionInBoundaries:function(){var E=this.text.length;this.selectionStart>E?this.selectionStart=E:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>E?this.selectionEnd=E:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),L.util.object.extend(L.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(B){if(this.canvas){this.__newClickTime=+new Date;var E=B.pointer;this.isTripleClick(E)&&(this.fire("tripleclick",B),this._stopEvent(B.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=E,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(B){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===B.x&&this.__lastPointer.y===B.y},_stopEvent:function(B){B.preventDefault&&B.preventDefault(),B.stopPropagation&&B.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(B){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(B.e))},tripleClickHandler:function(B){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(B.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(B){!this.canvas||!this.editable||B.e.button&&B.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(B.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(B){!this.canvas||!this.editable||B.e.button&&B.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(B){if(this.__isMousedown=!1,!(!this.editable||this.group||B.transform&&B.transform.actionPerformed||B.e.button&&B.e.button!==1)){if(this.canvas){var E=this.canvas._activeObject;if(E&&E!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(B.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(B){var E=this.getSelectionStartFromPointer(B),M=this.selectionStart,R=this.selectionEnd;B.shiftKey?this.setSelectionStartEndWithShift(M,R,E):(this.selectionStart=E,this.selectionEnd=E),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(B){for(var E=this.getLocalPointer(B),M=0,R=0,o=0,S=0,l=0,p,F,O=0,q=this._textLines.length;O<q&&o<=E.y;O++)o+=this.getHeightOfLine(O)*this.scaleY,l=O,O>0&&(S+=this._textLines[O-1].length+this.missingNewlineOffset(O-1));p=this._getLineLeftOffset(l),R=p*this.scaleX,F=this._textLines[l],this.direction==="rtl"&&(E.x=this.width*this.scaleX-E.x+R);for(var W=0,U=F.length;W<U&&(M=R,R+=this.__charBounds[l][W].kernedWidth*this.scaleX,R<=E.x);W++)S++;return this._getNewSelectionStartFromOffset(E,M,R,S,U)},_getNewSelectionStartFromOffset:function(B,E,M,R,o){var S=B.x-E,l=M-B.x,p=l>S||l<0?0:1,F=R+p;return this.flipX&&(F=o-F),F>this._text.length&&(F=this._text.length),F}}),L.util.object.extend(L.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=L.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var B=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+B.top+"; left: "+B.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+B.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):L.document.body.appendChild(this.hiddenTextarea),L.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),L.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),L.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),L.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),L.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),L.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),L.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),L.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),L.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(L.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(B){if(this.isEditing){var E=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(B.keyCode in E)this[E[B.keyCode]](B);else if(B.keyCode in this.ctrlKeysMapDown&&(B.ctrlKey||B.metaKey))this[this.ctrlKeysMapDown[B.keyCode]](B);else return;B.stopImmediatePropagation(),B.preventDefault(),B.keyCode>=33&&B.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(B){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(B.keyCode in this.ctrlKeysMapUp&&(B.ctrlKey||B.metaKey))this[this.ctrlKeysMapUp[B.keyCode]](B);else return;B.stopImmediatePropagation(),B.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(B){var E=this.fromPaste;if(this.fromPaste=!1,B&&B.stopPropagation(),!!this.isEditing){var M=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,R=this._text.length,o=M.length,S,l,p=o-R,F=this.selectionStart,O=this.selectionEnd,q=F!==O,W,U,Y;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var J=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),te=F>J.selectionStart;q?(S=this._text.slice(F,O),p+=O-F):o<R&&(te?S=this._text.slice(O+p,O):S=this._text.slice(F,F-p)),l=M.slice(J.selectionEnd-p,J.selectionEnd),S&&S.length&&(l.length&&(W=this.getSelectionStyles(F,F+1,!1),W=l.map(function(){return W[0]})),q?(U=F,Y=O):te?(U=O-S.length,Y=O):(U=O,Y=O+S.length),this.removeStyleFromTo(U,Y)),l.length&&(E&&l.join("")===L.copiedText&&!L.disableStyleCopyPaste&&(W=L.copiedTextStyle),this.insertNewStyleBlock(l,F,W)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(B){this.compositionStart=B.target.selectionStart,this.compositionEnd=B.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(L.copiedText=this.getSelectedText(),L.disableStyleCopyPaste?L.copiedTextStyle=null:L.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(B){return B&&B.clipboardData||L.window.clipboardData},_getWidthBeforeCursor:function(B,E){var M=this._getLineLeftOffset(B),R;return E>0&&(R=this.__charBounds[B][E-1],M+=R.left+R.width),M},getDownCursorOffset:function(B,E){var M=this._getSelectionForOffset(B,E),R=this.get2DCursorLocation(M),o=R.lineIndex;if(o===this._textLines.length-1||B.metaKey||B.keyCode===34)return this._text.length-M;var S=R.charIndex,l=this._getWidthBeforeCursor(o,S),p=this._getIndexOnLine(o+1,l),F=this._textLines[o].slice(S);return F.length+p+1+this.missingNewlineOffset(o)},_getSelectionForOffset:function(B,E){return B.shiftKey&&this.selectionStart!==this.selectionEnd&&E?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(B,E){var M=this._getSelectionForOffset(B,E),R=this.get2DCursorLocation(M),o=R.lineIndex;if(o===0||B.metaKey||B.keyCode===33)return-M;var S=R.charIndex,l=this._getWidthBeforeCursor(o,S),p=this._getIndexOnLine(o-1,l),F=this._textLines[o].slice(0,S),O=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+p-F.length+(1-O)},_getIndexOnLine:function(B,E){for(var M=this._textLines[B],R=this._getLineLeftOffset(B),o=R,S=0,l,p,F=0,O=M.length;F<O;F++)if(l=this.__charBounds[B][F].width,o+=l,o>E){p=!0;var q=o-l,W=o,U=Math.abs(q-E),Y=Math.abs(W-E);S=Y<U?F:F-1;break}return p||(S=M.length-1),S},moveCursorDown:function(B){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",B)},moveCursorUp:function(B){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",B)},_moveCursorUpOrDown:function(B,E){var M="get"+B+"CursorOffset",R=this[M](E,this._selectionDirection==="right");E.shiftKey?this.moveCursorWithShift(R):this.moveCursorWithoutShift(R),R!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(B){var E=this._selectionDirection==="left"?this.selectionStart+B:this.selectionEnd+B;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,E),B!==0},moveCursorWithoutShift:function(B){return B<0?(this.selectionStart+=B,this.selectionEnd=this.selectionStart):(this.selectionEnd+=B,this.selectionStart=this.selectionEnd),B!==0},moveCursorLeft:function(B){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",B)},_move:function(B,E,M){var R;if(B.altKey)R=this["findWordBoundary"+M](this[E]);else if(B.metaKey||B.keyCode===35||B.keyCode===36)R=this["findLineBoundary"+M](this[E]);else return this[E]+=M==="Left"?-1:1,!0;if(typeof R<"u"&&this[E]!==R)return this[E]=R,!0},_moveLeft:function(B,E){return this._move(B,E,"Left")},_moveRight:function(B,E){return this._move(B,E,"Right")},moveCursorLeftWithoutShift:function(B){var E=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(E=this._moveLeft(B,"selectionStart")),this.selectionEnd=this.selectionStart,E},moveCursorLeftWithShift:function(B){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(B,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(B,"selectionStart")},moveCursorRight:function(B){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",B)},_moveCursorLeftOrRight:function(B,E){var M="moveCursor"+B+"With";this._currentCursorOpacity=1,E.shiftKey?M+="Shift":M+="outShift",this[M](E)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(B){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(B,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(B,"selectionEnd")},moveCursorRightWithoutShift:function(B){var E=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(E=this._moveRight(B,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,E},removeChars:function(B,E){typeof E>"u"&&(E=B+1),this.removeStyleFromTo(B,E),this._text.splice(B,E-B),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(B,E,M,R){typeof R>"u"&&(R=M),R>M&&this.removeStyleFromTo(M,R);var o=L.util.string.graphemeSplit(B);this.insertNewStyleBlock(o,M,E),this._text=[].concat(this._text.slice(0,M),o,this._text.slice(R)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var B=L.util.toFixed,E=/  +/g;L.util.object.extend(L.Text.prototype,{_toSVG:function(){var M=this._getSVGLeftTopOffsets(),R=this._getSVGTextAndBg(M.textTop,M.textLeft);return this._wrapSVGTextAndBg(R)},toSVG:function(M){return this._createBaseSVGMarkup(this._toSVG(),{reviver:M,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(M){var R=!0,o=this.getSvgTextDecoration(this);return[M.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",o?'text-decoration="'+o+'" ':"",'style="',this.getSvgStyles(R),'"',this.addPaintOrder()," >",M.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(M,R){var o=[],S=[],l=M,p;this._setSVGBg(S);for(var F=0,O=this._textLines.length;F<O;F++)p=this._getLineLeftOffset(F),(this.textBackgroundColor||this.styleHas("textBackgroundColor",F))&&this._setSVGTextLineBg(S,F,R+p,l),this._setSVGTextLineText(o,F,R+p,l),l+=this.getHeightOfLine(F);return{textSpans:o,textBgRects:S}},_createTextCharSpan:function(M,R,o,S){var l=M!==M.trim()||M.match(E),p=this.getSvgSpanStyles(R,l),F=p?'style="'+p+'"':"",O=R.deltaY,q="",W=L.Object.NUM_FRACTION_DIGITS;return O&&(q=' dy="'+B(O,W)+'" '),['<tspan x="',B(o,W),'" y="',B(S,W),'" ',q,F,">",L.util.string.escapeXml(M),"</tspan>"].join("")},_setSVGTextLineText:function(M,R,o,S){var l=this.getHeightOfLine(R),p=this.textAlign.indexOf("justify")!==-1,F,O,q="",W,U,Y=0,J=this._textLines[R],te;S+=l*(1-this._fontSizeFraction)/this.lineHeight;for(var oe=0,fe=J.length-1;oe<=fe;oe++)te=oe===fe||this.charSpacing,q+=J[oe],W=this.__charBounds[R][oe],Y===0?(o+=W.kernedWidth-W.width,Y+=W.width):Y+=W.kernedWidth,p&&!te&&this._reSpaceAndTab.test(J[oe])&&(te=!0),te||(F=F||this.getCompleteStyleDeclaration(R,oe),O=this.getCompleteStyleDeclaration(R,oe+1),te=L.util.hasStyleChanged(F,O,!0)),te&&(U=this._getStyleDeclaration(R,oe)||{},M.push(this._createTextCharSpan(q,U,o,S)),q="",F=O,o+=Y,Y=0)},_pushTextBgRect:function(M,R,o,S,l,p){var F=L.Object.NUM_FRACTION_DIGITS;M.push("		<rect ",this._getFillAttributes(R),' x="',B(o,F),'" y="',B(S,F),'" width="',B(l,F),'" height="',B(p,F),`"></rect>
`)},_setSVGTextLineBg:function(M,R,o,S){for(var l=this._textLines[R],p=this.getHeightOfLine(R)/this.lineHeight,F=0,O=0,q,W,U=this.getValueOfPropertyAt(R,0,"textBackgroundColor"),Y=0,J=l.length;Y<J;Y++)q=this.__charBounds[R][Y],W=this.getValueOfPropertyAt(R,Y,"textBackgroundColor"),W!==U?(U&&this._pushTextBgRect(M,U,o+O,S,F,p),O=q.left,F=q.width,U=W):F+=q.kernedWidth;W&&this._pushTextBgRect(M,W,o+O,S,F,p)},_getFillAttributes:function(M){var R=M&&typeof M=="string"?new L.Color(M):"";return!R||!R.getSource()||R.getAlpha()===1?'fill="'+M+'"':'opacity="'+R.getAlpha()+'" fill="'+R.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(M){for(var R=0,o=0,S=0;S<M;S++)R+=this.getHeightOfLine(S);return o=this.getHeightOfLine(S),{lineTop:R,offset:(this._fontSizeMult-this._fontSizeFraction)*o/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(M){var R=L.Object.prototype.getSvgStyles.call(this,M);return R+" white-space: pre;"}})}(),function(B){var E=B.fabric||(B.fabric={});E.Textbox=E.util.createClass(E.IText,E.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:E.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(M){for(var R=0,o=0,S=0,l={},p=0;p<M.graphemeLines.length;p++)M.graphemeText[S]===`
`&&p>0?(o=0,S++,R++):!this.splitByGrapheme&&this._reSpaceAndTab.test(M.graphemeText[S])&&p>0&&(o++,S++),l[p]={line:R,offset:o},S+=M.graphemeLines[p].length,o+=M.graphemeLines[p].length;return l},styleHas:function(M,R){if(this._styleMap&&!this.isWrapping){var o=this._styleMap[R];o&&(R=o.line)}return E.Text.prototype.styleHas.call(this,M,R)},isEmptyStyles:function(M){if(!this.styles)return!0;var R=0,o=M+1,S,l,p=!1,F=this._styleMap[M],O=this._styleMap[M+1];F&&(M=F.line,R=F.offset),O&&(o=O.line,p=o===M,S=O.offset),l=typeof M>"u"?this.styles:{line:this.styles[M]};for(var q in l)for(var W in l[q])if(W>=R&&(!p||W<S))for(var U in l[q][W])return!1;return!0},_getStyleDeclaration:function(M,R){if(this._styleMap&&!this.isWrapping){var o=this._styleMap[M];if(!o)return null;M=o.line,R=o.offset+R}return this.callSuper("_getStyleDeclaration",M,R)},_setStyleDeclaration:function(M,R,o){var S=this._styleMap[M];M=S.line,R=S.offset+R,this.styles[M][R]=o},_deleteStyleDeclaration:function(M,R){var o=this._styleMap[M];M=o.line,R=o.offset+R,delete this.styles[M][R]},_getLineStyle:function(M){var R=this._styleMap[M];return!!this.styles[R.line]},_setLineStyle:function(M){var R=this._styleMap[M];this.styles[R.line]={}},_wrapText:function(M,R){var o=[],S;for(this.isWrapping=!0,S=0;S<M.length;S++)o=o.concat(this._wrapLine(M[S],S,R));return this.isWrapping=!1,o},_measureWord:function(M,R,o){var S=0,l,p=!0;o=o||0;for(var F=0,O=M.length;F<O;F++){var q=this._getGraphemeBox(M[F],R,F+o,l,p);S+=q.kernedWidth,l=M[F]}return S},_wrapLine:function(M,R,o,Re){var l=0,p=this.splitByGrapheme,F=[],O=[],q=p?E.util.string.graphemeSplit(M):M.split(this._wordJoiners),W="",U=0,Y=p?"":" ",J=0,te=0,oe=0,fe=!0,be=this._getWidthOfCharSpacing(),Re=Re||0;q.length===0&&q.push([]),o-=Re;for(var Fe=0;Fe<q.length;Fe++)W=p?q[Fe]:E.util.string.graphemeSplit(q[Fe]),J=this._measureWord(W,R,U),U+=W.length,l+=te+J-be,l>o&&!fe?(F.push(O),O=[],l=J,fe=!0):l+=be,!fe&&!p&&O.push(Y),O=O.concat(W),te=p?0:this._measureWord([Y],R,U),U++,fe=!1,J>oe&&(oe=J);return Fe&&F.push(O),oe+Re>this.dynamicMinWidth&&(this.dynamicMinWidth=oe-be+Re),F},isEndOfWrapping:function(M){return!this._styleMap[M+1]||this._styleMap[M+1].line!==this._styleMap[M].line},missingNewlineOffset:function(M){return this.splitByGrapheme?this.isEndOfWrapping(M)?1:0:1},_splitTextIntoLines:function(M){for(var R=E.Text.prototype._splitTextIntoLines.call(this,M),o=this._wrapText(R.lines,this.width),S=new Array(o.length),l=0;l<o.length;l++)S[l]=o[l].join("");return R.lines=S,R.graphemeLines=o,R},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var M={};for(var R in this._styleMap)this._textLines[R]&&(M[this._styleMap[R].line]=1);for(var R in this.styles)M[R]||delete this.styles[R]},toObject:function(M){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(M))}}),E.Textbox.fromObject=function(M,R){var o=E.util.stylesFromArray(M.styles,M.text),S=Object.assign({},M,{styles:o});return E.Object._fromObject("Textbox",S,R,"text")}}(X),function(){var B=L.controlsUtils,E=B.scaleSkewCursorStyleHandler,M=B.scaleCursorStyleHandler,R=B.scalingEqually,o=B.scalingYOrSkewingX,S=B.scalingXOrSkewingY,l=B.scaleOrSkewActionName,p=L.Object.prototype.controls;if(p.ml=new L.Control({x:-.5,y:0,cursorStyleHandler:E,actionHandler:S,getActionName:l}),p.mr=new L.Control({x:.5,y:0,cursorStyleHandler:E,actionHandler:S,getActionName:l}),p.mb=new L.Control({x:0,y:.5,cursorStyleHandler:E,actionHandler:o,getActionName:l}),p.mt=new L.Control({x:0,y:-.5,cursorStyleHandler:E,actionHandler:o,getActionName:l}),p.tl=new L.Control({x:-.5,y:-.5,cursorStyleHandler:M,actionHandler:R}),p.tr=new L.Control({x:.5,y:-.5,cursorStyleHandler:M,actionHandler:R}),p.bl=new L.Control({x:-.5,y:.5,cursorStyleHandler:M,actionHandler:R}),p.br=new L.Control({x:.5,y:.5,cursorStyleHandler:M,actionHandler:R}),p.mtr=new L.Control({x:0,y:-.5,actionHandler:B.rotationWithSnapping,cursorStyleHandler:B.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),L.Textbox){var F=L.Textbox.prototype.controls={};F.mtr=p.mtr,F.tr=p.tr,F.br=p.br,F.tl=p.tl,F.bl=p.bl,F.mt=p.mt,F.mb=p.mb,F.mr=new L.Control({x:.5,y:0,actionHandler:B.changeWidth,cursorStyleHandler:E,actionName:"resizing"}),F.ml=new L.Control({x:-.5,y:0,actionHandler:B.changeWidth,cursorStyleHandler:E,actionName:"resizing"})}}()})(fabric$1);class CreateLayerSection{constructor(L){this.layers=L}create(L,G){if(L.text)return;const V=document.createElement("img");V.className="layer-img",V.src=L.toDataURL();const K=document.createElement("span");K.className="layer-span",K.textContent=`Layer ${G+1}`;const Z=document.createElement("div");Z.setAttribute("tabindex","0"),Z.className="layer-container",Z.setAttribute("data_layer",G),Z.append(V,K),this.layers.append(Z)}}class DeleteLayer{constructor(L,G,V,K){this.event=L,this.canvas=G,this.layers=V,this.activeLayerIndex=K}deleteLayer(){var G,V,K;const L=this.canvas.getActiveObject();this.event.key==="Delete"&&(this.layers.children.length===1?(this.layers.removeChild(this.layers.firstChild),this.canvas.clear()):((V=(G=this.layers)==null?void 0:G.children[this.activeLayerIndex])==null||V.remove(),(K=this.canvas)==null||K.remove(L),this.activeLayerIndex===this.layers.children.length-1?this.activeLayerIndex=0:document.querySelectorAll(".layer-container").forEach(Z=>{const Q=parseInt(Z.getAttribute("data_layer"));Q>this.activeLayerIndex&&Z.setAttribute("data_layer",Q-1)}),this.canvas.setActiveObject(this.canvas.item(this.activeLayerIndex)),this.canvas.requestRenderAll()))}}const alwan_min="";/*!
 * iro.js v5.5.2
 * 2016-2021 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */var n,u,t,i,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function s(X,L){for(var G in L)X[G]=L[G];return X}function a(X){var L=X.parentNode;L&&L.removeChild(X)}function h(X,L,G){var V,K,Z,Q,B=arguments;if(L=s({},L),arguments.length>3)for(G=[G],V=3;V<arguments.length;V++)G.push(B[V]);if(G!=null&&(L.children=G),X!=null&&X.defaultProps!=null)for(K in X.defaultProps)L[K]===void 0&&(L[K]=X.defaultProps[K]);return Q=L.key,(Z=L.ref)!=null&&delete L.ref,Q!=null&&delete L.key,v(X,L,Q,Z)}function v(X,L,G,V){var K={type:X,props:L,key:G,ref:V,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return n.vnode&&n.vnode(K),K}function d(X){return X.children}function y(X){if(X==null||typeof X=="boolean")return null;if(typeof X=="string"||typeof X=="number")return v(null,X,null,null);if(X.__e!=null||X.__c!=null){var L=v(X.type,X.props,X.key,null);return L.__e=X.__e,L}return X}function m(X,L){this.props=X,this.context=L}function w(X,L){if(L==null)return X.__p?w(X.__p,X.__p.__k.indexOf(X)+1):null;for(var G;L<X.__k.length;L++)if((G=X.__k[L])!=null&&G.__e!=null)return G.__e;return typeof X.type=="function"?w(X):null}function g(X){var L,G;if((X=X.__p)!=null&&X.__c!=null){for(X.__e=X.__c.base=null,L=0;L<X.__k.length;L++)if((G=X.__k[L])!=null&&G.__e!=null){X.__e=X.__c.base=G.__e;break}return g(X)}}function k(X){(!X.__d&&(X.__d=!0)&&u.push(X)===1||i!==n.debounceRendering)&&(i=n.debounceRendering,(n.debounceRendering||t)(_))}function _(){var X,L,G,V,K,Z,Q,B;for(u.sort(function(E,M){return M.__v.__b-E.__v.__b});X=u.pop();)X.__d&&(G=void 0,V=void 0,Z=(K=(L=X).__v).__e,Q=L.__P,B=L.u,L.u=!1,Q&&(G=[],V=$(Q,K,s({},K),L.__n,Q.ownerSVGElement!==void 0,null,G,B,Z??w(K)),j(G,K),V!=Z&&g(K)))}function b(X,L,G,V,K,Z,Q,B,E){var M,R,o,S,l,p,F,O=G&&G.__k||e,q=O.length;if(B==f&&(B=Z!=null?Z[0]:q?w(G,0):null),M=0,L.__k=x(L.__k,function(W){if(W!=null){if(W.__p=L,W.__b=L.__b+1,(o=O[M])===null||o&&W.key==o.key&&W.type===o.type)O[M]=void 0;else for(R=0;R<q;R++){if((o=O[R])&&W.key==o.key&&W.type===o.type){O[R]=void 0;break}o=null}if(S=$(X,W,o=o||f,V,K,Z,Q,null,B,E),(R=W.ref)&&o.ref!=R&&(F||(F=[])).push(R,W.__c||S,W),S!=null){if(p==null&&(p=S),W.l!=null)S=W.l,W.l=null;else if(Z==o||S!=B||S.parentNode==null){e:if(B==null||B.parentNode!==X)X.appendChild(S);else{for(l=B,R=0;(l=l.nextSibling)&&R<q;R+=2)if(l==S)break e;X.insertBefore(S,B)}L.type=="option"&&(X.value="")}B=S.nextSibling,typeof L.type=="function"&&(L.l=S)}}return M++,W}),L.__e=p,Z!=null&&typeof L.type!="function")for(M=Z.length;M--;)Z[M]!=null&&a(Z[M]);for(M=q;M--;)O[M]!=null&&D(O[M],O[M]);if(F)for(M=0;M<F.length;M++)A(F[M],F[++M],F[++M])}function x(X,L,G){if(G==null&&(G=[]),X==null||typeof X=="boolean")L&&G.push(L(null));else if(Array.isArray(X))for(var V=0;V<X.length;V++)x(X[V],L,G);else G.push(L?L(y(X)):X);return G}function C(X,L,G,V,K){var Z;for(Z in G)Z in L||N(X,Z,null,G[Z],V);for(Z in L)K&&typeof L[Z]!="function"||Z==="value"||Z==="checked"||G[Z]===L[Z]||N(X,Z,L[Z],G[Z],V)}function P(X,L,G){L[0]==="-"?X.setProperty(L,G):X[L]=typeof G=="number"&&c.test(L)===!1?G+"px":G??""}function N(X,L,G,V,K){var Z,Q,B,E,M;if(!((L=K?L==="className"?"class":L:L==="class"?"className":L)==="key"||L==="children"))if(L==="style")if(Z=X.style,typeof G=="string")Z.cssText=G;else{if(typeof V=="string"&&(Z.cssText="",V=null),V)for(Q in V)G&&Q in G||P(Z,Q,"");if(G)for(B in G)V&&G[B]===V[B]||P(Z,B,G[B])}else L[0]==="o"&&L[1]==="n"?(E=L!==(L=L.replace(/Capture$/,"")),M=L.toLowerCase(),L=(M in X?M:L).slice(2),G?(V||X.addEventListener(L,T,E),(X.t||(X.t={}))[L]=G):X.removeEventListener(L,T,E)):L!=="list"&&L!=="tagName"&&L!=="form"&&!K&&L in X?X[L]=G??"":typeof G!="function"&&L!=="dangerouslySetInnerHTML"&&(L!==(L=L.replace(/^xlink:?/,""))?G==null||G===!1?X.removeAttributeNS("http://www.w3.org/1999/xlink",L.toLowerCase()):X.setAttributeNS("http://www.w3.org/1999/xlink",L.toLowerCase(),G):G==null||G===!1?X.removeAttribute(L):X.setAttribute(L,G))}function T(X){return this.t[X.type](n.event?n.event(X):X)}function $(X,L,G,V,K,Z,Q,B,E,M){var R,o,S,l,p,F,O,q,W,U,Y=L.type;if(L.constructor!==void 0)return null;(R=n.__b)&&R(L);try{e:if(typeof Y=="function"){if(q=L.props,W=(R=Y.contextType)&&V[R.__c],U=R?W?W.props.value:R.__p:V,G.__c?O=(o=L.__c=G.__c).__p=o.__E:("prototype"in Y&&Y.prototype.render?L.__c=o=new Y(q,U):(L.__c=o=new m(q,U),o.constructor=Y,o.render=H),W&&W.sub(o),o.props=q,o.state||(o.state={}),o.context=U,o.__n=V,S=o.__d=!0,o.__h=[]),o.__s==null&&(o.__s=o.state),Y.getDerivedStateFromProps!=null&&s(o.__s==o.state?o.__s=s({},o.__s):o.__s,Y.getDerivedStateFromProps(q,o.__s)),S)Y.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),o.componentDidMount!=null&&Q.push(o);else{if(Y.getDerivedStateFromProps==null&&B==null&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(q,U),!B&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(q,o.__s,U)===!1){for(o.props=q,o.state=o.__s,o.__d=!1,o.__v=L,L.__e=E!=null?E!==G.__e?E:G.__e:null,L.__k=G.__k,R=0;R<L.__k.length;R++)L.__k[R]&&(L.__k[R].__p=L);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(q,o.__s,U)}for(l=o.props,p=o.state,o.context=U,o.props=q,o.state=o.__s,(R=n.__r)&&R(L),o.__d=!1,o.__v=L,o.__P=X,R=o.render(o.props,o.state,o.context),L.__k=x(R!=null&&R.type==d&&R.key==null?R.props.children:R),o.getChildContext!=null&&(V=s(s({},V),o.getChildContext())),S||o.getSnapshotBeforeUpdate==null||(F=o.getSnapshotBeforeUpdate(l,p)),b(X,L,G,V,K,Z,Q,E,M),o.base=L.__e;R=o.__h.pop();)o.__s&&(o.state=o.__s),R.call(o);S||l==null||o.componentDidUpdate==null||o.componentDidUpdate(l,p,F),O&&(o.__E=o.__p=null)}else L.__e=z(G.__e,L,G,V,K,Z,Q,M);(R=n.diffed)&&R(L)}catch(J){n.__e(J,L,G)}return L.__e}function j(X,L){for(var G;G=X.pop();)try{G.componentDidMount()}catch(V){n.__e(V,G.__v)}n.__c&&n.__c(L)}function z(X,L,G,V,K,Z,Q,B){var E,M,R,o,S=G.props,l=L.props;if(K=L.type==="svg"||K,X==null&&Z!=null){for(E=0;E<Z.length;E++)if((M=Z[E])!=null&&(L.type===null?M.nodeType===3:M.localName===L.type)){X=M,Z[E]=null;break}}if(X==null){if(L.type===null)return document.createTextNode(l);X=K?document.createElementNS("http://www.w3.org/2000/svg",L.type):document.createElement(L.type),Z=null}return L.type===null?S!==l&&(Z!=null&&(Z[Z.indexOf(X)]=null),X.data=l):L!==G&&(Z!=null&&(Z=e.slice.call(X.childNodes)),R=(S=G.props||f).dangerouslySetInnerHTML,o=l.dangerouslySetInnerHTML,B||(o||R)&&(o&&R&&o.__html==R.__html||(X.innerHTML=o&&o.__html||"")),C(X,l,S,K,B),L.__k=L.props.children,o||b(X,L,G,V,L.type!=="foreignObject"&&K,Z,Q,f,B),B||("value"in l&&l.value!==void 0&&l.value!==X.value&&(X.value=l.value==null?"":l.value),"checked"in l&&l.checked!==void 0&&l.checked!==X.checked&&(X.checked=l.checked))),X}function A(X,L,G){try{typeof X=="function"?X(L):X.current=L}catch(V){n.__e(V,G)}}function D(X,L,G){var V,K,Z;if(n.unmount&&n.unmount(X),(V=X.ref)&&A(V,null,L),G||typeof X.type=="function"||(G=(K=X.__e)!=null),X.__e=X.l=null,(V=X.__c)!=null){if(V.componentWillUnmount)try{V.componentWillUnmount()}catch(Q){n.__e(Q,L)}V.base=V.__P=null}if(V=X.__k)for(Z=0;Z<V.length;Z++)V[Z]&&D(V[Z],L,G);K!=null&&a(K)}function H(X,L,G){return this.constructor(X,G)}function I(X,L,G){var V,K,Z;n.__p&&n.__p(X,L),K=(V=G===r)?null:G&&G.__k||L.__k,X=h(d,null,[X]),Z=[],$(L,V?L.__k=X:(G||L).__k=X,K||f,f,L.ownerSVGElement!==void 0,G&&!V?[G]:K?null:e.slice.call(L.childNodes),Z,!1,G||f,V),j(Z,X)}n={},m.prototype.setState=function(X,L){var G=this.__s!==this.state&&this.__s||(this.__s=s({},this.state));(typeof X!="function"||(X=X(G,this.props)))&&s(G,X),X!=null&&this.__v&&(this.u=!1,L&&this.__h.push(L),k(this))},m.prototype.forceUpdate=function(X){this.__v&&(X&&this.__h.push(X),this.u=!0,k(this))},m.prototype.render=d,u=[],t=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,i=n.debounceRendering,n.__e=function(X,L,G){for(var V;L=L.__p;)if((V=L.__c)&&!V.__p)try{if(V.constructor&&V.constructor.getDerivedStateFromError!=null)V.setState(V.constructor.getDerivedStateFromError(X));else{if(V.componentDidCatch==null)continue;V.componentDidCatch(X)}return k(V.__E=V)}catch(K){X=K}throw X},r=f;function _defineProperties(X,L){for(var G=0;G<L.length;G++){var V=L[G];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(X,V.key,V)}}function _createClass(X,L,G){return L&&_defineProperties(X.prototype,L),G&&_defineProperties(X,G),X}function _extends(){return _extends=Object.assign||function(X){for(var L=arguments,G=1;G<arguments.length;G++){var V=L[G];for(var K in V)Object.prototype.hasOwnProperty.call(V,K)&&(X[K]=V[K])}return X},_extends.apply(this,arguments)}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH_3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH_4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",REGEX_FUNCTIONAL_RGB=new RegExp("rgb"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_RGBA=new RegExp("rgba"+PERMISSIVE_MATCH_4),REGEX_FUNCTIONAL_HSL=new RegExp("hsl"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_HSLA=new RegExp("hsla"+PERMISSIVE_MATCH_4),HEX_START="^(?:#?|0x?)",HEX_INT_SINGLE="([0-9a-fA-F]{1})",HEX_INT_DOUBLE="([0-9a-fA-F]{2})",REGEX_HEX_3=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_4=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_6=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),REGEX_HEX_8=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),KELVIN_MIN=2e3,KELVIN_MAX=4e4,log=Math.log,round=Math.round,floor=Math.floor;function clamp(X,L,G){return Math.min(Math.max(X,L),G)}function parseUnit(X,L){var G=X.indexOf("%")>-1,V=parseFloat(X);return G?L/100*V:V}function parseHexInt(X){return parseInt(X,16)}function intToHex(X){return X.toString(16).padStart(2,"0")}var IroColor=function(){function X(G,V){this.$={h:0,s:0,v:0,a:1},G&&this.set(G),this.onChange=V,this.initialValue=_extends({},this.$)}var L=X.prototype;return L.set=function(V){if(typeof V=="string")/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(V)?this.hexString=V:/^rgba?/.test(V)?this.rgbString=V:/^hsla?/.test(V)&&(this.hslString=V);else if(typeof V=="object")V instanceof X?this.hsva=V.hsva:"r"in V&&"g"in V&&"b"in V?this.rgb=V:"h"in V&&"s"in V&&"v"in V?this.hsv=V:"h"in V&&"s"in V&&"l"in V?this.hsl=V:"kelvin"in V&&(this.kelvin=V.kelvin);else throw new Error("Invalid color value")},L.setChannel=function(V,K,Z){var Q;this[V]=_extends({},this[V],(Q={},Q[K]=Z,Q))},L.reset=function(){this.hsva=this.initialValue},L.clone=function(){return new X(this)},L.unbind=function(){this.onChange=void 0},X.hsvToRgb=function(V){var K=V.h/60,Z=V.s/100,Q=V.v/100,B=floor(K),E=K-B,M=Q*(1-Z),R=Q*(1-E*Z),o=Q*(1-(1-E)*Z),S=B%6,l=[Q,R,M,M,o,Q][S],p=[o,Q,Q,R,M,M][S],F=[M,M,o,Q,Q,R][S];return{r:clamp(l*255,0,255),g:clamp(p*255,0,255),b:clamp(F*255,0,255)}},X.rgbToHsv=function(V){var K=V.r/255,Z=V.g/255,Q=V.b/255,B=Math.max(K,Z,Q),E=Math.min(K,Z,Q),M=B-E,R=0,o=B,S=B===0?0:M/B;switch(B){case E:R=0;break;case K:R=(Z-Q)/M+(Z<Q?6:0);break;case Z:R=(Q-K)/M+2;break;case Q:R=(K-Z)/M+4;break}return{h:R*60%360,s:clamp(S*100,0,100),v:clamp(o*100,0,100)}},X.hsvToHsl=function(V){var K=V.s/100,Z=V.v/100,Q=(2-K)*Z,B=Q<=1?Q:2-Q,E=B<1e-9?0:K*Z/B;return{h:V.h,s:clamp(E*100,0,100),l:clamp(Q*50,0,100)}},X.hslToHsv=function(V){var K=V.l*2,Z=V.s*(K<=100?K:200-K)/100,Q=K+Z<1e-9?0:2*Z/(K+Z);return{h:V.h,s:clamp(Q*100,0,100),v:clamp((K+Z)/2,0,100)}},X.kelvinToRgb=function(V){var K=V/100,Z,Q,B;return K<66?(Z=255,Q=-155.25485562709179-.44596950469579133*(Q=K-2)+104.49216199393888*log(Q),B=K<20?0:-254.76935184120902+.8274096064007395*(B=K-10)+115.67994401066147*log(B)):(Z=351.97690566805693+.114206453784165*(Z=K-55)-40.25366309332127*log(Z),Q=325.4494125711974+.07943456536662342*(Q=K-50)-28.0852963507957*log(Q),B=255),{r:clamp(floor(Z),0,255),g:clamp(floor(Q),0,255),b:clamp(floor(B),0,255)}},X.rgbToKelvin=function(V){for(var K=V.r,Z=V.b,Q=.4,B=KELVIN_MIN,E=KELVIN_MAX,M;E-B>Q;){M=(E+B)*.5;var R=X.kelvinToRgb(M);R.b/R.r>=Z/K?E=M:B=M}return M},_createClass(X,[{key:"hsv",get:function(){var V=this.$;return{h:V.h,s:V.s,v:V.v}},set:function(V){var K=this.$;if(V=_extends({},K,V),this.onChange){var Z={h:!1,v:!1,s:!1,a:!1};for(var Q in K)Z[Q]=V[Q]!=K[Q];this.$=V,(Z.h||Z.s||Z.v||Z.a)&&this.onChange(this,Z)}else this.$=V}},{key:"hsva",get:function(){return _extends({},this.$)},set:function(V){this.hsv=V}},{key:"hue",get:function(){return this.$.h},set:function(V){this.hsv={h:V}}},{key:"saturation",get:function(){return this.$.s},set:function(V){this.hsv={s:V}}},{key:"value",get:function(){return this.$.v},set:function(V){this.hsv={v:V}}},{key:"alpha",get:function(){return this.$.a},set:function(V){this.hsv=_extends({},this.hsv,{a:V})}},{key:"kelvin",get:function(){return X.rgbToKelvin(this.rgb)},set:function(V){this.rgb=X.kelvinToRgb(V)}},{key:"red",get:function(){var V=this.rgb;return V.r},set:function(V){this.rgb=_extends({},this.rgb,{r:V})}},{key:"green",get:function(){var V=this.rgb;return V.g},set:function(V){this.rgb=_extends({},this.rgb,{g:V})}},{key:"blue",get:function(){var V=this.rgb;return V.b},set:function(V){this.rgb=_extends({},this.rgb,{b:V})}},{key:"rgb",get:function(){var V=X.hsvToRgb(this.$),K=V.r,Z=V.g,Q=V.b;return{r:round(K),g:round(Z),b:round(Q)}},set:function(V){this.hsv=_extends({},X.rgbToHsv(V),{a:V.a===void 0?1:V.a})}},{key:"rgba",get:function(){return _extends({},this.rgb,{a:this.alpha})},set:function(V){this.rgb=V}},{key:"hsl",get:function(){var V=X.hsvToHsl(this.$),K=V.h,Z=V.s,Q=V.l;return{h:round(K),s:round(Z),l:round(Q)}},set:function(V){this.hsv=_extends({},X.hslToHsv(V),{a:V.a===void 0?1:V.a})}},{key:"hsla",get:function(){return _extends({},this.hsl,{a:this.alpha})},set:function(V){this.hsl=V}},{key:"rgbString",get:function(){var V=this.rgb;return"rgb("+V.r+", "+V.g+", "+V.b+")"},set:function(V){var K,Z,Q,B,E=1;if((K=REGEX_FUNCTIONAL_RGB.exec(V))?(Z=parseUnit(K[1],255),Q=parseUnit(K[2],255),B=parseUnit(K[3],255)):(K=REGEX_FUNCTIONAL_RGBA.exec(V))&&(Z=parseUnit(K[1],255),Q=parseUnit(K[2],255),B=parseUnit(K[3],255),E=parseUnit(K[4],1)),K)this.rgb={r:Z,g:Q,b:B,a:E};else throw new Error("Invalid rgb string")}},{key:"rgbaString",get:function(){var V=this.rgba;return"rgba("+V.r+", "+V.g+", "+V.b+", "+V.a+")"},set:function(V){this.rgbString=V}},{key:"hexString",get:function(){var V=this.rgb;return"#"+intToHex(V.r)+intToHex(V.g)+intToHex(V.b)},set:function(V){var K,Z,Q,B,E=255;if((K=REGEX_HEX_3.exec(V))?(Z=parseHexInt(K[1])*17,Q=parseHexInt(K[2])*17,B=parseHexInt(K[3])*17):(K=REGEX_HEX_4.exec(V))?(Z=parseHexInt(K[1])*17,Q=parseHexInt(K[2])*17,B=parseHexInt(K[3])*17,E=parseHexInt(K[4])*17):(K=REGEX_HEX_6.exec(V))?(Z=parseHexInt(K[1]),Q=parseHexInt(K[2]),B=parseHexInt(K[3])):(K=REGEX_HEX_8.exec(V))&&(Z=parseHexInt(K[1]),Q=parseHexInt(K[2]),B=parseHexInt(K[3]),E=parseHexInt(K[4])),K)this.rgb={r:Z,g:Q,b:B,a:E/255};else throw new Error("Invalid hex string")}},{key:"hex8String",get:function(){var V=this.rgba;return"#"+intToHex(V.r)+intToHex(V.g)+intToHex(V.b)+intToHex(floor(V.a*255))},set:function(V){this.hexString=V}},{key:"hslString",get:function(){var V=this.hsl;return"hsl("+V.h+", "+V.s+"%, "+V.l+"%)"},set:function(V){var K,Z,Q,B,E=1;if((K=REGEX_FUNCTIONAL_HSL.exec(V))?(Z=parseUnit(K[1],360),Q=parseUnit(K[2],100),B=parseUnit(K[3],100)):(K=REGEX_FUNCTIONAL_HSLA.exec(V))&&(Z=parseUnit(K[1],360),Q=parseUnit(K[2],100),B=parseUnit(K[3],100),E=parseUnit(K[4],1)),K)this.hsl={h:Z,s:Q,l:B,a:E};else throw new Error("Invalid hsl string")}},{key:"hslaString",get:function(){var V=this.hsla;return"hsla("+V.h+", "+V.s+"%, "+V.l+"%, "+V.a+")"},set:function(V){this.hslString=V}}]),X}(),sliderDefaultOptions={sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3};function getSliderDimensions(X){var L,G=X.width,V=X.sliderSize,K=X.borderWidth,Z=X.handleRadius,Q=X.padding,B=X.sliderShape,E=X.layoutDirection==="horizontal";return V=(L=V)!=null?L:Q*2+Z*2,B==="circle"?{handleStart:X.padding+X.handleRadius,handleRange:G-Q*2-Z*2,width:G,height:G,cx:G/2,cy:G/2,radius:G/2-K/2}:{handleStart:V/2,handleRange:G-V,radius:V/2,x:0,y:0,width:E?V:G,height:E?G:V}}function getCurrentSliderValue(X,L){var G=L.hsva,V=L.rgb;switch(X.sliderType){case"red":return V.r/2.55;case"green":return V.g/2.55;case"blue":return V.b/2.55;case"alpha":return G.a*100;case"kelvin":var K=X.minTemperature,Z=X.maxTemperature,Q=Z-K,B=(L.kelvin-K)/Q*100;return Math.max(0,Math.min(B,100));case"hue":return G.h/=3.6;case"saturation":return G.s;case"value":default:return G.v}}function getSliderValueFromInput(X,L,G){var V=getSliderDimensions(X),K=V.handleRange,Z=V.handleStart,Q;X.layoutDirection==="horizontal"?Q=-1*G+K+Z:Q=L-Z,Q=Math.max(Math.min(Q,K),0);var B=Math.round(100/K*Q);switch(X.sliderType){case"kelvin":var E=X.minTemperature,M=X.maxTemperature,R=M-E;return E+R*(B/100);case"alpha":return B/100;case"hue":return B*3.6;case"red":case"blue":case"green":return B*2.55;default:return B}}function getSliderHandlePosition(X,L){var G=getSliderDimensions(X),V=G.width,K=G.height,Z=G.handleRange,Q=G.handleStart,B=X.layoutDirection==="horizontal",E=getCurrentSliderValue(X,L),M=B?V/2:K/2,R=Q+E/100*Z;return B&&(R=-1*R+Z+Q*2),{x:B?M:R,y:B?R:M}}function getSliderGradient(X,L){var G=L.hsv,V=L.rgb;switch(X.sliderType){case"red":return[[0,"rgb(0,"+V.g+","+V.b+")"],[100,"rgb(255,"+V.g+","+V.b+")"]];case"green":return[[0,"rgb("+V.r+",0,"+V.b+")"],[100,"rgb("+V.r+",255,"+V.b+")"]];case"blue":return[[0,"rgb("+V.r+","+V.g+",0)"],[100,"rgb("+V.r+","+V.g+",255)"]];case"alpha":return[[0,"rgba("+V.r+","+V.g+","+V.b+",0)"],[100,"rgb("+V.r+","+V.g+","+V.b+")"]];case"kelvin":for(var K=[],Z=X.minTemperature,Q=X.maxTemperature,B=8,E=Q-Z,M=Z,R=0;M<Q;M+=E/B,R+=1){var o=IroColor.kelvinToRgb(M),S=o.r,l=o.g,p=o.b;K.push([100/B*R,"rgb("+S+","+l+","+p+")"])}return K;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var F=IroColor.hsvToHsl({h:G.h,s:0,v:G.v}),O=IroColor.hsvToHsl({h:G.h,s:100,v:G.v});return[[0,"hsl("+F.h+","+F.s+"%,"+F.l+"%)"],[100,"hsl("+O.h+","+O.s+"%,"+O.l+"%)"]];case"value":default:var q=IroColor.hsvToHsl({h:G.h,s:G.s,v:100});return[[0,"#000"],[100,"hsl("+q.h+","+q.s+"%,"+q.l+"%)"]]}}var TAU=Math.PI*2,mod=function(L,G){return(L%G+G)%G},dist=function(L,G){return Math.sqrt(L*L+G*G)};function getHandleRange(X){return X.width/2-X.padding-X.handleRadius-X.borderWidth}function isInputInsideWheel(X,L,G){var V=getWheelDimensions(X),K=V.cx,Z=V.cy,Q=X.width/2;return dist(K-L,Z-G)<Q}function getWheelDimensions(X){var L=X.width/2;return{width:X.width,radius:L-X.borderWidth,cx:L,cy:L}}function translateWheelAngle(X,L,G){var V=X.wheelAngle,K=X.wheelDirection;return G&&K==="clockwise"?L=V+L:K==="clockwise"?L=360-V+L:G&&K==="anticlockwise"?L=V+180-L:K==="anticlockwise"&&(L=V-L),mod(L,360)}function getWheelHandlePosition(X,L){var G=L.hsv,V=getWheelDimensions(X),K=V.cx,Z=V.cy,Q=getHandleRange(X),B=(180+translateWheelAngle(X,G.h,!0))*(TAU/360),E=G.s/100*Q,M=X.wheelDirection==="clockwise"?-1:1;return{x:K+E*Math.cos(B)*M,y:Z+E*Math.sin(B)*M}}function getWheelValueFromInput(X,L,G){var V=getWheelDimensions(X),K=V.cx,Z=V.cy,Q=getHandleRange(X);L=K-L,G=Z-G;var B=translateWheelAngle(X,Math.atan2(-G,-L)*(360/TAU)),E=Math.min(dist(L,G),Q);return{h:Math.round(B),s:Math.round(100/Q*E)}}function getBoxDimensions(X){var L=X.width,G=X.boxHeight,V=X.padding,K=X.handleRadius;return{width:L,height:G??L,radius:V+K}}function getBoxValueFromInput(X,L,G){var V=getBoxDimensions(X),K=V.width,Z=V.height,Q=V.radius,B=Q,E=K-Q*2,M=Z-Q*2,R=(L-B)/E*100,o=(G-B)/M*100;return{s:Math.max(0,Math.min(R,100)),v:Math.max(0,Math.min(100-o,100))}}function getBoxHandlePosition(X,L){var G=getBoxDimensions(X),V=G.width,K=G.height,Z=G.radius,Q=L.hsv,B=Z,E=V-Z*2,M=K-Z*2;return{x:B+Q.s/100*E,y:B+(M-Q.v/100*M)}}function getBoxGradients(X,L){var G=L.hue;return[[[0,"#fff"],[100,"hsl("+G+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]]}var BASE_ELEMENTS;function resolveSvgUrl(X){BASE_ELEMENTS||(BASE_ELEMENTS=document.getElementsByTagName("base"));var L=window.navigator.userAgent,G=/^((?!chrome|android).)*safari/i.test(L),V=/iPhone|iPod|iPad/i.test(L),K=window.location;return(G||V)&&BASE_ELEMENTS.length>0?K.protocol+"//"+K.host+K.pathname+K.search+X:X}function getHandleAtPoint(X,L,G,V){for(var K=0;K<V.length;K++){var Z=V[K].x-L,Q=V[K].y-G,B=Math.sqrt(Z*Z+Q*Q);if(B<X.handleRadius)return K}return null}function cssBorderStyles(X){return{boxSizing:"border-box",border:X.borderWidth+"px solid "+X.borderColor}}function cssGradient(X,L,G){return X+"-gradient("+L+", "+G.map(function(V){var K=V[0],Z=V[1];return Z+" "+K+"%"}).join(",")+")"}function cssValue(X){return typeof X=="string"?X:X+"px"}var iroColorPickerOptionDefaults={width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},SECONDARY_EVENTS=["mousemove","touchmove","mouseup","touchend"],IroComponentWrapper=function(X){function L(G){X.call(this,G),this.uid=(Math.random()+1).toString(36).substring(5)}return X&&(L.__proto__=X),L.prototype=Object.create(X&&X.prototype),L.prototype.constructor=L,L.prototype.render=function(V){var K=this.handleEvent.bind(this),Z={onMouseDown:K,ontouchstart:K},Q=V.layoutDirection==="horizontal",B=V.margin===null?V.sliderMargin:V.margin,E={overflow:"visible",display:Q?"inline-block":"block"};return V.index>0&&(E[Q?"marginLeft":"marginTop"]=B),h(d,null,V.children(this.uid,Z,E))},L.prototype.handleEvent=function(V){var K=this,Z=this.props.onInput,Q=this.base.getBoundingClientRect();V.preventDefault();var B=V.touches?V.changedTouches[0]:V,E=B.clientX-Q.left,M=B.clientY-Q.top;switch(V.type){case"mousedown":case"touchstart":var R=Z(E,M,0);R!==!1&&SECONDARY_EVENTS.forEach(function(o){document.addEventListener(o,K,{passive:!1})});break;case"mousemove":case"touchmove":Z(E,M,1);break;case"mouseup":case"touchend":Z(E,M,2),SECONDARY_EVENTS.forEach(function(o){document.removeEventListener(o,K,{passive:!1})});break}},L}(m);function IroHandle(X){var L=X.r,G=X.url,V=L,K=L;return h("svg",{className:"IroHandle IroHandle--"+X.index+" "+(X.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+cssValue(X.x)+", "+cssValue(X.y)+")",willChange:"transform",top:cssValue(-L),left:cssValue(-L),width:cssValue(L*2),height:cssValue(L*2),position:"absolute",overflow:"visible"}},G&&h("use",Object.assign({xlinkHref:resolveSvgUrl(G)},X.props)),!G&&h("circle",{cx:V,cy:K,r:L,fill:"none","stroke-width":2,stroke:"#000"}),!G&&h("circle",{cx:V,cy:K,r:L-2,fill:X.fill,"stroke-width":2,stroke:"#fff"}))}IroHandle.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}};function IroSlider(X){var L=X.activeIndex,G=L!==void 0&&L<X.colors.length?X.colors[L]:X.color,V=getSliderDimensions(X),K=V.width,Z=V.height,Q=V.radius,B=getSliderHandlePosition(X,G),E=getSliderGradient(X,G);function M(R,o,S){var l=getSliderValueFromInput(X,R,o);X.parent.inputActive=!0,G[X.sliderType]=l,X.onInput(S,X.id)}return h(IroComponentWrapper,Object.assign({},X,{onInput:M}),function(R,o,S){return h("div",Object.assign({},o,{className:"IroSlider",style:Object.assign({},{position:"relative",width:cssValue(K),height:cssValue(Z),borderRadius:cssValue(Q),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},S)}),h("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:cssValue(Q),background:cssGradient("linear",X.layoutDirection==="horizontal"?"to top":"to right",E)},cssBorderStyles(X))}),h(IroHandle,{isActive:!0,index:G.index,r:X.handleRadius,url:X.handleSvg,props:X.handleProps,x:B.x,y:B.y}))})}IroSlider.defaultProps=Object.assign({},sliderDefaultOptions);function IroBox(X){var L=getBoxDimensions(X),G=L.width,V=L.height,K=L.radius,Z=X.colors,Q=X.parent,B=X.activeIndex,E=B!==void 0&&B<X.colors.length?X.colors[B]:X.color,M=getBoxGradients(X,E),R=Z.map(function(S){return getBoxHandlePosition(X,S)});function o(S,l,p){if(p===0){var F=getHandleAtPoint(X,S,l,R);F!==null?Q.setActiveColor(F):(Q.inputActive=!0,E.hsv=getBoxValueFromInput(X,S,l),X.onInput(p,X.id))}else p===1&&(Q.inputActive=!0,E.hsv=getBoxValueFromInput(X,S,l));X.onInput(p,X.id)}return h(IroComponentWrapper,Object.assign({},X,{onInput:o}),function(S,l,p){return h("div",Object.assign({},l,{className:"IroBox",style:Object.assign({},{width:cssValue(G),height:cssValue(V),position:"relative"},p)}),h("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:cssValue(K)},cssBorderStyles(X),{background:cssGradient("linear","to bottom",M[1])+","+cssGradient("linear","to right",M[0])})}),Z.filter(function(F){return F!==E}).map(function(F){return h(IroHandle,{isActive:!1,index:F.index,fill:F.hslString,r:X.handleRadius,url:X.handleSvg,props:X.handleProps,x:R[F.index].x,y:R[F.index].y})}),h(IroHandle,{isActive:!0,index:E.index,fill:E.hslString,r:X.activeHandleRadius||X.handleRadius,url:X.handleSvg,props:X.handleProps,x:R[E.index].x,y:R[E.index].y}))})}var HUE_GRADIENT_CLOCKWISE="conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",HUE_GRADIENT_ANTICLOCKWISE="conic-gradient(red, magenta, blue, aqua, lime, yellow, red)";function IroWheel(X){var L=getWheelDimensions(X),G=L.width,V=X.colors;X.borderWidth;var K=X.parent,Z=X.color,Q=Z.hsv,B=V.map(function(R){return getWheelHandlePosition(X,R)}),E={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};function M(R,o,S){if(S===0){if(!isInputInsideWheel(X,R,o))return!1;var l=getHandleAtPoint(X,R,o,B);l!==null?K.setActiveColor(l):(K.inputActive=!0,Z.hsv=getWheelValueFromInput(X,R,o),X.onInput(S,X.id))}else S===1&&(K.inputActive=!0,Z.hsv=getWheelValueFromInput(X,R,o));X.onInput(S,X.id)}return h(IroComponentWrapper,Object.assign({},X,{onInput:M}),function(R,o,S){return h("div",Object.assign({},o,{className:"IroWheel",style:Object.assign({},{width:cssValue(G),height:cssValue(G),position:"relative"},S)}),h("div",{className:"IroWheelHue",style:Object.assign({},E,{transform:"rotateZ("+(X.wheelAngle+90)+"deg)",background:X.wheelDirection==="clockwise"?HUE_GRADIENT_CLOCKWISE:HUE_GRADIENT_ANTICLOCKWISE})}),h("div",{className:"IroWheelSaturation",style:Object.assign({},E,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),X.wheelLightness&&h("div",{className:"IroWheelLightness",style:Object.assign({},E,{background:"#000",opacity:1-Q.v/100})}),h("div",{className:"IroWheelBorder",style:Object.assign({},E,cssBorderStyles(X))}),V.filter(function(l){return l!==Z}).map(function(l){return h(IroHandle,{isActive:!1,index:l.index,fill:l.hslString,r:X.handleRadius,url:X.handleSvg,props:X.handleProps,x:B[l.index].x,y:B[l.index].y})}),h(IroHandle,{isActive:!0,index:Z.index,fill:Z.hslString,r:X.activeHandleRadius||X.handleRadius,url:X.handleSvg,props:X.handleProps,x:B[Z.index].x,y:B[Z.index].y}))})}function createWidget(X){var L=function(G,V){var K,Z=document.createElement("div");I(h(X,Object.assign({},{ref:function(B){return K=B}},V)),Z);function Q(){var B=G instanceof Element?G:document.querySelector(G);B.appendChild(K.base),K.onMount(B)}return document.readyState!=="loading"?Q():document.addEventListener("DOMContentLoaded",Q),K};return L.prototype=X.prototype,Object.assign(L,X),L.__component=X,L}var IroColorPicker=function(X){function L(G){var V=this;X.call(this,G),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=G.id;var K=G.colors.length>0?G.colors:[G.color];K.forEach(function(Z){return V.addColor(Z)}),this.setActiveColor(0),this.state=Object.assign({},G,{color:this.color,colors:this.colors,layout:G.layout})}return X&&(L.__proto__=X),L.prototype=Object.create(X&&X.prototype),L.prototype.constructor=L,L.prototype.addColor=function(V,K){K===void 0&&(K=this.colors.length);var Z=new IroColor(V,this.onColorChange.bind(this));this.colors.splice(K,0,Z),this.colors.forEach(function(Q,B){return Q.index=B}),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",Z)},L.prototype.removeColor=function(V){var K=this.colors.splice(V,1)[0];K.unbind(),this.colors.forEach(function(Z,Q){return Z.index=Q}),this.state&&this.setState({colors:this.colors}),K.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",K)},L.prototype.setActiveColor=function(V){this.color=this.colors[V],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},L.prototype.setColors=function(V,K){var Z=this;K===void 0&&(K=0),this.colors.forEach(function(Q){return Q.unbind()}),this.colors=[],V.forEach(function(Q){return Z.addColor(Q)}),this.setActiveColor(K),this.emit("color:setAll",this.colors)},L.prototype.on=function(V,K){var Z=this,Q=this.events;(Array.isArray(V)?V:[V]).forEach(function(B){(Q[B]||(Q[B]=[])).push(K),Z.deferredEvents[B]&&(Z.deferredEvents[B].forEach(function(E){K.apply(null,E)}),Z.deferredEvents[B]=[])})},L.prototype.off=function(V,K){var Z=this;(Array.isArray(V)?V:[V]).forEach(function(Q){var B=Z.events[Q];B&&B.splice(B.indexOf(K),1)})},L.prototype.emit=function(V){for(var K=this,Z=[],Q=arguments.length-1;Q-- >0;)Z[Q]=arguments[Q+1];var B=this.activeEvents,E=B.hasOwnProperty(V)?B[V]:!1;if(!E){B[V]=!0;var M=this.events[V]||[];M.forEach(function(R){return R.apply(K,Z)}),B[V]=!1}},L.prototype.deferredEmit=function(V){for(var K,Z=[],Q=arguments.length-1;Q-- >0;)Z[Q]=arguments[Q+1];var B=this.deferredEvents;(K=this).emit.apply(K,[V].concat(Z)),(B[V]||(B[V]=[])).push(Z)},L.prototype.setOptions=function(V){this.setState(V)},L.prototype.resize=function(V){this.setOptions({width:V})},L.prototype.reset=function(){this.colors.forEach(function(V){return V.reset()}),this.setState({colors:this.colors})},L.prototype.onMount=function(V){this.el=V,this.deferredEmit("mount",this)},L.prototype.onColorChange=function(V,K){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",V,K)),this.emit("color:change",V,K)},L.prototype.emitInputEvent=function(V,K){V===0?this.emit("input:start",this.color,K):V===1?this.emit("input:move",this.color,K):V===2&&this.emit("input:end",this.color,K)},L.prototype.render=function(V,K){var Z=this,Q=K.layout;if(!Array.isArray(Q)){switch(Q){default:Q=[{component:IroWheel},{component:IroSlider}]}K.transparency&&Q.push({component:IroSlider,options:{sliderType:"alpha"}})}return h("div",{class:"IroColorPicker",id:K.id,style:{display:K.display}},Q.map(function(B,E){var M=B.component,R=B.options;return h(M,Object.assign({},K,R,{ref:void 0,onInput:Z.emitInputEvent.bind(Z),parent:Z,index:E}))}))},L}(m);IroColorPicker.defaultProps=Object.assign({},iroColorPickerOptionDefaults,{colors:[],display:"block",id:null,layout:"default",margin:null});var IroColorPickerWidget=createWidget(IroColorPicker),iro;(function(X){X.version="5.5.2",X.Color=IroColor,X.ColorPicker=IroColorPickerWidget,function(L){L.h=h,L.ComponentBase=IroComponentWrapper,L.Handle=IroHandle,L.Slider=IroSlider,L.Wheel=IroWheel,L.Box=IroBox}(X.ui||(X.ui={}))})(iro||(iro={}));var iro$1=iro,webfontloader={exports:{}};(function(X){(function(){function L(se,de,Le){return se.call.apply(se.bind,arguments)}function G(se,de,Le){if(!se)throw Error();if(2<arguments.length){var we=Array.prototype.slice.call(arguments,2);return function(){var We=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(We,we),se.apply(de,We)}}return function(){return se.apply(de,arguments)}}function V(se,de,Le){return V=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?L:G,V.apply(null,arguments)}var K=Date.now||function(){return+new Date};function Z(se,de){this.a=se,this.o=de||se,this.c=this.o.document}var Q=!!window.FontFace;function B(se,de,Le,we){if(de=se.c.createElement(de),Le)for(var We in Le)Le.hasOwnProperty(We)&&(We=="style"?de.style.cssText=Le[We]:de.setAttribute(We,Le[We]));return we&&de.appendChild(se.c.createTextNode(we)),de}function E(se,de,Le){se=se.c.getElementsByTagName(de)[0],se||(se=document.documentElement),se.insertBefore(Le,se.lastChild)}function M(se){se.parentNode&&se.parentNode.removeChild(se)}function R(se,de,Le){de=de||[],Le=Le||[];for(var we=se.className.split(/\s+/),We=0;We<de.length;We+=1){for(var Ke=!1,Je=0;Je<we.length;Je+=1)if(de[We]===we[Je]){Ke=!0;break}Ke||we.push(de[We])}for(de=[],We=0;We<we.length;We+=1){for(Ke=!1,Je=0;Je<Le.length;Je+=1)if(we[We]===Le[Je]){Ke=!0;break}Ke||de.push(we[We])}se.className=de.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function o(se,de){for(var Le=se.className.split(/\s+/),we=0,We=Le.length;we<We;we++)if(Le[we]==de)return!0;return!1}function S(se){return se.o.location.hostname||se.a.location.hostname}function l(se,de,Le){function we(){ot&&We&&Ke&&(ot(Je),ot=null)}de=B(se,"link",{rel:"stylesheet",href:de,media:"all"});var We=!1,Ke=!0,Je=null,ot=Le||null;Q?(de.onload=function(){We=!0,we()},de.onerror=function(){We=!0,Je=Error("Stylesheet failed to load"),we()}):setTimeout(function(){We=!0,we()},0),E(se,"head",de)}function p(se,de,Le,we){var We=se.c.getElementsByTagName("head")[0];if(We){var Ke=B(se,"script",{src:de}),Je=!1;return Ke.onload=Ke.onreadystatechange=function(){Je||this.readyState&&this.readyState!="loaded"&&this.readyState!="complete"||(Je=!0,Le&&Le(null),Ke.onload=Ke.onreadystatechange=null,Ke.parentNode.tagName=="HEAD"&&We.removeChild(Ke))},We.appendChild(Ke),setTimeout(function(){Je||(Je=!0,Le&&Le(Error("Script load timeout")))},we||5e3),Ke}return null}function F(){this.a=0,this.c=null}function O(se){return se.a++,function(){se.a--,W(se)}}function q(se,de){se.c=de,W(se)}function W(se){se.a==0&&se.c&&(se.c(),se.c=null)}function U(se){this.a=se||"-"}U.prototype.c=function(se){for(var de=[],Le=0;Le<arguments.length;Le++)de.push(arguments[Le].replace(/[\W_]+/g,"").toLowerCase());return de.join(this.a)};function Y(se,de){this.c=se,this.f=4,this.a="n";var Le=(de||"n4").match(/^([nio])([1-9])$/i);Le&&(this.a=Le[1],this.f=parseInt(Le[2],10))}function J(se){return fe(se)+" "+(se.f+"00")+" 300px "+te(se.c)}function te(se){var de=[];se=se.split(/,\s*/);for(var Le=0;Le<se.length;Le++){var we=se[Le].replace(/['"]/g,"");we.indexOf(" ")!=-1||/^\d/.test(we)?de.push("'"+we+"'"):de.push(we)}return de.join(",")}function oe(se){return se.a+se.f}function fe(se){var de="normal";return se.a==="o"?de="oblique":se.a==="i"&&(de="italic"),de}function be(se){var de=4,Le="n",we=null;return se&&((we=se.match(/(normal|oblique|italic)/i))&&we[1]&&(Le=we[1].substr(0,1).toLowerCase()),(we=se.match(/([1-9]00|normal|bold)/i))&&we[1]&&(/bold/i.test(we[1])?de=7:/[1-9]00/.test(we[1])&&(de=parseInt(we[1].substr(0,1),10)))),Le+de}function Re(se,de){this.c=se,this.f=se.o.document.documentElement,this.h=de,this.a=new U("-"),this.j=de.events!==!1,this.g=de.classes!==!1}function Fe(se){se.g&&R(se.f,[se.a.c("wf","loading")]),Be(se,"loading")}function Me(se){if(se.g){var de=o(se.f,se.a.c("wf","active")),Le=[],we=[se.a.c("wf","loading")];de||Le.push(se.a.c("wf","inactive")),R(se.f,Le,we)}Be(se,"inactive")}function Be(se,de,Le){se.j&&se.h[de]&&(Le?se.h[de](Le.c,oe(Le)):se.h[de]())}function Ie(){this.c={}}function je(se,de,Le){var we=[],We;for(We in de)if(de.hasOwnProperty(We)){var Ke=se.c[We];Ke&&we.push(Ke(de[We],Le))}return we}function Xe(se,de){this.c=se,this.f=de,this.a=B(this.c,"span",{"aria-hidden":"true"},this.f)}function ze(se){E(se.c,"body",se.a)}function Ue(se){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+te(se.c)+";"+("font-style:"+fe(se)+";font-weight:"+(se.f+"00")+";")}function ie(se,de,Le,we,We,Ke){this.g=se,this.j=de,this.a=we,this.c=Le,this.f=We||3e3,this.h=Ke||void 0}ie.prototype.start=function(){var se=this.c.o.document,de=this,Le=K(),we=new Promise(function(Je,ot){function lt(){K()-Le>=de.f?ot():se.fonts.load(J(de.a),de.h).then(function(ht){1<=ht.length?Je():setTimeout(lt,25)},function(){ot()})}lt()}),We=null,Ke=new Promise(function(Je,ot){We=setTimeout(ot,de.f)});Promise.race([Ke,we]).then(function(){We&&(clearTimeout(We),We=null),de.g(de.a)},function(){de.j(de.a)})};function ue(se,de,Le,we,We,Ke,Je){this.v=se,this.B=de,this.c=Le,this.a=we,this.s=Je||"BESbswy",this.f={},this.w=We||3e3,this.u=Ke||null,this.m=this.j=this.h=this.g=null,this.g=new Xe(this.c,this.s),this.h=new Xe(this.c,this.s),this.j=new Xe(this.c,this.s),this.m=new Xe(this.c,this.s),se=new Y(this.a.c+",serif",oe(this.a)),se=Ue(se),this.g.a.style.cssText=se,se=new Y(this.a.c+",sans-serif",oe(this.a)),se=Ue(se),this.h.a.style.cssText=se,se=new Y("serif",oe(this.a)),se=Ue(se),this.j.a.style.cssText=se,se=new Y("sans-serif",oe(this.a)),se=Ue(se),this.m.a.style.cssText=se,ze(this.g),ze(this.h),ze(this.j),ze(this.m)}var he={D:"serif",C:"sans-serif"},ce=null;function me(){if(ce===null){var se=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);ce=!!se&&(536>parseInt(se[1],10)||parseInt(se[1],10)===536&&11>=parseInt(se[2],10))}return ce}ue.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=K(),ne(this)};function ae(se,de,Le){for(var we in he)if(he.hasOwnProperty(we)&&de===se.f[he[we]]&&Le===se.f[he[we]])return!0;return!1}function ne(se){var de=se.g.a.offsetWidth,Le=se.h.a.offsetWidth,we;(we=de===se.f.serif&&Le===se.f["sans-serif"])||(we=me()&&ae(se,de,Le)),we?K()-se.A>=se.w?me()&&ae(se,de,Le)&&(se.u===null||se.u.hasOwnProperty(se.a.c))?ve(se,se.v):ve(se,se.B):ge(se):ve(se,se.v)}function ge(se){setTimeout(V(function(){ne(this)},se),50)}function ve(se,de){setTimeout(V(function(){M(this.g.a),M(this.h.a),M(this.j.a),M(this.m.a),de(this.a)},se),0)}function xe(se,de,Le){this.c=se,this.a=de,this.f=0,this.m=this.j=!1,this.s=Le}var ye=null;xe.prototype.g=function(se){var de=this.a;de.g&&R(de.f,[de.a.c("wf",se.c,oe(se).toString(),"active")],[de.a.c("wf",se.c,oe(se).toString(),"loading"),de.a.c("wf",se.c,oe(se).toString(),"inactive")]),Be(de,"fontactive",se),this.m=!0,Ae(this)},xe.prototype.h=function(se){var de=this.a;if(de.g){var Le=o(de.f,de.a.c("wf",se.c,oe(se).toString(),"active")),we=[],We=[de.a.c("wf",se.c,oe(se).toString(),"loading")];Le||we.push(de.a.c("wf",se.c,oe(se).toString(),"inactive")),R(de.f,we,We)}Be(de,"fontinactive",se),Ae(this)};function Ae(se){--se.f==0&&se.j&&(se.m?(se=se.a,se.g&&R(se.f,[se.a.c("wf","active")],[se.a.c("wf","loading"),se.a.c("wf","inactive")]),Be(se,"active")):Me(se.a))}function De(se){this.j=se,this.a=new Ie,this.h=0,this.f=this.g=!0}De.prototype.load=function(se){this.c=new Z(this.j,se.context||this.j),this.g=se.events!==!1,this.f=se.classes!==!1,Se(this,new Re(this.c,se),se)};function He(se,de,Le,we,We){var Ke=--se.h==0;(se.f||se.g)&&setTimeout(function(){var Je=We||null,ot=we||null||{};if(Le.length===0&&Ke)Me(de.a);else{de.f+=Le.length,Ke&&(de.j=Ke);var lt,ht=[];for(lt=0;lt<Le.length;lt++){var ee=Le[lt],re=ot[ee.c],le=de.a,_e=ee;if(le.g&&R(le.f,[le.a.c("wf",_e.c,oe(_e).toString(),"loading")]),Be(le,"fontloading",_e),le=null,ye===null)if(window.FontFace){var _e=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),Oe=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);ye=_e?42<parseInt(_e[1],10):!Oe}else ye=!1;ye?le=new ie(V(de.g,de),V(de.h,de),de.c,ee,de.s,re):le=new ue(V(de.g,de),V(de.h,de),de.c,ee,de.s,Je,re),ht.push(le)}for(lt=0;lt<ht.length;lt++)ht[lt].start()}},0)}function Se(se,de,Le){var We=[],we=Le.timeout;Fe(de);var We=je(se.a,Le,se.c),Ke=new xe(se.c,de,we);for(se.h=We.length,de=0,Le=We.length;de<Le;de++)We[de].load(function(Je,ot,lt){He(se,Ke,Je,ot,lt)})}function pe(se,de){this.c=se,this.a=de}pe.prototype.load=function(se){function de(){if(Ke["__mti_fntLst"+we]){var Je=Ke["__mti_fntLst"+we](),ot=[],lt;if(Je)for(var ht=0;ht<Je.length;ht++){var ee=Je[ht].fontfamily;Je[ht].fontStyle!=null&&Je[ht].fontWeight!=null?(lt=Je[ht].fontStyle+Je[ht].fontWeight,ot.push(new Y(ee,lt))):ot.push(new Y(ee))}se(ot)}else setTimeout(function(){de()},50)}var Le=this,we=Le.a.projectId,We=Le.a.version;if(we){var Ke=Le.c.o;p(this.c,(Le.a.api||"https://fast.fonts.net/jsapi")+"/"+we+".js"+(We?"?v="+We:""),function(Je){Je?se([]):(Ke["__MonotypeConfiguration__"+we]=function(){return Le.a},de())}).id="__MonotypeAPIScript__"+we}else se([])};function Ee(se,de){this.c=se,this.a=de}Ee.prototype.load=function(se){var de,Le,we=this.a.urls||[],We=this.a.families||[],Ke=this.a.testStrings||{},Je=new F;for(de=0,Le=we.length;de<Le;de++)l(this.c,we[de],O(Je));var ot=[];for(de=0,Le=We.length;de<Le;de++)if(we=We[de].split(":"),we[1])for(var lt=we[1].split(","),ht=0;ht<lt.length;ht+=1)ot.push(new Y(we[0],lt[ht]));else ot.push(new Y(we[0]));q(Je,function(){se(ot,Ke)})};function ke(se,de){se?this.c=se:this.c=Ce,this.a=[],this.f=[],this.g=de||""}var Ce="https://fonts.googleapis.com/css";function Pe(se,de){for(var Le=de.length,we=0;we<Le;we++){var We=de[we].split(":");We.length==3&&se.f.push(We.pop());var Ke="";We.length==2&&We[1]!=""&&(Ke=":"),se.a.push(We.join(Ke))}}function Ne(se){if(se.a.length==0)throw Error("No fonts to load!");if(se.c.indexOf("kit=")!=-1)return se.c;for(var de=se.a.length,Le=[],we=0;we<de;we++)Le.push(se.a[we].replace(/ /g,"+"));return de=se.c+"?family="+Le.join("%7C"),0<se.f.length&&(de+="&subset="+se.f.join(",")),0<se.g.length&&(de+="&text="+encodeURIComponent(se.g)),de}function Qe(se){this.f=se,this.a=[],this.c={}}var Ge={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},Te={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},$e={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function it(se){for(var de=se.f.length,Le=0;Le<de;Le++){var we=se.f[Le].split(":"),We=we[0].replace(/\+/g," "),Ke=["n4"];if(2<=we.length){var Je,ot=we[1];if(Je=[],ot)for(var ot=ot.split(","),lt=ot.length,ht=0;ht<lt;ht++){var ee;if(ee=ot[ht],ee.match(/^[\w-]+$/)){var re=et.exec(ee.toLowerCase());if(re==null)ee="";else{if(ee=re[2],ee=ee==null||ee==""?"n":$e[ee],re=re[1],re==null||re=="")re="4";else var le=Te[re],re=le||(isNaN(re)?"4":re.substr(0,1));ee=[ee,re].join("")}}else ee="";ee&&Je.push(ee)}0<Je.length&&(Ke=Je),we.length==3&&(we=we[2],Je=[],we=we?we.split(","):Je,0<we.length&&(we=Ge[we[0]])&&(se.c[We]=we))}for(se.c[We]||(we=Ge[We])&&(se.c[We]=we),we=0;we<Ke.length;we+=1)se.a.push(new Y(We,Ke[we]))}}function ct(se,de){this.c=se,this.a=de}var nt={Arimo:!0,Cousine:!0,Tinos:!0};ct.prototype.load=function(se){var de=new F,Le=this.c,we=new ke(this.a.api,this.a.text),We=this.a.families;Pe(we,We);var Ke=new Qe(We);it(Ke),l(Le,Ne(we),O(de)),q(de,function(){se(Ke.a,Ke.c,nt)})};function ut(se,de){this.c=se,this.a=de}ut.prototype.load=function(se){var de=this.a.id,Le=this.c.o;de?p(this.c,(this.a.api||"https://use.typekit.net")+"/"+de+".js",function(we){if(we)se([]);else if(Le.Typekit&&Le.Typekit.config&&Le.Typekit.config.fn){we=Le.Typekit.config.fn;for(var We=[],Ke=0;Ke<we.length;Ke+=2)for(var Je=we[Ke],ot=we[Ke+1],lt=0;lt<ot.length;lt++)We.push(new Y(Je,ot[lt]));try{Le.Typekit.load({events:!1,classes:!1,async:!0})}catch{}se(We)}},2e3):se([])};function st(se,de){this.c=se,this.f=de,this.a=[]}st.prototype.load=function(se){var de=this.f.id,Le=this.c.o,we=this;de?(Le.__webfontfontdeckmodule__||(Le.__webfontfontdeckmodule__={}),Le.__webfontfontdeckmodule__[de]=function(We,Ke){for(var Je=0,ot=Ke.fonts.length;Je<ot;++Je){var lt=Ke.fonts[Je];we.a.push(new Y(lt.name,be("font-weight:"+lt.weight+";font-style:"+lt.style)))}se(we.a)},p(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+S(this.c)+"/"+de+".js",function(We){We&&se([])})):se([])};var pt=new De(window);pt.a.c.custom=function(se,de){return new Ee(de,se)},pt.a.c.fontdeck=function(se,de){return new st(de,se)},pt.a.c.monotype=function(se,de){return new pe(de,se)},pt.a.c.typekit=function(se,de){return new ut(de,se)},pt.a.c.google=function(se,de){return new ct(de,se)};var _t={load:V(pt.load,pt)};X.exports?X.exports=_t:(window.WebFont=_t,window.WebFontConfig&&pt.load(window.WebFontConfig))})()})(webfontloader);var webfontloaderExports=webfontloader.exports;const WebFont=getDefaultExportFromCjs(webfontloaderExports);function bind(X,L){return function(){return X.apply(L,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(X=>L=>{const G=toString.call(L);return X[G]||(X[G]=G.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=X=>(X=X.toLowerCase(),L=>kindOf(L)===X),typeOfTest=X=>L=>typeof L===X,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(X){return X!==null&&!isUndefined(X)&&X.constructor!==null&&!isUndefined(X.constructor)&&isFunction(X.constructor.isBuffer)&&X.constructor.isBuffer(X)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(X){let L;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?L=ArrayBuffer.isView(X):L=X&&X.buffer&&isArrayBuffer(X.buffer),L}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=X=>X!==null&&typeof X=="object",isBoolean=X=>X===!0||X===!1,isPlainObject=X=>{if(kindOf(X)!=="object")return!1;const L=getPrototypeOf(X);return(L===null||L===Object.prototype||Object.getPrototypeOf(L)===null)&&!(Symbol.toStringTag in X)&&!(Symbol.iterator in X)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=X=>isObject(X)&&isFunction(X.pipe),isFormData=X=>{let L;return X&&(typeof FormData=="function"&&X instanceof FormData||isFunction(X.append)&&((L=kindOf(X))==="formdata"||L==="object"&&isFunction(X.toString)&&X.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=X=>X.trim?X.trim():X.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(X,L,{allOwnKeys:G=!1}={}){if(X===null||typeof X>"u")return;let V,K;if(typeof X!="object"&&(X=[X]),isArray(X))for(V=0,K=X.length;V<K;V++)L.call(null,X[V],V,X);else{const Z=G?Object.getOwnPropertyNames(X):Object.keys(X),Q=Z.length;let B;for(V=0;V<Q;V++)B=Z[V],L.call(null,X[B],B,X)}}function findKey(X,L){L=L.toLowerCase();const G=Object.keys(X);let V=G.length,K;for(;V-- >0;)if(K=G[V],L===K.toLowerCase())return K;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=X=>!isUndefined(X)&&X!==_global;function merge(){const{caseless:X}=isContextDefined(this)&&this||{},L={},G=(V,K)=>{const Z=X&&findKey(L,K)||K;isPlainObject(L[Z])&&isPlainObject(V)?L[Z]=merge(L[Z],V):isPlainObject(V)?L[Z]=merge({},V):isArray(V)?L[Z]=V.slice():L[Z]=V};for(let V=0,K=arguments.length;V<K;V++)arguments[V]&&forEach(arguments[V],G);return L}const extend=(X,L,G,{allOwnKeys:V}={})=>(forEach(L,(K,Z)=>{G&&isFunction(K)?X[Z]=bind(K,G):X[Z]=K},{allOwnKeys:V}),X),stripBOM=X=>(X.charCodeAt(0)===65279&&(X=X.slice(1)),X),inherits=(X,L,G,V)=>{X.prototype=Object.create(L.prototype,V),X.prototype.constructor=X,Object.defineProperty(X,"super",{value:L.prototype}),G&&Object.assign(X.prototype,G)},toFlatObject=(X,L,G,V)=>{let K,Z,Q;const B={};if(L=L||{},X==null)return L;do{for(K=Object.getOwnPropertyNames(X),Z=K.length;Z-- >0;)Q=K[Z],(!V||V(Q,X,L))&&!B[Q]&&(L[Q]=X[Q],B[Q]=!0);X=G!==!1&&getPrototypeOf(X)}while(X&&(!G||G(X,L))&&X!==Object.prototype);return L},endsWith=(X,L,G)=>{X=String(X),(G===void 0||G>X.length)&&(G=X.length),G-=L.length;const V=X.indexOf(L,G);return V!==-1&&V===G},toArray=X=>{if(!X)return null;if(isArray(X))return X;let L=X.length;if(!isNumber(L))return null;const G=new Array(L);for(;L-- >0;)G[L]=X[L];return G},isTypedArray=(X=>L=>X&&L instanceof X)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(X,L)=>{const V=(X&&X[Symbol.iterator]).call(X);let K;for(;(K=V.next())&&!K.done;){const Z=K.value;L.call(X,Z[0],Z[1])}},matchAll=(X,L)=>{let G;const V=[];for(;(G=X.exec(L))!==null;)V.push(G);return V},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=X=>X.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(G,V,K){return V.toUpperCase()+K}),hasOwnProperty=(({hasOwnProperty:X})=>(L,G)=>X.call(L,G))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(X,L)=>{const G=Object.getOwnPropertyDescriptors(X),V={};forEach(G,(K,Z)=>{let Q;(Q=L(K,Z,X))!==!1&&(V[Z]=Q||K)}),Object.defineProperties(X,V)},freezeMethods=X=>{reduceDescriptors(X,(L,G)=>{if(isFunction(X)&&["arguments","caller","callee"].indexOf(G)!==-1)return!1;const V=X[G];if(isFunction(V)){if(L.enumerable=!1,"writable"in L){L.writable=!1;return}L.set||(L.set=()=>{throw Error("Can not rewrite read-only method '"+G+"'")})}})},toObjectSet=(X,L)=>{const G={},V=K=>{K.forEach(Z=>{G[Z]=!0})};return isArray(X)?V(X):V(String(X).split(L)),G},noop=()=>{},toFiniteNumber=(X,L)=>(X=+X,Number.isFinite(X)?X:L),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(X=16,L=ALPHABET.ALPHA_DIGIT)=>{let G="";const{length:V}=L;for(;X--;)G+=L[Math.random()*V|0];return G};function isSpecCompliantForm(X){return!!(X&&isFunction(X.append)&&X[Symbol.toStringTag]==="FormData"&&X[Symbol.iterator])}const toJSONObject=X=>{const L=new Array(10),G=(V,K)=>{if(isObject(V)){if(L.indexOf(V)>=0)return;if(!("toJSON"in V)){L[K]=V;const Z=isArray(V)?[]:{};return forEach(V,(Q,B)=>{const E=G(Q,K+1);!isUndefined(E)&&(Z[B]=E)}),L[K]=void 0,Z}}return V};return G(X,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=X=>X&&(isObject(X)||isFunction(X))&&isFunction(X.then)&&isFunction(X.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(X,L,G,V,K){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=X,this.name="AxiosError",L&&(this.code=L),G&&(this.config=G),V&&(this.request=V),K&&(this.response=K)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(X=>{descriptors[X]={value:X}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(X,L,G,V,K,Z)=>{const Q=Object.create(prototype$1);return utils$1.toFlatObject(X,Q,function(E){return E!==Error.prototype},B=>B!=="isAxiosError"),AxiosError.call(Q,X.message,L,G,V,K),Q.cause=X,Q.name=X.name,Z&&Object.assign(Q,Z),Q};const httpAdapter=null;function isVisitable(X){return utils$1.isPlainObject(X)||utils$1.isArray(X)}function removeBrackets(X){return utils$1.endsWith(X,"[]")?X.slice(0,-2):X}function renderKey(X,L,G){return X?X.concat(L).map(function(K,Z){return K=removeBrackets(K),!G&&Z?"["+K+"]":K}).join(G?".":""):L}function isFlatArray(X){return utils$1.isArray(X)&&!X.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(L){return/^is[A-Z]/.test(L)});function toFormData(X,L,G){if(!utils$1.isObject(X))throw new TypeError("target must be an object");L=L||new FormData,G=utils$1.toFlatObject(G,{metaTokens:!0,dots:!1,indexes:!1},!1,function(F,O){return!utils$1.isUndefined(O[F])});const V=G.metaTokens,K=G.visitor||R,Z=G.dots,Q=G.indexes,E=(G.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(L);if(!utils$1.isFunction(K))throw new TypeError("visitor must be a function");function M(p){if(p===null)return"";if(utils$1.isDate(p))return p.toISOString();if(!E&&utils$1.isBlob(p))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(p)||utils$1.isTypedArray(p)?E&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function R(p,F,O){let q=p;if(p&&!O&&typeof p=="object"){if(utils$1.endsWith(F,"{}"))F=V?F:F.slice(0,-2),p=JSON.stringify(p);else if(utils$1.isArray(p)&&isFlatArray(p)||(utils$1.isFileList(p)||utils$1.endsWith(F,"[]"))&&(q=utils$1.toArray(p)))return F=removeBrackets(F),q.forEach(function(U,Y){!(utils$1.isUndefined(U)||U===null)&&L.append(Q===!0?renderKey([F],Y,Z):Q===null?F:F+"[]",M(U))}),!1}return isVisitable(p)?!0:(L.append(renderKey(O,F,Z),M(p)),!1)}const o=[],S=Object.assign(predicates,{defaultVisitor:R,convertValue:M,isVisitable});function l(p,F){if(!utils$1.isUndefined(p)){if(o.indexOf(p)!==-1)throw Error("Circular reference detected in "+F.join("."));o.push(p),utils$1.forEach(p,function(q,W){(!(utils$1.isUndefined(q)||q===null)&&K.call(L,q,utils$1.isString(W)?W.trim():W,F,S))===!0&&l(q,F?F.concat(W):[W])}),o.pop()}}if(!utils$1.isObject(X))throw new TypeError("data must be an object");return l(X),L}function encode$1(X){const L={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(X).replace(/[!'()~]|%20|%00/g,function(V){return L[V]})}function AxiosURLSearchParams(X,L){this._pairs=[],X&&toFormData(X,this,L)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(L,G){this._pairs.push([L,G])};prototype.toString=function(L){const G=L?function(V){return L.call(this,V,encode$1)}:encode$1;return this._pairs.map(function(K){return G(K[0])+"="+G(K[1])},"").join("&")};function encode(X){return encodeURIComponent(X).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(X,L,G){if(!L)return X;const V=G&&G.encode||encode,K=G&&G.serialize;let Z;if(K?Z=K(L,G):Z=utils$1.isURLSearchParams(L)?L.toString():new AxiosURLSearchParams(L,G).toString(V),Z){const Q=X.indexOf("#");Q!==-1&&(X=X.slice(0,Q)),X+=(X.indexOf("?")===-1?"?":"&")+Z}return X}class InterceptorManager{constructor(){this.handlers=[]}use(L,G,V){return this.handlers.push({fulfilled:L,rejected:G,synchronous:V?V.synchronous:!1,runWhen:V?V.runWhen:null}),this.handlers.length-1}eject(L){this.handlers[L]&&(this.handlers[L]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(L){utils$1.forEach(this.handlers,function(V){V!==null&&L(V)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(X=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(X)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(X,L){return toFormData(X,new platform.classes.URLSearchParams,Object.assign({visitor:function(G,V,K,Z){return platform.isNode&&utils$1.isBuffer(G)?(this.append(V,G.toString("base64")),!1):Z.defaultVisitor.apply(this,arguments)}},L))}function parsePropPath(X){return utils$1.matchAll(/\w+|\[(\w*)]/g,X).map(L=>L[0]==="[]"?"":L[1]||L[0])}function arrayToObject(X){const L={},G=Object.keys(X);let V;const K=G.length;let Z;for(V=0;V<K;V++)Z=G[V],L[Z]=X[Z];return L}function formDataToJSON(X){function L(G,V,K,Z){let Q=G[Z++];if(Q==="__proto__")return!0;const B=Number.isFinite(+Q),E=Z>=G.length;return Q=!Q&&utils$1.isArray(K)?K.length:Q,E?(utils$1.hasOwnProp(K,Q)?K[Q]=[K[Q],V]:K[Q]=V,!B):((!K[Q]||!utils$1.isObject(K[Q]))&&(K[Q]=[]),L(G,V,K[Q],Z)&&utils$1.isArray(K[Q])&&(K[Q]=arrayToObject(K[Q])),!B)}if(utils$1.isFormData(X)&&utils$1.isFunction(X.entries)){const G={};return utils$1.forEachEntry(X,(V,K)=>{L(parsePropPath(V),K,G,0)}),G}return null}function stringifySafely(X,L,G){if(utils$1.isString(X))try{return(L||JSON.parse)(X),utils$1.trim(X)}catch(V){if(V.name!=="SyntaxError")throw V}return(G||JSON.stringify)(X)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(L,G){const V=G.getContentType()||"",K=V.indexOf("application/json")>-1,Z=utils$1.isObject(L);if(Z&&utils$1.isHTMLForm(L)&&(L=new FormData(L)),utils$1.isFormData(L))return K?JSON.stringify(formDataToJSON(L)):L;if(utils$1.isArrayBuffer(L)||utils$1.isBuffer(L)||utils$1.isStream(L)||utils$1.isFile(L)||utils$1.isBlob(L))return L;if(utils$1.isArrayBufferView(L))return L.buffer;if(utils$1.isURLSearchParams(L))return G.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),L.toString();let B;if(Z){if(V.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(L,this.formSerializer).toString();if((B=utils$1.isFileList(L))||V.indexOf("multipart/form-data")>-1){const E=this.env&&this.env.FormData;return toFormData(B?{"files[]":L}:L,E&&new E,this.formSerializer)}}return Z||K?(G.setContentType("application/json",!1),stringifySafely(L)):L}],transformResponse:[function(L){const G=this.transitional||defaults.transitional,V=G&&G.forcedJSONParsing,K=this.responseType==="json";if(L&&utils$1.isString(L)&&(V&&!this.responseType||K)){const Q=!(G&&G.silentJSONParsing)&&K;try{return JSON.parse(L)}catch(B){if(Q)throw B.name==="SyntaxError"?AxiosError.from(B,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):B}}return L}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(L){return L>=200&&L<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],X=>{defaults.headers[X]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=X=>{const L={};let G,V,K;return X&&X.split(`
`).forEach(function(Q){K=Q.indexOf(":"),G=Q.substring(0,K).trim().toLowerCase(),V=Q.substring(K+1).trim(),!(!G||L[G]&&ignoreDuplicateOf[G])&&(G==="set-cookie"?L[G]?L[G].push(V):L[G]=[V]:L[G]=L[G]?L[G]+", "+V:V)}),L},$internals=Symbol("internals");function normalizeHeader(X){return X&&String(X).trim().toLowerCase()}function normalizeValue(X){return X===!1||X==null?X:utils$1.isArray(X)?X.map(normalizeValue):String(X)}function parseTokens(X){const L=Object.create(null),G=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let V;for(;V=G.exec(X);)L[V[1]]=V[2];return L}const isValidHeaderName=X=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(X.trim());function matchHeaderValue(X,L,G,V,K){if(utils$1.isFunction(V))return V.call(this,L,G);if(K&&(L=G),!!utils$1.isString(L)){if(utils$1.isString(V))return L.indexOf(V)!==-1;if(utils$1.isRegExp(V))return V.test(L)}}function formatHeader(X){return X.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(L,G,V)=>G.toUpperCase()+V)}function buildAccessors(X,L){const G=utils$1.toCamelCase(" "+L);["get","set","has"].forEach(V=>{Object.defineProperty(X,V+G,{value:function(K,Z,Q){return this[V].call(this,L,K,Z,Q)},configurable:!0})})}class AxiosHeaders{constructor(L){L&&this.set(L)}set(L,G,V){const K=this;function Z(B,E,M){const R=normalizeHeader(E);if(!R)throw new Error("header name must be a non-empty string");const o=utils$1.findKey(K,R);(!o||K[o]===void 0||M===!0||M===void 0&&K[o]!==!1)&&(K[o||E]=normalizeValue(B))}const Q=(B,E)=>utils$1.forEach(B,(M,R)=>Z(M,R,E));return utils$1.isPlainObject(L)||L instanceof this.constructor?Q(L,G):utils$1.isString(L)&&(L=L.trim())&&!isValidHeaderName(L)?Q(parseHeaders(L),G):L!=null&&Z(G,L,V),this}get(L,G){if(L=normalizeHeader(L),L){const V=utils$1.findKey(this,L);if(V){const K=this[V];if(!G)return K;if(G===!0)return parseTokens(K);if(utils$1.isFunction(G))return G.call(this,K,V);if(utils$1.isRegExp(G))return G.exec(K);throw new TypeError("parser must be boolean|regexp|function")}}}has(L,G){if(L=normalizeHeader(L),L){const V=utils$1.findKey(this,L);return!!(V&&this[V]!==void 0&&(!G||matchHeaderValue(this,this[V],V,G)))}return!1}delete(L,G){const V=this;let K=!1;function Z(Q){if(Q=normalizeHeader(Q),Q){const B=utils$1.findKey(V,Q);B&&(!G||matchHeaderValue(V,V[B],B,G))&&(delete V[B],K=!0)}}return utils$1.isArray(L)?L.forEach(Z):Z(L),K}clear(L){const G=Object.keys(this);let V=G.length,K=!1;for(;V--;){const Z=G[V];(!L||matchHeaderValue(this,this[Z],Z,L,!0))&&(delete this[Z],K=!0)}return K}normalize(L){const G=this,V={};return utils$1.forEach(this,(K,Z)=>{const Q=utils$1.findKey(V,Z);if(Q){G[Q]=normalizeValue(K),delete G[Z];return}const B=L?formatHeader(Z):String(Z).trim();B!==Z&&delete G[Z],G[B]=normalizeValue(K),V[B]=!0}),this}concat(...L){return this.constructor.concat(this,...L)}toJSON(L){const G=Object.create(null);return utils$1.forEach(this,(V,K)=>{V!=null&&V!==!1&&(G[K]=L&&utils$1.isArray(V)?V.join(", "):V)}),G}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([L,G])=>L+": "+G).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(L){return L instanceof this?L:new this(L)}static concat(L,...G){const V=new this(L);return G.forEach(K=>V.set(K)),V}static accessor(L){const V=(this[$internals]=this[$internals]={accessors:{}}).accessors,K=this.prototype;function Z(Q){const B=normalizeHeader(Q);V[B]||(buildAccessors(K,Q),V[B]=!0)}return utils$1.isArray(L)?L.forEach(Z):Z(L),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:X},L)=>{let G=L[0].toUpperCase()+L.slice(1);return{get:()=>X,set(V){this[G]=V}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(X,L){const G=this||defaults$1,V=L||G,K=AxiosHeaders$1.from(V.headers);let Z=V.data;return utils$1.forEach(X,function(B){Z=B.call(G,Z,K.normalize(),L?L.status:void 0)}),K.normalize(),Z}function isCancel(X){return!!(X&&X.__CANCEL__)}function CanceledError(X,L,G){AxiosError.call(this,X??"canceled",AxiosError.ERR_CANCELED,L,G),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(X,L,G){const V=G.config.validateStatus;!G.status||!V||V(G.status)?X(G):L(new AxiosError("Request failed with status code "+G.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(G.status/100)-4],G.config,G.request,G))}const cookies=platform.hasStandardBrowserEnv?{write(X,L,G,V,K,Z){const Q=[X+"="+encodeURIComponent(L)];utils$1.isNumber(G)&&Q.push("expires="+new Date(G).toGMTString()),utils$1.isString(V)&&Q.push("path="+V),utils$1.isString(K)&&Q.push("domain="+K),Z===!0&&Q.push("secure"),document.cookie=Q.join("; ")},read(X){const L=document.cookie.match(new RegExp("(^|;\\s*)("+X+")=([^;]*)"));return L?decodeURIComponent(L[3]):null},remove(X){this.write(X,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(X){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(X)}function combineURLs(X,L){return L?X.replace(/\/?\/$/,"")+"/"+L.replace(/^\/+/,""):X}function buildFullPath(X,L){return X&&!isAbsoluteURL(L)?combineURLs(X,L):L}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const L=/(msie|trident)/i.test(navigator.userAgent),G=document.createElement("a");let V;function K(Z){let Q=Z;return L&&(G.setAttribute("href",Q),Q=G.href),G.setAttribute("href",Q),{href:G.href,protocol:G.protocol?G.protocol.replace(/:$/,""):"",host:G.host,search:G.search?G.search.replace(/^\?/,""):"",hash:G.hash?G.hash.replace(/^#/,""):"",hostname:G.hostname,port:G.port,pathname:G.pathname.charAt(0)==="/"?G.pathname:"/"+G.pathname}}return V=K(window.location.href),function(Q){const B=utils$1.isString(Q)?K(Q):Q;return B.protocol===V.protocol&&B.host===V.host}}():function(){return function(){return!0}}();function parseProtocol(X){const L=/^([-+\w]{1,25})(:?\/\/|:)/.exec(X);return L&&L[1]||""}function speedometer(X,L){X=X||10;const G=new Array(X),V=new Array(X);let K=0,Z=0,Q;return L=L!==void 0?L:1e3,function(E){const M=Date.now(),R=V[Z];Q||(Q=M),G[K]=E,V[K]=M;let o=Z,S=0;for(;o!==K;)S+=G[o++],o=o%X;if(K=(K+1)%X,K===Z&&(Z=(Z+1)%X),M-Q<L)return;const l=R&&M-R;return l?Math.round(S*1e3/l):void 0}}function progressEventReducer(X,L){let G=0;const V=speedometer(50,250);return K=>{const Z=K.loaded,Q=K.lengthComputable?K.total:void 0,B=Z-G,E=V(B),M=Z<=Q;G=Z;const R={loaded:Z,total:Q,progress:Q?Z/Q:void 0,bytes:B,rate:E||void 0,estimated:E&&Q&&M?(Q-Z)/E:void 0,event:K};R[L?"download":"upload"]=!0,X(R)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(X){return new Promise(function(G,V){let K=X.data;const Z=AxiosHeaders$1.from(X.headers).normalize();let{responseType:Q,withXSRFToken:B}=X,E;function M(){X.cancelToken&&X.cancelToken.unsubscribe(E),X.signal&&X.signal.removeEventListener("abort",E)}let R;if(utils$1.isFormData(K)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)Z.setContentType(!1);else if((R=Z.getContentType())!==!1){const[F,...O]=R?R.split(";").map(q=>q.trim()).filter(Boolean):[];Z.setContentType([F||"multipart/form-data",...O].join("; "))}}let o=new XMLHttpRequest;if(X.auth){const F=X.auth.username||"",O=X.auth.password?unescape(encodeURIComponent(X.auth.password)):"";Z.set("Authorization","Basic "+btoa(F+":"+O))}const S=buildFullPath(X.baseURL,X.url);o.open(X.method.toUpperCase(),buildURL(S,X.params,X.paramsSerializer),!0),o.timeout=X.timeout;function l(){if(!o)return;const F=AxiosHeaders$1.from("getAllResponseHeaders"in o&&o.getAllResponseHeaders()),q={data:!Q||Q==="text"||Q==="json"?o.responseText:o.response,status:o.status,statusText:o.statusText,headers:F,config:X,request:o};settle(function(U){G(U),M()},function(U){V(U),M()},q),o=null}if("onloadend"in o?o.onloadend=l:o.onreadystatechange=function(){!o||o.readyState!==4||o.status===0&&!(o.responseURL&&o.responseURL.indexOf("file:")===0)||setTimeout(l)},o.onabort=function(){o&&(V(new AxiosError("Request aborted",AxiosError.ECONNABORTED,X,o)),o=null)},o.onerror=function(){V(new AxiosError("Network Error",AxiosError.ERR_NETWORK,X,o)),o=null},o.ontimeout=function(){let O=X.timeout?"timeout of "+X.timeout+"ms exceeded":"timeout exceeded";const q=X.transitional||transitionalDefaults;X.timeoutErrorMessage&&(O=X.timeoutErrorMessage),V(new AxiosError(O,q.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,X,o)),o=null},platform.hasStandardBrowserEnv&&(B&&utils$1.isFunction(B)&&(B=B(X)),B||B!==!1&&isURLSameOrigin(S))){const F=X.xsrfHeaderName&&X.xsrfCookieName&&cookies.read(X.xsrfCookieName);F&&Z.set(X.xsrfHeaderName,F)}K===void 0&&Z.setContentType(null),"setRequestHeader"in o&&utils$1.forEach(Z.toJSON(),function(O,q){o.setRequestHeader(q,O)}),utils$1.isUndefined(X.withCredentials)||(o.withCredentials=!!X.withCredentials),Q&&Q!=="json"&&(o.responseType=X.responseType),typeof X.onDownloadProgress=="function"&&o.addEventListener("progress",progressEventReducer(X.onDownloadProgress,!0)),typeof X.onUploadProgress=="function"&&o.upload&&o.upload.addEventListener("progress",progressEventReducer(X.onUploadProgress)),(X.cancelToken||X.signal)&&(E=F=>{o&&(V(!F||F.type?new CanceledError(null,X,o):F),o.abort(),o=null)},X.cancelToken&&X.cancelToken.subscribe(E),X.signal&&(X.signal.aborted?E():X.signal.addEventListener("abort",E)));const p=parseProtocol(S);if(p&&platform.protocols.indexOf(p)===-1){V(new AxiosError("Unsupported protocol "+p+":",AxiosError.ERR_BAD_REQUEST,X));return}o.send(K||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(X,L)=>{if(X){try{Object.defineProperty(X,"name",{value:L})}catch{}Object.defineProperty(X,"adapterName",{value:L})}});const renderReason=X=>`- ${X}`,isResolvedHandle=X=>utils$1.isFunction(X)||X===null||X===!1,adapters={getAdapter:X=>{X=utils$1.isArray(X)?X:[X];const{length:L}=X;let G,V;const K={};for(let Z=0;Z<L;Z++){G=X[Z];let Q;if(V=G,!isResolvedHandle(G)&&(V=knownAdapters[(Q=String(G)).toLowerCase()],V===void 0))throw new AxiosError(`Unknown adapter '${Q}'`);if(V)break;K[Q||"#"+Z]=V}if(!V){const Z=Object.entries(K).map(([B,E])=>`adapter ${B} `+(E===!1?"is not supported by the environment":"is not available in the build"));let Q=L?Z.length>1?`since :
`+Z.map(renderReason).join(`
`):" "+renderReason(Z[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+Q,"ERR_NOT_SUPPORT")}return V},adapters:knownAdapters};function throwIfCancellationRequested(X){if(X.cancelToken&&X.cancelToken.throwIfRequested(),X.signal&&X.signal.aborted)throw new CanceledError(null,X)}function dispatchRequest(X){return throwIfCancellationRequested(X),X.headers=AxiosHeaders$1.from(X.headers),X.data=transformData.call(X,X.transformRequest),["post","put","patch"].indexOf(X.method)!==-1&&X.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(X.adapter||defaults$1.adapter)(X).then(function(V){return throwIfCancellationRequested(X),V.data=transformData.call(X,X.transformResponse,V),V.headers=AxiosHeaders$1.from(V.headers),V},function(V){return isCancel(V)||(throwIfCancellationRequested(X),V&&V.response&&(V.response.data=transformData.call(X,X.transformResponse,V.response),V.response.headers=AxiosHeaders$1.from(V.response.headers))),Promise.reject(V)})}const headersToObject=X=>X instanceof AxiosHeaders$1?X.toJSON():X;function mergeConfig(X,L){L=L||{};const G={};function V(M,R,o){return utils$1.isPlainObject(M)&&utils$1.isPlainObject(R)?utils$1.merge.call({caseless:o},M,R):utils$1.isPlainObject(R)?utils$1.merge({},R):utils$1.isArray(R)?R.slice():R}function K(M,R,o){if(utils$1.isUndefined(R)){if(!utils$1.isUndefined(M))return V(void 0,M,o)}else return V(M,R,o)}function Z(M,R){if(!utils$1.isUndefined(R))return V(void 0,R)}function Q(M,R){if(utils$1.isUndefined(R)){if(!utils$1.isUndefined(M))return V(void 0,M)}else return V(void 0,R)}function B(M,R,o){if(o in L)return V(M,R);if(o in X)return V(void 0,M)}const E={url:Z,method:Z,data:Z,baseURL:Q,transformRequest:Q,transformResponse:Q,paramsSerializer:Q,timeout:Q,timeoutMessage:Q,withCredentials:Q,withXSRFToken:Q,adapter:Q,responseType:Q,xsrfCookieName:Q,xsrfHeaderName:Q,onUploadProgress:Q,onDownloadProgress:Q,decompress:Q,maxContentLength:Q,maxBodyLength:Q,beforeRedirect:Q,transport:Q,httpAgent:Q,httpsAgent:Q,cancelToken:Q,socketPath:Q,responseEncoding:Q,validateStatus:B,headers:(M,R)=>K(headersToObject(M),headersToObject(R),!0)};return utils$1.forEach(Object.keys(Object.assign({},X,L)),function(R){const o=E[R]||K,S=o(X[R],L[R],R);utils$1.isUndefined(S)&&o!==B||(G[R]=S)}),G}const VERSION="1.6.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((X,L)=>{validators$1[X]=function(V){return typeof V===X||"a"+(L<1?"n ":" ")+X}});const deprecatedWarnings={};validators$1.transitional=function(L,G,V){function K(Z,Q){return"[Axios v"+VERSION+"] Transitional option '"+Z+"'"+Q+(V?". "+V:"")}return(Z,Q,B)=>{if(L===!1)throw new AxiosError(K(Q," has been removed"+(G?" in "+G:"")),AxiosError.ERR_DEPRECATED);return G&&!deprecatedWarnings[Q]&&(deprecatedWarnings[Q]=!0,console.warn(K(Q," has been deprecated since v"+G+" and will be removed in the near future"))),L?L(Z,Q,B):!0}};function assertOptions(X,L,G){if(typeof X!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const V=Object.keys(X);let K=V.length;for(;K-- >0;){const Z=V[K],Q=L[Z];if(Q){const B=X[Z],E=B===void 0||Q(B,Z,X);if(E!==!0)throw new AxiosError("option "+Z+" must be "+E,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(G!==!0)throw new AxiosError("Unknown option "+Z,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(L){this.defaults=L,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}async request(L,G){try{return await this._request(L,G)}catch(V){if(V instanceof Error){let K;Error.captureStackTrace?Error.captureStackTrace(K={}):K=new Error;const Z=K.stack?K.stack.replace(/^.+\n/,""):"";V.stack?Z&&!String(V.stack).endsWith(Z.replace(/^.+\n.+\n/,""))&&(V.stack+=`
`+Z):V.stack=Z}throw V}}_request(L,G){typeof L=="string"?(G=G||{},G.url=L):G=L||{},G=mergeConfig(this.defaults,G);const{transitional:V,paramsSerializer:K,headers:Z}=G;V!==void 0&&validator.assertOptions(V,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),K!=null&&(utils$1.isFunction(K)?G.paramsSerializer={serialize:K}:validator.assertOptions(K,{encode:validators.function,serialize:validators.function},!0)),G.method=(G.method||this.defaults.method||"get").toLowerCase();let Q=Z&&utils$1.merge(Z.common,Z[G.method]);Z&&utils$1.forEach(["delete","get","head","post","put","patch","common"],p=>{delete Z[p]}),G.headers=AxiosHeaders$1.concat(Q,Z);const B=[];let E=!0;this.interceptors.request.forEach(function(F){typeof F.runWhen=="function"&&F.runWhen(G)===!1||(E=E&&F.synchronous,B.unshift(F.fulfilled,F.rejected))});const M=[];this.interceptors.response.forEach(function(F){M.push(F.fulfilled,F.rejected)});let R,o=0,S;if(!E){const p=[dispatchRequest.bind(this),void 0];for(p.unshift.apply(p,B),p.push.apply(p,M),S=p.length,R=Promise.resolve(G);o<S;)R=R.then(p[o++],p[o++]);return R}S=B.length;let l=G;for(o=0;o<S;){const p=B[o++],F=B[o++];try{l=p(l)}catch(O){F.call(this,O);break}}try{R=dispatchRequest.call(this,l)}catch(p){return Promise.reject(p)}for(o=0,S=M.length;o<S;)R=R.then(M[o++],M[o++]);return R}getUri(L){L=mergeConfig(this.defaults,L);const G=buildFullPath(L.baseURL,L.url);return buildURL(G,L.params,L.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(L){Axios.prototype[L]=function(G,V){return this.request(mergeConfig(V||{},{method:L,url:G,data:(V||{}).data}))}});utils$1.forEach(["post","put","patch"],function(L){function G(V){return function(Z,Q,B){return this.request(mergeConfig(B||{},{method:L,headers:V?{"Content-Type":"multipart/form-data"}:{},url:Z,data:Q}))}}Axios.prototype[L]=G(),Axios.prototype[L+"Form"]=G(!0)});const Axios$1=Axios;class CancelToken{constructor(L){if(typeof L!="function")throw new TypeError("executor must be a function.");let G;this.promise=new Promise(function(Z){G=Z});const V=this;this.promise.then(K=>{if(!V._listeners)return;let Z=V._listeners.length;for(;Z-- >0;)V._listeners[Z](K);V._listeners=null}),this.promise.then=K=>{let Z;const Q=new Promise(B=>{V.subscribe(B),Z=B}).then(K);return Q.cancel=function(){V.unsubscribe(Z)},Q},L(function(Z,Q,B){V.reason||(V.reason=new CanceledError(Z,Q,B),G(V.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(L){if(this.reason){L(this.reason);return}this._listeners?this._listeners.push(L):this._listeners=[L]}unsubscribe(L){if(!this._listeners)return;const G=this._listeners.indexOf(L);G!==-1&&this._listeners.splice(G,1)}static source(){let L;return{token:new CancelToken(function(K){L=K}),cancel:L}}}const CancelToken$1=CancelToken;function spread(X){return function(G){return X.apply(null,G)}}function isAxiosError(X){return utils$1.isObject(X)&&X.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([X,L])=>{HttpStatusCode[L]=X});const HttpStatusCode$1=HttpStatusCode;function createInstance(X){const L=new Axios$1(X),G=bind(Axios$1.prototype.request,L);return utils$1.extend(G,Axios$1.prototype,L,{allOwnKeys:!0}),utils$1.extend(G,L,null,{allOwnKeys:!0}),G.create=function(K){return createInstance(mergeConfig(X,K))},G}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(L){return Promise.all(L)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=X=>formDataToJSON(utils$1.isHTMLForm(X)?new FormData(X):X);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios,convertRGBtoHex=(X,L,G)=>{const V=ColorChannelToHex(X),K=ColorChannelToHex(L),Z=ColorChannelToHex(G);return`#${V}${K}${Z}`},rgbToHex=X=>{let L=X.replace("rgb(","").replace(")","").split(","),G=parseInt(L[0],10),V=parseInt(L[1],10),K=parseInt(L[2],10);return G=G.toString(16),V=V.toString(16),K=K.toString(16),G.length<2&&(G="0"+G),V.length<2&&(V="0"+V),K.length<2&&(K="0"+K),"#"+G+V+K},hexToRgb=X=>{X=X.replace(/^#/,"");let L=parseInt(X,16),G=L>>16&255,V=L>>8&255,K=L&255;return`rgb(${G}, ${V}, ${K})`},hexToHsl=X=>{X=X.replace(/^#/,"");let L=parseInt(X,16),G=L>>16&255,V=L>>8&255,K=L&255;G/=255,V/=255,K/=255;let Z=Math.max(G,V,K),Q=Math.min(G,V,K),B,E,M=(Z+Q)/2;if(Z==Q)B=E=0;else{let R=Z-Q;switch(E=M>.5?R/(2-Z-Q):R/(Z+Q),Z){case G:B=(V-K)/R+(V<K?6:0);break;case V:B=(K-G)/R+2;break;case K:B=(G-V)/R+4;break}B/=6}return B=Math.round(B*360),E=Math.round(E*100),M=Math.round(M*100),`hsl(${B}, ${E}%, ${M}%)`},rgbaToHex=X=>{const L=X.toString().match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)$/);if(!L)return"HEX";const G=parseInt(L[1]),V=parseInt(L[2]),K=parseInt(L[3]),Z=B=>{const E=B.toString(16);return E.length==1?"0"+E:E};return"#"+Z(G)+Z(V)+Z(K)},ColorChannelToHex=X=>{const L=X==null?void 0:X.toString(16);return(L==null?void 0:L.length)===1?"0"+L:L};function rotateReset(X){if(X)if(X._objects){(X==null?void 0:X.getObjects()).forEach(V=>{const K=V.getCenterPoint();V.set("angle",0),V.set("matrix",[1,0,0,1,0,0]),V.set({originX:"center",originY:"center"}),V.setPositionByOrigin(new fabric.Point(K.x,K.y),"center","center")});const G=X.getCenterPoint();X.setPositionByOrigin(new fabric.Point(G.x,G.y),"center","center")}else{const L=X.getCenterPoint();X.set("angle",0),X.set("matrix",[1,0,0,1,0,0]),X.set({originX:"center",originY:"center"}),X.setPositionByOrigin(new fabric.Point(L.x,L.y),"center","center")}}var toastify$1={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */(function(X){(function(L,G){X.exports?X.exports=G():L.Toastify=G()})(commonjsGlobal,function(L){var G=function(Q){return new G.lib.init(Q)},V="1.12.0";G.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},G.lib=G.prototype={toastify:V,constructor:G,init:function(Q){return Q||(Q={}),this.options={},this.toastElement=null,this.options.text=Q.text||G.defaults.text,this.options.node=Q.node||G.defaults.node,this.options.duration=Q.duration===0?0:Q.duration||G.defaults.duration,this.options.selector=Q.selector||G.defaults.selector,this.options.callback=Q.callback||G.defaults.callback,this.options.destination=Q.destination||G.defaults.destination,this.options.newWindow=Q.newWindow||G.defaults.newWindow,this.options.close=Q.close||G.defaults.close,this.options.gravity=Q.gravity==="bottom"?"toastify-bottom":G.defaults.gravity,this.options.positionLeft=Q.positionLeft||G.defaults.positionLeft,this.options.position=Q.position||G.defaults.position,this.options.backgroundColor=Q.backgroundColor||G.defaults.backgroundColor,this.options.avatar=Q.avatar||G.defaults.avatar,this.options.className=Q.className||G.defaults.className,this.options.stopOnFocus=Q.stopOnFocus===void 0?G.defaults.stopOnFocus:Q.stopOnFocus,this.options.onClick=Q.onClick||G.defaults.onClick,this.options.offset=Q.offset||G.defaults.offset,this.options.escapeMarkup=Q.escapeMarkup!==void 0?Q.escapeMarkup:G.defaults.escapeMarkup,this.options.ariaLive=Q.ariaLive||G.defaults.ariaLive,this.options.style=Q.style||G.defaults.style,Q.backgroundColor&&(this.options.style.background=Q.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var Q=document.createElement("div");Q.className="toastify on "+this.options.className,this.options.position?Q.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(Q.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):Q.className+=" toastify-right",Q.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var B in this.options.style)Q.style[B]=this.options.style[B];if(this.options.ariaLive&&Q.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)Q.appendChild(this.options.node);else if(this.options.escapeMarkup?Q.innerText=this.options.text:Q.innerHTML=this.options.text,this.options.avatar!==""){var E=document.createElement("img");E.src=this.options.avatar,E.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?Q.appendChild(E):Q.insertAdjacentElement("afterbegin",E)}if(this.options.close===!0){var M=document.createElement("button");M.type="button",M.setAttribute("aria-label","Close"),M.className="toast-close",M.innerHTML="&#10006;",M.addEventListener("click",(function(O){O.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var R=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&R>360?Q.insertAdjacentElement("afterbegin",M):Q.appendChild(M)}if(this.options.stopOnFocus&&this.options.duration>0){var o=this;Q.addEventListener("mouseover",function(O){window.clearTimeout(Q.timeOutValue)}),Q.addEventListener("mouseleave",function(){Q.timeOutValue=window.setTimeout(function(){o.removeElement(Q)},o.options.duration)})}if(typeof this.options.destination<"u"&&Q.addEventListener("click",(function(O){O.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&Q.addEventListener("click",(function(O){O.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var S=K("x",this.options),l=K("y",this.options),p=this.options.position=="left"?S:"-"+S,F=this.options.gravity=="toastify-top"?l:"-"+l;Q.style.transform="translate("+p+","+F+")"}return Q},showToast:function(){this.toastElement=this.buildToast();var Q;if(typeof this.options.selector=="string"?Q=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?Q=this.options.selector:Q=document.body,!Q)throw"Root element is not defined";var B=G.defaults.oldestFirst?Q.firstChild:Q.lastChild;return Q.insertBefore(this.toastElement,B),G.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(Q){Q.className=Q.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),Q.parentNode&&Q.parentNode.removeChild(Q),this.options.callback.call(Q),G.reposition()}).bind(this),400)}},G.reposition=function(){for(var Q={top:15,bottom:15},B={top:15,bottom:15},E={top:15,bottom:15},M=document.getElementsByClassName("toastify"),R,o=0;o<M.length;o++){Z(M[o],"toastify-top")===!0?R="toastify-top":R="toastify-bottom";var S=M[o].offsetHeight;R=R.substr(9,R.length-1);var l=15,p=window.innerWidth>0?window.innerWidth:screen.width;p<=360?(M[o].style[R]=E[R]+"px",E[R]+=S+l):Z(M[o],"toastify-left")===!0?(M[o].style[R]=Q[R]+"px",Q[R]+=S+l):(M[o].style[R]=B[R]+"px",B[R]+=S+l)}return this};function K(Q,B){return B.offset[Q]?isNaN(B.offset[Q])?B.offset[Q]:B.offset[Q]+"px":"0px"}function Z(Q,B){return!Q||typeof B!="string"?!1:!!(Q.className&&Q.className.trim().split(/\s+/gi).indexOf(B)>-1)}return G.lib.init.prototype=G.lib,G})})(toastify$1);var toastifyExports=toastify$1.exports;const Toastify=getDefaultExportFromCjs(toastifyExports),toastify="",toastNotification$1=X=>Toastify({text:X,duration:3e3,newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{background:"var(--gold)",color:"#ffffff",borderRadius:"8px",cursor:"context-menu"},onClick:null}).showToast(),querySelect$2=X=>document.querySelector(X);function getTextCase(X){return X===X.toUpperCase()?"Uppercase":X===X.toLowerCase()?"Lowercase":X===X.charAt(0).toUpperCase()+X.slice(1).toLowerCase()?"Sentence Case":"Title Case"}async function saveCanvas(X,L,G,V,K,Z,Q=!1){var M,R;const B=L.get("backgroundColor");L.setBackgroundImage(null),L.setBackgroundColor(null,L.renderAll.bind(L)),console.log("Save function triggered");const E=L.toSVG();if(E){const o=F=>{if(!F)return null;const{blur:O,offsetX:q,offsetY:W}=F,U=[O??0,q??0,W??0],Y=U.join(",");for(let J=0;J<U.length;J++)if(U[J]===U[J+1])return"0";return Y},S=V.get("fill"),l=K.get("fill"),p={buyer_logo_id:(M=querySelect$2("#buyer_logo_id"))==null?void 0:M.value,buyer_id:(R=querySelect$2("#buyer_Id"))==null?void 0:R.value,logo_id:X,brand_name:querySelect$2("#logoMainField").value,slogan:querySelect$2("#sloganNameField").value,svg_data:E,logo_position:Z,logo_backgroundcolor:B==="#efefef"?"transparent":B,brandName_color:S.includes("#")?S:rgbToHex(S),brandName_fontFamely:V.get("fontFamily"),brandName_fontSize:V.get("fontSize"),brandName_letterCase:getTextCase(V.text),brandName_fontStyle:V.get("fontStyle"),brandName_letterSpace:V.get("charSpacing")/10,brandName_droupShadow:o(V.get("shadow")),slogan_color:l.includes("#")?l:rgbToHex(l),slogan_fontFamely:K.get("fontFamily"),slogan_fontSize:K.get("fontSize"),slogan_letterCase:getTextCase(K.text),slogan_fontStyle:K.get("fontStyle"),slogan_letterSpace:K.get("charSpacing")/10,slogan_droupShadow:o(K.get("shadow"))};console.log(p);try{const F=await axios$1.post("https://www.mybrande.com/api/buyer/logo/store",p);if((F==null?void 0:F.status)===200){const{buyer_logo_id:O}=F.data;if(!O)return toastNotification$1("Error encountered with buyer logo ID");querySelect$2("#buyer_logo_id").value=O,Q?location.href=`https://www.mybrande.com/api/buyer/logo/downloadandpayment/${O}`:window.location.href=`https://www.mybrande.com/api/user/logo/preview/${O}`,toastNotification$1("Logo Saved Successfully")}}catch(F){console.log(F)}}}const querySelect$1=X=>document.querySelector(X),centerAndResizeElements=(X,L,G,V,K,Z,Q=!1,B,E,M)=>{const R=B==null?void 0:B.getObjects();E.charSpacing=0,M.charSpacing=0;const o=R.filter(l=>!l.text&&l.id!=="external_layer"),S=5;switch(X){case"topBottom":setTimeout(()=>{const l=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#logoMainField").value.toLowerCase()),p=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#sloganNameField").value.toLowerCase());if(l==null||l.set("fontSize",L),p==null||p.set("fontSize",G),l==null||l.set("charSpacing",0),p==null||p.set("charSpacing",0),l==null||l.centerH(),p==null||p.centerH(),l==null||l.set("top",B.height/Z),p==null||p.set("top",B.height/K),Q){l.text=toTitleCase(l.text),p.text=toSentenceCase(p.text),l==null||l.set("fontFamily","Poppins"),p==null||p.set("fontFamily","Poppins");const O=l.width;p==null||p.set("width",O),p==null||p.set("charSpacing",322),p==null||p.set("fontSize",27)}l==null||l.centerH(),p==null||p.centerH();const F=new fabric.Group(R);B.viewportCenterObject(F),F.ungroupOnCanvas(),B.requestRenderAll()},S);break;case"bottomTop":setTimeout(()=>{const l=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#logoMainField").value.toLowerCase()),p=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#sloganNameField").value.toLowerCase());l.set("fontSize",L),p.set("fontSize",G),l.centerH(),p.centerH(),l.set("top",B.height/Z),p.set("top",B.height/K);const F=new fabric.Group(R);B.viewportCenterObject(F),F.ungroupOnCanvas(),B.requestRenderAll()},S);break;case"leftRight":setTimeout(()=>{const l=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#logoMainField").value.toLowerCase()),p=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#sloganNameField").value.toLowerCase());console.log("Left Right"),l.center(),p.center(),l.set("top",B.height/2.3),p.set("top",B.height/1.9),l.set("fontSize",46),p.set("fontSize",22),l.set("charSpacing",0),p.set("charSpacing",0),V==="left"?(l.viewportCenter(),p.viewportCenter(),console.log("left"),l.set("top",B.height/2.3),p.set("top",B.height/1.9),l.set("left",B.width/2.4),p.set("left",l.left)):(console.log("center"),l.viewportCenterH(),p.viewportCenterH(),l.text.length<=40?(l.set("left",B.width-570),p.set("left",l.left+l.width/2-p.width/2)):l.text.length<=30?(l.set("left",B.width-500),p.set("left",l.left+l.width/2-p.width/2)):(l.set("left",B.width/2.5),p.set("left",l.left+l.width/2-p.width/2))),Q&&(l.text=toTitleCase(l.text),p.text=toSentenceCase(p.text),l.set("fontFamily","Poppins"),p.set("fontFamily","Poppins"),p.set("charSpacing",322),p.set("fontSize",27),p.set("left",l.left+l.width/2-p.width/2)),o.forEach(O=>O.left-=200);const F=new fabric.Group(R);B.viewportCenterObjectH(F),B.viewportCenterObjectV(F),F.ungroupOnCanvas(),B.requestRenderAll()},S);break;case"rightLeft":setTimeout(()=>{const l=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#logoMainField").value.toLowerCase()),p=R.find(O=>O.type==="text"&&O.text.toLowerCase()===querySelect$1("#sloganNameField").value.toLowerCase());console.log("rightLeft"),l.center(),p.center(),l.set("top",B.height/2.3),p.set("top",B.height/1.9),l.set("fontSize",46),p.set("fontSize",22),l.set("charSpacing",0),p.set("charSpacing",0),V==="left"?(l.viewportCenter(),p.viewportCenter(),l.set("top",B.height/2.3),p.set("top",B.height/1.9),l.set("left",B.width/6),p.set("left",l.left+l.width-p.width),Q&&(l.text=toTitleCase(l.text),p.text=toSentenceCase(p.text),l.set("fontFamily","Poppins"),p.set("fontFamily","Poppins"),p.set("charSpacing",322),p.set("fontSize",27),p.set("left",l.left+l.width-p.width))):(console.log("center"),l.viewportCenterH(),p.viewportCenterH(),l.text.length<=20?(l.set("left",B.width/6),p.set("left",l.left+l.width/2.5-p.width/2.5)):l.text.length<=30?(console.log("<= 30"),l.set("left",B.width/14),p.set("left",l.left+l.width/2.5-p.width/2.5)):l.text.length<=40?(console.log("40"),l.set("left",-200),p.set("left",l.left+l.width/2.5-p.width/2.5)):(l.set("left",B.width/6),p.set("left",l.left+l.width/2-p.width/2))),o.forEach(O=>{O.left+=150,O.top+=40});const F=new fabric.Group(R);B.viewportCenterObjectH(F),B.viewportCenterObjectV(F),F.ungroupOnCanvas(),B.requestRenderAll()},S);break}B.requestRenderAll()},querySelect=X=>document.querySelector(X),querySelectAll=X=>document.querySelectorAll(X),getAttr=(X,L)=>querySelect(X).getAttribute(L),families=["Poppins:300,400,500,600,700","Inter:300,400,500,600,700","Roboto:400,500,700"];WebFont.load({google:{families},fontloading:()=>querySelect("#loader_font").style.display="block",fontactive:X=>{(X==="Poppins"||X==="Inter"||X==="Roboto")&&(querySelect("#loader_font").style.display="none")}});class EditorScreen{constructor(){this.canvasBG="#efefef",this.canvas=new fabric$1.fabric.Canvas("c",{backgroundColor:this.canvasBG}),this.magnifier=new fabric$1.fabric.Canvas("magnifier",{backgroundColor:this.canvasBG}),this.textMode=querySelect('.nav-item[data-name="text"]'),this.logoMode=querySelect('.nav-item[data-name="logo"]'),this.uploadsMode=querySelect('.nav-item[data-name="uploads"]'),this.backgroundMode=querySelect('.nav-item[data-name="background"]'),this.previewMode=querySelect('.nav-item[data-name="preview"]'),this.galleryMode=querySelect('.nav-item[data-name="gallery"]'),this.logoName="My Brand Name",this.sloganName="Slogan goes here",this.rotateRange=querySelect("#rotate-bar"),this.saveBtn=querySelect("#save-btn"),this.scaleRange=querySelect("#progress-bar"),this.scaleRangeUploads=querySelect("#progress-bar-uploads"),this.scaleElement=querySelect("#scale-value"),this.flipHorizontal=querySelect("#flip-x"),this.flipVertical=querySelect("#flip-y"),this.activeLayerIndex=null,this.logoFile=localStorage.getItem("logo-file"),this.layers=querySelect("#layers"),this.textLayers=querySelect("#text-layers"),this.rotateValue=null,this.isRotating=!1,this.scaleValue=3,this.urlParams=new URLSearchParams(document.location.search),this.isScaling=null,this.isFlipX=!1,this.isFlipY=!1,this.textcolorPicker=querySelect("#color-picker"),this.logoColorPicker=querySelect("#logo-color-picker"),this.logoColorPicker1=querySelect("#logo-color-picker1"),this.logoColorPicker2=querySelect("#logo-color-picker2"),this.logoNameInput=querySelect("#logoNameInput"),this.sloganNameInput=querySelect("#sloganNameInput"),this.logoSettingsContainer=querySelect(".setting-container"),this.textSettingsContainer=querySelect(".text-settings-container"),this.backgroundSettingsContainer=querySelect(".bg-settings-container"),this.uploadSettingsContainer=querySelect(".uploads-settings-container"),this.textColorPickerContainer=querySelect(".color-picker-container"),this.letterSpacingSlider=querySelect("#letter-spacing-slider"),this.textColorPickerValue="#eeeeee",this.letterSpacing="0",this.textSelector=querySelect("#text-selector"),this.shadowBlurSlider=querySelect("#shadow-blur-slider"),this.shadowOffsetXSlider=querySelect("#shadow-offsetX-slider"),this.shadowOffsetYSlider=querySelect("#shadow-offsetY-slider"),this.logoShadowOffsetXSlider=querySelect("#logo-shadow-offsetX-slider"),this.logoShadowOffsetYSlider=querySelect("#logo-shadow-offsetY-slider"),this.shadowBlur=null,this.shadowOffsetX=null,this.shadowOffsetY=null,this.logoShadowBlur=null,this.logoShadowOffsetX=null,this.logoShadowOffsetY=null,this.textSettingsContainer.style.display="none",this.canvasZoomLevel=1,this.settingsListTitle=querySelect(".setting-list-item__title"),this.caseListTitle=querySelect(".case-list-item__title"),this.fontSizeListTitle=querySelect(".font_size-list-item__title"),this.fontStyleListTitle=querySelect(".font_style-list-item__title"),this.settingsList=querySelect(".setting-list-items-li"),this.fontStyleList=querySelect(".font_style-list-items-li"),this.fontSizeList=querySelect(".font_size-list-items-li"),this.caseList=querySelect(".case-list-items-li"),this.fontSelector=querySelect(".font-selector"),this.textSelectorValue="LogoName",this.logoFillColor=null,this.zoomSlider=querySelect("#zoom-slider"),this.colorMode="Solid",this.activeNavbarSetting="logo",this.initialRotation=null,this.logoOrientation=null,this.alignId=1,querySelect("#logoMainField").addEventListener("input",L=>{const G=L.target.value;params.set("logo",G);const V=url.origin+url.pathname+"?"+params.toString();history.pushState({},"",V)}),querySelect("#sloganNameField").addEventListener("input",L=>{const G=L.target.value;params.set("slogan",G);const V=url.origin+url.pathname+"?"+params.toString();history.pushState({},"",V)}),this.transparentLoader=(L=!0)=>{querySelect("#loader_font").style.display=L?"block":"none",querySelect("#loader_font").style.background="#ffffffbb"},this.rotateObject=()=>{const L=this.canvas.getActiveObject();this.isRotating&&L&&this.rotateValue&&(L.rotate(this.rotateValue),this.canvas.requestRenderAll()),this.isRotating=!1},this.scaleObject=()=>{const L=this.canvas.getActiveObject(),G=L==null?void 0:L.getCenterPoint();this.isScaling&&L&&this.scaleValue&&(L.scale(this.scaleValue),L.setPositionByOrigin(new fabric$1.fabric.Point(G.x,G.y),"center","center"),L.setCoords(),this.canvas.requestRenderAll()),this.isScaling=!1},querySelect("#rotate_reset").addEventListener("click",()=>{const L=this.canvas.getActiveObject();rotateReset(L),this.canvas.renderAll()}),this.shadowChanger=(L,G)=>{(this.textSelectorValue==="SloganName"?L:G).set("shadow",{offsetX:this.shadowOffsetX,offsetY:this.shadowOffsetY,blur:this.shadowBlur})},this.canvas.setBackgroundImage("/static/pattern.png",this.canvas.renderAll.bind(this.canvas),{opacity:.6,originX:"left",originY:"top",top:0,left:0,scaleX:.3,scaleY:.3}),this.canvas.on("after:render",()=>{querySelect("#loader_font").style.display="none"})}initialize(){var ht;const L=()=>{const ee=this.canvas.toDataURL({format:"png",multiplier:.5});querySelect("#magnifier_img").src=ee},G=()=>{this.canvas.setBackgroundImage("/static/pattern.png",this.canvas.renderAll.bind(this.canvas),{opacity:.6,originX:"left",originY:"top",top:0,left:0,scaleX:.3,scaleY:.3})};G(),L(),fabric$1.fabric.Object.prototype.setControlsVisibility({mt:!1,mb:!1,ml:!1,mr:!1,mtr:!1,bl:!0,br:!0,tl:!0,tr:!0}),this.canvas.requestRenderAll(),this.updateActiveNavbar=()=>{querySelectAll(".nav-item").forEach(ee=>{this.activeNavbarSetting.includes(ee.innerText.toLowerCase())?ee.style.backgroundColor="var(--gold-darker)":ee.style.backgroundColor="var(--gold)"})},this.updateActiveNavbar(),this.caseListTitle.addEventListener("click",()=>{this.caseList.classList.contains("show")?this.caseList.classList.remove("show"):this.caseList.classList.add("show"),[Y,oe].forEach(ee=>ee.classList.remove("show"))});const V=ee=>ee.replace(/\w\S*/g,re=>re.charAt(0).toUpperCase()+re.substr(1).toLowerCase()),K=ee=>{const re=[];re.push(ee[0].toUpperCase());for(let le=1;le<ee.length;le++)re.push(ee[le].toLowerCase());return re.join("")};this.caseList.addEventListener("click",ee=>{const re=ee.target.innerText,le=this.canvas.getActiveObject(),_e=le.getCenterPoint(),Oe=le.get("fontFamily"),Ve=le.get("fill"),qe=le.get("selectable"),Ye=le.get("hasRotatingPoint"),Ze=le.get("diameter"),at=le.get("left"),tt=le.get("top"),rt=le.get("flipped"),gt=le.get("fontSize");le.set("fontSize",40);const ft=le==null?void 0:le.text;re==="Uppercase"?le.text=ft.toUpperCase():re==="Lowercase"?le.text=ft.toLowerCase():re==="Title Case"?le.text=V(ft):re==="Sentence Case"&&(le.text=K(ft)),le.set("fontFamily",Oe),le.set("fill",Ve),le.set("selectable",qe),le.set("hasRotatingPoint",Ye),le.set("diameter",Ze),le.set("left",at),le.set("top",tt),le.set("flipped",rt),le.set("fontSize",gt),le.setPositionByOrigin(new fabric$1.fabric.Point(_e.x,_e.y),"center","center"),le.setCoords(),this.canvas.renderAll(),this.caseListTitle.innerText=re;const dt=document.createElement("i");dt.className="fa-solid fa-angle-down",this.caseListTitle.append(dt),this.caseList.classList.remove("show")}),this.fontStyleList.addEventListener("click",ee=>{const re=ee.target.innerText,le=this.canvas.getActiveObject();re==="Normal"?(le.set("fontStyle","normal"),le.set("underline",!1)):re==="Italic"?(le.set("fontStyle","italic"),le.set("underline",!1)):(le.set("fontStyle","normal"),le.set("underline",!0)),this.fontStyleListTitle.innerText=re;const _e=document.createElement("i");_e.className="fa-solid fa-angle-down",this.fontStyleListTitle.append(_e),this.fontStyleList.classList.remove("show"),this.canvas.requestRenderAll()}),this.rotateRange.addEventListener("input",ee=>{this.isRotating=!0,this.rotateValue=parseInt(ee.target.value,10),querySelect("#rotate_info").innerText=`Rotate: ${parseInt(this.rotateValue)}deg`,this.rotateObject()}),this.rotateRange.addEventListener("change",L),querySelect("#rotate-bar-uploads").addEventListener("input",ee=>{this.isRotating=!0,this.rotateValue=parseInt(ee.target.value,10),this.rotateObject()}),this.saveBtn.addEventListener("click",async()=>{var re;if(!this.canvasBG||!p||!F||!this.alignId)return toastNotification("Data Error");const ee=(re=querySelect("#logo_id"))==null?void 0:re.value;saveCanvas(ee,this.canvas,this.canvasBG,p,F,this.alignId)}),querySelect("#save-package").addEventListener("click",()=>{var re;if(!this.canvasBG||!p||!F||!this.alignId)return toastNotification("Data Error");const ee=(re=querySelect("#logo_id"))==null?void 0:re.value;saveCanvas(ee,this.canvas,this.canvasBG,p,F,this.alignId,!0)}),querySelect("#third_page_btn").addEventListener("click",()=>{const ee={format:"jpg",multiplier:1},re=this.canvas.toDataURL(ee);localStorage.setItem("logo-file",re),localStorage.setItem("mainEditorCounter",3),location.reload(),setTimeout(()=>{querySelect("#drag_drop_view").style.display="none",querySelect("#main_editor_view").style.display="none",querySelect("#details_view").style.display="block"},50)}),this.scaleElement.textContent=1,this.scaleRange.addEventListener("input",ee=>{const re=ee.target.value;re&&(this.isScaling<=10&&(this.isScaling=!0),this.scaleValue=parseFloat(re,10)/10,this.scaleObject(),this.scaleElement.textContent=this.scaleValue)}),this.scaleRange.addEventListener("change",L),this.flipHorizontal.addEventListener("change",()=>{const ee=this.canvas.getActiveObject(),re=ee.getCenterPoint();ee&&(this.isFlipX=!this.isFlipX,ee.set("flipX",this.isFlipX),ee.setPositionByOrigin(new fabric$1.fabric.Point(re.x,re.y),"center","center"),ee.setCoords(),this.canvas.renderAll()),L()}),this.flipVertical.addEventListener("change",()=>{const ee=this.canvas.getActiveObject(),re=ee.getCenterPoint();ee&&(this.isFlipY=!this.isFlipY,ee.set("flipY",this.isFlipY),ee.setPositionByOrigin(new fabric$1.fabric.Point(re.x,re.y),"center","center"),ee.setCoords(),this.canvas.renderAll(),L())}),this.layers.addEventListener("click",ee=>{const re=ee.target;this.activeLayerIndex=re.getAttribute("data_layer")||re.parentElement.getAttribute("data_layer"),this.activeLayerIndex&&this.canvas.setActiveObject(this.canvas.item(this.activeLayerIndex)),this.canvas.requestRenderAll()}),this.canvas.on("after:render",()=>{this.rotateObject(),this.scaleObject()});let Z="block",Q="block",B="#fff",E=new iro$1.ColorPicker("#open_picker",{display:Q,width:210,marginTop:20,color:B,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]});const M=ee=>{const re=Array.isArray(ee.get("fill").colorStops)?rgbToHex(ee.get("fill").colorStops[0].color):ee.get("fill");E.color.set(re),Xe()},R=ee=>()=>M(ee),o=()=>{const ee=this.canvas.getActiveObject();this.activeLayerIndex=this.canvas.getObjects().indexOf(ee),!ee.text&&ee.on("mousedown",R(ee)),ee&&querySelectAll(".layer-container").forEach((le,_e)=>{const Oe=le.querySelector(".layer-img"),Ve=le.querySelector(".layer-span");let qe;const Ye=ee.get("fill");typeof Ye=="object"?qe=Ye.colorStops[0].color:Ye&&Ye.includes("#")?qe=Ye:qe=rgbaToHex(Ye),E.color.set(qe),querySelect("#HEX").value=qe;let at=hexToRgb(qe).match(/\d+/g);at&&at.length===3&&(querySelect("#R").value=at[0],querySelect("#G").value=at[1],querySelect("#B").value=at[2]);let rt=hexToHsl(qe).match(/\d+/g);rt&&rt.length===3&&(querySelect("#H").value=rt[0],querySelect("#S").value=rt[1],querySelect("#L").value=rt[2]),_e==this.activeLayerIndex?(Ve.scrollIntoView({block:"center",behavior:"smooth"}),Oe.classList.add("selected"),Ve.classList.add("selected")):(Oe.classList.remove("selected"),Ve.classList.remove("selected"))}),this.canvas.requestRenderAll()};this.canvas.on("selection:created",o),this.canvas.on("selection:updated",o);var S;const l=({text:ee,fontFamily:re="Poppins",fontSize:le=32,fill:_e="#000000"})=>new fabric$1.fabric.Text(ee,{fontFamily:re,fontSize:le,fill:_e,selectable:!0,hasRotatingPoint:!1,diameter:500,left:50,top:50,flipped:!0});var p=l({text:this.logoName}),F=l({text:this.sloganName});querySelect("#logoMainField").addEventListener("input",ee=>{const re=ee.target.value;this.logoName=re;const le=this.canvas.getObjects().map(_e=>_e);p=le[le.length-2],p.set("text",re),this.canvas.requestRenderAll()}),querySelect("#sloganNameField").addEventListener("input",ee=>{const re=ee.target.value,le=this.canvas.getObjects().map(_e=>_e);F=le[le.length-1],F.set("text",re),this.canvas.requestRenderAll()});const O=ee=>{fabric$1.fabric.loadSVGFromString(ee,(le,_e)=>{S=new fabric$1.fabric.Group(le,_e),this.canvas.on("selection:created",()=>{this.canvas.getActiveObjects().forEach(()=>{this.activeNavbarSetting="logo",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="grid",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none"})}),le.forEach((tt,rt)=>{const gt=le.length-1,ft=le.length-2;if(tt.id==="external_layer")return;gt===rt?(tt.scale(800),F=tt,tt.text=querySelect("#sloganNameField").value):ft===rt&&(tt.scale(800),p=tt,tt.text=querySelect("#logoMainField").value),this.canvas.requestRenderAll(),this.canvas.add(tt),new CreateLayerSection(this.layers).create(tt,rt),tt.on("mousedown",vt=>{var Tt;this.isFlipY=tt.get("flipY"),this.isFlipX=tt.get("flipX"),querySelect("#flip-y").checked=this.isFlipY,querySelect("#flip-x").checked=this.isFlipX;const mt=!!((Tt=tt==null?void 0:tt.shadow)!=null&&Tt.blur);querySelect("#logo-drop-shadow").checked=mt,ye=mt,mt?(querySelect("#logo-shadow-adjust").style.display="block",querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block"):(querySelect("#logo-shadow-adjust").style.display="none",querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none"),querySelect("#rotate_info").innerText=`Rotate: ${parseInt(tt.get("angle"))}deg`,querySelect("#rotate-bar").value=tt.get("angle");const yt=tt.get("angle");querySelect("#rotate-bar").value=yt;const Ct=tt.getTotalObjectScaling().scaleX;querySelect("#progress-bar").value=Ct*10,querySelect("#scale-value").innerText=` ${Ct.toFixed(2)}`;let St;const bt=vt.target.fill;typeof bt=="object"?St=bt.colorStops[0].color:bt&&bt.includes("#")?St=bt:St=rgbaToHex(bt),E.color.set(St),querySelect("#HEX").value=St;let xt=hexToRgb(St).match(/\d+/g);xt&&xt.length===3&&(querySelect("#R").value=xt[0],querySelect("#G").value=xt[1],querySelect("#B").value=xt[2]);let wt=hexToHsl(St).match(/\d+/g);wt&&wt.length===3&&(querySelect("#H").value=wt[0],querySelect("#S").value=wt[1],querySelect("#L").value=wt[2]),this.activeNavbarSetting="logo",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="grid",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.canvas.requestRenderAll()})});var Oe=S.width,Ve=S.height;const qe=200,Ye=200,Ze=qe/Oe,at=Ye/Ve;S.set({scaleX:Ze,scaleY:at,width:qe,height:Ye}),S.setCoords(),this.canvas.viewportCenterObject(S),this.initialRotation={centerPoint:S.getCenterPoint(),coords:S.getCoords()},S.scaleToWidth(Ze),S.ungroupOnCanvas(),this.canvas.renderAll()}),p.viewportCenter(),F.viewportCenter();const re=new fabric$1.fabric.ActiveSelection(this.canvas.getObjects(),{canvas:this.canvas});this.canvas.setActiveObject(re),this.canvas.discardActiveObject(re),this.canvas.renderAll()};this.logoFile&&O(this.logoFile);const q=ee=>ee===ee.toUpperCase()?"Uppercase":ee===ee.toLowerCase()?"Lowercase":ee===ee.charAt(0).toUpperCase()+ee.slice(1).toLowerCase()?"Sentence Case":"Title Case",W=(ee,re)=>{const le=document.createElement("i");le.className="fa-solid fa-angle-down",querySelect(ee).append(le),typeof re=="function"&&le.addEventListener("click",re)};p.on("mousedblclick",()=>{const ee=document.getElementById("logoNameInput");ee&&ee.focus()}),F.on("mousedblclick",()=>{document.getElementById("sloganNameInput").focus()&&F.focus()});const U=(ee,re)=>{let le=ee?"var(--gold-darker)":"var(--gold)";re.style.background=le,ee||this.updateActiveNavbar()};this.backgroundMode.addEventListener("mouseover",()=>U(!0,this.backgroundMode)),this.backgroundMode.addEventListener("mouseleave",()=>U(!1,this.backgroundMode)),this.textMode.addEventListener("mouseover",()=>U(!0,this.textMode)),this.textMode.addEventListener("mouseleave",()=>U(!1,this.textMode)),this.logoMode.addEventListener("mouseover",()=>U(!0,this.logoMode)),this.logoMode.addEventListener("mouseleave",()=>U(!1,this.logoMode)),this.previewMode.addEventListener("mouseover",()=>U(!0,this.previewMode)),this.previewMode.addEventListener("mouseleave",()=>U(!1,this.previewMode)),this.uploadSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.textMode.addEventListener("click",()=>{this.activeNavbarSetting="text",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="grid",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",this.canvas.renderAll()}),this.logoMode.addEventListener("click",()=>{this.activeNavbarSetting="logo",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="grid",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",this.canvas.renderAll()}),this.backgroundMode.addEventListener("click",()=>{this.backgroundSettingsContainer.style.display="none",this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="grid",this.uploadSettingsContainer.style.display="none",this.activeNavbarSetting="background",this.updateActiveNavbar()}),this.previewMode.addEventListener("click",()=>{this.transparentLoader();const ee=this.canvas.get("backgroundColor");setTimeout(()=>{ee===this.canvasBG&&this.canvas.setBackgroundColor(null,this.canvas.renderAll.bind(this.canvas)),this.canvas.setBackgroundImage(null,this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="block";const le=this.canvas.toDataURL({format:"png",multiplier:3});le&&(querySelect("#fixed_preview").src=le,querySelect("#loader_font").style.display="none")},1e3)}),this.letterSpacingSlider.addEventListener("input",ee=>{this.letterSpacing=ee.target.value;const re=this.canvas.getActiveObject(),le=re.getCenterPoint();re.set("charSpacing",this.letterSpacing),querySelect("#l_spacing_value").innerText=": "+ee.target.value/10,re.setPositionByOrigin(new fabric$1.fabric.Point(le.x,le.y),"center","center"),re.setCoords(),this.canvas.requestRenderAll(),setTimeout(()=>{L()},100)}),(ht=querySelect("#shadow-blur-slider"))==null||ht.addEventListener("input",ee=>{const re=ee.target.value;this.shadowBlur=re,querySelect("#shadow_blur_title").innerText=` :${re}px`,this.shadowChanger(F,p),this.canvas.requestRenderAll()}),querySelect("#logo-shadow-blur-slider").addEventListener("input",ee=>{this.logoShadowBlur=ee.target.value;const re=this.canvas.getActiveObjects();querySelect("#logo-shadow_blur_title").innerText=` :${ee.target.value}px`,re.forEach(le=>{le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}),this.canvas.requestRenderAll()}),this.shadowOffsetXSlider.addEventListener("input",ee=>{const re=ee.target.value;this.shadowOffsetX=re,querySelect("#offset_x_title").innerText=` :${re}px`,this.shadowChanger(F,p),this.canvas.requestRenderAll()}),this.logoShadowOffsetXSlider.addEventListener("input",ee=>{this.logoShadowOffsetX=ee.target.value,querySelect("#logo-shadow_offsetX").innerText=` :${ee.target.value}px`,this.canvas.getActiveObjects().forEach(le=>{le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}),this.canvas.requestRenderAll()}),this.shadowOffsetYSlider.addEventListener("input",ee=>{const re=ee.target.value;this.shadowOffsetY=re,querySelect("#offset_y_title").innerText=` :${re}px`,this.shadowChanger(F,p),this.canvas.requestRenderAll()}),this.logoShadowOffsetYSlider.addEventListener("input",ee=>{this.logoShadowOffsetY=ee.target.value,querySelect("#logo-shadow_offsetY").innerText=` :${ee.target.value}px`,this.canvas.getActiveObjects().forEach(le=>{le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}),this.canvas.requestRenderAll()});const Y=querySelect(".font-selector-list"),J=querySelect(".font-selector-title"),te=querySelect(".case-list-items-li"),oe=querySelect(".font_style-list-items-li");J.addEventListener("click",ee=>{ee.stopPropagation(),Y.classList.contains("show")?Y.classList.remove("show"):Y.classList.add("show"),[oe,te].forEach(re=>re.classList.remove("show"))}),this.fontStyleListTitle.addEventListener("click",ee=>{ee.stopPropagation(),this.fontStyleList.classList.contains("show")?this.fontStyleList.classList.remove("show"):this.fontStyleList.classList.add("show"),[Y,te].forEach(re=>re.classList.remove("show"))}),document.addEventListener("click",ee=>{ee.target!==J&&Y.classList.remove("show"),ee.target!==this.fontStyleListTitle&&this.fontStyleList.classList.remove("show"),ee.target!==this.caseListTitle&&this.caseList.classList.remove("show")}),[p,F].forEach(ee=>{ee.on("mousedown",()=>{this.updateActiveNavbar("text"),this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="grid",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",this.canvas.renderAll()})}),querySelect("#upload-file").addEventListener("input",ee=>{be=ee.target.files[0],Re=[],Re.push(be),Re.forEach(re=>{fabric$1.fabric.Image.fromURL(URL.createObjectURL(re),le=>{const _e=le.width,Oe=le.height,Ve=Math.min(400/_e,400/Oe);le.scale(Ve),this.canvas.add(le),this.canvas.centerObject(le),this.canvas.requestRenderAll()})}),ee.target.value=""}),Y.addEventListener("click",ee=>{const re=ee.target.innerText;let le=this.canvas.getActiveObject();const _e=le.getCenterPoint();switch(re){case"Inter":le.set("fontFamily","Inter");break;case"Roboto":le.set("fontFamily","Roboto");break;default:le.set("fontFamily","Poppins");break}const Oe=this.fontSelector.querySelector(".font-selector-title");Oe.textContent=re;const Ve=document.createElement("i");Ve.className="fa-solid fa-angle-down",Oe.append(Ve),Y.classList.remove("show"),le.setPositionByOrigin(new fabric$1.fabric.Point(_e.x,_e.y),"center","center"),le.setCoords(),this.canvas.renderAll()});const fe=()=>{Xe(),L()};this.canvas.on("object:added",fe),this.canvas.on("object:removed",fe),this.canvas.on("object:modified",fe);let be=null,Re=null;document.onkeydown=ee=>{ee.key==="Delete"&&(new DeleteLayer(ee,this.canvas,this.layers,this.activeLayerIndex).deleteLayer(),be=null)};const Fe=new iro$1.ColorPicker("#open_picker_text",{display:Z,width:210,marginTop:20,color:B,transparency:!1,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]});p.on("mousedown",ee=>{var dt;ee.e.preventDefault(),this.textSelectorValue="LogoName";const re=!!((dt=p==null?void 0:p.shadow)!=null&&dt.blur);querySelect("#drop-shadow").checked=re,De=re,re?(querySelect("#shadow-adjust").style.display="block",querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block"):(querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none");const le=p.get("charSpacing");querySelect("#l_spacing_value").innerText=": "+le/10;let _e;const Oe=ee.target.fill;typeof Oe=="object"?_e=Oe.colorStops[0].color:Oe&&Oe.includes("#")?_e=Oe:_e=rgbaToHex(Oe),Fe.color.set(_e),querySelect("#HEX2").value=_e;let qe=hexToRgb(_e).match(/\d+/g);qe&&qe.length===3&&(querySelect("#R2").value=qe[0],querySelect("#G2").value=qe[1],querySelect("#B2").value=qe[2]);let Ze=hexToHsl(_e).match(/\d+/g);Ze&&Ze.length===3&&(querySelect("#H2").value=Ze[0],querySelect("#S2").value=Ze[1],querySelect("#L2").value=Ze[2]),querySelect(".font_style-list-item__title").innerText=p.fontStyle,W(".font_style-list-item__title");const at=p.get("charSpacing");querySelect("#letter-spacing-slider").value=at;const tt=p.get("fontFamily");querySelect("#font-selector-title").innerText=tt,W("#font-selector-title");const rt=p.fontSize;querySelect("#font_size_title").value=`${rt}px`,querySelect("#font_size_range").value=rt;const gt=p.text;querySelect(".case-list-item__title").innerText=q(gt);const ft=document.createElement("i");if(ft.className="fa-solid fa-angle-down",querySelect(".case-list-item__title").append(ft),p.shadow){const{blur:vt,offsetX:mt,offsetY:yt}=p.shadow;vt&&mt&&yt&&(querySelect("#shadow_blur_title").innerText=` :${vt}px`,querySelect("#shadow-blur-slider").value=vt,querySelect("#offset_x_title").innerText=` :${mt}px`,querySelect("#shadow-offsetX-slider").value=mt,querySelect("#offset_y_title").innerText=` :${yt}px`,querySelect("#shadow-offsetY-slider").value=yt)}Xe(),this.canvas.requestRenderAll(),this.activeNavbarSetting="text",this.updateActiveNavbar()}),F.on("mousedown",ee=>{var ft;ee.e.preventDefault(),this.textSelectorValue="SloganName";const re=!!((ft=F==null?void 0:F.shadow)!=null&&ft.blur);querySelect("#drop-shadow").checked=re,De=re,re?(querySelect("#shadow-adjust").style.display="block",querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block"):(querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none");const le=F.get("charSpacing");querySelect("#l_spacing_value").innerText=": "+le/10;let _e;const Oe=ee.target.fill;typeof Oe=="object"?_e=Oe.colorStops[0].color:Oe&&Oe.includes("#")?_e=Oe:_e=rgbaToHex(Oe),Fe.color.set(_e),querySelect("#HEX2").value=_e;let qe=hexToRgb(_e).match(/\d+/g);qe&&qe.length===3&&(querySelect("#R2").value=qe[0],querySelect("#G2").value=qe[1],querySelect("#B2").value=qe[2]);let Ze=hexToHsl(_e).match(/\d+/g);Ze&&Ze.length===3&&(querySelect("#H2").value=Ze[0],querySelect("#S2").value=Ze[1],querySelect("#L2").value=Ze[2]),querySelect(".font_style-list-item__title").innerText=F.fontStyle,W(".font_style-list-item__title");const at=+F.charSpacing;querySelect("#letter-spacing-slider").value=at;const tt=F.get("fontFamily");querySelect("#font-selector-title").innerText=tt,W("#font-selector-title");const rt=F.fontSize;querySelect("#font_size_title").value=`${rt}px`,querySelect("#font_size_range").value=rt;const gt=F.text;if(querySelect(".case-list-item__title").innerText=q(gt),W(".case-list-item__title"),F.shadow){const{blur:dt,offsetX:vt,offsetY:mt}=F.shadow;dt&&vt&&mt&&(querySelect("#shadow_blur_title").innerText=` :${dt}px`,querySelect("#shadow-blur-slider").value=dt,querySelect("#offset_x_title").innerText=` :${vt}px`,querySelect("#shadow-offsetX-slider").value=vt,querySelect("#offset_y_title").innerText=` :${mt}px`,querySelect("#shadow-offsetY-slider").value=mt)}Xe(),this.canvas.requestRenderAll(),this.activeNavbarSetting="text",this.updateActiveNavbar()});const Me=[];let Be=-1,Ie=null;const je=100,Xe=()=>{clearTimeout(Ie),Me.length<je?Ie=setTimeout(()=>{Me.push(JSON.stringify(this.canvas)),Be=Me.length-1},100):Me.length===je&&(Be=je-1,Me.shift(),Me.push(JSON.stringify(this.canvas)))},ze=()=>{if(Be>0){G(),Be-=1;const ee=JSON.parse(Me[Be]);this.canvas.clear();const re=(le="logo")=>{querySelectAll(".nav-item").forEach(_e=>{le.includes(_e.innerText.toLowerCase())?(this.logoSettingsContainer.style.display="grid",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",_e.style.backgroundColor="var(--gold-darker)"):_e.style.backgroundColor="var(--gold)"})};this.canvas.loadFromJSON(ee,()=>{const le=this.canvas.getObjects().find(Oe=>Oe.text==="My Brand Name"),_e=this.canvas.getObjects().find(Oe=>Oe.text==="Slogan goes here");this.canvas.getObjects().forEach(Oe=>{Oe.text||Oe.on("mousedown",()=>{re("logo")})}),le.on("mousedown",Oe=>{var rt,gt;Oe.e.preventDefault(),this.textSelectorValue="LogoName",querySelect("#drop-shadow").checked=!!((rt=le==null?void 0:le.shadow)!=null&&rt.blur),(gt=le==null?void 0:le.shadow)!=null&&gt.blur&&(querySelect("#logo-shadow-adjust").style.display="block",querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block");let Ve;const qe=le.get("fill");qe.includes("#")?Ve=qe:Ve=rgbaToHex(qe),Fe.color.set(Ve),querySelect(".font_style-list-item__title").innerText=le.fontStyle,W(".font_style-list-item__title");const Ye=le.get("charSpacing");querySelect("#letter-spacing-slider").value=Ye;const Ze=le.fontFamily;querySelect("#font-selector-title").innerText=Ze,W("#font-selector-title");const at=le.fontSize;querySelect("#font_size_title").value=`${at}px`,querySelect("#font_size_range").value=at;const tt=le.text;if(querySelect(".case-list-item__title").innerText=q(tt),W(".case-list-item__title"),le.shadow){const{blur:ft,offsetX:dt,offsetY:vt}=le.shadow;ft&&dt&&vt&&(querySelect("#shadow_blur_title").innerText=` :${ft}px`,querySelect("#shadow-blur-slider").value=ft,querySelect("#offset_x_title").innerText=` :${dt}px`,querySelect("#shadow-offsetX-slider").value=dt,querySelect("#offset_y_title").innerText=` :${vt}px`,querySelect("#shadow-offsetY-slider").value=vt)}Xe(),this.canvas.requestRenderAll(),re("text"),this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="grid",this.backgroundSettingsContainer.style.display="none"}),_e.on("mousedown",Oe=>{var tt,rt;Oe.e.preventDefault(),this.textSelectorValue="SloganName",querySelect("#drop-shadow").checked=!!((tt=_e==null?void 0:_e.shadow)!=null&&tt.blur),(rt=_e==null?void 0:_e.shadow)!=null&&rt.blur&&(querySelect("#logo-shadow-adjust").style.display="block",querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block");let Ve;const qe=_e.get("fill");qe.includes("#")?Ve=qe:Ve=rgbaToHex(qe),Fe.color.set(Ve),querySelect(".font_style-list-item__title").innerText=_e.fontStyle,W(".font_style-list-item__title");const Ye=_e.fontSize;querySelect("#font_size_range").value=Ye;const Ze=+_e.charSpacing;querySelect("#letter-spacing-slider").value=Ze,querySelect("#font_size_title").value=`${Ye}px`;const at=_e.text;if(querySelect(".case-list-item__title").innerText=q(at),W(".case-list-item__title"),_e.shadow){const{blur:gt,offsetX:ft,offsetY:dt}=_e.shadow;gt&&ft&&dt&&(querySelect("#shadow_blur_title").innerText=` :${gt}px`,querySelect("#shadow-blur-slider").value=gt,querySelect("#offset_x_title").innerText=` :${ft}px`,querySelect("#shadow-offsetX-slider").value=ft,querySelect("#offset_y_title").innerText=` :${dt}px`,querySelect("#shadow-offsetY-slider").value=dt)}Xe(),this.canvas.requestRenderAll(),re("text"),this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="grid",this.backgroundSettingsContainer.style.display="none"}),querySelectAll("#solid_color").forEach(Oe=>{Oe.addEventListener("click",Ve=>{if(this.canvas){const qe=this.canvas.getActiveObject();if(qe){const Ye=Ve.target.style.backgroundColor,Ze=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(Ye);if(Ze){const at=parseInt(Ze[1]),tt=parseInt(Ze[2]),rt=parseInt(Ze[3]),gt=convertRGBtoHex(at,tt,rt);qe.set("fill",gt),querySelectAll("#color-layers-pickers").forEach(vt=>vt.remove());let dt=new Set;this.canvas.getObjects().forEach(vt=>{let mt=vt.get("fill");const yt=document.createElement("div");if(Ne(mt)!==void 0){let Ct=Ne(mt);Ct=Ct.padEnd(7,"0"),dt.has(Ct)||(dt.add(Ct),yt.setAttribute("id","color-layers-pickers"),yt.style.background=mt,yt.className="color-picker",yt.style.borderRadius="5px",pe.append(yt)),yt.addEventListener("click",St=>{const bt=rgbToHex(St.target.style.backgroundColor);this.canvas.getActiveObject().set("fill",bt),this.canvas.requestRenderAll()})}}),Xe(),this.canvas.requestRenderAll(),L()}}}})}),querySelectAll("#solid_color_text").forEach(Oe=>{Oe.addEventListener("click",Ve=>{const qe=this.canvas.getActiveObject();if(qe){const Ye=Ve.target.style.backgroundColor,Ze=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(Ye);if(Ze){const at=parseInt(Ze[1]),tt=parseInt(Ze[2]),rt=parseInt(Ze[3]),gt=convertRGBtoHex(at,tt,rt);qe.set("fill",gt),this.canvas.requestRenderAll(),Xe(),L()}}})})})}},Ue=()=>{if(Be<Me.length-1){G(),Be+=1;const ee=JSON.parse(Me[Be]);this.canvas.clear(),this.canvas.loadFromJSON(ee,()=>{this.canvas.requestRenderAll()})}};querySelect("#undo-btn").addEventListener("click",ze),querySelect("#redo-btn").addEventListener("click",Ue),document.addEventListener("keydown",ee=>{ee.ctrlKey&&ee.key==="z"&&ze(),ee.ctrlKey&&ee.key==="y"&&(Ue(),this.canvas.requestRenderAll())}),querySelect("#font_size_range").addEventListener("input",ee=>{const re=ee.target.value;if(re>0){querySelect("#font_size_title").value=`${re}px`;const le=this.canvas.getActiveObject(),_e=re;le.fontSize=_e,this.canvas.renderAll(),L()}}),querySelect("#font_size_title").addEventListener("input",ee=>{const re=ee.target.value,le=Number(re.split("px")[0]),_e=this.canvas.getActiveObject();_e.fontSize=le,querySelect("#font_size_range").value=le,this.canvas.requestRenderAll()});const ie=(ee="increment")=>{const re=this.canvas.getActiveObject();let le=parseInt(re.fontSize);le<=1&&(le=2);const _e=le+1,Oe=le-1,Ve=ee==="increment"?re.fontSize=_e:re.fontSize=Oe;querySelect("#font_size_range").value=Ve,querySelect("#font_size_title").value=Ve+"px",this.canvas.requestRenderAll(),L()};querySelect("#font_size_up").addEventListener("click",()=>void ie("increment")),querySelect("#font_size_down").addEventListener("click",()=>void ie("decrement")),querySelect("#font_size_title").addEventListener("keydown",ee=>{if(ee.key==="ArrowUp"){let le=Number(ee.target.value.split("px")[0]);ee.target.value=le+1+"px"}else if(ee.key==="ArrowDown"){let le=Number(ee.target.value.split("px")[0]);ee.target.value=le-1+"px"}const re=this.canvas.getActiveObject();re.fontSize=Number(ee.target.value.split("px")[0]),this.canvas.requestRenderAll()}),this.zoomSlider.addEventListener("input",()=>{let ee=this.zoomSlider.value*2;ee<=2?ee-=2.5:ee+=2.5,document.getElementById("magnifier_img").style.scale=ee,document.getElementById("magnifier_img").style.rotate="180deg",this.canvas.zoomToPoint(new fabric$1.fabric.Point(this.canvas.width/2,this.canvas.height/2),1/this.zoomSlider.value),this.canvas.requestRenderAll()}),querySelect("#copyElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();ee._objects?ee.clone(re=>{re._objects.forEach(le=>{this.canvas.add(le)}),this.canvas.centerObject(re),re.set("top",100),re.set("left",100),this.canvas.setActiveObject(re),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()}):ee.clone(re=>{this.canvas.add(re),re.top+=10,re.left+=10}),this.canvas.requestRenderAll()}),querySelect("#eyeElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let re=!!ee.get("opacity");re=!re,ee.set("opacity",re?1:0),this.canvas.requestRenderAll()}),querySelect("#removeElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();ee&&(this.canvas.remove(ee),this.canvas.renderAll())}),querySelect("#bringDownElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendBackwards(ee),this.canvas.requestRenderAll()}),querySelect("#bringUpElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.bringForward(ee),this.canvas.requestRenderAll()}),querySelect("#copyElement2").addEventListener("click",()=>{this.canvas.getActiveObject().clone(re=>{this.canvas.add(re),re.top+=10,re.left+=10}),this.canvas.requestRenderAll()}),querySelect("#eyeElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let re=!!ee.get("opacity");re=!re,ee.set("opacity",re?1:0),this.canvas.requestRenderAll()}),querySelect("#removeElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.remove(ee),this.canvas.requestRenderAll()}),querySelect("#bringDownElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendBackwards(ee),this.canvas.requestRenderAll()}),querySelect("#bringUpElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.bringForward(ee),this.canvas.requestRenderAll()}),querySelect("#eyeElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let re=ee.visible;re=!re,ee.set("visible",re),this.canvas.requestRenderAll()}),querySelect("#copyElement-uploads").addEventListener("click",ee=>{this.canvas.getActiveObject().clone(re=>{this.canvas.add(re),this.canvas.centerObject(re),this.canvas.requestRenderAll()})}),querySelect("#bringUpElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.bringForward(ee),this.canvas.requestRenderAll()}),querySelect("#bringDownElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendBackwards(ee),this.canvas.requestRenderAll()}),querySelect("#bg-pallete").addEventListener("colorChange",ee=>{const{colorMode:re,grad1Value:le,grad2Value:_e,colorAngle:Oe,solidValue:Ve}=ee.detail;console.log(ee.detail);let qe=`${Oe}deg`,Ye=null;re==="Linear"?Ye=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:this.canvas.width,y2:this.canvas.height,angle:Oe},colorStops:[{offset:0,color:le},{offset:1,color:_e}]}):re==="None"?(G(),this.canvas.setBackgroundColor("#eeeeee",this.canvas.renderAll.bind(this.canvas)),this.canvas.requestRenderAll()):Ye=Ve,this.canvas.backgroundColor=Ye,querySelect(".color-palette-gradient").style.background=`linear-gradient(${qe}, ${le}, ${_e})`,L();const Ze=new fabric$1.fabric.Rect({left:150,top:100,fill:Ye,width:150,height:250});this.canvas.add(Ze),Ze.center(),this.canvas.remove(Ze),this.canvas.requestRenderAll(),setTimeout(()=>{L()},100)}),querySelect("#logo-pallete").addEventListener("colorChange",ee=>{const re=this.canvas.getActiveObject(),{colorMode:le,grad1Value:_e,grad2Value:Oe,solidValue:Ve,colorAngle:qe}=ee.detail;let Ye=null;le!=="Solid"?Ye=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:re.width,y2:re.height},colorStops:[{offset:0,color:_e},{offset:1,color:Oe}]}):Ye=Ve,re.set("fill",Ye),this.canvas.requestRenderAll(),setTimeout(()=>{L()},100)}),querySelect("#text-pallete").addEventListener("colorChange",ee=>{const re=this.canvas.getActiveObject(),{colorMode:le,grad1Value:_e,grad2Value:Oe,solidValue:Ve}=ee.detail;let qe=null;le!=="Solid"?qe=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:re.width,y2:re.height},colorStops:[{offset:0,color:_e},{offset:1,color:Oe}]}):qe=Ve,re.set("fill",qe),this.canvas.requestRenderAll(),setTimeout(()=>{L()},100)}),L();let me=["/static/mug.png","/static/wall.png"],ae=me.length-1;querySelect("#right-arrow").addEventListener("click",()=>{ae++,ae>=me.length&&(ae=0);const ee=me[ae];querySelect(".preview_image_wrapper").style.backgroundImage="url("+ee.toString()+")",querySelect(".preview_image").style.marginTop=ae===0?"100px":"-100px"}),querySelect("#left-arrow").addEventListener("click",()=>{ae===0?ae=me.length-1:ae--;const ee=me[ae];querySelect(".preview_image_wrapper").style.backgroundImage="url("+ee.toString()+")",querySelect(".preview_image").style.marginTop=ae===0?"100px":"-100px"}),querySelect("#close_modal").addEventListener("click",()=>{G(),this.canvas.setBackgroundColor(this.canvasBG,this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="none"}),querySelect("#overlay").addEventListener("click",ee=>{ee.target.classList.contains("overlay")&&(G(),this.canvas.setBackgroundColor("#eee",this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="none")}),querySelect("#icon-search-input").addEventListener("input",ee=>{const re=ee.target.value;querySelectAll("#clip-icon").forEach(le=>{le.getAttribute("data-name").toLowerCase().includes(re.toLowerCase())?le.style.display="grid":le.style.display="none"})}),querySelect(".popup").addEventListener("click",ee=>{ee.target.classList.contains("popup")&&(querySelect("#popup-parent").style.display="none",querySelect("#popup-parent-icons").style.display="none")}),document.getElementById("close-btn").addEventListener("click",ee=>{querySelect("#popup-parent-icons").style.display="none"});const ne="https://www.mybrande.com/api/all/icons";function ge(ee,re=""){const le=new Image;le.classList.add("clip-icon"),le.setAttribute("id","clip-icon"),le.setAttribute("data-name",re);const _e=new Blob([ee],{type:"image/svg+xml"}),Oe=URL.createObjectURL(_e);return le.src=Oe,le.style.width="80px",le.style.height="80px",le.style.objectFit="cover",le}let ve=0,xe;axios$1.get(ne).then(ee=>{xe=ee.data.CategoryWiseIcon,xe.forEach((re,le)=>{let _e=re.Icons[ve].icon_svg;const Oe=re.category.iconcategory_name,Ve=querySelect("#category_type_title"),qe=document.createElement("span");qe.setAttribute("index",le),qe.classList.add("search-icon-category-text"),qe.innerText=Oe,Ve.append(qe);const Ye=ge(_e,Oe);querySelect("#clip-icons").appendChild(Ye)})}).catch(ee=>{console.error("Error fetching icons:",ee)}),querySelect("#category_type_title").addEventListener("click",ee=>{querySelect("#clip-icons").innerHTML=null;const re=ee.target.getAttribute("index");xe[re].Icons.forEach(_e=>{const Oe=_e.iconcategory_name,Ve=ge(_e.icon_svg,Oe);querySelect("#clip-icons").appendChild(Ve)})}),document.getElementById("clip-icons").addEventListener("click",ee=>{const re=ee.target.src,le=decodeURIComponent(re),_e=this.canvas;fabric$1.fabric.loadSVGFromURL(le,(Oe,Ve)=>{const qe=fabric$1.fabric.util.groupSVGElements(Oe,Ve);qe.scaleToWidth(50),qe.set({left:qe.left+100}),qe.set("id","external_layer"),_e.add(qe),_e.viewportCenterObjectV(qe),_e.requestRenderAll(),qe.on("mousedown",Ye=>{console.log("Clicked on object with ID:",Ye.target.id)})}),document.getElementById("popup-parent-icons").style.display="none"}),querySelect("#add-clip-text").addEventListener("click",ee=>{querySelect("#popup-parent").style.display="block",querySelect("#popup-parent-icons").style.display="none"}),querySelect("#add-icon").addEventListener("click",()=>{querySelect("#popup-parent").style.display="block",querySelect("#popup-parent-icons").style.display="block"}),querySelect(".item-title").addEventListener("click",ee=>{const re=new fabric$1.fabric.IText("Add Text",{fontFamily:"Poppins"});this.canvas.add(re),re.center(),re.set("left",re.top+50),L(),this.canvas.requestRenderAll(),this.canvas.setActiveObject(re),querySelect("#popup-parent").style.display="none",querySelect("#popup-parent-icons").style.display="none"});let ye=!1;querySelect("#logo-drop-shadow").addEventListener("change",()=>{const ee=this.canvas.getActiveObject();if(ye=!ye,ye){querySelect("#logo-shadow-adjust").style.display="block";const re=querySelect(".settings-view");re.scrollTop=re.scrollHeight,ee._objects?ee.forEachObject(le=>{le.set("shadow",{offsetX:2,offsetY:2,blur:5})}):ee.set("shadow",{offsetX:2,offsetY:2,blur:5}),this.canvas.requestRenderAll()}else{querySelect("#logo-shadow-adjust").style.display="none",querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none";const re=this.canvas.getActiveObject();re._objects?re.forEachObject(le=>{le.set("shadow",{offsetX:0,offsetY:0,blur:0})}):re.set("shadow",{offsetX:0,offsetY:0,blur:0}),this.canvas.requestRenderAll()}});let Ae=!1;querySelect("#logo-shadow-adjust").addEventListener("click",()=>{if(this.canvas.getActiveObject(),Ae=!Ae,Ae){querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block";const ee=querySelect(".settings-view");ee.scrollTop=ee.scrollHeight}else querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none"});let De=!1;querySelect("#drop-shadow").addEventListener("change",()=>{De=!De;const ee=this.canvas.getActiveObject();if(De){querySelect("#shadow-adjust").style.display="block";const re=querySelect(".settings-view");re.scrollTop=re.scrollHeight,ee._objects?ee.forEachObject(le=>{le.set("shadow",{offsetX:2,offsetY:2,blur:5})}):ee.set("shadow",{offsetX:2,offsetY:2,blur:5}),this.canvas.requestRenderAll()}else querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none",ee._objects?ee.forEachObject(re=>{re.set("shadow",{offsetX:0,offsetY:0,blur:0})}):ee.set("shadow",{offsetX:0,offsetY:0,blur:0}),this.canvas.requestRenderAll()});let He=!1;querySelect("#shadow-adjust").addEventListener("click",()=>{if(He=!He,He){querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block";const ee=querySelect(".settings-view");ee.scrollTop=ee.scrollHeight}else querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none"});const Se=this.canvas.getObjects(),pe=querySelect("#logo_colors_pallete");querySelect("#logo_text_colors_pallete");const Ee=querySelect("#solid_color_mode"),ke=querySelect("#picker_color_mode"),Ce=querySelect("#solid_color_text_mode"),Pe=querySelect("#picker_color_text_mode"),Ne=ee=>{var re;if(ee&&typeof ee=="string")return ee!=null&&ee.includes("#")?ee:ee&&ee.colorStops?rgbToHex((re=ee==null?void 0:ee.colorStops[0])==null?void 0:re.color):rgbToHex(ee)},Qe=()=>{let ee=new Set;Se.forEach(re=>{let le=re.get("fill");const _e=document.createElement("div");if(Ne(le)!==void 0){let Oe=Ne(le);Oe=Oe.padEnd(7,"0"),ee.has(Oe)||(ee.add(Oe),_e.setAttribute("id","color-layers-pickers"),_e.style.background=le,_e.className="color-picker",_e.style.borderRadius="5px",pe.append(_e),Oe.includes("#ffffff")&&(_e.style.border="1px solid #aaaaaa")),_e.addEventListener("click",Ve=>{const qe=rgbToHex(Ve.target.style.backgroundColor);this.canvas.getActiveObject().set("fill",qe),E.color.set(qe),querySelect("#HEX").value=qe;let at=hexToRgb(qe).match(/\d+/g);at&&at.length===3&&(querySelect("#R").value=at[0],querySelect("#G").value=at[1],querySelect("#B").value=at[2]);let rt=hexToHsl(qe).match(/\d+/g);rt&&rt.length===3&&(querySelect("#H").value=rt[0],querySelect("#S").value=rt[1],querySelect("#L").value=rt[2]),this.canvas.renderAll(),L()})}}),Xe()};Qe(),E.on("color:init",ee=>{ee.set(B)}),E.on("input:change",ee=>{if(B=ee.rgbaString,ee.index===0){const _e=ee.hsl,Oe=ee.rgb;querySelect("#H").value=_e.h,querySelect("#S").value=_e.s,querySelect("#L").value=_e.l,querySelect("#R").value=Oe.r,querySelect("#G").value=Oe.g,querySelect("#B").value=Oe.b,querySelect("#HEX").value=ee.hexString}this.canvas.getActiveObject().set("fill",ee.rgbaString),querySelectAll("#color-layers-pickers").forEach(_e=>_e.remove()),Qe(),this.canvas.requestRenderAll()}),["#B"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{let re=querySelect("#R").value,le=querySelect("#G").value,_e=querySelect("#B").value;E.color.rgb={r:re,g:le,b:_e},this.canvas.getActiveObject().set("fill",E.color.hexString),this.canvas.requestRenderAll()})}),["#H","#S","#L"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{let re=querySelect("#H").value,le=querySelect("#S").value,_e=querySelect("#L").value;E.color.hsl={h:re,s:le,l:_e},this.canvas.getActiveObject().set("fill",E.color.hexString),this.canvas.requestRenderAll()})}),["#B2"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{let re=querySelect("#R2").value,le=querySelect("#G2").value,_e=querySelect("#B2").value;E.color.rgb={r:re,g:le,b:_e},this.canvas.getActiveObject().set("fill",E.color.hexString),this.canvas.requestRenderAll()})}),["#H2","#S2","#L2"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{let re=querySelect("#H2").value,le=querySelect("#S2").value,_e=querySelect("#L2").value;E.color.hsl={h:re,s:le,l:_e},this.canvas.getActiveObject().set("fill",E.color.hexString),this.canvas.requestRenderAll()})});let Ge=0,Te=0;querySelect("#HEX").addEventListener("input",ee=>{let re=ee.target.value;re.length>0&&re[0]!=="#"&&(Ge>=3?(re="#"+re,querySelect("#HEX").value=re,Ge=0):Ge++),E.color.set(re),this.canvas.getActiveObject().set("fill",re);let _e=querySelect("#R").value,Oe=querySelect("#G").value,Ve=querySelect("#B").value;E.color.rgb={r:_e,g:Oe,b:Ve};let qe=querySelect("#H").value,Ye=querySelect("#S").value,Ze=querySelect("#L").value;E.color.hsl={h:qe,s:Ye,l:Ze},this.canvas.requestRenderAll()}),querySelect("#HEX2").addEventListener("input",ee=>{let re=ee.target.value;re.length>0&&re[0]!=="#"&&(Te>=3?(re="#"+re,querySelect("#HEX2").value=re,Te=0):Te++),E.color.set(re),this.canvas.getActiveObject().set("fill",re);let _e=querySelect("#R2").value,Oe=querySelect("#G2").value,Ve=querySelect("#B2").value;E.color.rgb={r:_e,g:Oe,b:Ve};let qe=querySelect("#H2").value,Ye=querySelect("#S2").value,Ze=querySelect("#L2").value;E.color.hsl={h:qe,s:Ye,l:Ze},this.canvas.requestRenderAll()});const $e=()=>{querySelect("#picker_color_mode").classList.remove("category_selected"),querySelect("#solid_color_mode").classList.add("category_selected"),querySelect("#solid_color_items").style.display="flex",querySelect("#picker_color_items").style.display="none",Q="none"},et=()=>{querySelect("#solid_color_items").style.display="none",querySelect("#picker_color_items").style.display="flex",querySelect("#solid_color_mode").classList.remove("category_selected"),querySelect("#picker_color_mode").classList.add("category_selected"),querySelect("#picker_color_items").style.marginTop="8px",Z="block"},it=()=>{querySelect("#picker_color_text_mode").classList.remove("category_selected"),querySelect("#solid_color_text_mode").classList.add("category_selected"),querySelect("#solid_color_items_text").style.display="flex",querySelect("#picker_color_items_text").style.display="none",Q="none"},ct=()=>{querySelect("#solid_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="flex",querySelect("#solid_color_text_mode").classList.remove("category_selected"),querySelect("#picker_color_text_mode").classList.add("category_selected"),querySelect("#picker_color_items_text").style.marginTop="8px",Z="block"};let nt="block",ut="#fff",st=new iro$1.ColorPicker("#openTextPickerViewBG",{display:nt,width:210,marginTop:20,color:ut,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]});const pt=()=>{querySelect("#picker_color_text_modeBG").classList.remove("category_selected"),querySelect("#solid_color_text_modeBG").classList.add("category_selected"),querySelect("#bg_solid_color_items_text").style.display="flex",querySelect("#bg_picker_color_items_text").style.display="none",nt="none"},_t=()=>{querySelect("#bg_solid_color_items_text").style.display="none",querySelect("#bg_picker_color_items_text").style.display="flex",querySelect("#solid_color_text_modeBG").classList.remove("category_selected"),querySelect("#picker_color_text_modeBG").classList.add("category_selected"),querySelect("#bg_picker_color_items_text").style.marginTop="8px",nt="block"};pt(),querySelect("#solid_color_text_modeBG").addEventListener("click",()=>{pt()}),querySelect("#picker_color_text_modeBG").addEventListener("click",()=>{_t()}),["#B_BG"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{const re=querySelect("#R_BG").value,le=querySelect("#G_BG").value,_e=querySelect("#B_BG").value;st.color.rgb={r:re,g:le,b:_e};const Oe=st.color.hexString;this.canvas.setBackgroundColor(Oe),this.canvas.requestRenderAll()})}),["#H_BG","#S_BG","#L_BG"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{const re=querySelect("#H_BG").value,le=querySelect("#S_BG").value,_e=querySelect("#L_BG").value;st.color.hsl={h:re,s:le,l:_e};const Oe=st.color.hexString;this.canvas.setBackgroundColor(Oe),this.canvas.requestRenderAll()})}),querySelect("#HEX_BG").addEventListener("input",ee=>{let re=ee.target.value;re.length>0&&re[0]!=="#"&&re.length>=3&&(re="#"+re,querySelect("#HEX_BG").value=re);const le=querySelect("#R_BG").value,_e=querySelect("#G_BG").value,Oe=querySelect("#B_BG").value;st.color.rgb={r:le,g:_e,b:Oe};const Ve=querySelect("#H_BG").value,qe=querySelect("#S_BG").value,Ye=querySelect("#L_BG").value;st.color.hsl={h:Ve,s:qe,l:Ye},st.color.set(re),this.canvas.setBackgroundColor(st.color.hexString),this.canvas.requestRenderAll()});const se=(ee,re,le)=>{querySelect(re+"_view_BG").classList.remove("color_mode_title-active"),querySelect(re+"_view_BG").style.display="none",querySelect(le+"_view_BG").classList.remove("color_mode_title-active"),querySelect(le+"_view_BG").style.display="none",querySelect(ee+"_view_BG").classList.add("color_mode_title-active"),querySelect(ee+"_view_BG").style.display="flex"};querySelect("#HSL_mode_BG").addEventListener("click",()=>{se("#HSL","#RGB","#HEX")}),querySelect("#RGB_mode_BG").addEventListener("click",()=>{se("#RGB","#HSL","#HEX")}),querySelect("#HEX_mode_BG").addEventListener("click",()=>{se("#HEX","#RGB","#HSL")}),se("#HEX","#RGB","#HSL"),st.on("color:init",ee=>{ee.set(ut)}),st.on("input:change",ee=>{if(ut=ee.rgbaString,ee.index===0){const re=ee.hsl,le=ee.rgb;querySelect("#H_BG").value=re.h,querySelect("#S_BG").value=re.s,querySelect("#L_BG").value=re.l,querySelect("#R_BG").value=le.r,querySelect("#G_BG").value=le.g,querySelect("#B_BG").value=le.b,querySelect("#HEX_BG").value=ee.hexString}this.canvas.setBackgroundColor(ee.rgbaString),this.canvas.requestRenderAll()}),$e(),it(),Ee.addEventListener("click",$e),ke.addEventListener("click",et),Ce.addEventListener("click",it),Pe.addEventListener("click",ct),querySelect("#custom_color_generator").addEventListener("change",ee=>{const re=ee.target.value,le=document.createElement("div");le.style.backgroundColor=re,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=re,le.style.borderRadius="5px",le.addEventListener("click",()=>{this.canvas.getActiveObject().set("fill",re),E.color.set(re),querySelect("#HEX").value=re;let Ve=hexToRgb(re).match(/\d+/g);Ve&&Ve.length===3&&(querySelect("#R").value=Ve[0],querySelect("#G").value=Ve[1],querySelect("#B").value=Ve[2]);let Ye=hexToHsl(re).match(/\d+/g);Ye&&Ye.length===3&&(querySelect("#H").value=Ye[0],querySelect("#S").value=Ye[1],querySelect("#L").value=Ye[2]),this.canvas.renderAll(),L()}),querySelect("#custom_colors_wrapper").append(le)}),querySelect("#custom_text_color_generator").addEventListener("change",ee=>{const re=ee.target.value,le=document.createElement("div");le.style.backgroundColor=re,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=re,le.style.borderRadius="5px",le.addEventListener("click",()=>{this.canvas.getActiveObject().set("fill",re),Fe.color.set(re),querySelect("#HEX2").value=re;let Ve=hexToRgb(re).match(/\d+/g);Ve&&Ve.length===3&&(querySelect("#R2").value=Ve[0],querySelect("#G2").value=Ve[1],querySelect("#B2").value=Ve[2]);let Ye=hexToHsl(re).match(/\d+/g);Ye&&Ye.length===3&&(querySelect("#H2").value=Ye[0],querySelect("#S2").value=Ye[1],querySelect("#L2").value=Ye[2]),this.canvas.renderAll(),L()}),querySelect("#custom_text_colors_wrapper").append(le)}),querySelect("#custom_bg_color_generator").addEventListener("change",ee=>{const re=ee.target.value,le=document.createElement("div");le.style.backgroundColor=re,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=re,le.style.borderRadius="5px",le.addEventListener("click",()=>{this.canvas.setBackgroundColor(re),st.color.set(re),querySelect("#HEX_BG").value=re;let Oe=hexToRgb(re).match(/\d+/g);Oe&&Oe.length===3&&(querySelect("#R_BG").value=Oe[0],querySelect("#G_BG").value=Oe[1],querySelect("#B_BG").value=Oe[2]);let qe=hexToHsl(re).match(/\d+/g);qe&&qe.length===3&&(querySelect("#H_BG").value=qe[0],querySelect("#S_BG").value=qe[1],querySelect("#L_BG").value=qe[2]),this.canvas.renderAll(),L()}),querySelect("#custom_bg_colors_wrapper").append(le)}),querySelectAll("#solid_color").forEach(ee=>{ee.addEventListener("click",re=>{if(this.canvas){const le=this.canvas.getActiveObject();if(le){const _e=re.target.style.backgroundColor,Oe=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(_e);if(Oe){const Ve=parseInt(Oe[2]),qe=parseInt(Oe[1]),Ye=parseInt(Oe[3]),Ze=convertRGBtoHex(qe,Ve,Ye);le.set("fill",Ze),E.color.set(Ze),querySelectAll("#color-layers-pickers").forEach(tt=>tt.remove()),Qe(),this.canvas.renderAll(),L(),Xe()}}}})}),querySelectAll("#solid_color_text").forEach(ee=>{ee.addEventListener("click",re=>{if(this.canvas){const le=this.canvas.getActiveObject();if(le){const _e=re.target.style.backgroundColor,Oe=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(_e);if(Oe){const Ve=parseInt(Oe[1]),qe=parseInt(Oe[2]),Ye=parseInt(Oe[3]),Ze=convertRGBtoHex(Ve,qe,Ye);le.set("fill",Ze),Fe.color.set(Ze),this.canvas.renderAll(),L(),Xe()}}}})}),querySelectAll("#solid_color-bg").forEach(ee=>{ee.addEventListener("click",re=>{if(this.canvas){const le=re.target.style.backgroundColor,_e=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(le);if(_e){const Oe=parseInt(_e[1]),Ve=parseInt(_e[2]),qe=parseInt(_e[3]),Ye=convertRGBtoHex(Oe,Ve,qe);this.canvas.setBackgroundColor(Ye),querySelectAll("#color-layers-pickers").forEach(at=>at.remove()),Qe(),this.canvas.renderAll(),Xe()}L()}})}),(()=>{let ee,re;Se.forEach(le=>{if(ee=le.get("fill"),re=document.createElement("input"),re.setAttribute("id","color-layers-pickers"),re.setAttribute("type","color"),typeof ee=="string")re.setAttribute("value",ee);else{const Oe=ee.colorStops[0].color.match(/\d+/g);if(Oe&&Oe.length===3){const Ve=convertRGBtoHex(parseInt(Oe[0]),parseInt(Oe[1]),parseInt(Oe[2]));re.setAttribute("value",Ve)}}re.className="color-picker",re.style.borderRadius="5px",re.addEventListener("input",_e=>{const Oe=_e.target.value;le.set("fill",Oe),this.canvas.requestRenderAll()})}),Xe(),L()})(),Fe.on("color:init",ee=>{ee.set(B)});const Le=ee=>{if(B=ee.rgbaString,ee.index===0){const _e=ee.hsl,Oe=ee.rgb;querySelect("#H2").value=_e.h,querySelect("#S2").value=_e.s,querySelect("#L2").value=_e.l,querySelect("#R2").value=Oe.r,querySelect("#G2").value=Oe.g,querySelect("#B2").value=Oe.b,querySelect("#HEX2").value=ee.hexString}this.canvas.getActiveObject().set("fill",ee.rgbaString),this.canvas.requestRenderAll(),querySelectAll("#color-layers-pickers").forEach(_e=>_e.remove()),Qe(),this.canvas.requestRenderAll(),setTimeout(()=>{L()},100)};Fe.on("input:change",Le),Fe.on("input:move",Le);const we=(ee,re,le)=>{querySelect(re+"_view").classList.remove("color_mode_title-active"),querySelect(re+"_view").style.display="none",querySelect(le+"_view").classList.remove("color_mode_title-active"),querySelect(le+"_view").style.display="none",querySelect(ee+"_view").classList.add("color_mode_title-active"),querySelect(ee+"_view").style.display="flex"};querySelect("#HSL_mode").addEventListener("click",()=>{we("#HSL","#RGB","#HEX")}),querySelect("#RGB_mode").addEventListener("click",()=>{we("#RGB","#HSL","#HEX")}),querySelect("#HEX_mode").addEventListener("click",()=>{we("#HEX","#RGB","#HSL")}),querySelect("#HSL2_mode").addEventListener("click",()=>{we("#HSL2","#RGB2","#HEX2")}),querySelect("#RGB2_mode").addEventListener("click",()=>{we("#RGB2","#HSL2","#HEX2")}),querySelect("#HEX2_mode").addEventListener("click",()=>{we("#HEX2","#RGB2","#HSL2")}),we("#HEX","#RGB","#HSL"),we("#HEX2","#RGB2","#HSL2");const We=ee=>{const re=new fabric$1.fabric.ActiveSelection(this.canvas.getObjects().filter(Ve=>!Ve.text),{canvas:this.canvas}),{width:le,height:_e}=re,Oe=Math.min(ee/le,ee/_e);re.scale(Oe),re.center(),this.canvas.setActiveObject(re),this.canvas.discardActiveObject(re),this.canvas.requestRenderAll()};querySelect("#canvas-bg-none").addEventListener("click",()=>{this.canvas.setBackgroundColor(this.canvasBG),L(),this.canvas.requestRenderAll(),Xe()});const Ke=()=>{this.canvas.discardActiveObject(),this.canvas.requestRenderAll()};function Je(ee,re){switch(ee){case"1":centerAndResizeElements("topBottom",46,22,"center",1.32,1.5,!1,re,p,F);break;case"2":centerAndResizeElements("topBottom",40,20,"center",1.35,1.52,!1,re,p,F);break;case"3":centerAndResizeElements("topBottom",46,22,"center",1.42,1.6,!1,re,p,F);break;case"4":centerAndResizeElements("bottomTop",46,22,"center",3.8,5.5,!1,re,p,F);break;case"5":centerAndResizeElements("bottomTop",40,18,"center",3.5,5,!1,re,p,F);break;case"6":centerAndResizeElements("bottomTop",46,22,"center",3.3,4.5,!1,re,p,F);break;case"7":centerAndResizeElements("leftRight",32,25,"center",1.32,1.5,!1,re,p,F);break;case"8":centerAndResizeElements("leftRight",32,25,"left",1.32,1.5,!1,re,p,F);break;case"9":centerAndResizeElements("leftRight",32,25,"left",1.32,1.5,!1,re,p,F);break;case"10":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;case"11":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;case"12":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;case"13":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;case"14":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;case"15":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,re,p,F);break;default:We(200),centerAndResizeElements("topBottom",46,22,"center",1.32,1.5,!1,re,p,F);break}}Je(1,this.canvas);var ot;async function lt(ee){var qe,Ye,Ze,at,tt,rt;querySelect("#loader_main").style.display="block";const re=querySelect("#logo_id").value;if(!re)return toastNotification("Error!! Logo ID Not Found");let le;querySelect("#api_check").value==="1"?le=await axios$1.get(`https://www.mybrande.com/api/find/logo/${re}`):le=await axios$1.get(`https://www.mybrande.com/api/find/logo/buyer/${re}`);const Oe=(Ye=(qe=le.data)==null?void 0:qe.AllData)==null?void 0:Ye.logo_backgroundcolor;ot=(at=(Ze=le.data)==null?void 0:Ze.AllData)==null?void 0:at.logo_position;const Ve=(rt=(tt=le.data)==null?void 0:tt.AllData)==null?void 0:rt.svg_data;return Ve&&(localStorage.setItem("logo-file",Ve),Je(ot,ee)),{bg:Oe,logoPosition:ot,svgData:le.data}}lt(this.canvas).then((ee,re,le)=>{var _e;if(sessionStorage.getItem("reloaded")||(sessionStorage.setItem("reloaded","true"),location.reload()),(_e=ee==null?void 0:ee.bg)!=null&&_e.includes(",")){const Oe=ee.bg.split(",");let Ve=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:this.canvas.width,y2:this.canvas.height},colorStops:[{offset:0,color:Oe[0]},{offset:1,color:Oe[1]}]});this.canvas.setBackgroundColor(Ve)}else this.canvas.setBackgroundColor(ee.bg);this.canvas.renderAll(),this.alignId=+ee.logoPosition,L(),querySelect("#loader_main").style.display="none"}),["top_bottom_1","top_bottom_2","top_bottom_3","top_bottom_4","bottom_top_1","bottom_top_2","bottom_top_3","left_right_1","left_right_2","left_right_3","left_right_4","right_left_1","right_left_2","right_left_3","right_left_4"].forEach(ee=>{querySelect(`#${ee}`).addEventListener("click",()=>{Ke(),this.alignId=getAttr(ee,"data-align-id")})})}}const editorScreen=new EditorScreen;editorScreen.initialize();const paletteMarkup=`
<div class="bg-settings-container">
<div>
  <div id="color-mode" class="color-mode-selector">
    <span id="color-mode-title" class="color-mode-title" style="margin-left: -10px; margin-bottom: 40px;">Linear Colors
      <i class="fa-solid fa-angle-down"  style="visibility: hidden; display: none"></i>
    </span>
        <div id="bg-color-list" class="color-mode-list"></div>
    </div>

    <div id="gradient-panel-viewer" style="position: absolute; left: 43%; margin-top: -130px;">
        <div id="color-palette-gradient" class="color-palette-gradient"></div>
    </div>

    <div id="gradient-panel" style="margin-top: 60px;  display: none; justify-content: flex-start; gap: 5px;">
        <input type="color" value="#000000" class="color-picker" id="grad-1">
        <input type="color" value="#000000" class="color-picker" id="grad-2">
      </div>
      
      <div id="solid-panel" style="margin-top: 60px;">
        <input type="color" value="#000000" class="color-picker" id="grad-solid">
    </div>

    <!-- <h3 id="color-angle-text" style="display: none">0deg</h3> -->
    <div id="slider-container" class="slider-container" style="margin-top: 20px; margin-left: -15px; display: none">
        <input class="slider" id="color-angle" type="range" value="0" min="0" max="360">
    </div>

  </div>
</div>`;class Palette extends HTMLElement{constructor(){super(),this.innerHTML=paletteMarkup;const $=X=>this.querySelector(X);this.colorMode="Linear";const dataList=this.getAttribute("data-list"),mainDataList=eval(dataList);mainDataList.forEach(X=>{const L=document.createElement("li");L.textContent=X,L.style.fontWeight=500,$("#bg-color-list").append(L)}),$("#color-angle").style.display="block",$("#gradient-panel").style.display="flex",$("#solid-panel").style.display="none",$("#color-palette-gradient").style.background="#000"}connectedCallback(){const X=this.querySelector("#grad-1"),L=this.querySelector("#grad-2"),G=this.querySelector("#grad-solid"),V=this.querySelector("#color-angle"),K=()=>{this.dispatchEvent(new CustomEvent("colorChange",{detail:{grad1Value:X.value,grad2Value:L.value,colorAngle:V.value,solidValue:G.value,colorMode:this.colorMode}}))},Z=B=>document.querySelector(B),Q=this.querySelector("#bg-color-list");Q.addEventListener("click",B=>{this.colorMode=B.target.innerText;const E=this.colorMode;E==="Solid"?(Z("#gradient-panel").style.display="none",Z("#color-angle").style.display="none",Z("#solid-panel").style.display="block",Z("#solid-panel").style.opacity=1,Z("#solid-panel").style.visibility="visible",Z("#solid-panel").style.marginTop="60px",Z("#color-palette-gradient").style.background="#000"):E==="Linear"?(Z("#color-angle").style.display="block",Z("#gradient-panel").style.display="flex",Z("#solid-panel").style.display="none",Z("#color-palette-gradient").style.background="#000"):E==="Transparent"?(Z("#gradient-panel").style.display="none",Z("#solid-panel").style.opacity=0,Z("#solid-panel").style.visibility="hidden",Z("#solid-panel").style.marginTop="-10px",Z("#color-angle").style.display="none",Z("#color-palette-gradient").style.background="url(https://t3.ftcdn.net/jpg/03/76/74/78/240_F_376747823_L8il80K6c2CM1lnPYJhhJZQNl6ynX1yj.jpg)"):E==="None"&&K(),Q.classList.remove("show"),colorModeTitle.innerText=E;const M=document.createElement("i");M.className="fa-solid fa-angle-down",colorModeTitle.append(M)}),X.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(0deg, ${X.value}, ${L.value})`,K()}),L.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(0deg, ${X.value}, ${L.value})`,K()}),G.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=G.value,K()})}}customElements.define("pallete-component",Palette);
