var Ut=Object.defineProperty;var Yt=(B,p,W)=>p in B?Ut(B,p,{enumerable:!0,configurable:!0,writable:!0,value:W}):B[p]=W;var Ft=(B,p,W)=>(Yt(B,typeof p!="symbol"?p+"":p,W),W);(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const K of document.querySelectorAll('link[rel="modulepreload"]'))G(K);new MutationObserver(K=>{for(const J of K)if(J.type==="childList")for(const Z of J.addedNodes)Z.tagName==="LINK"&&Z.rel==="modulepreload"&&G(Z)}).observe(document,{childList:!0,subtree:!0});function W(K){const J={};return K.integrity&&(J.integrity=K.integrity),K.referrerPolicy&&(J.referrerPolicy=K.referrerPolicy),K.crossOrigin==="use-credentials"?J.credentials="include":K.crossOrigin==="anonymous"?J.credentials="omit":J.credentials="same-origin",J}function G(K){if(K.ep)return;K.ep=!0;const J=W(K);fetch(K.href,J)}})();const editor_style="",details_style="",mobile="";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}function getAugmentedNamespace(B){if(B.__esModule)return B;var p=B.default;if(typeof p=="function"){var W=function G(){return this instanceof G?Reflect.construct(p,arguments,this.constructor):p.apply(this,arguments)};W.prototype=p.prototype}else W={};return Object.defineProperty(W,"__esModule",{value:!0}),Object.keys(B).forEach(function(G){var K=Object.getOwnPropertyDescriptor(B,G);Object.defineProperty(W,G,K.get?K:{enumerable:!0,get:function(){return B[G]}})}),W}var fabric$1={};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(B){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var p=p||{version:"5.4.2"};if(B.fabric=p,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?p.document=document:p.document=document.implementation.createHTMLDocument(""),p.window=window;else{var W=require$$2,G=new W.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;p.document=G.document,p.jsdomImplForWrapper=require$$2.implForWrapper,p.nodeCanvas=require$$2.Canvas,p.window=G,DOMParser=p.window.DOMParser}p.isTouchSupported="ontouchstart"in p.window||"ontouchstart"in p.document||p.window&&p.window.navigator&&p.window.navigator.maxTouchPoints>0,p.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",p.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],p.DPI=96,p.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",p.commaWsp="(?:\\s+,?\\s*|,\\s*)",p.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,p.reNonWord=/[ \n\.,;!\?\-]/,p.fontPaths={},p.iMatrix=[1,0,0,1,0,0],p.svgNS="http://www.w3.org/2000/svg",p.perfLimitSizeTotal=2097152,p.maxCacheSideLimit=4096,p.minCacheSideLimit=256,p.charWidthsCache={},p.textureSize=2048,p.disableStyleCopyPaste=!1,p.enableGLFiltering=!0,p.devicePixelRatio=p.window.devicePixelRatio||p.window.webkitDevicePixelRatio||p.window.mozDevicePixelRatio||1,p.browserShadowBlurConstant=1,p.arcToSegmentsCache={},p.boundsOfCurveCache={},p.cachesBoundsOfCurve=!0,p.forceGLPutImageData=!1,p.initFilterBackend=function(){if(p.enableGLFiltering&&p.isWebglSupported&&p.isWebglSupported(p.textureSize))return console.log("max texture size: "+p.maxTextureSize),new p.WebglFilterBackend({tileSize:p.textureSize});if(p.Canvas2dFilterBackend)return new p.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=p),function(){function M(l,L){if(this.__eventListeners[l]){var q=this.__eventListeners[l];L?q[q.indexOf(L)]=!1:p.util.array.fill(q,!1)}}function E(l,L){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var q in l)this.on(q,l[q]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(L);return this}function F(l,L){var q=(function(){L.apply(this,arguments),this.off(l,q)}).bind(this);this.on(l,q)}function R(l,L){if(arguments.length===1)for(var q in l)F.call(this,q,l[q]);else F.call(this,l,L);return this}function o(l,L){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)M.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var q in l)M.call(this,q,l[q]);else M.call(this,l,L);return this}function S(l,L){if(!this.__eventListeners)return this;var q=this.__eventListeners[l];if(!q)return this;for(var O=0,X=q.length;O<X;O++)q[O]&&q[O].call(this,L||{});return this.__eventListeners[l]=q.filter(function(V){return V!==!1}),this}p.Observable={fire:S,on:E,once:R,off:o}}(),p.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var M=0,E=arguments.length;M<E;M++)this._onObjectAdded(arguments[M]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(M,E,F){var R=this._objects;return F?R[E]=M:R.splice(E,0,M),this._onObjectAdded&&this._onObjectAdded(M),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var M=this._objects,E,F=!1,R=0,o=arguments.length;R<o;R++)E=M.indexOf(arguments[R]),E!==-1&&(F=!0,M.splice(E,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[R]));return this.renderOnAddRemove&&F&&this.requestRenderAll(),this},forEachObject:function(M,E){for(var F=this.getObjects(),R=0,o=F.length;R<o;R++)M.call(E,F[R],R,F);return this},getObjects:function(M){return typeof M>"u"?this._objects.concat():this._objects.filter(function(E){return E.type===M})},item:function(M){return this._objects[M]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(M,E){return this._objects.indexOf(M)>-1?!0:E?this._objects.some(function(F){return typeof F.contains=="function"&&F.contains(M,!0)}):!1},complexity:function(){return this._objects.reduce(function(M,E){return M+=E.complexity?E.complexity():0,M},0)}},p.CommonMethods={_setOptions:function(M){for(var E in M)this.set(E,M[E])},_initGradient:function(M,E){M&&M.colorStops&&!(M instanceof p.Gradient)&&this.set(E,new p.Gradient(M))},_initPattern:function(M,E,F){M&&M.source&&!(M instanceof p.Pattern)?this.set(E,new p.Pattern(M,F)):F&&F()},_setObject:function(M){for(var E in M)this._set(E,M[E])},set:function(M,E){return typeof M=="object"?this._setObject(M):this._set(M,E),this},_set:function(M,E){this[M]=E},toggle:function(M){var E=this.get(M);return typeof E=="boolean"&&this.set(M,!E),this},get:function(M){return this[M]}},function(M){var E=Math.sqrt,F=Math.atan2,R=Math.pow,o=Math.PI/180,S=Math.PI/2;p.util={cos:function(l){if(l===0)return 1;l<0&&(l=-l);var L=l/S;switch(L){case 1:case 3:return 0;case 2:return-1}return Math.cos(l)},sin:function(l){if(l===0)return 0;var L=l/S,q=1;switch(l<0&&(q=-1),L){case 1:return q;case 2:return 0;case 3:return-q}return Math.sin(l)},removeFromArray:function(l,L){var q=l.indexOf(L);return q!==-1&&l.splice(q,1),l},getRandomInt:function(l,L){return Math.floor(Math.random()*(L-l+1))+l},degreesToRadians:function(l){return l*o},radiansToDegrees:function(l){return l/o},rotatePoint:function(l,L,q){var O=new p.Point(l.x-L.x,l.y-L.y),X=p.util.rotateVector(O,q);return new p.Point(X.x,X.y).addEquals(L)},rotateVector:function(l,L){var q=p.util.sin(L),O=p.util.cos(L),X=l.x*O-l.y*q,V=l.x*q+l.y*O;return{x:X,y:V}},createVector:function(l,L){return new p.Point(L.x-l.x,L.y-l.y)},calcAngleBetweenVectors:function(l,L){return Math.acos((l.x*L.x+l.y*L.y)/(Math.hypot(l.x,l.y)*Math.hypot(L.x,L.y)))},getHatVector:function(l){return new p.Point(l.x,l.y).multiply(1/Math.hypot(l.x,l.y))},getBisector:function(l,L,q){var O=p.util.createVector(l,L),X=p.util.createVector(l,q),V=p.util.calcAngleBetweenVectors(O,X),Y=p.util.calcAngleBetweenVectors(p.util.rotateVector(O,V),X),U=V*(Y===0?1:-1)/2;return{vector:p.util.getHatVector(p.util.rotateVector(O,U)),angle:V}},projectStrokeOnPoints:function(l,L,q){var O=[],X=L.strokeWidth/2,V=L.strokeUniform?new p.Point(1/L.scaleX,1/L.scaleY):new p.Point(1,1),Y=function(U){var Q=X/Math.hypot(U.x,U.y);return new p.Point(U.x*Q*V.x,U.y*Q*V.y)};return l.length<=1||l.forEach(function(U,Q){var te=new p.Point(U.x,U.y),se,fe;Q===0?(fe=l[Q+1],se=q?Y(p.util.createVector(fe,te)).addEquals(te):l[l.length-1]):Q===l.length-1?(se=l[Q-1],fe=q?Y(p.util.createVector(se,te)).addEquals(te):l[0]):(se=l[Q-1],fe=l[Q+1]);var Se=p.util.getBisector(te,se,fe),Te=Se.vector,Re=Se.angle,je,He;if(L.strokeLineJoin==="miter"&&(je=-X/Math.sin(Re/2),He=new p.Point(Te.x*je*V.x,Te.y*je*V.y),Math.hypot(He.x,He.y)/X<=L.strokeMiterLimit)){O.push(te.add(He)),O.push(te.subtract(He));return}je=-X*Math.SQRT2,He=new p.Point(Te.x*je*V.x,Te.y*je*V.y),O.push(te.add(He)),O.push(te.subtract(He))}),O},transformPoint:function(l,L,q){return q?new p.Point(L[0]*l.x+L[2]*l.y,L[1]*l.x+L[3]*l.y):new p.Point(L[0]*l.x+L[2]*l.y+L[4],L[1]*l.x+L[3]*l.y+L[5])},makeBoundingBoxFromPoints:function(l,L){if(L)for(var q=0;q<l.length;q++)l[q]=p.util.transformPoint(l[q],L);var O=[l[0].x,l[1].x,l[2].x,l[3].x],X=p.util.array.min(O),V=p.util.array.max(O),Y=V-X,U=[l[0].y,l[1].y,l[2].y,l[3].y],Q=p.util.array.min(U),te=p.util.array.max(U),se=te-Q;return{left:X,top:Q,width:Y,height:se}},invertTransform:function(l){var L=1/(l[0]*l[3]-l[1]*l[2]),q=[L*l[3],-L*l[1],-L*l[2],L*l[0]],O=p.util.transformPoint({x:l[4],y:l[5]},q,!0);return q[4]=-O.x,q[5]=-O.y,q},toFixed:function(l,L){return parseFloat(Number(l).toFixed(L))},parseUnit:function(l,L){var q=/\D{0,2}$/.exec(l),O=parseFloat(l);switch(L||(L=p.Text.DEFAULT_SVG_FONT_SIZE),q[0]){case"mm":return O*p.DPI/25.4;case"cm":return O*p.DPI/2.54;case"in":return O*p.DPI;case"pt":return O*p.DPI/72;case"pc":return O*p.DPI/72*12;case"em":return O*L;default:return O}},falseFunction:function(){return!1},getKlass:function(l,L){return l=p.util.string.camelize(l.charAt(0).toUpperCase()+l.slice(1)),p.util.resolveNamespace(L)[l]},getSvgAttributes:function(l){var L=["instantiated_by_use","style","id","class"];switch(l){case"linearGradient":L=L.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":L=L.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":L=L.concat(["offset","stop-color","stop-opacity"]);break}return L},resolveNamespace:function(l){if(!l)return p;var L=l.split("."),q=L.length,O,X=M||p.window;for(O=0;O<q;++O)X=X[L[O]];return X},loadImage:function(l,L,q,O){if(!l){L&&L.call(q,l);return}var X=p.util.createImage(),V=function(){L&&L.call(q,X,!1),X=X.onload=X.onerror=null};X.onload=V,X.onerror=function(){p.log("Error loading "+X.src),L&&L.call(q,null,!0),X=X.onload=X.onerror=null},l.indexOf("data")!==0&&O!==void 0&&O!==null&&(X.crossOrigin=O),l.substring(0,14)==="data:image/svg"&&(X.onload=null,p.util.loadImageInDom(X,V)),X.src=l},loadImageInDom:function(l,L){var q=p.document.createElement("div");q.style.width=q.style.height="1px",q.style.left=q.style.top="-100%",q.style.position="absolute",q.appendChild(l),p.document.querySelector("body").appendChild(q),l.onload=function(){L(),q.parentNode.removeChild(q),q=null}},enlivenObjects:function(l,L,q,O){l=l||[];var X=[],V=0,Y=l.length;function U(){++V===Y&&L&&L(X.filter(function(Q){return Q}))}if(!Y){L&&L(X);return}l.forEach(function(Q,te){if(!Q||!Q.type){U();return}var se=p.util.getKlass(Q.type,q);se.fromObject(Q,function(fe,Se){Se||(X[te]=fe),O&&O(Q,fe,Se),U()})})},enlivenObjectEnlivables:function(l,L,q){var O=p.Object.ENLIVEN_PROPS.filter(function(X){return!!l[X]});p.util.enlivenObjects(O.map(function(X){return l[X]}),function(X){var V={};O.forEach(function(Y,U){V[Y]=X[U],L&&(L[Y]=X[U])}),q&&q(V)})},enlivenPatterns:function(l,L){l=l||[];function q(){++X===V&&L&&L(O)}var O=[],X=0,V=l.length;if(!V){L&&L(O);return}l.forEach(function(Y,U){Y&&Y.source?new p.Pattern(Y,function(Q){O[U]=Q,q()}):(O[U]=Y,q())})},groupSVGElements:function(l,L,q){var O;return l&&l.length===1?(typeof q<"u"&&(l[0].sourcePath=q),l[0]):(L&&(L.width&&L.height?L.centerPoint={x:L.width/2,y:L.height/2}:(delete L.width,delete L.height)),O=new p.Group(l,L),typeof q<"u"&&(O.sourcePath=q),O)},populateWithProperties:function(l,L,q){if(q&&Array.isArray(q))for(var O=0,X=q.length;O<X;O++)q[O]in l&&(L[q[O]]=l[q[O]])},createCanvasElement:function(){return p.document.createElement("canvas")},copyCanvasElement:function(l){var L=p.util.createCanvasElement();return L.width=l.width,L.height=l.height,L.getContext("2d").drawImage(l,0,0),L},toDataURL:function(l,L,q){return l.toDataURL("image/"+L,q)},createImage:function(){return p.document.createElement("img")},multiplyTransformMatrices:function(l,L,q){return[l[0]*L[0]+l[2]*L[1],l[1]*L[0]+l[3]*L[1],l[0]*L[2]+l[2]*L[3],l[1]*L[2]+l[3]*L[3],q?0:l[0]*L[4]+l[2]*L[5]+l[4],q?0:l[1]*L[4]+l[3]*L[5]+l[5]]},qrDecompose:function(l){var L=F(l[1],l[0]),q=R(l[0],2)+R(l[1],2),O=E(q),X=(l[0]*l[3]-l[2]*l[1])/O,V=F(l[0]*l[2]+l[1]*l[3],q);return{angle:L/o,scaleX:O,scaleY:X,skewX:V/o,skewY:0,translateX:l[4],translateY:l[5]}},calcRotateMatrix:function(l){if(!l.angle)return p.iMatrix.concat();var L=p.util.degreesToRadians(l.angle),q=p.util.cos(L),O=p.util.sin(L);return[q,O,-O,q,0,0]},calcDimensionsMatrix:function(l){var L=typeof l.scaleX>"u"?1:l.scaleX,q=typeof l.scaleY>"u"?1:l.scaleY,O=[l.flipX?-L:L,0,0,l.flipY?-q:q,0,0],X=p.util.multiplyTransformMatrices,V=p.util.degreesToRadians;return l.skewX&&(O=X(O,[1,0,Math.tan(V(l.skewX)),1],!0)),l.skewY&&(O=X(O,[1,Math.tan(V(l.skewY)),0,1],!0)),O},composeMatrix:function(l){var L=[1,0,0,1,l.translateX||0,l.translateY||0],q=p.util.multiplyTransformMatrices;return l.angle&&(L=q(L,p.util.calcRotateMatrix(l))),(l.scaleX!==1||l.scaleY!==1||l.skewX||l.skewY||l.flipX||l.flipY)&&(L=q(L,p.util.calcDimensionsMatrix(l))),L},resetObjectTransform:function(l){l.scaleX=1,l.scaleY=1,l.skewX=0,l.skewY=0,l.flipX=!1,l.flipY=!1,l.rotate(0)},saveObjectTransform:function(l){return{scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,angle:l.angle,left:l.left,flipX:l.flipX,flipY:l.flipY,top:l.top}},isTransparent:function(l,L,q,O){O>0&&(L>O?L-=O:L=0,q>O?q-=O:q=0);var X=!0,V,Y,U=l.getImageData(L,q,O*2||1,O*2||1),Q=U.data.length;for(V=3;V<Q&&(Y=U.data[V],X=Y<=0,X!==!1);V+=4);return U=null,X},parsePreserveAspectRatioAttribute:function(l){var L="meet",q="Mid",O="Mid",X=l.split(" "),V;return X&&X.length&&(L=X.pop(),L!=="meet"&&L!=="slice"?(V=L,L="meet"):X.length&&(V=X.pop())),q=V!=="none"?V.slice(1,4):"none",O=V!=="none"?V.slice(5,8):"none",{meetOrSlice:L,alignX:q,alignY:O}},clearFabricFontCache:function(l){l=(l||"").toLowerCase(),l?p.charWidthsCache[l]&&delete p.charWidthsCache[l]:p.charWidthsCache={}},limitDimsByArea:function(l,L){var q=Math.sqrt(L*l),O=Math.floor(L/q);return{x:Math.floor(q),y:O}},capValue:function(l,L,q){return Math.max(l,Math.min(L,q))},findScaleToFit:function(l,L){return Math.min(L.width/l.width,L.height/l.height)},findScaleToCover:function(l,L){return Math.max(L.width/l.width,L.height/l.height)},matrixToSVG:function(l){return"matrix("+l.map(function(L){return p.util.toFixed(L,p.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(l,L){var q=p.util.invertTransform(L),O=p.util.multiplyTransformMatrices(q,l.calcOwnMatrix());p.util.applyTransformToObject(l,O)},addTransformToObject:function(l,L){p.util.applyTransformToObject(l,p.util.multiplyTransformMatrices(L,l.calcOwnMatrix()))},applyTransformToObject:function(l,L){var q=p.util.qrDecompose(L),O=new p.Point(q.translateX,q.translateY);l.flipX=!1,l.flipY=!1,l.set("scaleX",q.scaleX),l.set("scaleY",q.scaleY),l.skewX=q.skewX,l.skewY=q.skewY,l.angle=q.angle,l.setPositionByOrigin(O,"center","center")},sizeAfterTransform:function(l,L,q){var O=l/2,X=L/2,V=[{x:-O,y:-X},{x:O,y:-X},{x:-O,y:X},{x:O,y:X}],Y=p.util.calcDimensionsMatrix(q),U=p.util.makeBoundingBoxFromPoints(V,Y);return{x:U.width,y:U.height}},mergeClipPaths:function(l,L){var q=l,O=L;q.inverted&&!O.inverted&&(q=L,O=l),p.util.applyTransformToObject(O,p.util.multiplyTransformMatrices(p.util.invertTransform(q.calcTransformMatrix()),O.calcTransformMatrix()));var X=q.inverted&&O.inverted;return X&&(q.inverted=O.inverted=!1),new p.Group([q],{clipPath:O,inverted:X})},hasStyleChanged:function(l,L,q){return q=q||!1,l.fill!==L.fill||l.stroke!==L.stroke||l.strokeWidth!==L.strokeWidth||l.fontSize!==L.fontSize||l.fontFamily!==L.fontFamily||l.fontWeight!==L.fontWeight||l.fontStyle!==L.fontStyle||l.textBackgroundColor!==L.textBackgroundColor||l.deltaY!==L.deltaY||q&&(l.overline!==L.overline||l.underline!==L.underline||l.linethrough!==L.linethrough)},stylesToArray:function(q,L){for(var q=p.util.object.clone(q,!0),O=L.split(`
`),X=-1,V={},Y=[],U=0;U<O.length;U++){if(!q[U]){X+=O[U].length;continue}for(var Q=0;Q<O[U].length;Q++){X++;var te=q[U][Q];if(te&&Object.keys(te).length>0){var se=p.util.hasStyleChanged(V,te,!0);se?Y.push({start:X,end:X+1,style:te}):Y[Y.length-1].end++}V=te||{}}}return Y},stylesFromArray:function(l,L){if(!Array.isArray(l))return l;for(var q=L.split(`
`),O=-1,X=0,V={},Y=0;Y<q.length;Y++)for(var U=0;U<q[Y].length;U++)O++,l[X]&&l[X].start<=O&&O<l[X].end&&(V[Y]=V[Y]||{},V[Y][U]=Object.assign({},l[X].style),O===l[X].end-1&&X++);return V}}}(B),function(){var M=Array.prototype.join,E={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},F={m:"l",M:"L"};function R(re,ce,ue,he,pe,oe,ne,ge,ye,ke,xe){var Fe=p.util.cos(re),Me=p.util.sin(re),ze=p.util.cos(ce),we=p.util.sin(ce),be=ue*pe*ze-he*oe*we+ne,Pe=he*pe*ze+ue*oe*we+ge,Le=ke+ye*(-ue*pe*Me-he*oe*Fe),Ce=xe+ye*(-he*pe*Me+ue*oe*Fe),De=be+ye*(ue*pe*we+he*oe*ze),We=Pe+ye*(he*pe*we-ue*oe*ze);return["C",Le,Ce,De,We,be,Pe]}function o(re,ce,ue,he,pe,oe,ne){var ge=Math.PI,ye=ne*ge/180,ke=p.util.sin(ye),xe=p.util.cos(ye),Fe=0,Me=0;ue=Math.abs(ue),he=Math.abs(he);var ze=-xe*re*.5-ke*ce*.5,we=-xe*ce*.5+ke*re*.5,be=ue*ue,Pe=he*he,Le=we*we,Ce=ze*ze,De=be*Pe-be*Le-Pe*Ce,We=0;if(De<0){var et=Math.sqrt(1-De/(be*Pe));ue*=et,he*=et}else We=(pe===oe?-1:1)*Math.sqrt(De/(be*Le+Pe*Ce));var $e=We*ue*we/he,Oe=-We*he*ze/ue,Ke=xe*$e-ke*Oe+re*.5,tt=ke*$e+xe*Oe+ce*.5,it=S(1,0,(ze-$e)/ue,(we-Oe)/he),lt=S((ze-$e)/ue,(we-Oe)/he,(-ze-$e)/ue,(-we-Oe)/he);oe===0&&lt>0?lt-=2*ge:oe===1&&lt<0&&(lt+=2*ge);for(var rt=Math.ceil(Math.abs(lt/ge*2)),dt=[],ct=lt/rt,vt=8/3*Math.sin(ct/4)*Math.sin(ct/4)/Math.sin(ct/2),wt=it+ct,ae=0;ae<rt;ae++)dt[ae]=R(it,wt,xe,ke,ue,he,Ke,tt,vt,Fe,Me),Fe=dt[ae][5],Me=dt[ae][6],it=wt,wt+=ct;return dt}function S(re,ce,ue,he){var pe=Math.atan2(ce,re),oe=Math.atan2(he,ue);return oe>=pe?oe-pe:2*Math.PI-(pe-oe)}function l(re,ce,ue,he,pe,oe,ne,ge){var ye;if(p.cachesBoundsOfCurve&&(ye=M.call(arguments),p.boundsOfCurveCache[ye]))return p.boundsOfCurveCache[ye];var ke=Math.sqrt,xe=Math.min,Fe=Math.max,Me=Math.abs,ze=[],we=[[],[]],be,Pe,Le,Ce,De,We,et,$e;Pe=6*re-12*ue+6*pe,be=-3*re+9*ue-9*pe+3*ne,Le=3*ue-3*re;for(var Oe=0;Oe<2;++Oe){if(Oe>0&&(Pe=6*ce-12*he+6*oe,be=-3*ce+9*he-9*oe+3*ge,Le=3*he-3*ce),Me(be)<1e-12){if(Me(Pe)<1e-12)continue;Ce=-Le/Pe,0<Ce&&Ce<1&&ze.push(Ce);continue}et=Pe*Pe-4*Le*be,!(et<0)&&($e=ke(et),De=(-Pe+$e)/(2*be),0<De&&De<1&&ze.push(De),We=(-Pe-$e)/(2*be),0<We&&We<1&&ze.push(We))}for(var Ke,tt,it=ze.length,lt=it,rt;it--;)Ce=ze[it],rt=1-Ce,Ke=rt*rt*rt*re+3*rt*rt*Ce*ue+3*rt*Ce*Ce*pe+Ce*Ce*Ce*ne,we[0][it]=Ke,tt=rt*rt*rt*ce+3*rt*rt*Ce*he+3*rt*Ce*Ce*oe+Ce*Ce*Ce*ge,we[1][it]=tt;we[0][lt]=re,we[1][lt]=ce,we[0][lt+1]=ne,we[1][lt+1]=ge;var dt=[{x:xe.apply(null,we[0]),y:xe.apply(null,we[1])},{x:Fe.apply(null,we[0]),y:Fe.apply(null,we[1])}];return p.cachesBoundsOfCurve&&(p.boundsOfCurveCache[ye]=dt),dt}function L(re,ce,ue){for(var he=ue[1],pe=ue[2],oe=ue[3],ne=ue[4],ge=ue[5],ye=ue[6],ke=ue[7],xe=o(ye-re,ke-ce,he,pe,ne,ge,oe),Fe=0,Me=xe.length;Fe<Me;Fe++)xe[Fe][1]+=re,xe[Fe][2]+=ce,xe[Fe][3]+=re,xe[Fe][4]+=ce,xe[Fe][5]+=re,xe[Fe][6]+=ce;return xe}function q(re){var ce=0,ue=0,he=re.length,pe=0,oe=0,ne,ge,ye,ke=[],xe,Fe,Me;for(ge=0;ge<he;++ge){switch(ye=!1,ne=re[ge].slice(0),ne[0]){case"l":ne[0]="L",ne[1]+=ce,ne[2]+=ue;case"L":ce=ne[1],ue=ne[2];break;case"h":ne[1]+=ce;case"H":ne[0]="L",ne[2]=ue,ce=ne[1];break;case"v":ne[1]+=ue;case"V":ne[0]="L",ue=ne[1],ne[1]=ce,ne[2]=ue;break;case"m":ne[0]="M",ne[1]+=ce,ne[2]+=ue;case"M":ce=ne[1],ue=ne[2],pe=ne[1],oe=ne[2];break;case"c":ne[0]="C",ne[1]+=ce,ne[2]+=ue,ne[3]+=ce,ne[4]+=ue,ne[5]+=ce,ne[6]+=ue;case"C":Fe=ne[3],Me=ne[4],ce=ne[5],ue=ne[6];break;case"s":ne[0]="S",ne[1]+=ce,ne[2]+=ue,ne[3]+=ce,ne[4]+=ue;case"S":xe==="C"?(Fe=2*ce-Fe,Me=2*ue-Me):(Fe=ce,Me=ue),ce=ne[3],ue=ne[4],ne[0]="C",ne[5]=ne[3],ne[6]=ne[4],ne[3]=ne[1],ne[4]=ne[2],ne[1]=Fe,ne[2]=Me,Fe=ne[3],Me=ne[4];break;case"q":ne[0]="Q",ne[1]+=ce,ne[2]+=ue,ne[3]+=ce,ne[4]+=ue;case"Q":Fe=ne[1],Me=ne[2],ce=ne[3],ue=ne[4];break;case"t":ne[0]="T",ne[1]+=ce,ne[2]+=ue;case"T":xe==="Q"?(Fe=2*ce-Fe,Me=2*ue-Me):(Fe=ce,Me=ue),ne[0]="Q",ce=ne[1],ue=ne[2],ne[1]=Fe,ne[2]=Me,ne[3]=ce,ne[4]=ue;break;case"a":ne[0]="A",ne[6]+=ce,ne[7]+=ue;case"A":ye=!0,ke=ke.concat(L(ce,ue,ne)),ce=ne[6],ue=ne[7];break;case"z":case"Z":ce=pe,ue=oe;break}ye||ke.push(ne),xe=ne[0]}return ke}function O(re,ce,ue,he){return Math.sqrt((ue-re)*(ue-re)+(he-ce)*(he-ce))}function X(re){return re*re*re}function V(re){return 3*re*re*(1-re)}function Y(re){return 3*re*(1-re)*(1-re)}function U(re){return(1-re)*(1-re)*(1-re)}function Q(re,ce,ue,he,pe,oe,ne,ge){return function(ye){var ke=X(ye),xe=V(ye),Fe=Y(ye),Me=U(ye);return{x:ne*ke+pe*xe+ue*Fe+re*Me,y:ge*ke+oe*xe+he*Fe+ce*Me}}}function te(re,ce,ue,he,pe,oe,ne,ge){return function(ye){var ke=1-ye,xe=3*ke*ke*(ue-re)+6*ke*ye*(pe-ue)+3*ye*ye*(ne-pe),Fe=3*ke*ke*(he-ce)+6*ke*ye*(oe-he)+3*ye*ye*(ge-oe);return Math.atan2(Fe,xe)}}function se(re){return re*re}function fe(re){return 2*re*(1-re)}function Se(re){return(1-re)*(1-re)}function Te(re,ce,ue,he,pe,oe){return function(ne){var ge=se(ne),ye=fe(ne),ke=Se(ne);return{x:pe*ge+ue*ye+re*ke,y:oe*ge+he*ye+ce*ke}}}function Re(re,ce,ue,he,pe,oe){return function(ne){var ge=1-ne,ye=2*ge*(ue-re)+2*ne*(pe-ue),ke=2*ge*(he-ce)+2*ne*(oe-he);return Math.atan2(ke,ye)}}function je(re,ce,ue){var he={x:ce,y:ue},pe,oe=0,ne;for(ne=1;ne<=100;ne+=1)pe=re(ne/100),oe+=O(he.x,he.y,pe.x,pe.y),he=pe;return oe}function He(re,ce){for(var ue=0,he=0,pe=re.iterator,oe={x:re.x,y:re.y},ne,ge,ye=.01,ke=re.angleFinder,xe;he<ce&&ye>1e-4;)ne=pe(ue),xe=ue,ge=O(oe.x,oe.y,ne.x,ne.y),ge+he>ce?(ue-=ye,ye/=2):(oe=ne,ue+=ye,he+=ge);return ne.angle=ke(xe),ne}function ve(re){for(var ce=0,ue=re.length,he,pe=0,oe=0,ne=0,ge=0,ye=[],ke,xe,Fe,Me=0;Me<ue;Me++){switch(he=re[Me],xe={x:pe,y:oe,command:he[0]},he[0]){case"M":xe.length=0,ne=pe=he[1],ge=oe=he[2];break;case"L":xe.length=O(pe,oe,he[1],he[2]),pe=he[1],oe=he[2];break;case"C":ke=Q(pe,oe,he[1],he[2],he[3],he[4],he[5],he[6]),Fe=te(pe,oe,he[1],he[2],he[3],he[4],he[5],he[6]),xe.iterator=ke,xe.angleFinder=Fe,xe.length=je(ke,pe,oe),pe=he[5],oe=he[6];break;case"Q":ke=Te(pe,oe,he[1],he[2],he[3],he[4]),Fe=Re(pe,oe,he[1],he[2],he[3],he[4]),xe.iterator=ke,xe.angleFinder=Fe,xe.length=je(ke,pe,oe),pe=he[3],oe=he[4];break;case"Z":case"z":xe.destX=ne,xe.destY=ge,xe.length=O(pe,oe,ne,ge),pe=ne,oe=ge;break}ce+=xe.length,ye.push(xe)}return ye.push({length:ce,x:pe,y:oe}),ye}function _e(re,ce,ue){ue||(ue=ve(re));for(var he=0;ce-ue[he].length>0&&he<ue.length-2;)ce-=ue[he].length,he++;var pe=ue[he],oe=ce/pe.length,ne=pe.command,ge=re[he],ye;switch(ne){case"M":return{x:pe.x,y:pe.y,angle:0};case"Z":case"z":return ye=new p.Point(pe.x,pe.y).lerp(new p.Point(pe.destX,pe.destY),oe),ye.angle=Math.atan2(pe.destY-pe.y,pe.destX-pe.x),ye;case"L":return ye=new p.Point(pe.x,pe.y).lerp(new p.Point(ge[1],ge[2]),oe),ye.angle=Math.atan2(ge[2]-pe.y,ge[1]-pe.x),ye;case"C":return He(pe,ce);case"Q":return He(pe,ce)}}function qe(re){var ce=[],ue=[],he,pe,oe=p.rePathCommand,ne="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",ge="("+ne+")"+p.commaWsp,ye="([01])"+p.commaWsp+"?",ke=ge+"?"+ge+"?"+ge+ye+ye+ge+"?("+ne+")",xe=new RegExp(ke,"g"),Fe,Me,ze;if(!re||!re.match)return ce;ze=re.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var we=0,be,Pe=ze.length;we<Pe;we++){he=ze[we],Me=he.slice(1).trim(),ue.length=0;var Le=he.charAt(0);if(be=[Le],Le.toLowerCase()==="a")for(var Ce;Ce=xe.exec(Me);)for(var De=1;De<Ce.length;De++)ue.push(Ce[De]);else for(;Fe=oe.exec(Me);)ue.push(Fe[0]);for(var De=0,We=ue.length;De<We;De++)pe=parseFloat(ue[De]),isNaN(pe)||be.push(pe);var et=E[Le.toLowerCase()],$e=F[Le]||Le;if(be.length-1>et)for(var Oe=1,Ke=be.length;Oe<Ke;Oe+=et)ce.push([Le].concat(be.slice(Oe,Oe+et))),Le=$e;else ce.push(be)}return ce}function Xe(re,ce){var ue=[],he,pe=new p.Point(re[0].x,re[0].y),oe=new p.Point(re[1].x,re[1].y),ne=re.length,ge=1,ye=0,ke=ne>2;for(ce=ce||0,ke&&(ge=re[2].x<oe.x?-1:re[2].x===oe.x?0:1,ye=re[2].y<oe.y?-1:re[2].y===oe.y?0:1),ue.push(["M",pe.x-ge*ce,pe.y-ye*ce]),he=1;he<ne;he++){if(!pe.eq(oe)){var xe=pe.midPointFrom(oe);ue.push(["Q",pe.x,pe.y,xe.x,xe.y])}pe=re[he],he+1<re.length&&(oe=re[he+1])}return ke&&(ge=pe.x>re[he-2].x?1:pe.x===re[he-2].x?0:-1,ye=pe.y>re[he-2].y?1:pe.y===re[he-2].y?0:-1),ue.push(["L",pe.x+ge*ce,pe.y+ye*ce]),ue}function Ge(re,ce,ue){return ue&&(ce=p.util.multiplyTransformMatrices(ce,[1,0,0,1,-ue.x,-ue.y])),re.map(function(he){for(var pe=he.slice(0),oe={},ne=1;ne<he.length-1;ne+=2)oe.x=he[ne],oe.y=he[ne+1],oe=p.util.transformPoint(oe,ce),pe[ne]=oe.x,pe[ne+1]=oe.y;return pe})}p.util.joinPath=function(re){return re.map(function(ce){return ce.join(" ")}).join(" ")},p.util.parsePath=qe,p.util.makePathSimpler=q,p.util.getSmoothPathFromPoints=Xe,p.util.getPathSegmentsInfo=ve,p.util.getBoundsOfCurve=l,p.util.getPointOnPath=_e,p.util.transformPath=Ge}(),function(){var M=Array.prototype.slice;function E(l,L){for(var q=M.call(arguments,2),O=[],X=0,V=l.length;X<V;X++)O[X]=q.length?l[X][L].apply(l[X],q):l[X][L].call(l[X]);return O}function F(l,L){return S(l,L,function(q,O){return q>=O})}function R(l,L){return S(l,L,function(q,O){return q<O})}function o(l,L){for(var q=l.length;q--;)l[q]=L;return l}function S(l,L,q){if(!(!l||l.length===0)){var O=l.length-1,X=L?l[O][L]:l[O];if(L)for(;O--;)q(l[O][L],X)&&(X=l[O][L]);else for(;O--;)q(l[O],X)&&(X=l[O]);return X}}p.util.array={fill:o,invoke:E,min:R,max:F}}(),function(){function M(F,R,o){if(o)if(!p.isLikelyNode&&R instanceof Element)F=R;else if(R instanceof Array){F=[];for(var S=0,l=R.length;S<l;S++)F[S]=M({},R[S],o)}else if(R&&typeof R=="object")for(var L in R)L==="canvas"||L==="group"?F[L]=null:R.hasOwnProperty(L)&&(F[L]=M({},R[L],o));else F=R;else for(var L in R)F[L]=R[L];return F}function E(F,R){return M({},F,R)}p.util.object={extend:M,clone:E},p.util.object.extend(p.util,p.Observable)}(),function(){function M(S){return S.replace(/-+(.)?/g,function(l,L){return L?L.toUpperCase():""})}function E(S,l){return S.charAt(0).toUpperCase()+(l?S.slice(1):S.slice(1).toLowerCase())}function F(S){return S.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function R(S){var l=0,L,q=[];for(l=0,L;l<S.length;l++)(L=o(S,l))!==!1&&q.push(L);return q}function o(S,l){var L=S.charCodeAt(l);if(isNaN(L))return"";if(L<55296||L>57343)return S.charAt(l);if(55296<=L&&L<=56319){if(S.length<=l+1)throw"High surrogate without following low surrogate";var q=S.charCodeAt(l+1);if(56320>q||q>57343)throw"High surrogate without following low surrogate";return S.charAt(l)+S.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var O=S.charCodeAt(l-1);if(55296>O||O>56319)throw"Low surrogate without preceding high surrogate";return!1}p.util.string={camelize:M,capitalize:E,escapeXml:F,graphemeSplit:R}}(),function(){var M=Array.prototype.slice,E=function(){},F=function(){for(var L in{toString:1})if(L==="toString")return!1;return!0}(),R=function(L,q,O){for(var X in q)X in L.prototype&&typeof L.prototype[X]=="function"&&(q[X]+"").indexOf("callSuper")>-1?L.prototype[X]=function(V){return function(){var Y=this.constructor.superclass;this.constructor.superclass=O;var U=q[V].apply(this,arguments);if(this.constructor.superclass=Y,V!=="initialize")return U}}(X):L.prototype[X]=q[X],F&&(q.toString!==Object.prototype.toString&&(L.prototype.toString=q.toString),q.valueOf!==Object.prototype.valueOf&&(L.prototype.valueOf=q.valueOf))};function o(){}function S(L){for(var q=null,O=this;O.constructor.superclass;){var X=O.constructor.superclass.prototype[L];if(O[L]!==X){q=X;break}O=O.constructor.superclass.prototype}return q?arguments.length>1?q.apply(this,M.call(arguments,1)):q.call(this):console.log("tried to callSuper "+L+", method not found in prototype chain",this)}function l(){var L=null,q=M.call(arguments,0);typeof q[0]=="function"&&(L=q.shift());function O(){this.initialize.apply(this,arguments)}O.superclass=L,O.subclasses=[],L&&(o.prototype=L.prototype,O.prototype=new o,L.subclasses.push(O));for(var X=0,V=q.length;X<V;X++)R(O,q[X],L);return O.prototype.initialize||(O.prototype.initialize=E),O.prototype.constructor=O,O.prototype.callSuper=S,O}p.util.createClass=l}(),function(){var M=!!p.document.createElement("div").attachEvent,E=["touchstart","touchmove","touchend"];p.util.addListener=function(R,o,S,l){R&&R.addEventListener(o,S,M?!1:l)},p.util.removeListener=function(R,o,S,l){R&&R.removeEventListener(o,S,M?!1:l)};function F(R){var o=R.changedTouches;return o&&o[0]?o[0]:R}p.util.getPointer=function(R){var o=R.target,S=p.util.getScrollLeftTop(o),l=F(R);return{x:l.clientX+S.left,y:l.clientY+S.top}},p.util.isTouchEvent=function(R){return E.indexOf(R.type)>-1||R.pointerType==="touch"}}(),function(){function M(l,L){var q=l.style;if(!q)return l;if(typeof L=="string")return l.style.cssText+=";"+L,L.indexOf("opacity")>-1?S(l,L.match(/opacity:\s*(\d?\.?\d*)/)[1]):l;for(var O in L)if(O==="opacity")S(l,L[O]);else{var X=O==="float"||O==="cssFloat"?typeof q.styleFloat>"u"?"cssFloat":"styleFloat":O;q.setProperty(X,L[O])}return l}var E=p.document.createElement("div"),F=typeof E.style.opacity=="string",R=typeof E.style.filter=="string",o=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,S=function(l){return l};F?S=function(l,L){return l.style.opacity=L,l}:R&&(S=function(l,L){var q=l.style;return l.currentStyle&&!l.currentStyle.hasLayout&&(q.zoom=1),o.test(q.filter)?(L=L>=.9999?"":"alpha(opacity="+L*100+")",q.filter=q.filter.replace(o,L)):q.filter+=" alpha(opacity="+L*100+")",l}),p.util.setStyle=M}(),function(){var M=Array.prototype.slice;function E(U){return typeof U=="string"?p.document.getElementById(U):U}var F,R=function(U){return M.call(U,0)};try{F=R(p.document.childNodes)instanceof Array}catch{}F||(R=function(U){for(var Q=new Array(U.length),te=U.length;te--;)Q[te]=U[te];return Q});function o(U,Q){var te=p.document.createElement(U);for(var se in Q)se==="class"?te.className=Q[se]:se==="for"?te.htmlFor=Q[se]:te.setAttribute(se,Q[se]);return te}function S(U,Q){U&&(" "+U.className+" ").indexOf(" "+Q+" ")===-1&&(U.className+=(U.className?" ":"")+Q)}function l(U,Q,te){return typeof Q=="string"&&(Q=o(Q,te)),U.parentNode&&U.parentNode.replaceChild(Q,U),Q.appendChild(U),Q}function L(U){for(var Q=0,te=0,se=p.document.documentElement,fe=p.document.body||{scrollLeft:0,scrollTop:0};U&&(U.parentNode||U.host)&&(U=U.parentNode||U.host,U===p.document?(Q=fe.scrollLeft||se.scrollLeft||0,te=fe.scrollTop||se.scrollTop||0):(Q+=U.scrollLeft||0,te+=U.scrollTop||0),!(U.nodeType===1&&U.style.position==="fixed")););return{left:Q,top:te}}function q(U){var Q,te=U&&U.ownerDocument,se={left:0,top:0},fe={left:0,top:0},Se,Te={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!te)return fe;for(var Re in Te)fe[Te[Re]]+=parseInt(O(U,Re),10)||0;return Q=te.documentElement,typeof U.getBoundingClientRect<"u"&&(se=U.getBoundingClientRect()),Se=L(U),{left:se.left+Se.left-(Q.clientLeft||0)+fe.left,top:se.top+Se.top-(Q.clientTop||0)+fe.top}}var O;p.document.defaultView&&p.document.defaultView.getComputedStyle?O=function(U,Q){var te=p.document.defaultView.getComputedStyle(U,null);return te?te[Q]:void 0}:O=function(U,Q){var te=U.style[Q];return!te&&U.currentStyle&&(te=U.currentStyle[Q]),te},function(){var U=p.document.documentElement.style,Q="userSelect"in U?"userSelect":"MozUserSelect"in U?"MozUserSelect":"WebkitUserSelect"in U?"WebkitUserSelect":"KhtmlUserSelect"in U?"KhtmlUserSelect":"";function te(fe){return typeof fe.onselectstart<"u"&&(fe.onselectstart=p.util.falseFunction),Q?fe.style[Q]="none":typeof fe.unselectable=="string"&&(fe.unselectable="on"),fe}function se(fe){return typeof fe.onselectstart<"u"&&(fe.onselectstart=null),Q?fe.style[Q]="":typeof fe.unselectable=="string"&&(fe.unselectable=""),fe}p.util.makeElementUnselectable=te,p.util.makeElementSelectable=se}();function X(U){var Q=p.jsdomImplForWrapper(U);return Q._canvas||Q._image}function V(U){if(p.isLikelyNode){var Q=p.jsdomImplForWrapper(U);Q&&(Q._image=null,Q._canvas=null,Q._currentSrc=null,Q._attributes=null,Q._classList=null)}}function Y(U,Q){U.imageSmoothingEnabled=U.imageSmoothingEnabled||U.webkitImageSmoothingEnabled||U.mozImageSmoothingEnabled||U.msImageSmoothingEnabled||U.oImageSmoothingEnabled,U.imageSmoothingEnabled=Q}p.util.setImageSmoothing=Y,p.util.getById=E,p.util.toArray=R,p.util.addClass=S,p.util.makeElement=o,p.util.wrapElement=l,p.util.getScrollLeftTop=L,p.util.getElementOffset=q,p.util.getNodeCanvas=X,p.util.cleanUpJsdomNode=V}(),function(){function M(R,o){return R+(/\?/.test(R)?"&":"?")+o}function E(){}function F(R,o){o||(o={});var S=o.method?o.method.toUpperCase():"GET",l=o.onComplete||function(){},L=new p.window.XMLHttpRequest,q=o.body||o.parameters;return L.onreadystatechange=function(){L.readyState===4&&(l(L),L.onreadystatechange=E)},S==="GET"&&(q=null,typeof o.parameters=="string"&&(R=M(R,o.parameters))),L.open(S,R,!0),(S==="POST"||S==="PUT")&&L.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),L.send(q),L}p.util.request=F}(),p.log=console.log,p.warn=console.warn,function(){var M=p.util.object.extend,E=p.util.object.clone,F=[];p.util.object.extend(F,{cancelAll:function(){var X=this.splice(0);return X.forEach(function(V){V.cancel()}),X},cancelByCanvas:function(X){if(!X)return[];var V=this.filter(function(Y){return typeof Y.target=="object"&&Y.target.canvas===X});return V.forEach(function(Y){Y.cancel()}),V},cancelByTarget:function(X){var V=this.findAnimationsByTarget(X);return V.forEach(function(Y){Y.cancel()}),V},findAnimationIndex:function(X){return this.indexOf(this.findAnimation(X))},findAnimation:function(X){return this.find(function(V){return V.cancel===X})},findAnimationsByTarget:function(X){return X?this.filter(function(V){return V.target===X}):[]}});function R(){return!1}function o(X,V,Y,U){return-Y*Math.cos(X/U*(Math.PI/2))+Y+V}function S(X){X||(X={});var V=!1,Y,U=function(){var Q=p.runningAnimations.indexOf(Y);return Q>-1&&p.runningAnimations.splice(Q,1)[0]};return Y=M(E(X),{cancel:function(){return V=!0,U()},currentValue:"startValue"in X?X.startValue:0,completionRate:0,durationRate:0}),p.runningAnimations.push(Y),q(function(Q){var te=Q||+new Date,se=X.duration||500,fe=te+se,Se,Te=X.onChange||R,Re=X.abort||R,je=X.onComplete||R,He=X.easing||o,ve="startValue"in X?X.startValue.length>0:!1,_e="startValue"in X?X.startValue:0,qe="endValue"in X?X.endValue:100,Xe=X.byValue||(ve?_e.map(function(Ge,re){return qe[re]-_e[re]}):qe-_e);X.onStart&&X.onStart(),function Ge(re){Se=re||+new Date;var ce=Se>fe?se:Se-te,ue=ce/se,he=ve?_e.map(function(oe,ne){return He(ce,_e[ne],Xe[ne],se)}):He(ce,_e,Xe,se),pe=Math.abs(ve?(he[0]-_e[0])/Xe[0]:(he-_e)/Xe);if(Y.currentValue=ve?he.slice():he,Y.completionRate=pe,Y.durationRate=ue,!V){if(Re(he,pe,ue)){U();return}if(Se>fe){Y.currentValue=ve?qe.slice():qe,Y.completionRate=1,Y.durationRate=1,Te(ve?qe.slice():qe,1,1),je(qe,1,1),U();return}else Te(he,pe,ue),q(Ge)}}(te)}),Y.cancel}var l=p.window.requestAnimationFrame||p.window.webkitRequestAnimationFrame||p.window.mozRequestAnimationFrame||p.window.oRequestAnimationFrame||p.window.msRequestAnimationFrame||function(X){return p.window.setTimeout(X,1e3/60)},L=p.window.cancelAnimationFrame||p.window.clearTimeout;function q(){return l.apply(p.window,arguments)}function O(){return L.apply(p.window,arguments)}p.util.animate=S,p.util.requestAnimFrame=q,p.util.cancelAnimFrame=O,p.runningAnimations=F}(),function(){function M(F,R,o){var S="rgba("+parseInt(F[0]+o*(R[0]-F[0]),10)+","+parseInt(F[1]+o*(R[1]-F[1]),10)+","+parseInt(F[2]+o*(R[2]-F[2]),10);return S+=","+(F&&R?parseFloat(F[3]+o*(R[3]-F[3])):1),S+=")",S}function E(F,R,o,S){var l=new p.Color(F).getSource(),L=new p.Color(R).getSource(),q=S.onComplete,O=S.onChange;return S=S||{},p.util.animate(p.util.object.extend(S,{duration:o||500,startValue:l,endValue:L,byValue:L,easing:function(X,V,Y,U){var Q=S.colorEasing?S.colorEasing(X,U):1-Math.cos(X/U*(Math.PI/2));return M(V,Y,Q)},onComplete:function(X,V,Y){if(q)return q(M(L,L,0),V,Y)},onChange:function(X,V,Y){if(O){if(Array.isArray(X))return O(M(X,X,0),V,Y);O(X,V,Y)}}}))}p.util.animateColor=E}(),function(){function M(re,ce,ue,he){return re<Math.abs(ce)?(re=ce,he=ue/4):ce===0&&re===0?he=ue/(2*Math.PI)*Math.asin(1):he=ue/(2*Math.PI)*Math.asin(ce/re),{a:re,c:ce,p:ue,s:he}}function E(re,ce,ue){return re.a*Math.pow(2,10*(ce-=1))*Math.sin((ce*ue-re.s)*(2*Math.PI)/re.p)}function F(re,ce,ue,he){return ue*((re=re/he-1)*re*re+1)+ce}function R(re,ce,ue,he){return re/=he/2,re<1?ue/2*re*re*re+ce:ue/2*((re-=2)*re*re+2)+ce}function o(re,ce,ue,he){return ue*(re/=he)*re*re*re+ce}function S(re,ce,ue,he){return-ue*((re=re/he-1)*re*re*re-1)+ce}function l(re,ce,ue,he){return re/=he/2,re<1?ue/2*re*re*re*re+ce:-ue/2*((re-=2)*re*re*re-2)+ce}function L(re,ce,ue,he){return ue*(re/=he)*re*re*re*re+ce}function q(re,ce,ue,he){return ue*((re=re/he-1)*re*re*re*re+1)+ce}function O(re,ce,ue,he){return re/=he/2,re<1?ue/2*re*re*re*re*re+ce:ue/2*((re-=2)*re*re*re*re+2)+ce}function X(re,ce,ue,he){return-ue*Math.cos(re/he*(Math.PI/2))+ue+ce}function V(re,ce,ue,he){return ue*Math.sin(re/he*(Math.PI/2))+ce}function Y(re,ce,ue,he){return-ue/2*(Math.cos(Math.PI*re/he)-1)+ce}function U(re,ce,ue,he){return re===0?ce:ue*Math.pow(2,10*(re/he-1))+ce}function Q(re,ce,ue,he){return re===he?ce+ue:ue*(-Math.pow(2,-10*re/he)+1)+ce}function te(re,ce,ue,he){return re===0?ce:re===he?ce+ue:(re/=he/2,re<1?ue/2*Math.pow(2,10*(re-1))+ce:ue/2*(-Math.pow(2,-10*--re)+2)+ce)}function se(re,ce,ue,he){return-ue*(Math.sqrt(1-(re/=he)*re)-1)+ce}function fe(re,ce,ue,he){return ue*Math.sqrt(1-(re=re/he-1)*re)+ce}function Se(re,ce,ue,he){return re/=he/2,re<1?-ue/2*(Math.sqrt(1-re*re)-1)+ce:ue/2*(Math.sqrt(1-(re-=2)*re)+1)+ce}function Te(re,ce,ue,he){var pe=1.70158,oe=0,ne=ue;if(re===0)return ce;if(re/=he,re===1)return ce+ue;oe||(oe=he*.3);var ge=M(ne,ue,oe,pe);return-E(ge,re,he)+ce}function Re(re,ce,ue,he){var pe=1.70158,oe=0,ne=ue;if(re===0)return ce;if(re/=he,re===1)return ce+ue;oe||(oe=he*.3);var ge=M(ne,ue,oe,pe);return ge.a*Math.pow(2,-10*re)*Math.sin((re*he-ge.s)*(2*Math.PI)/ge.p)+ge.c+ce}function je(re,ce,ue,he){var pe=1.70158,oe=0,ne=ue;if(re===0)return ce;if(re/=he/2,re===2)return ce+ue;oe||(oe=he*(.3*1.5));var ge=M(ne,ue,oe,pe);return re<1?-.5*E(ge,re,he)+ce:ge.a*Math.pow(2,-10*(re-=1))*Math.sin((re*he-ge.s)*(2*Math.PI)/ge.p)*.5+ge.c+ce}function He(re,ce,ue,he,pe){return pe===void 0&&(pe=1.70158),ue*(re/=he)*re*((pe+1)*re-pe)+ce}function ve(re,ce,ue,he,pe){return pe===void 0&&(pe=1.70158),ue*((re=re/he-1)*re*((pe+1)*re+pe)+1)+ce}function _e(re,ce,ue,he,pe){return pe===void 0&&(pe=1.70158),re/=he/2,re<1?ue/2*(re*re*(((pe*=1.525)+1)*re-pe))+ce:ue/2*((re-=2)*re*(((pe*=1.525)+1)*re+pe)+2)+ce}function qe(re,ce,ue,he){return ue-Xe(he-re,0,ue,he)+ce}function Xe(re,ce,ue,he){return(re/=he)<1/2.75?ue*(7.5625*re*re)+ce:re<2/2.75?ue*(7.5625*(re-=1.5/2.75)*re+.75)+ce:re<2.5/2.75?ue*(7.5625*(re-=2.25/2.75)*re+.9375)+ce:ue*(7.5625*(re-=2.625/2.75)*re+.984375)+ce}function Ge(re,ce,ue,he){return re<he/2?qe(re*2,0,ue,he)*.5+ce:Xe(re*2-he,0,ue,he)*.5+ue*.5+ce}p.util.ease={easeInQuad:function(re,ce,ue,he){return ue*(re/=he)*re+ce},easeOutQuad:function(re,ce,ue,he){return-ue*(re/=he)*(re-2)+ce},easeInOutQuad:function(re,ce,ue,he){return re/=he/2,re<1?ue/2*re*re+ce:-ue/2*(--re*(re-2)-1)+ce},easeInCubic:function(re,ce,ue,he){return ue*(re/=he)*re*re+ce},easeOutCubic:F,easeInOutCubic:R,easeInQuart:o,easeOutQuart:S,easeInOutQuart:l,easeInQuint:L,easeOutQuint:q,easeInOutQuint:O,easeInSine:X,easeOutSine:V,easeInOutSine:Y,easeInExpo:U,easeOutExpo:Q,easeInOutExpo:te,easeInCirc:se,easeOutCirc:fe,easeInOutCirc:Se,easeInElastic:Te,easeOutElastic:Re,easeInOutElastic:je,easeInBack:He,easeOutBack:ve,easeInOutBack:_e,easeInBounce:qe,easeOutBounce:Xe,easeInOutBounce:Ge}}(),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.util.object.clone,o=E.util.toFixed,S=E.util.parseUnit,l=E.util.multiplyTransformMatrices,L=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],q=["symbol","image","marker","pattern","view","svg"],O=["pattern","defs","symbol","metadata","clipPath","mask","desc"],X=["symbol","g","a","svg","clipPath","defs"],V={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Y={stroke:"strokeOpacity",fill:"fillOpacity"},U="font-size",Q="clip-path";E.svgValidTagNamesRegEx=fe(L),E.svgViewBoxElementsRegEx=fe(q),E.svgInvalidAncestorsRegEx=fe(O),E.svgValidParentsRegEx=fe(X),E.cssRules={},E.gradientDefs={},E.clipPaths={};function te(oe){return oe in V?V[oe]:oe}function se(oe,ne,ge,ye){var ke=Array.isArray(ne),xe;if((oe==="fill"||oe==="stroke")&&ne==="none")ne="";else{if(oe==="strokeUniform")return ne==="non-scaling-stroke";if(oe==="strokeDashArray")ne==="none"?ne=null:ne=ne.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(oe==="transformMatrix")ge&&ge.transformMatrix?ne=l(ge.transformMatrix,E.parseTransformAttribute(ne)):ne=E.parseTransformAttribute(ne);else if(oe==="visible")ne=ne!=="none"&&ne!=="hidden",ge&&ge.visible===!1&&(ne=!1);else if(oe==="opacity")ne=parseFloat(ne),ge&&typeof ge.opacity<"u"&&(ne*=ge.opacity);else if(oe==="textAnchor")ne=ne==="start"?"left":ne==="end"?"right":"center";else if(oe==="charSpacing")xe=S(ne,ye)/ye*1e3;else if(oe==="paintFirst"){var Fe=ne.indexOf("fill"),Me=ne.indexOf("stroke"),ne="fill";(Fe>-1&&Me>-1&&Me<Fe||Fe===-1&&Me>-1)&&(ne="stroke")}else{if(oe==="href"||oe==="xlink:href"||oe==="font")return ne;if(oe==="imageSmoothing")return ne==="optimizeQuality";xe=ke?ne.map(S):S(ne,ye)}}return!ke&&isNaN(xe)?ne:xe}function fe(oe){return new RegExp("^("+oe.join("|")+")\\b","i")}function Se(oe){for(var ne in Y)if(!(typeof oe[Y[ne]]>"u"||oe[ne]==="")){if(typeof oe[ne]>"u"){if(!E.Object.prototype[ne])continue;oe[ne]=E.Object.prototype[ne]}if(oe[ne].indexOf("url(")!==0){var ge=new E.Color(oe[ne]);oe[ne]=ge.setAlpha(o(ge.getAlpha()*oe[Y[ne]],2)).toRgba()}}return oe}function Te(oe,ne){var ge,ye=[],ke,xe,Fe;for(xe=0,Fe=ne.length;xe<Fe;xe++)ge=ne[xe],ke=oe.getElementsByTagName(ge),ye=ye.concat(Array.prototype.slice.call(ke));return ye}E.parseTransformAttribute=function(){function oe(Oe,Ke){var tt=E.util.cos(Ke[0]),it=E.util.sin(Ke[0]),lt=0,rt=0;Ke.length===3&&(lt=Ke[1],rt=Ke[2]),Oe[0]=tt,Oe[1]=it,Oe[2]=-it,Oe[3]=tt,Oe[4]=lt-(tt*lt-it*rt),Oe[5]=rt-(it*lt+tt*rt)}function ne(Oe,Ke){var tt=Ke[0],it=Ke.length===2?Ke[1]:Ke[0];Oe[0]=tt,Oe[3]=it}function ge(Oe,Ke,tt){Oe[tt]=Math.tan(E.util.degreesToRadians(Ke[0]))}function ye(Oe,Ke){Oe[4]=Ke[0],Ke.length===2&&(Oe[5]=Ke[1])}var ke=E.iMatrix,xe=E.reNum,Fe=E.commaWsp,Me="(?:(skewX)\\s*\\(\\s*("+xe+")\\s*\\))",ze="(?:(skewY)\\s*\\(\\s*("+xe+")\\s*\\))",we="(?:(rotate)\\s*\\(\\s*("+xe+")(?:"+Fe+"("+xe+")"+Fe+"("+xe+"))?\\s*\\))",be="(?:(scale)\\s*\\(\\s*("+xe+")(?:"+Fe+"("+xe+"))?\\s*\\))",Pe="(?:(translate)\\s*\\(\\s*("+xe+")(?:"+Fe+"("+xe+"))?\\s*\\))",Le="(?:(matrix)\\s*\\(\\s*("+xe+")"+Fe+"("+xe+")"+Fe+"("+xe+")"+Fe+"("+xe+")"+Fe+"("+xe+")"+Fe+"("+xe+")\\s*\\))",Ce="(?:"+Le+"|"+Pe+"|"+be+"|"+we+"|"+Me+"|"+ze+")",De="(?:"+Ce+"(?:"+Fe+"*"+Ce+")*)",We="^\\s*(?:"+De+"?)\\s*$",et=new RegExp(We),$e=new RegExp(Ce,"g");return function(Oe){var Ke=ke.concat(),tt=[];if(!Oe||Oe&&!et.test(Oe))return Ke;Oe.replace($e,function(lt){var rt=new RegExp(Ce).exec(lt).filter(function(vt){return!!vt}),dt=rt[1],ct=rt.slice(2).map(parseFloat);switch(dt){case"translate":ye(Ke,ct);break;case"rotate":ct[0]=E.util.degreesToRadians(ct[0]),oe(Ke,ct);break;case"scale":ne(Ke,ct);break;case"skewX":ge(Ke,ct,2);break;case"skewY":ge(Ke,ct,1);break;case"matrix":Ke=ct;break}tt.push(Ke.concat()),Ke=ke.concat()});for(var it=tt[0];tt.length>1;)tt.shift(),it=E.util.multiplyTransformMatrices(it,tt[0]);return it}}();function Re(oe,ne){var ge,ye;oe.replace(/;\s*$/,"").split(";").forEach(function(ke){var xe=ke.split(":");ge=xe[0].trim().toLowerCase(),ye=xe[1].trim(),ne[ge]=ye})}function je(oe,ne){var ge,ye;for(var ke in oe)typeof oe[ke]>"u"||(ge=ke.toLowerCase(),ye=oe[ke],ne[ge]=ye)}function He(oe,ne){var ge={};for(var ye in E.cssRules[ne])if(ve(oe,ye.split(" ")))for(var ke in E.cssRules[ne][ye])ge[ke]=E.cssRules[ne][ye][ke];return ge}function ve(oe,ne){var ge,ye=!0;return ge=qe(oe,ne.pop()),ge&&ne.length&&(ye=_e(oe,ne)),ge&&ye&&ne.length===0}function _e(oe,ne){for(var ge,ye=!0;oe.parentNode&&oe.parentNode.nodeType===1&&ne.length;)ye&&(ge=ne.pop()),oe=oe.parentNode,ye=qe(oe,ge);return ne.length===0}function qe(oe,ne){var ge=oe.nodeName,ye=oe.getAttribute("class"),ke=oe.getAttribute("id"),xe,Fe;if(xe=new RegExp("^"+ge,"i"),ne=ne.replace(xe,""),ke&&ne.length&&(xe=new RegExp("#"+ke+"(?![a-zA-Z\\-]+)","i"),ne=ne.replace(xe,"")),ye&&ne.length)for(ye=ye.split(" "),Fe=ye.length;Fe--;)xe=new RegExp("\\."+ye[Fe]+"(?![a-zA-Z\\-]+)","i"),ne=ne.replace(xe,"");return ne.length===0}function Xe(oe,ne){var ge;if(oe.getElementById&&(ge=oe.getElementById(ne)),ge)return ge;var ye,ke,xe,Fe=oe.getElementsByTagName("*");for(ke=0,xe=Fe.length;ke<xe;ke++)if(ye=Fe[ke],ne===ye.getAttribute("id"))return ye}function Ge(oe){for(var ne=Te(oe,["use","svg:use"]),ge=0;ne.length&&ge<ne.length;){var ye=ne[ge],ke=ye.getAttribute("xlink:href")||ye.getAttribute("href");if(ke===null)return;var xe=ke.slice(1),Fe=ye.getAttribute("x")||0,Me=ye.getAttribute("y")||0,ze=Xe(oe,xe).cloneNode(!0),we=(ze.getAttribute("transform")||"")+" translate("+Fe+", "+Me+")",be,Pe=ne.length,Le,Ce,De,We,et=E.svgNS;if(ce(ze),/^svg$/i.test(ze.nodeName)){var $e=ze.ownerDocument.createElementNS(et,"g");for(Ce=0,De=ze.attributes,We=De.length;Ce<We;Ce++)Le=De.item(Ce),$e.setAttributeNS(et,Le.nodeName,Le.nodeValue);for(;ze.firstChild;)$e.appendChild(ze.firstChild);ze=$e}for(Ce=0,De=ye.attributes,We=De.length;Ce<We;Ce++)Le=De.item(Ce),!(Le.nodeName==="x"||Le.nodeName==="y"||Le.nodeName==="xlink:href"||Le.nodeName==="href")&&(Le.nodeName==="transform"?we=Le.nodeValue+" "+we:ze.setAttribute(Le.nodeName,Le.nodeValue));ze.setAttribute("transform",we),ze.setAttribute("instantiated_by_use","1"),ze.removeAttribute("id"),be=ye.parentNode,be.replaceChild(ze,ye),ne.length===Pe&&ge++}}var re=new RegExp("^\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*,?\\s*("+E.reNum+"+)\\s*$");function ce(oe){if(!E.svgViewBoxElementsRegEx.test(oe.nodeName))return{};var ne=oe.getAttribute("viewBox"),ge=1,ye=1,ke=0,xe=0,Fe,Me,ze,we,be=oe.getAttribute("width"),Pe=oe.getAttribute("height"),Le=oe.getAttribute("x")||0,Ce=oe.getAttribute("y")||0,De=oe.getAttribute("preserveAspectRatio")||"",We=!ne||!(ne=ne.match(re)),et=!be||!Pe||be==="100%"||Pe==="100%",$e=We&&et,Oe={},Ke="",tt=0,it=0;if(Oe.width=0,Oe.height=0,Oe.toBeParsed=$e,We&&(Le||Ce)&&oe.parentNode&&oe.parentNode.nodeName!=="#document"&&(Ke=" translate("+S(Le)+" "+S(Ce)+") ",ze=(oe.getAttribute("transform")||"")+Ke,oe.setAttribute("transform",ze),oe.removeAttribute("x"),oe.removeAttribute("y")),$e)return Oe;if(We)return Oe.width=S(be),Oe.height=S(Pe),Oe;if(ke=-parseFloat(ne[1]),xe=-parseFloat(ne[2]),Fe=parseFloat(ne[3]),Me=parseFloat(ne[4]),Oe.minX=ke,Oe.minY=xe,Oe.viewBoxWidth=Fe,Oe.viewBoxHeight=Me,et?(Oe.width=Fe,Oe.height=Me):(Oe.width=S(be),Oe.height=S(Pe),ge=Oe.width/Fe,ye=Oe.height/Me),De=E.util.parsePreserveAspectRatioAttribute(De),De.alignX!=="none"&&(De.meetOrSlice==="meet"&&(ye=ge=ge>ye?ye:ge),De.meetOrSlice==="slice"&&(ye=ge=ge>ye?ge:ye),tt=Oe.width-Fe*ge,it=Oe.height-Me*ge,De.alignX==="Mid"&&(tt/=2),De.alignY==="Mid"&&(it/=2),De.alignX==="Min"&&(tt=0),De.alignY==="Min"&&(it=0)),ge===1&&ye===1&&ke===0&&xe===0&&Le===0&&Ce===0)return Oe;if((Le||Ce)&&oe.parentNode.nodeName!=="#document"&&(Ke=" translate("+S(Le)+" "+S(Ce)+") "),ze=Ke+" matrix("+ge+" 0 0 "+ye+" "+(ke*ge+tt)+" "+(xe*ye+it)+") ",oe.nodeName==="svg"){for(we=oe.ownerDocument.createElementNS(E.svgNS,"g");oe.firstChild;)we.appendChild(oe.firstChild);oe.appendChild(we)}else we=oe,we.removeAttribute("x"),we.removeAttribute("y"),ze=we.getAttribute("transform")+ze;return we.setAttribute("transform",ze),Oe}function ue(oe,ne){for(;oe&&(oe=oe.parentNode);)if(oe.nodeName&&ne.test(oe.nodeName.replace("svg:",""))&&!oe.getAttribute("instantiated_by_use"))return!0;return!1}E.parseSVGDocument=function(oe,ne,ge,ye){if(oe){Ge(oe);var ke=E.Object.__uid++,xe,Fe,Me=ce(oe),ze=E.util.toArray(oe.getElementsByTagName("*"));if(Me.crossOrigin=ye&&ye.crossOrigin,Me.svgUid=ke,ze.length===0&&E.isLikelyNode){ze=oe.selectNodes('//*[name(.)!="svg"]');var we=[];for(xe=0,Fe=ze.length;xe<Fe;xe++)we[xe]=ze[xe];ze=we}var be=ze.filter(function(Le){return ce(Le),E.svgValidTagNamesRegEx.test(Le.nodeName.replace("svg:",""))&&!ue(Le,E.svgInvalidAncestorsRegEx)});if(!be||be&&!be.length){ne&&ne([],{});return}var Pe={};ze.filter(function(Le){return Le.nodeName.replace("svg:","")==="clipPath"}).forEach(function(Le){var Ce=Le.getAttribute("id");Pe[Ce]=E.util.toArray(Le.getElementsByTagName("*")).filter(function(De){return E.svgValidTagNamesRegEx.test(De.nodeName.replace("svg:",""))})}),E.gradientDefs[ke]=E.getGradientDefs(oe),E.cssRules[ke]=E.getCSSRules(oe),E.clipPaths[ke]=Pe,E.parseElements(be,function(Le,Ce){ne&&(ne(Le,Me,Ce,ze),delete E.gradientDefs[ke],delete E.cssRules[ke],delete E.clipPaths[ke])},R(Me),ge,ye)}};function he(oe,ne){var ge=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],ye="xlink:href",ke=ne.getAttribute(ye).slice(1),xe=Xe(oe,ke);if(xe&&xe.getAttribute(ye)&&he(oe,xe),ge.forEach(function(Me){xe&&!ne.hasAttribute(Me)&&xe.hasAttribute(Me)&&ne.setAttribute(Me,xe.getAttribute(Me))}),!ne.children.length)for(var Fe=xe.cloneNode(!0);Fe.firstChild;)ne.appendChild(Fe.firstChild);ne.removeAttribute(ye)}var pe=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+E.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+E.reNum+"))?\\s+(.*)");F(E,{parseFontDeclaration:function(oe,ne){var ge=oe.match(pe);if(ge){var ye=ge[1],ke=ge[3],xe=ge[4],Fe=ge[5],Me=ge[6];ye&&(ne.fontStyle=ye),ke&&(ne.fontWeight=isNaN(parseFloat(ke))?ke:parseFloat(ke)),xe&&(ne.fontSize=S(xe)),Me&&(ne.fontFamily=Me),Fe&&(ne.lineHeight=Fe==="normal"?1:Fe)}},getGradientDefs:function(oe){var ne=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],ge=Te(oe,ne),ye,ke=0,xe={};for(ke=ge.length;ke--;)ye=ge[ke],ye.getAttribute("xlink:href")&&he(oe,ye),xe[ye.getAttribute("id")]=ye;return xe},parseAttributes:function(oe,ne,ge){if(oe){var ye,ke={},xe,Fe;typeof ge>"u"&&(ge=oe.getAttribute("svgUid")),oe.parentNode&&E.svgValidParentsRegEx.test(oe.parentNode.nodeName)&&(ke=E.parseAttributes(oe.parentNode,ne,ge));var Me=ne.reduce(function(De,We){return ye=oe.getAttribute(We),ye&&(De[We]=ye),De},{}),ze=F(He(oe,ge),E.parseStyleAttribute(oe));Me=F(Me,ze),ze[Q]&&oe.setAttribute(Q,ze[Q]),xe=Fe=ke.fontSize||E.Text.DEFAULT_SVG_FONT_SIZE,Me[U]&&(Me[U]=xe=S(Me[U],Fe));var we,be,Pe={};for(var Le in Me)we=te(Le),be=se(we,Me[Le],ke,xe),Pe[we]=be;Pe&&Pe.font&&E.parseFontDeclaration(Pe.font,Pe);var Ce=F(ke,Pe);return E.svgValidParentsRegEx.test(oe.nodeName)?Ce:Se(Ce)}},parseElements:function(oe,ne,ge,ye,ke){new E.ElementsParser(oe,ne,ge,ye,ke).parse()},parseStyleAttribute:function(oe){var ne={},ge=oe.getAttribute("style");return ge&&(typeof ge=="string"?Re(ge,ne):je(ge,ne)),ne},parsePointsAttribute:function(oe){if(!oe)return null;oe=oe.replace(/,/g," ").trim(),oe=oe.split(/\s+/);var ne=[],ge,ye;for(ge=0,ye=oe.length;ge<ye;ge+=2)ne.push({x:parseFloat(oe[ge]),y:parseFloat(oe[ge+1])});return ne},getCSSRules:function(oe){var ne=oe.getElementsByTagName("style"),ge,ye,ke={},xe;for(ge=0,ye=ne.length;ge<ye;ge++){var Fe=ne[ge].textContent;Fe=Fe.replace(/\/\*[\s\S]*?\*\//g,""),Fe.trim()!==""&&(xe=Fe.split("}"),xe=xe.filter(function(Me){return Me.trim()}),xe.forEach(function(Me){var ze=Me.split("{"),we={},be=ze[1].trim(),Pe=be.split(";").filter(function(We){return We.trim()});for(ge=0,ye=Pe.length;ge<ye;ge++){var Le=Pe[ge].split(":"),Ce=Le[0].trim(),De=Le[1].trim();we[Ce]=De}Me=ze[0].trim(),Me.split(",").forEach(function(We){We=We.replace(/^svg/i,"").trim(),We!==""&&(ke[We]?E.util.object.extend(ke[We],we):ke[We]=E.util.object.clone(we))})}))}return ke},loadSVGFromURL:function(oe,ne,ge,ye){oe=oe.replace(/^\n\s*/,"").trim(),new E.util.request(oe,{method:"get",onComplete:ke});function ke(xe){var Fe=xe.responseXML;if(!Fe||!Fe.documentElement)return ne&&ne(null),!1;E.parseSVGDocument(Fe.documentElement,function(Me,ze,we,be){ne&&ne(Me,ze,we,be)},ge,ye)}},loadSVGFromString:function(oe,ne,ge,ye){var ke=new E.window.DOMParser,xe=ke.parseFromString(oe.trim(),"text/xml");E.parseSVGDocument(xe.documentElement,function(Fe,Me,ze,we){ne(Fe,Me,ze,we)},ge,ye)}})}(B),p.ElementsParser=function(M,E,F,R,o,S){this.elements=M,this.callback=E,this.options=F,this.reviver=R,this.svgUid=F&&F.svgUid||0,this.parsingOptions=o,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=S},function(M){M.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},M.createObjects=function(){var E=this;this.elements.forEach(function(F,R){F.setAttribute("svgUid",E.svgUid),E.createObject(F,R)})},M.findTag=function(E){return p[p.util.string.capitalize(E.tagName.replace("svg:",""))]},M.createObject=function(E,F){var R=this.findTag(E);if(R&&R.fromElement)try{R.fromElement(E,this.createCallback(F,E),this.options)}catch(o){p.log(o)}else this.checkIfDone()},M.createCallback=function(E,F){var R=this;return function(o){var S;R.resolveGradient(o,F,"fill"),R.resolveGradient(o,F,"stroke"),o instanceof p.Image&&o._originalElement&&(S=o.parsePreserveAspectRatioAttribute(F)),o._removeTransformMatrix(S),R.resolveClipPath(o,F),R.reviver&&R.reviver(F,o),R.instances[E]=o,R.checkIfDone()}},M.extractPropertyDefinition=function(E,F,R){var o=E[F],S=this.regexUrl;if(S.test(o)){S.lastIndex=0;var l=S.exec(o)[1];return S.lastIndex=0,p[R][this.svgUid][l]}},M.resolveGradient=function(E,F,R){var o=this.extractPropertyDefinition(E,R,"gradientDefs");if(o){var S=F.getAttribute(R+"-opacity"),l=p.Gradient.fromElement(o,E,S,this.options);E.set(R,l)}},M.createClipPathCallback=function(E,F){return function(R){R._removeTransformMatrix(),R.fillRule=R.clipRule,F.push(R)}},M.resolveClipPath=function(E,F){var R=this.extractPropertyDefinition(E,"clipPath","clipPaths"),o,S,l,L,q,O;if(R){L=[],l=p.util.invertTransform(E.calcTransformMatrix());for(var X=R[0].parentNode,V=F;V.parentNode&&V.getAttribute("clip-path")!==E.clipPath;)V=V.parentNode;V.parentNode.appendChild(X);for(var Y=0;Y<R.length;Y++)o=R[Y],S=this.findTag(o),S.fromElement(o,this.createClipPathCallback(E,L),this.options);L.length===1?R=L[0]:R=new p.Group(L),q=p.util.multiplyTransformMatrices(l,R.calcTransformMatrix()),R.clipPath&&this.resolveClipPath(R,V);var O=p.util.qrDecompose(q);R.flipX=!1,R.flipY=!1,R.set("scaleX",O.scaleX),R.set("scaleY",O.scaleY),R.angle=O.angle,R.skewX=O.skewX,R.skewY=0,R.setPositionByOrigin({x:O.translateX,y:O.translateY},"center","center"),E.clipPath=R}else delete E.clipPath},M.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(E){return E!=null}),this.callback(this.instances,this.elements))}}(p.ElementsParser.prototype),function(M){var E=M.fabric||(M.fabric={});if(E.Point){E.warn("fabric.Point is already defined");return}E.Point=F;function F(R,o){this.x=R,this.y=o}F.prototype={type:"point",constructor:F,add:function(R){return new F(this.x+R.x,this.y+R.y)},addEquals:function(R){return this.x+=R.x,this.y+=R.y,this},scalarAdd:function(R){return new F(this.x+R,this.y+R)},scalarAddEquals:function(R){return this.x+=R,this.y+=R,this},subtract:function(R){return new F(this.x-R.x,this.y-R.y)},subtractEquals:function(R){return this.x-=R.x,this.y-=R.y,this},scalarSubtract:function(R){return new F(this.x-R,this.y-R)},scalarSubtractEquals:function(R){return this.x-=R,this.y-=R,this},multiply:function(R){return new F(this.x*R,this.y*R)},multiplyEquals:function(R){return this.x*=R,this.y*=R,this},divide:function(R){return new F(this.x/R,this.y/R)},divideEquals:function(R){return this.x/=R,this.y/=R,this},eq:function(R){return this.x===R.x&&this.y===R.y},lt:function(R){return this.x<R.x&&this.y<R.y},lte:function(R){return this.x<=R.x&&this.y<=R.y},gt:function(R){return this.x>R.x&&this.y>R.y},gte:function(R){return this.x>=R.x&&this.y>=R.y},lerp:function(R,o){return typeof o>"u"&&(o=.5),o=Math.max(Math.min(1,o),0),new F(this.x+(R.x-this.x)*o,this.y+(R.y-this.y)*o)},distanceFrom:function(R){var o=this.x-R.x,S=this.y-R.y;return Math.sqrt(o*o+S*S)},midPointFrom:function(R){return this.lerp(R)},min:function(R){return new F(Math.min(this.x,R.x),Math.min(this.y,R.y))},max:function(R){return new F(Math.max(this.x,R.x),Math.max(this.y,R.y))},toString:function(){return this.x+","+this.y},setXY:function(R,o){return this.x=R,this.y=o,this},setX:function(R){return this.x=R,this},setY:function(R){return this.y=R,this},setFromPoint:function(R){return this.x=R.x,this.y=R.y,this},swap:function(R){var o=this.x,S=this.y;this.x=R.x,this.y=R.y,R.x=o,R.y=S},clone:function(){return new F(this.x,this.y)}}}(B),function(M){var E=M.fabric||(M.fabric={});if(E.Intersection){E.warn("fabric.Intersection is already defined");return}function F(R){this.status=R,this.points=[]}E.Intersection=F,E.Intersection.prototype={constructor:F,appendPoint:function(R){return this.points.push(R),this},appendPoints:function(R){return this.points=this.points.concat(R),this}},E.Intersection.intersectLineLine=function(R,o,S,l){var L,q=(l.x-S.x)*(R.y-S.y)-(l.y-S.y)*(R.x-S.x),O=(o.x-R.x)*(R.y-S.y)-(o.y-R.y)*(R.x-S.x),X=(l.y-S.y)*(o.x-R.x)-(l.x-S.x)*(o.y-R.y);if(X!==0){var V=q/X,Y=O/X;0<=V&&V<=1&&0<=Y&&Y<=1?(L=new F("Intersection"),L.appendPoint(new E.Point(R.x+V*(o.x-R.x),R.y+V*(o.y-R.y)))):L=new F}else q===0||O===0?L=new F("Coincident"):L=new F("Parallel");return L},E.Intersection.intersectLinePolygon=function(R,o,S){var l=new F,L=S.length,q,O,X,V;for(V=0;V<L;V++)q=S[V],O=S[(V+1)%L],X=F.intersectLineLine(R,o,q,O),l.appendPoints(X.points);return l.points.length>0&&(l.status="Intersection"),l},E.Intersection.intersectPolygonPolygon=function(R,o){var S=new F,l=R.length,L;for(L=0;L<l;L++){var q=R[L],O=R[(L+1)%l],X=F.intersectLinePolygon(q,O,o);S.appendPoints(X.points)}return S.points.length>0&&(S.status="Intersection"),S},E.Intersection.intersectPolygonRectangle=function(R,o,S){var l=o.min(S),L=o.max(S),q=new E.Point(L.x,l.y),O=new E.Point(l.x,L.y),X=F.intersectLinePolygon(l,q,R),V=F.intersectLinePolygon(q,L,R),Y=F.intersectLinePolygon(L,O,R),U=F.intersectLinePolygon(O,l,R),Q=new F;return Q.appendPoints(X.points),Q.appendPoints(V.points),Q.appendPoints(Y.points),Q.appendPoints(U.points),Q.points.length>0&&(Q.status="Intersection"),Q}}(B),function(M){var E=M.fabric||(M.fabric={});if(E.Color){E.warn("fabric.Color is already defined.");return}function F(o){o?this._tryParsingColor(o):this.setSource([0,0,0,1])}E.Color=F,E.Color.prototype={_tryParsingColor:function(o){var S;o in F.colorNameMap&&(o=F.colorNameMap[o]),o==="transparent"&&(S=[255,255,255,0]),S||(S=F.sourceFromHex(o)),S||(S=F.sourceFromRgb(o)),S||(S=F.sourceFromHsl(o)),S||(S=[0,0,0,1]),S&&this.setSource(S)},_rgbToHsl:function(o,S,l){o/=255,S/=255,l/=255;var L,q,O,X=E.util.array.max([o,S,l]),V=E.util.array.min([o,S,l]);if(O=(X+V)/2,X===V)L=q=0;else{var Y=X-V;switch(q=O>.5?Y/(2-X-V):Y/(X+V),X){case o:L=(S-l)/Y+(S<l?6:0);break;case S:L=(l-o)/Y+2;break;case l:L=(o-S)/Y+4;break}L/=6}return[Math.round(L*360),Math.round(q*100),Math.round(O*100)]},getSource:function(){return this._source},setSource:function(o){this._source=o},toRgb:function(){var o=this.getSource();return"rgb("+o[0]+","+o[1]+","+o[2]+")"},toRgba:function(){var o=this.getSource();return"rgba("+o[0]+","+o[1]+","+o[2]+","+o[3]+")"},toHsl:function(){var o=this.getSource(),S=this._rgbToHsl(o[0],o[1],o[2]);return"hsl("+S[0]+","+S[1]+"%,"+S[2]+"%)"},toHsla:function(){var o=this.getSource(),S=this._rgbToHsl(o[0],o[1],o[2]);return"hsla("+S[0]+","+S[1]+"%,"+S[2]+"%,"+o[3]+")"},toHex:function(){var o=this.getSource(),S,l,L;return S=o[0].toString(16),S=S.length===1?"0"+S:S,l=o[1].toString(16),l=l.length===1?"0"+l:l,L=o[2].toString(16),L=L.length===1?"0"+L:L,S.toUpperCase()+l.toUpperCase()+L.toUpperCase()},toHexa:function(){var o=this.getSource(),S;return S=Math.round(o[3]*255),S=S.toString(16),S=S.length===1?"0"+S:S,this.toHex()+S.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(o){var S=this.getSource();return S[3]=o,this.setSource(S),this},toGrayscale:function(){var o=this.getSource(),S=parseInt((o[0]*.3+o[1]*.59+o[2]*.11).toFixed(0),10),l=o[3];return this.setSource([S,S,S,l]),this},toBlackWhite:function(o){var S=this.getSource(),l=(S[0]*.3+S[1]*.59+S[2]*.11).toFixed(0),L=S[3];return o=o||127,l=Number(l)<Number(o)?0:255,this.setSource([l,l,l,L]),this},overlayWith:function(o){o instanceof F||(o=new F(o));var S=[],l=this.getAlpha(),L=.5,q=this.getSource(),O=o.getSource(),X;for(X=0;X<3;X++)S.push(Math.round(q[X]*(1-L)+O[X]*L));return S[3]=l,this.setSource(S),this}},E.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,E.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,E.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,E.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function R(o,S,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?o+(S-o)*6*l:l<1/2?S:l<2/3?o+(S-o)*(2/3-l)*6:o}E.Color.fromRgb=function(o){return F.fromSource(F.sourceFromRgb(o))},E.Color.sourceFromRgb=function(o){var S=o.match(F.reRGBa);if(S){var l=parseInt(S[1],10)/(/%$/.test(S[1])?100:1)*(/%$/.test(S[1])?255:1),L=parseInt(S[2],10)/(/%$/.test(S[2])?100:1)*(/%$/.test(S[2])?255:1),q=parseInt(S[3],10)/(/%$/.test(S[3])?100:1)*(/%$/.test(S[3])?255:1);return[parseInt(l,10),parseInt(L,10),parseInt(q,10),S[4]?parseFloat(S[4]):1]}},E.Color.fromRgba=F.fromRgb,E.Color.fromHsl=function(o){return F.fromSource(F.sourceFromHsl(o))},E.Color.sourceFromHsl=function(o){var S=o.match(F.reHSLa);if(S){var l=(parseFloat(S[1])%360+360)%360/360,L=parseFloat(S[2])/(/%$/.test(S[2])?100:1),q=parseFloat(S[3])/(/%$/.test(S[3])?100:1),O,X,V;if(L===0)O=X=V=q;else{var Y=q<=.5?q*(L+1):q+L-q*L,U=q*2-Y;O=R(U,Y,l+1/3),X=R(U,Y,l),V=R(U,Y,l-1/3)}return[Math.round(O*255),Math.round(X*255),Math.round(V*255),S[4]?parseFloat(S[4]):1]}},E.Color.fromHsla=F.fromHsl,E.Color.fromHex=function(o){return F.fromSource(F.sourceFromHex(o))},E.Color.sourceFromHex=function(o){if(o.match(F.reHex)){var S=o.slice(o.indexOf("#")+1),l=S.length===3||S.length===4,L=S.length===8||S.length===4,q=l?S.charAt(0)+S.charAt(0):S.substring(0,2),O=l?S.charAt(1)+S.charAt(1):S.substring(2,4),X=l?S.charAt(2)+S.charAt(2):S.substring(4,6),V=L?l?S.charAt(3)+S.charAt(3):S.substring(6,8):"FF";return[parseInt(q,16),parseInt(O,16),parseInt(X,16),parseFloat((parseInt(V,16)/255).toFixed(2))]}},E.Color.fromSource=function(o){var S=new F;return S.setSource(o),S}}(B),function(M){var E=M.fabric||(M.fabric={}),F=["e","se","s","sw","w","nw","n","ne","e"],R=["ns","nesw","ew","nwse"],o={},S="left",l="top",L="right",q="bottom",O="center",X={top:q,bottom:l,left:L,right:S,center:O},V=E.util.radiansToDegrees,Y=Math.sign||function(we){return(we>0)-(we<0)||+we};function U(we,be){var Pe=we.angle+V(Math.atan2(be.y,be.x))+360;return Math.round(Pe%360/45)}function Q(we,be){var Pe=be.transform.target,Le=Pe.canvas,Ce=E.util.object.clone(be);Ce.target=Pe,Le&&Le.fire("object:"+we,Ce),Pe.fire(we,be)}function te(we,be){var Pe=be.canvas,Le=Pe.uniScaleKey,Ce=we[Le];return Pe.uniformScaling&&!Ce||!Pe.uniformScaling&&Ce}function se(we){return we.originX===O&&we.originY===O}function fe(we,be,Pe){var Le=we.lockScalingX,Ce=we.lockScalingY;return!!(Le&&Ce||!be&&(Le||Ce)&&Pe||Le&&be==="x"||Ce&&be==="y")}function Se(we,be,Pe){var Le="not-allowed",Ce=te(we,Pe),De="";if(be.x!==0&&be.y===0?De="x":be.x===0&&be.y!==0&&(De="y"),fe(Pe,De,Ce))return Le;var We=U(Pe,be);return F[We]+"-resize"}function Te(we,be,Pe){var Le="not-allowed";if(be.x!==0&&Pe.lockSkewingY||be.y!==0&&Pe.lockSkewingX)return Le;var Ce=U(Pe,be)%4;return R[Ce]+"-resize"}function Re(we,be,Pe){return we[Pe.canvas.altActionKey]?o.skewCursorStyleHandler(we,be,Pe):o.scaleCursorStyleHandler(we,be,Pe)}function je(we,be,Pe){var Le=we[Pe.canvas.altActionKey];if(be.x===0)return Le?"skewX":"scaleY";if(be.y===0)return Le?"skewY":"scaleX"}function He(we,be,Pe){return Pe.lockRotation?"not-allowed":be.cursorStyle}function ve(we,be,Pe,Le){return{e:we,transform:be,pointer:{x:Pe,y:Le}}}function _e(we){return function(be,Pe,Le,Ce){var De=Pe.target,We=De.getCenterPoint(),et=De.translateToOriginPoint(We,Pe.originX,Pe.originY),$e=we(be,Pe,Le,Ce);return De.setPositionByOrigin(et,Pe.originX,Pe.originY),$e}}function qe(we,be){return function(Pe,Le,Ce,De){var We=be(Pe,Le,Ce,De);return We&&Q(we,ve(Pe,Le,Ce,De)),We}}function Xe(we,be,Pe,Le,Ce){var De=we.target,We=De.controls[we.corner],et=De.canvas.getZoom(),$e=De.padding/et,Oe=De.toLocalPoint(new E.Point(Le,Ce),be,Pe);return Oe.x>=$e&&(Oe.x-=$e),Oe.x<=-$e&&(Oe.x+=$e),Oe.y>=$e&&(Oe.y-=$e),Oe.y<=$e&&(Oe.y+=$e),Oe.x-=We.offsetX,Oe.y-=We.offsetY,Oe}function Ge(we){return we.flipX!==we.flipY}function re(we,be,Pe,Le,Ce){if(we[be]!==0){var De=we._getTransformedDimensions()[Le],We=Ce/De*we[Pe];we.set(Pe,We)}}function ce(we,be,Pe,Le){var Ce=be.target,De=Ce._getTransformedDimensions(0,Ce.skewY),We=Xe(be,be.originX,be.originY,Pe,Le),et=Math.abs(We.x*2)-De.x,$e=Ce.skewX,Oe;et<2?Oe=0:(Oe=V(Math.atan2(et/Ce.scaleX,De.y/Ce.scaleY)),be.originX===S&&be.originY===q&&(Oe=-Oe),be.originX===L&&be.originY===l&&(Oe=-Oe),Ge(Ce)&&(Oe=-Oe));var Ke=$e!==Oe;if(Ke){var tt=Ce._getTransformedDimensions().y;Ce.set("skewX",Oe),re(Ce,"skewY","scaleY","y",tt)}return Ke}function ue(we,be,Pe,Le){var Ce=be.target,De=Ce._getTransformedDimensions(Ce.skewX,0),We=Xe(be,be.originX,be.originY,Pe,Le),et=Math.abs(We.y*2)-De.y,$e=Ce.skewY,Oe;et<2?Oe=0:(Oe=V(Math.atan2(et/Ce.scaleY,De.x/Ce.scaleX)),be.originX===S&&be.originY===q&&(Oe=-Oe),be.originX===L&&be.originY===l&&(Oe=-Oe),Ge(Ce)&&(Oe=-Oe));var Ke=$e!==Oe;if(Ke){var tt=Ce._getTransformedDimensions().x;Ce.set("skewY",Oe),re(Ce,"skewX","scaleX","x",tt)}return Ke}function he(we,be,Pe,Le){var Ce=be.target,De=Ce.skewX,We,et=be.originY;if(Ce.lockSkewingX)return!1;if(De===0){var $e=Xe(be,O,O,Pe,Le);$e.x>0?We=S:We=L}else De>0&&(We=et===l?S:L),De<0&&(We=et===l?L:S),Ge(Ce)&&(We=We===S?L:S);be.originX=We;var Oe=qe("skewing",_e(ce));return Oe(we,be,Pe,Le)}function pe(we,be,Pe,Le){var Ce=be.target,De=Ce.skewY,We,et=be.originX;if(Ce.lockSkewingY)return!1;if(De===0){var $e=Xe(be,O,O,Pe,Le);$e.y>0?We=l:We=q}else De>0&&(We=et===S?l:q),De<0&&(We=et===S?q:l),Ge(Ce)&&(We=We===l?q:l);be.originY=We;var Oe=qe("skewing",_e(ue));return Oe(we,be,Pe,Le)}function oe(we,be,Pe,Le){var Ce=be,De=Ce.target,We=De.translateToOriginPoint(De.getCenterPoint(),Ce.originX,Ce.originY);if(De.lockRotation)return!1;var et=Math.atan2(Ce.ey-We.y,Ce.ex-We.x),$e=Math.atan2(Le-We.y,Pe-We.x),Oe=V($e-et+Ce.theta),Ke=!0;if(De.snapAngle>0){var tt=De.snapAngle,it=De.snapThreshold||tt,lt=Math.ceil(Oe/tt)*tt,rt=Math.floor(Oe/tt)*tt;Math.abs(Oe-rt)<it?Oe=rt:Math.abs(Oe-lt)<it&&(Oe=lt)}return Oe<0&&(Oe=360+Oe),Oe%=360,Ke=De.angle!==Oe,De.angle=Oe,Ke}function ne(we,be,Pe,Le,Ce){Ce=Ce||{};var De=be.target,We=De.lockScalingX,et=De.lockScalingY,$e=Ce.by,Oe,Ke,tt,it,lt=te(we,De),rt=fe(De,$e,lt),dt,ct,vt=be.gestureScale;if(rt)return!1;if(vt)Ke=be.scaleX*vt,tt=be.scaleY*vt;else{if(Oe=Xe(be,be.originX,be.originY,Pe,Le),dt=$e!=="y"?Y(Oe.x):1,ct=$e!=="x"?Y(Oe.y):1,be.signX||(be.signX=dt),be.signY||(be.signY=ct),De.lockScalingFlip&&(be.signX!==dt||be.signY!==ct))return!1;if(it=De._getTransformedDimensions(),lt&&!$e){var wt=Math.abs(Oe.x)+Math.abs(Oe.y),ae=be.original,me=Math.abs(it.x*ae.scaleX/De.scaleX)+Math.abs(it.y*ae.scaleY/De.scaleY),Ie=wt/me;Ke=ae.scaleX*Ie,tt=ae.scaleY*Ie}else Ke=Math.abs(Oe.x*De.scaleX/it.x),tt=Math.abs(Oe.y*De.scaleY/it.y);se(be)&&(Ke*=2,tt*=2),be.signX!==dt&&$e!=="y"&&(be.originX=X[be.originX],Ke*=-1,be.signX=dt),be.signY!==ct&&$e!=="x"&&(be.originY=X[be.originY],tt*=-1,be.signY=ct)}var Ee=De.scaleX,Ve=De.scaleY;return $e?($e==="x"&&De.set("scaleX",Ke),$e==="y"&&De.set("scaleY",tt)):(!We&&De.set("scaleX",Ke),!et&&De.set("scaleY",tt)),Ee!==De.scaleX||Ve!==De.scaleY}function ge(we,be,Pe,Le){return ne(we,be,Pe,Le)}function ye(we,be,Pe,Le){return ne(we,be,Pe,Le,{by:"x"})}function ke(we,be,Pe,Le){return ne(we,be,Pe,Le,{by:"y"})}function xe(we,be,Pe,Le){return we[be.target.canvas.altActionKey]?o.skewHandlerX(we,be,Pe,Le):o.scalingY(we,be,Pe,Le)}function Fe(we,be,Pe,Le){return we[be.target.canvas.altActionKey]?o.skewHandlerY(we,be,Pe,Le):o.scalingX(we,be,Pe,Le)}function Me(we,be,Pe,Le){var Ce=be.target,De=Xe(be,be.originX,be.originY,Pe,Le),We=Ce.strokeWidth/(Ce.strokeUniform?Ce.scaleX:1),et=se(be)?2:1,$e=Ce.width,Oe=Math.abs(De.x*et/Ce.scaleX)-We;return Ce.set("width",Math.max(Oe,0)),$e!==Oe}function ze(we,be,Pe,Le){var Ce=be.target,De=Pe-be.offsetX,We=Le-be.offsetY,et=!Ce.get("lockMovementX")&&Ce.left!==De,$e=!Ce.get("lockMovementY")&&Ce.top!==We;return et&&Ce.set("left",De),$e&&Ce.set("top",We),(et||$e)&&Q("moving",ve(we,be,Pe,Le)),et||$e}o.scaleCursorStyleHandler=Se,o.skewCursorStyleHandler=Te,o.scaleSkewCursorStyleHandler=Re,o.rotationWithSnapping=qe("rotating",_e(oe)),o.scalingEqually=qe("scaling",_e(ge)),o.scalingX=qe("scaling",_e(ye)),o.scalingY=qe("scaling",_e(ke)),o.scalingYOrSkewingX=xe,o.scalingXOrSkewingY=Fe,o.changeWidth=qe("resizing",_e(Me)),o.skewHandlerX=he,o.skewHandlerY=pe,o.dragHandler=ze,o.scaleOrSkewActionName=je,o.rotationStyleHandler=He,o.fireEvent=Q,o.wrapWithFixedAnchor=_e,o.wrapWithFireEvent=qe,o.getLocalPoint=Xe,E.controlsUtils=o}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.degreesToRadians,R=E.controlsUtils;function o(l,L,q,O,X){O=O||{};var V=this.sizeX||O.cornerSize||X.cornerSize,Y=this.sizeY||O.cornerSize||X.cornerSize,U=typeof O.transparentCorners<"u"?O.transparentCorners:X.transparentCorners,Q=U?"stroke":"fill",te=!U&&(O.cornerStrokeColor||X.cornerStrokeColor),se=L,fe=q,Se;l.save(),l.fillStyle=O.cornerColor||X.cornerColor,l.strokeStyle=O.cornerStrokeColor||X.cornerStrokeColor,V>Y?(Se=V,l.scale(1,Y/V),fe=q*V/Y):Y>V?(Se=Y,l.scale(V/Y,1),se=L*Y/V):Se=V,l.lineWidth=1,l.beginPath(),l.arc(se,fe,Se/2,0,2*Math.PI,!1),l[Q](),te&&l.stroke(),l.restore()}function S(l,L,q,O,X){O=O||{};var V=this.sizeX||O.cornerSize||X.cornerSize,Y=this.sizeY||O.cornerSize||X.cornerSize,U=typeof O.transparentCorners<"u"?O.transparentCorners:X.transparentCorners,Q=U?"stroke":"fill",te=!U&&(O.cornerStrokeColor||X.cornerStrokeColor),se=V/2,fe=Y/2;l.save(),l.fillStyle=O.cornerColor||X.cornerColor,l.strokeStyle=O.cornerStrokeColor||X.cornerStrokeColor,l.lineWidth=1,l.translate(L,q),l.rotate(F(X.angle)),l[Q+"Rect"](-se,-fe,V,Y),te&&l.strokeRect(-se,-fe,V,Y),l.restore()}R.renderCircleControl=o,R.renderSquareControl=S}(B),function(M){var E=M.fabric||(M.fabric={});function F(R){for(var o in R)this[o]=R[o]}E.Control=F,E.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(R,o){return o.cursorStyle},getActionName:function(R,o){return o.actionName},getVisibility:function(R,o){var S=R._controlsVisibility;return S&&typeof S[o]<"u"?S[o]:this.visible},setVisibility:function(R){this.visible=R},positionHandler:function(R,o){var S=E.util.transformPoint({x:this.x*R.x+this.offsetX,y:this.y*R.y+this.offsetY},o);return S},calcCornerCoords:function(R,o,S,l,L){var q,O,X,V,Y=L?this.touchSizeX:this.sizeX,U=L?this.touchSizeY:this.sizeY;if(Y&&U&&Y!==U){var Q=Math.atan2(U,Y),te=Math.sqrt(Y*Y+U*U)/2,se=Q-E.util.degreesToRadians(R),fe=Math.PI/2-Q-E.util.degreesToRadians(R);q=te*E.util.cos(se),O=te*E.util.sin(se),X=te*E.util.cos(fe),V=te*E.util.sin(fe)}else{var Se=Y&&U?Y:o;te=Se*.7071067812;var se=E.util.degreesToRadians(45-R);q=X=te*E.util.cos(se),O=V=te*E.util.sin(se)}return{tl:{x:S-V,y:l-X},tr:{x:S+q,y:l-O},bl:{x:S-q,y:l+O},br:{x:S+V,y:l+X}}},render:function(R,o,S,l,L){switch(l=l||{},l.cornerStyle||L.cornerStyle){case"circle":E.controlsUtils.renderCircleControl.call(this,R,o,S,l,L);break;default:E.controlsUtils.renderSquareControl.call(this,R,o,S,l,L)}}}}(B),function(){function M(S,l){var L=S.getAttribute("style"),q=S.getAttribute("offset")||0,O,X,V,Y;if(q=parseFloat(q)/(/%$/.test(q)?100:1),q=q<0?0:q>1?1:q,L){var U=L.split(/\s*;\s*/);for(U[U.length-1]===""&&U.pop(),Y=U.length;Y--;){var Q=U[Y].split(/\s*:\s*/),te=Q[0].trim(),se=Q[1].trim();te==="stop-color"?O=se:te==="stop-opacity"&&(V=se)}}return O||(O=S.getAttribute("stop-color")||"rgb(0,0,0)"),V||(V=S.getAttribute("stop-opacity")),O=new p.Color(O),X=O.getAlpha(),V=isNaN(parseFloat(V))?1:parseFloat(V),V*=X*l,{offset:q,color:O.toRgb(),opacity:V}}function E(S){return{x1:S.getAttribute("x1")||0,y1:S.getAttribute("y1")||0,x2:S.getAttribute("x2")||"100%",y2:S.getAttribute("y2")||0}}function F(S){return{x1:S.getAttribute("fx")||S.getAttribute("cx")||"50%",y1:S.getAttribute("fy")||S.getAttribute("cy")||"50%",r1:0,x2:S.getAttribute("cx")||"50%",y2:S.getAttribute("cy")||"50%",r2:S.getAttribute("r")||"50%"}}var R=p.util.object.clone;p.Gradient=p.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(S){S||(S={}),S.coords||(S.coords={});var l,L=this;Object.keys(S).forEach(function(q){L[q]=S[q]}),this.id?this.id+="_"+p.Object.__uid++:this.id=p.Object.__uid++,l={x1:S.coords.x1||0,y1:S.coords.y1||0,x2:S.coords.x2||0,y2:S.coords.y2||0},this.type==="radial"&&(l.r1=S.coords.r1||0,l.r2=S.coords.r2||0),this.coords=l,this.colorStops=S.colorStops.slice()},addColorStop:function(S){for(var l in S){var L=new p.Color(S[l]);this.colorStops.push({offset:parseFloat(l),color:L.toRgb(),opacity:L.getAlpha()})}return this},toObject:function(S){var l={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return p.util.populateWithProperties(this,l,S),l},toSVG:function(S,X){var L=R(this.coords,!0),q,O,X=X||{},V,Y,U=R(this.colorStops,!0),Q=L.r1>L.r2,te=this.gradientTransform?this.gradientTransform.concat():p.iMatrix.concat(),se=-this.offsetX,fe=-this.offsetY,Se=!!X.additionalTransform,Te=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(U.sort(function(_e,qe){return _e.offset-qe.offset}),Te==="objectBoundingBox"?(se/=S.width,fe/=S.height):(se+=S.width/2,fe+=S.height/2),S.type==="path"&&this.gradientUnits!=="percentage"&&(se-=S.pathOffset.x,fe-=S.pathOffset.y),te[4]-=se,te[5]-=fe,Y='id="SVGID_'+this.id+'" gradientUnits="'+Te+'"',Y+=' gradientTransform="'+(Se?X.additionalTransform+" ":"")+p.util.matrixToSVG(te)+'" ',this.type==="linear"?V=["<linearGradient ",Y,' x1="',L.x1,'" y1="',L.y1,'" x2="',L.x2,'" y2="',L.y2,`">
`]:this.type==="radial"&&(V=["<radialGradient ",Y,' cx="',Q?L.x1:L.x2,'" cy="',Q?L.y1:L.y2,'" r="',Q?L.r1:L.r2,'" fx="',Q?L.x2:L.x1,'" fy="',Q?L.y2:L.y1,`">
`]),this.type==="radial"){if(Q)for(U=U.concat(),U.reverse(),q=0,O=U.length;q<O;q++)U[q].offset=1-U[q].offset;var Re=Math.min(L.r1,L.r2);if(Re>0){var je=Math.max(L.r1,L.r2),He=Re/je;for(q=0,O=U.length;q<O;q++)U[q].offset+=He*(1-U[q].offset)}}for(q=0,O=U.length;q<O;q++){var ve=U[q];V.push("<stop ",'offset="',ve.offset*100+"%",'" style="stop-color:',ve.color,typeof ve.opacity<"u"?";stop-opacity: "+ve.opacity:";",`"/>
`)}return V.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),V.join("")},toLive:function(S){var l,L=p.util.object.clone(this.coords),q,O;if(this.type){for(this.type==="linear"?l=S.createLinearGradient(L.x1,L.y1,L.x2,L.y2):this.type==="radial"&&(l=S.createRadialGradient(L.x1,L.y1,L.r1,L.x2,L.y2,L.r2)),q=0,O=this.colorStops.length;q<O;q++){var X=this.colorStops[q].color,V=this.colorStops[q].opacity,Y=this.colorStops[q].offset;typeof V<"u"&&(X=new p.Color(X).setAlpha(V).toRgba()),l.addColorStop(Y,X)}return l}}}),p.util.object.extend(p.Gradient,{fromElement:function(S,l,L,q){var O=parseFloat(L)/(/%$/.test(L)?100:1);O=O<0?0:O>1?1:O,isNaN(O)&&(O=1);var X=S.getElementsByTagName("stop"),V,Y=S.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",U=S.getAttribute("gradientTransform")||"",Q=[],te,se,fe=0,Se=0,Te;for(S.nodeName==="linearGradient"||S.nodeName==="LINEARGRADIENT"?(V="linear",te=E(S)):(V="radial",te=F(S)),se=X.length;se--;)Q.push(M(X[se],O));Te=p.parseTransformAttribute(U),o(l,te,q,Y),Y==="pixels"&&(fe=-l.left,Se=-l.top);var Re=new p.Gradient({id:S.getAttribute("id"),type:V,coords:te,colorStops:Q,gradientUnits:Y,gradientTransform:Te,offsetX:fe,offsetY:Se});return Re}});function o(S,l,L,q){var O,X;Object.keys(l).forEach(function(V){O=l[V],O==="Infinity"?X=1:O==="-Infinity"?X=0:(X=parseFloat(l[V],10),typeof O=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(O)&&(X*=.01,q==="pixels"&&((V==="x1"||V==="x2"||V==="r2")&&(X*=L.viewBoxWidth||L.width),(V==="y1"||V==="y2")&&(X*=L.viewBoxHeight||L.height)))),l[V]=X})}}(),function(){var M=p.util.toFixed;p.Pattern=p.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(E,F){if(E||(E={}),this.id=p.Object.__uid++,this.setOptions(E),!E.source||E.source&&typeof E.source!="string"){F&&F(this);return}else{var R=this;this.source=p.util.createImage(),p.util.loadImage(E.source,function(o,S){R.source=o,F&&F(R,S)},null,this.crossOrigin)}},toObject:function(E){var F=p.Object.NUM_FRACTION_DIGITS,R,o;return typeof this.source.src=="string"?R=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(R=this.source.toDataURL()),o={type:"pattern",source:R,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:M(this.offsetX,F),offsetY:M(this.offsetY,F),patternTransform:this.patternTransform?this.patternTransform.concat():null},p.util.populateWithProperties(this,o,E),o},toSVG:function(E){var F=typeof this.source=="function"?this.source():this.source,R=F.width/E.width,o=F.height/E.height,S=this.offsetX/E.width,l=this.offsetY/E.height,L="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(o=1,l&&(o+=Math.abs(l))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(R=1,S&&(R+=Math.abs(S))),F.src?L=F.src:F.toDataURL&&(L=F.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+S+'" y="'+l+'" width="'+R+'" height="'+o+`">
<image x="0" y="0" width="`+F.width+'" height="'+F.height+'" xlink:href="'+L+`"></image>
</pattern>
`},setOptions:function(E){for(var F in E)this[F]=E[F]},toLive:function(E){var F=this.source;return!F||typeof F.src<"u"&&(!F.complete||F.naturalWidth===0||F.naturalHeight===0)?"":E.createPattern(F,this.repeat)}})}(),function(M){var E=M.fabric||(M.fabric={}),F=E.util.toFixed;if(E.Shadow){E.warn("fabric.Shadow is already defined.");return}E.Shadow=E.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(R){typeof R=="string"&&(R=this._parseShadow(R));for(var o in R)this[o]=R[o];this.id=E.Object.__uid++},_parseShadow:function(R){var o=R.trim(),S=E.Shadow.reOffsetsAndBlur.exec(o)||[],l=o.replace(E.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:l.trim(),offsetX:parseFloat(S[1],10)||0,offsetY:parseFloat(S[2],10)||0,blur:parseFloat(S[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(R){var o=40,S=40,l=E.Object.NUM_FRACTION_DIGITS,L=E.util.rotateVector({x:this.offsetX,y:this.offsetY},E.util.degreesToRadians(-R.angle)),q=20,O=new E.Color(this.color);return R.width&&R.height&&(o=F((Math.abs(L.x)+this.blur)/R.width,l)*100+q,S=F((Math.abs(L.y)+this.blur)/R.height,l)*100+q),R.flipX&&(L.x*=-1),R.flipY&&(L.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+S+'%" height="'+(100+2*S)+'%" x="-'+o+'%" width="'+(100+2*o)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+F(this.blur?this.blur/2:0,l)+`"></feGaussianBlur>
	<feOffset dx="`+F(L.x,l)+'" dy="'+F(L.y,l)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+O.toRgb()+'" flood-opacity="'+O.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var R={},o=E.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(S){this[S]!==o[S]&&(R[S]=this[S])},this),R}}),E.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(B),function(){if(p.StaticCanvas){p.warn("fabric.StaticCanvas is already defined.");return}var M=p.util.object.extend,E=p.util.getElementOffset,F=p.util.removeFromArray,R=p.util.toFixed,o=p.util.transformPoint,S=p.util.invertTransform,l=p.util.getNodeCanvas,L=p.util.createCanvasElement,q=new Error("Could not initialize `canvas` element");p.StaticCanvas=p.util.createClass(p.CommonMethods,{initialize:function(O,X){X||(X={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(O,X)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:p.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(O,X){var V=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(O),this._initOptions(X),this.interactive||this._initRetinaScaling(),X.overlayImage&&this.setOverlayImage(X.overlayImage,V),X.backgroundImage&&this.setBackgroundImage(X.backgroundImage,V),X.backgroundColor&&this.setBackgroundColor(X.backgroundColor,V),X.overlayColor&&this.setOverlayColor(X.overlayColor,V),this.calcOffset()},_isRetinaScaling:function(){return p.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,p.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var O=p.devicePixelRatio;this.__initRetinaScaling(O,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(O,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(O,X,V){X.setAttribute("width",this.width*O),X.setAttribute("height",this.height*O),V.scale(O,O)},calcOffset:function(){return this._offset=E(this.lowerCanvasEl),this},setOverlayImage:function(O,X,V){return this.__setBgOverlayImage("overlayImage",O,X,V)},setBackgroundImage:function(O,X,V){return this.__setBgOverlayImage("backgroundImage",O,X,V)},setOverlayColor:function(O,X){return this.__setBgOverlayColor("overlayColor",O,X)},setBackgroundColor:function(O,X){return this.__setBgOverlayColor("backgroundColor",O,X)},__setBgOverlayImage:function(O,X,V,Y){return typeof X=="string"?p.util.loadImage(X,function(U,Q){if(U){var te=new p.Image(U,Y);this[O]=te,te.canvas=this}V&&V(U,Q)},this,Y&&Y.crossOrigin):(Y&&X.setOptions(Y),this[O]=X,X&&(X.canvas=this),V&&V(X,!1)),this},__setBgOverlayColor:function(O,X,V){return this[O]=X,this._initGradient(X,O),this._initPattern(X,O,V),this},_createCanvasElement:function(){var O=L();if(!O||(O.style||(O.style={}),typeof O.getContext>"u"))throw q;return O},_initOptions:function(O){var X=this.lowerCanvasEl;this._setOptions(O),this.width=this.width||parseInt(X.width,10)||0,this.height=this.height||parseInt(X.height,10)||0,this.lowerCanvasEl.style&&(X.width=this.width,X.height=this.height,X.style.width=this.width+"px",X.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(O){O&&O.getContext?this.lowerCanvasEl=O:this.lowerCanvasEl=p.util.getById(O)||this._createCanvasElement(),p.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(O,X){return this.setDimensions({width:O},X)},setHeight:function(O,X){return this.setDimensions({height:O},X)},setDimensions:function(O,X){var V;X=X||{};for(var Y in O)V=O[Y],X.cssOnly||(this._setBackstoreDimension(Y,O[Y]),V+="px",this.hasLostContext=!0),X.backstoreOnly||this._setCssDimension(Y,V);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),X.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(O,X){return this.lowerCanvasEl[O]=X,this.upperCanvasEl&&(this.upperCanvasEl[O]=X),this.cacheCanvasEl&&(this.cacheCanvasEl[O]=X),this[O]=X,this},_setCssDimension:function(O,X){return this.lowerCanvasEl.style[O]=X,this.upperCanvasEl&&(this.upperCanvasEl.style[O]=X),this.wrapperEl&&(this.wrapperEl.style[O]=X),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(O){var X=this._activeObject,V=this.backgroundImage,Y=this.overlayImage,U,Q,te;for(this.viewportTransform=O,Q=0,te=this._objects.length;Q<te;Q++)U=this._objects[Q],U.group||U.setCoords(!0);return X&&X.setCoords(),V&&V.setCoords(!0),Y&&Y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(O,X){var V=O,Y=this.viewportTransform.slice(0);O=o(O,S(this.viewportTransform)),Y[0]=X,Y[3]=X;var U=o(O,Y);return Y[4]+=V.x-U.x,Y[5]+=V.y-U.y,this.setViewportTransform(Y)},setZoom:function(O){return this.zoomToPoint(new p.Point(0,0),O),this},absolutePan:function(O){var X=this.viewportTransform.slice(0);return X[4]=-O.x,X[5]=-O.y,this.setViewportTransform(X)},relativePan:function(O){return this.absolutePan(new p.Point(-O.x-this.viewportTransform[4],-O.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(O){this.stateful&&O.setupState(),O._set("canvas",this),O.setCoords(),this.fire("object:added",{target:O}),O.fire("added")},_onObjectRemoved:function(O){this.fire("object:removed",{target:O}),O.fire("removed"),delete O.canvas},clearContext:function(O){return O.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var O=this.contextContainer;return this.renderCanvas(O,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=p.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var O={},X=this.width,V=this.height,Y=S(this.viewportTransform);return O.tl=o({x:0,y:0},Y),O.br=o({x:X,y:V},Y),O.tr=new p.Point(O.br.x,O.tl.y),O.bl=new p.Point(O.tl.x,O.br.y),this.vptCoords=O,O},cancelRequestedRender:function(){this.isRendering&&(p.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(O,X){var V=this.viewportTransform,Y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(O),p.util.setImageSmoothing(O,this.imageSmoothingEnabled),this.fire("before:render",{ctx:O}),this._renderBackground(O),O.save(),O.transform(V[0],V[1],V[2],V[3],V[4],V[5]),this._renderObjects(O,X),O.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(O),Y&&(Y.canvas=this,Y.shouldCache(),Y._transformDone=!0,Y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(O)),this._renderOverlay(O),this.controlsAboveOverlay&&this.interactive&&this.drawControls(O),this.fire("after:render",{ctx:O})},drawClipPathOnCanvas:function(O){var X=this.viewportTransform,V=this.clipPath;O.save(),O.transform(X[0],X[1],X[2],X[3],X[4],X[5]),O.globalCompositeOperation="destination-in",V.transform(O),O.scale(1/V.zoomX,1/V.zoomY),O.drawImage(V._cacheCanvas,-V.cacheTranslationX,-V.cacheTranslationY),O.restore()},_renderObjects:function(O,X){var V,Y;for(V=0,Y=X.length;V<Y;++V)X[V]&&X[V].render(O)},_renderBackgroundOrOverlay:function(O,X){var V=this[X+"Color"],Y=this[X+"Image"],U=this.viewportTransform,Q=this[X+"Vpt"];if(!(!V&&!Y)){if(V){O.save(),O.beginPath(),O.moveTo(0,0),O.lineTo(this.width,0),O.lineTo(this.width,this.height),O.lineTo(0,this.height),O.closePath(),O.fillStyle=V.toLive?V.toLive(O,this):V,Q&&O.transform(U[0],U[1],U[2],U[3],U[4],U[5]),O.transform(1,0,0,1,V.offsetX||0,V.offsetY||0);var te=V.gradientTransform||V.patternTransform;te&&O.transform(te[0],te[1],te[2],te[3],te[4],te[5]),O.fill(),O.restore()}if(Y){O.save();var se=this.skipOffscreen;this.skipOffscreen=Q,Q&&O.transform(U[0],U[1],U[2],U[3],U[4],U[5]),Y.render(O),this.skipOffscreen=se,O.restore()}}},_renderBackground:function(O){this._renderBackgroundOrOverlay(O,"background")},_renderOverlay:function(O){this._renderBackgroundOrOverlay(O,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new p.Point(this.width/2,this.height/2)},centerObjectH:function(O){return this._centerObject(O,new p.Point(this.getCenterPoint().x,O.getCenterPoint().y))},centerObjectV:function(O){return this._centerObject(O,new p.Point(O.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(O){var X=this.getCenterPoint();return this._centerObject(O,X)},viewportCenterObject:function(O){var X=this.getVpCenter();return this._centerObject(O,X)},viewportCenterObjectH:function(O){var X=this.getVpCenter();return this._centerObject(O,new p.Point(X.x,O.getCenterPoint().y)),this},viewportCenterObjectV:function(O){var X=this.getVpCenter();return this._centerObject(O,new p.Point(O.getCenterPoint().x,X.y))},getVpCenter:function(){var O=this.getCenterPoint(),X=S(this.viewportTransform);return o(O,X)},_centerObject:function(O,X){return O.setPositionByOrigin(X,"center","center"),O.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(O){return this.toDatalessObject(O)},toObject:function(O){return this._toObjectMethod("toObject",O)},toDatalessObject:function(O){return this._toObjectMethod("toDatalessObject",O)},_toObjectMethod:function(O,X){var V=this.clipPath,Y={version:p.version,objects:this._toObjects(O,X)};return V&&!V.excludeFromExport&&(Y.clipPath=this._toObject(this.clipPath,O,X)),M(Y,this.__serializeBgOverlay(O,X)),p.util.populateWithProperties(this,Y,X),Y},_toObjects:function(O,X){return this._objects.filter(function(V){return!V.excludeFromExport}).map(function(V){return this._toObject(V,O,X)},this)},_toObject:function(O,X,V){var Y;this.includeDefaultValues||(Y=O.includeDefaultValues,O.includeDefaultValues=!1);var U=O[X](V);return this.includeDefaultValues||(O.includeDefaultValues=Y),U},__serializeBgOverlay:function(O,X){var V={},Y=this.backgroundImage,U=this.overlayImage,Q=this.backgroundColor,te=this.overlayColor;return Q&&Q.toObject?Q.excludeFromExport||(V.background=Q.toObject(X)):Q&&(V.background=Q),te&&te.toObject?te.excludeFromExport||(V.overlay=te.toObject(X)):te&&(V.overlay=te),Y&&!Y.excludeFromExport&&(V.backgroundImage=this._toObject(Y,O,X)),U&&!U.excludeFromExport&&(V.overlayImage=this._toObject(U,O,X)),V},svgViewportTransformation:!0,toSVG:function(O,X){O||(O={}),O.reviver=X;var V=[];return this._setSVGPreamble(V,O),this._setSVGHeader(V,O),this.clipPath&&V.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(V,"background"),this._setSVGBgOverlayImage(V,"backgroundImage",X),this._setSVGObjects(V,X),this.clipPath&&V.push(`</g>
`),this._setSVGBgOverlayColor(V,"overlay"),this._setSVGBgOverlayImage(V,"overlayImage",X),V.push("</svg>"),V.join("")},_setSVGPreamble:function(O,X){X.suppressPreamble||O.push('<?xml version="1.0" encoding="',X.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(O,X){var V=X.width||this.width,Y=X.height||this.height,U,Q='viewBox="0 0 '+this.width+" "+this.height+'" ',te=p.Object.NUM_FRACTION_DIGITS;X.viewBox?Q='viewBox="'+X.viewBox.x+" "+X.viewBox.y+" "+X.viewBox.width+" "+X.viewBox.height+'" ':this.svgViewportTransformation&&(U=this.viewportTransform,Q='viewBox="'+R(-U[4]/U[0],te)+" "+R(-U[5]/U[3],te)+" "+R(this.width/U[0],te)+" "+R(this.height/U[3],te)+'" '),O.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',V,'" ','height="',Y,'" ',Q,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",p.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(X),`</defs>
`)},createSVGClipPathMarkup:function(O){var X=this.clipPath;return X?(X.clipPathId="CLIPPATH_"+p.Object.__uid++,'<clipPath id="'+X.clipPathId+`" >
`+this.clipPath.toClipPathSVG(O.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var O=this,X=["background","overlay"].map(function(V){var Y=O[V+"Color"];if(Y&&Y.toLive){var U=O[V+"Vpt"],Q=O.viewportTransform,te={width:O.width/(U?Q[0]:1),height:O.height/(U?Q[3]:1)};return Y.toSVG(te,{additionalTransform:U?p.util.matrixToSVG(Q):""})}});return X.join("")},createSVGFontFacesMarkup:function(){var O="",X={},V,Y,U,Q,te,se,fe,Se,Te,Re=p.fontPaths,je=[];for(this._objects.forEach(function ve(_e){je.push(_e),_e._objects&&_e._objects.forEach(ve)}),Se=0,Te=je.length;Se<Te;Se++)if(V=je[Se],Y=V.fontFamily,!(V.type.indexOf("text")===-1||X[Y]||!Re[Y])&&(X[Y]=!0,!!V.styles)){U=V.styles;for(te in U){Q=U[te];for(fe in Q)se=Q[fe],Y=se.fontFamily,!X[Y]&&Re[Y]&&(X[Y]=!0)}}for(var He in X)O+=[`		@font-face {
`,"			font-family: '",He,`';
`,"			src: url('",Re[He],`');
`,`		}
`].join("");return O&&(O=['	<style type="text/css">',`<![CDATA[
`,O,"]]>",`</style>
`].join("")),O},_setSVGObjects:function(O,X){var V,Y,U,Q=this._objects;for(Y=0,U=Q.length;Y<U;Y++)V=Q[Y],!V.excludeFromExport&&this._setSVGObject(O,V,X)},_setSVGObject:function(O,X,V){O.push(X.toSVG(V))},_setSVGBgOverlayImage:function(O,X,V){this[X]&&!this[X].excludeFromExport&&this[X].toSVG&&O.push(this[X].toSVG(V))},_setSVGBgOverlayColor:function(O,X){var V=this[X+"Color"],Y=this.viewportTransform,U=this.width,Q=this.height;if(V)if(V.toLive){var te=V.repeat,se=p.util.invertTransform(Y),fe=this[X+"Vpt"],Se=fe?p.util.matrixToSVG(se):"";O.push('<rect transform="'+Se+" translate(",U/2,",",Q/2,')"',' x="',V.offsetX-U/2,'" y="',V.offsetY-Q/2,'" ','width="',te==="repeat-y"||te==="no-repeat"?V.source.width:U,'" height="',te==="repeat-x"||te==="no-repeat"?V.source.height:Q,'" fill="url(#SVGID_'+V.id+')"',`></rect>
`)}else O.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',V,'"',`></rect>
`)},sendToBack:function(O){if(!O)return this;var X=this._activeObject,V,Y,U;if(O===X&&O.type==="activeSelection")for(U=X._objects,V=U.length;V--;)Y=U[V],F(this._objects,Y),this._objects.unshift(Y);else F(this._objects,O),this._objects.unshift(O);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(O){if(!O)return this;var X=this._activeObject,V,Y,U;if(O===X&&O.type==="activeSelection")for(U=X._objects,V=0;V<U.length;V++)Y=U[V],F(this._objects,Y),this._objects.push(Y);else F(this._objects,O),this._objects.push(O);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(O,X){if(!O)return this;var V=this._activeObject,Y,U,Q,te,se,fe=0;if(O===V&&O.type==="activeSelection")for(se=V._objects,Y=0;Y<se.length;Y++)U=se[Y],Q=this._objects.indexOf(U),Q>0+fe&&(te=Q-1,F(this._objects,U),this._objects.splice(te,0,U)),fe++;else Q=this._objects.indexOf(O),Q!==0&&(te=this._findNewLowerIndex(O,Q,X),F(this._objects,O),this._objects.splice(te,0,O));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(O,X,V){var Y,U;if(V)for(Y=X,U=X-1;U>=0;--U){var Q=O.intersectsWithObject(this._objects[U])||O.isContainedWithinObject(this._objects[U])||this._objects[U].isContainedWithinObject(O);if(Q){Y=U;break}}else Y=X-1;return Y},bringForward:function(O,X){if(!O)return this;var V=this._activeObject,Y,U,Q,te,se,fe=0;if(O===V&&O.type==="activeSelection")for(se=V._objects,Y=se.length;Y--;)U=se[Y],Q=this._objects.indexOf(U),Q<this._objects.length-1-fe&&(te=Q+1,F(this._objects,U),this._objects.splice(te,0,U)),fe++;else Q=this._objects.indexOf(O),Q!==this._objects.length-1&&(te=this._findNewUpperIndex(O,Q,X),F(this._objects,O),this._objects.splice(te,0,O));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(O,X,V){var Y,U,Q;if(V)for(Y=X,U=X+1,Q=this._objects.length;U<Q;++U){var te=O.intersectsWithObject(this._objects[U])||O.isContainedWithinObject(this._objects[U])||this._objects[U].isContainedWithinObject(O);if(te){Y=U;break}}else Y=X+1;return Y},moveTo:function(O,X){return F(this._objects,O),this._objects.splice(X,0,O),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(p.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(O){O.dispose&&O.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),p.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),p.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),M(p.StaticCanvas.prototype,p.Observable),M(p.StaticCanvas.prototype,p.Collection),M(p.StaticCanvas.prototype,p.DataURLExporter),M(p.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(O){var X=L();if(!X||!X.getContext)return null;var V=X.getContext("2d");if(!V)return null;switch(O){case"setLineDash":return typeof V.setLineDash<"u";default:return null}}}),p.StaticCanvas.prototype.toJSON=p.StaticCanvas.prototype.toObject,p.isLikelyNode&&(p.StaticCanvas.prototype.createPNGStream=function(){var O=l(this.lowerCanvasEl);return O&&O.createPNGStream()},p.StaticCanvas.prototype.createJPEGStream=function(O){var X=l(this.lowerCanvasEl);return X&&X.createJPEGStream(O)})}(),p.BaseBrush=p.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(M){M.strokeStyle=this.color,M.lineWidth=this.width,M.lineCap=this.strokeLineCap,M.miterLimit=this.strokeMiterLimit,M.lineJoin=this.strokeLineJoin,M.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(M){var E=this.canvas.viewportTransform;M.save(),M.transform(E[0],E[1],E[2],E[3],E[4],E[5])},_setShadow:function(){if(this.shadow){var M=this.canvas,E=this.shadow,F=M.contextTop,R=M.getZoom();M&&M._isRetinaScaling()&&(R*=p.devicePixelRatio),F.shadowColor=E.color,F.shadowBlur=E.blur*R,F.shadowOffsetX=E.offsetX*R,F.shadowOffsetY=E.offsetY*R}},needsFullRender:function(){var M=new p.Color(this.color);return M.getAlpha()<1||!!this.shadow},_resetShadow:function(){var M=this.canvas.contextTop;M.shadowColor="",M.shadowBlur=M.shadowOffsetX=M.shadowOffsetY=0},_isOutSideCanvas:function(M){return M.x<0||M.x>this.canvas.getWidth()||M.y<0||M.y>this.canvas.getHeight()}}),function(){p.PencilBrush=p.util.createClass(p.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(M){this.canvas=M,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(M,E,F){var R=E.midPointFrom(F);return M.quadraticCurveTo(E.x,E.y,R.x,R.y),R},onMouseDown:function(M,E){this.canvas._isMainEvent(E.e)&&(this.drawStraightLine=E.e[this.straightLineKey],this._prepareForDrawing(M),this._captureDrawingPath(M),this._render())},onMouseMove:function(M,E){if(this.canvas._isMainEvent(E.e)&&(this.drawStraightLine=E.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(M))&&this._captureDrawingPath(M)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var F=this._points,R=F.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(o,F[R-2],F[R-1],!0),o.stroke(),o.restore()}},onMouseUp:function(M){return this.canvas._isMainEvent(M.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(M){var E=new p.Point(M.x,M.y);this._reset(),this._addPoint(E),this.canvas.contextTop.moveTo(E.x,E.y)},_addPoint:function(M){return this._points.length>1&&M.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(M),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(M){var E=new p.Point(M.x,M.y);return this._addPoint(E)},_render:function(M){var E,F,R=this._points[0],o=this._points[1];if(M=M||this.canvas.contextTop,this._saveAndTransform(M),M.beginPath(),this._points.length===2&&R.x===o.x&&R.y===o.y){var S=this.width/1e3;R=new p.Point(R.x,R.y),o=new p.Point(o.x,o.y),R.x-=S,o.x+=S}for(M.moveTo(R.x,R.y),E=1,F=this._points.length;E<F;E++)this._drawSegment(M,R,o),R=this._points[E],o=this._points[E+1];M.lineTo(R.x,R.y),M.stroke(),M.restore()},convertPointsToSVGPath:function(M){var E=this.width/1e3;return p.util.getSmoothPathFromPoints(M,E)},_isEmptySVGPath:function(M){var E=p.util.joinPath(M);return E==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(M){var E=new p.Path(M,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,E.shadow=new p.Shadow(this.shadow)),E},decimatePoints:function(M,E){if(M.length<=2)return M;var F=this.canvas.getZoom(),R=Math.pow(E/F,2),o,S=M.length-1,l=M[0],L=[l],q;for(o=1;o<S-1;o++)q=Math.pow(l.x-M[o].x,2)+Math.pow(l.y-M[o].y,2),q>=R&&(l=M[o],L.push(l));return L.push(M[S]),L},_finalizeAndAddPath:function(){var M=this.canvas.contextTop;M.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var E=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(E)){this.canvas.requestRenderAll();return}var F=this.createPath(E);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:F}),this.canvas.add(F),this.canvas.requestRenderAll(),F.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:F})}})}(),p.CircleBrush=p.util.createClass(p.BaseBrush,{width:10,initialize:function(M){this.canvas=M,this.points=[]},drawDot:function(M){var E=this.addPoint(M),F=this.canvas.contextTop;this._saveAndTransform(F),this.dot(F,E),F.restore()},dot:function(M,E){M.fillStyle=E.fill,M.beginPath(),M.arc(E.x,E.y,E.radius,0,Math.PI*2,!1),M.closePath(),M.fill()},onMouseDown:function(M){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(M)},_render:function(){var M=this.canvas.contextTop,E,F,R=this.points;for(this._saveAndTransform(M),E=0,F=R.length;E<F;E++)this.dot(M,R[E]);M.restore()},onMouseMove:function(M){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(M)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(M),this._render()):this.drawDot(M))},onMouseUp:function(){var M=this.canvas.renderOnAddRemove,E,F;this.canvas.renderOnAddRemove=!1;var R=[];for(E=0,F=this.points.length;E<F;E++){var o=this.points[E],S=new p.Circle({radius:o.radius,left:o.x,top:o.y,originX:"center",originY:"center",fill:o.fill});this.shadow&&(S.shadow=new p.Shadow(this.shadow)),R.push(S)}var l=new p.Group(R);l.canvas=this.canvas,this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=M,this.canvas.requestRenderAll()},addPoint:function(M){var E=new p.Point(M.x,M.y),F=p.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,R=new p.Color(this.color).setAlpha(p.util.getRandomInt(0,100)/100).toRgba();return E.radius=F,E.fill=R,this.points.push(E),E}}),p.SprayBrush=p.util.createClass(p.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(M){this.canvas=M,this.sprayChunks=[]},onMouseDown:function(M){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(M),this.render(this.sprayChunkPoints)},onMouseMove:function(M){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(M)||(this.addSprayChunk(M),this.render(this.sprayChunkPoints))},onMouseUp:function(){var M=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var E=[],F=0,R=this.sprayChunks.length;F<R;F++)for(var o=this.sprayChunks[F],S=0,l=o.length;S<l;S++){var L=new p.Rect({width:o[S].width,height:o[S].width,left:o[S].x+1,top:o[S].y+1,originX:"center",originY:"center",fill:this.color});E.push(L)}this.optimizeOverlapping&&(E=this._getOptimizedRects(E));var q=new p.Group(E);this.shadow&&q.set("shadow",new p.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:q}),this.canvas.add(q),this.canvas.fire("path:created",{path:q}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=M,this.canvas.requestRenderAll()},_getOptimizedRects:function(M){var E={},F,R,o;for(R=0,o=M.length;R<o;R++)F=M[R].left+""+M[R].top,E[F]||(E[F]=M[R]);var S=[];for(F in E)S.push(E[F]);return S},render:function(M){var E=this.canvas.contextTop,F,R;for(E.fillStyle=this.color,this._saveAndTransform(E),F=0,R=M.length;F<R;F++){var o=M[F];typeof o.opacity<"u"&&(E.globalAlpha=o.opacity),E.fillRect(o.x,o.y,o.width,o.width)}E.restore()},_render:function(){var M=this.canvas.contextTop,E,F;for(M.fillStyle=this.color,this._saveAndTransform(M),E=0,F=this.sprayChunks.length;E<F;E++)this.render(this.sprayChunks[E]);M.restore()},addSprayChunk:function(M){this.sprayChunkPoints=[];var E,F,R,o=this.width/2,S;for(S=0;S<this.density;S++){E=p.util.getRandomInt(M.x-o,M.x+o),F=p.util.getRandomInt(M.y-o,M.y+o),this.dotWidthVariance?R=p.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):R=this.dotWidth;var l=new p.Point(E,F);l.width=R,this.randomOpacity&&(l.opacity=p.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(l)}this.sprayChunks.push(this.sprayChunkPoints)}}),p.PatternBrush=p.util.createClass(p.PencilBrush,{getPatternSrc:function(){var M=20,E=5,F=p.util.createCanvasElement(),R=F.getContext("2d");return F.width=F.height=M+E,R.fillStyle=this.color,R.beginPath(),R.arc(M/2,M/2,M/2,0,Math.PI*2,!1),R.closePath(),R.fill(),F},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(M){return M.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(M){this.callSuper("_setBrushStyles",M),M.strokeStyle=this.getPattern(M)},createPath:function(M){var E=this.callSuper("createPath",M),F=E._getLeftTopCoords().scalarAdd(E.strokeWidth/2);return E.stroke=new p.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-F.x,offsetY:-F.y}),E}}),function(){var M=p.util.getPointer,E=p.util.degreesToRadians,F=p.util.isTouchEvent;p.Canvas=p.util.createClass(p.StaticCanvas,{initialize:function(o,S){S||(S={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(o,S),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=p.PencilBrush&&new p.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var o=this.getActiveObjects(),S,l,L;if(o.length>0&&!this.preserveObjectStacking){l=[],L=[];for(var q=0,O=this._objects.length;q<O;q++)S=this._objects[q],o.indexOf(S)===-1?l.push(S):L.push(S);o.length>1&&(this._activeObject._objects=L),l.push.apply(l,L)}else l=this._objects;return l},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var o=this.contextContainer;return this.renderCanvas(o,this._chooseObjectsToRender()),this},renderTopLayer:function(o){o.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(o),this.contextTopDirty=!0),o.restore()},renderTop:function(){var o=this.contextTop;return this.clearContext(o),this.renderTopLayer(o),this.fire("after:render"),this},_normalizePointer:function(o,S){var l=o.calcTransformMatrix(),L=p.util.invertTransform(l),q=this.restorePointerVpt(S);return p.util.transformPoint(q,L)},isTargetTransparent:function(o,S,l){if(o.shouldCache()&&o._cacheCanvas&&o!==this._activeObject){var L=this._normalizePointer(o,{x:S,y:l}),q=Math.max(o.cacheTranslationX+L.x*o.zoomX,0),O=Math.max(o.cacheTranslationY+L.y*o.zoomY,0),U=p.util.isTransparent(o._cacheContext,Math.round(q),Math.round(O),this.targetFindTolerance);return U}var X=this.contextCache,V=o.selectionBackgroundColor,Y=this.viewportTransform;o.selectionBackgroundColor="",this.clearContext(X),X.save(),X.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),o.render(X),X.restore(),o.selectionBackgroundColor=V;var U=p.util.isTransparent(X,S,l,this.targetFindTolerance);return U},_isSelectionKeyPressed:function(o){var S=!1;return Array.isArray(this.selectionKey)?S=!!this.selectionKey.find(function(l){return o[l]===!0}):S=o[this.selectionKey],S},_shouldClearSelection:function(o,S){var l=this.getActiveObjects(),L=this._activeObject;return!S||S&&L&&l.length>1&&l.indexOf(S)===-1&&L!==S&&!this._isSelectionKeyPressed(o)||S&&!S.evented||S&&!S.selectable&&L&&L!==S},_shouldCenterTransform:function(o,S,l){if(o){var L;return S==="scale"||S==="scaleX"||S==="scaleY"||S==="resizing"?L=this.centeredScaling||o.centeredScaling:S==="rotate"&&(L=this.centeredRotation||o.centeredRotation),L?!l:l}},_getOriginFromCorner:function(o,S){var l={x:o.originX,y:o.originY};return S==="ml"||S==="tl"||S==="bl"?l.x="right":(S==="mr"||S==="tr"||S==="br")&&(l.x="left"),S==="tl"||S==="mt"||S==="tr"?l.y="bottom":(S==="bl"||S==="mb"||S==="br")&&(l.y="top"),l},_getActionFromCorner:function(o,S,l,L){if(!S||!o)return"drag";var q=L.controls[S];return q.getActionName(l,q,L)},_setupCurrentTransform:function(o,S,l){if(S){var L=this.getPointer(o),q=S.__corner,O=S.controls[q],X=l&&q?O.getActionHandler(o,S,O):p.controlsUtils.dragHandler,V=this._getActionFromCorner(l,q,o,S),Y=this._getOriginFromCorner(S,q),U=o[this.centeredKey],Q={target:S,action:V,actionHandler:X,corner:q,scaleX:S.scaleX,scaleY:S.scaleY,skewX:S.skewX,skewY:S.skewY,offsetX:L.x-S.left,offsetY:L.y-S.top,originX:Y.x,originY:Y.y,ex:L.x,ey:L.y,lastX:L.x,lastY:L.y,theta:E(S.angle),width:S.width*S.scaleX,shiftKey:o.shiftKey,altKey:U,original:p.util.saveObjectTransform(S)};this._shouldCenterTransform(S,V,U)&&(Q.originX="center",Q.originY="center"),Q.original.originX=Y.x,Q.original.originY=Y.y,this._currentTransform=Q,this._beforeTransform(o)}},setCursor:function(o){this.upperCanvasEl.style.cursor=o},_drawSelection:function(o){var S=this._groupSelector,l=new p.Point(S.ex,S.ey),L=p.util.transformPoint(l,this.viewportTransform),q=new p.Point(S.ex+S.left,S.ey+S.top),O=p.util.transformPoint(q,this.viewportTransform),X=Math.min(L.x,O.x),V=Math.min(L.y,O.y),Y=Math.max(L.x,O.x),U=Math.max(L.y,O.y),Q=this.selectionLineWidth/2;this.selectionColor&&(o.fillStyle=this.selectionColor,o.fillRect(X,V,Y-X,U-V)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(o.lineWidth=this.selectionLineWidth,o.strokeStyle=this.selectionBorderColor,X+=Q,V+=Q,Y-=Q,U-=Q,p.Object.prototype._setLineDash.call(this,o,this.selectionDashArray),o.strokeRect(X,V,Y-X,U-V))},findTarget:function(o,S){if(!this.skipTargetFind){var l=!0,L=this.getPointer(o,l),q=this._activeObject,O=this.getActiveObjects(),X,V,Y=F(o),U=O.length>1&&!S||O.length===1;if(this.targets=[],U&&q._findTargetCorner(L,Y)||O.length>1&&!S&&q===this._searchPossibleTargets([q],L))return q;if(O.length===1&&q===this._searchPossibleTargets([q],L))if(this.preserveObjectStacking)X=q,V=this.targets,this.targets=[];else return q;var Q=this._searchPossibleTargets(this._objects,L);return o[this.altSelectionKey]&&Q&&X&&Q!==X&&(Q=X,this.targets=V),Q}},_checkTarget:function(o,S,l){if(S&&S.visible&&S.evented&&S.containsPoint(o))if((this.perPixelTargetFind||S.perPixelTargetFind)&&!S.isEditing){var L=this.isTargetTransparent(S,l.x,l.y);if(!L)return!0}else return!0},_searchPossibleTargets:function(o,S){for(var l,L=o.length,q;L--;){var O=o[L],X=O.group?this._normalizePointer(O.group,S):S;if(this._checkTarget(X,O,S)){l=o[L],l.subTargetCheck&&l instanceof p.Group&&(q=this._searchPossibleTargets(l._objects,S),q&&this.targets.push(q));break}}return l},restorePointerVpt:function(o){return p.util.transformPoint(o,p.util.invertTransform(this.viewportTransform))},getPointer:function(o,S){if(this._absolutePointer&&!S)return this._absolutePointer;if(this._pointer&&S)return this._pointer;var l=M(o),L=this.upperCanvasEl,q=L.getBoundingClientRect(),O=q.width||0,X=q.height||0,V;(!O||!X)&&("top"in q&&"bottom"in q&&(X=Math.abs(q.top-q.bottom)),"right"in q&&"left"in q&&(O=Math.abs(q.right-q.left))),this.calcOffset(),l.x=l.x-this._offset.left,l.y=l.y-this._offset.top,S||(l=this.restorePointerVpt(l));var Y=this.getRetinaScaling();return Y!==1&&(l.x/=Y,l.y/=Y),O===0||X===0?V={width:1,height:1}:V={width:L.width/O,height:L.height/X},{x:l.x*V.width,y:l.y*V.height}},_createUpperCanvas:function(){var o=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),S=this.lowerCanvasEl,l=this.upperCanvasEl;l?l.className="":(l=this._createCanvasElement(),this.upperCanvasEl=l),p.util.addClass(l,"upper-canvas "+o),this.wrapperEl.appendChild(l),this._copyCanvasStyle(S,l),this._applyCanvasStyle(l),this.contextTop=l.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=p.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),p.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),p.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(o){var S=this.width||o.width,l=this.height||o.height;p.util.setStyle(o,{position:"absolute",width:S+"px",height:l+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),o.width=S,o.height=l,p.util.makeElementUnselectable(o)},_copyCanvasStyle:function(o,S){S.style.cssText=o.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var o=this._activeObject;return o?o.type==="activeSelection"&&o._objects?o._objects.slice(0):[o]:[]},_onObjectRemoved:function(o){o===this._activeObject&&(this.fire("before:selection:cleared",{target:o}),this._discardActiveObject(),this.fire("selection:cleared",{target:o}),o.fire("deselected")),o===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",o)},_fireSelectionEvents:function(o,S){var l=!1,L=this.getActiveObjects(),q=[],O=[];o.forEach(function(X){L.indexOf(X)===-1&&(l=!0,X.fire("deselected",{e:S,target:X}),O.push(X))}),L.forEach(function(X){o.indexOf(X)===-1&&(l=!0,X.fire("selected",{e:S,target:X}),q.push(X))}),o.length>0&&L.length>0?l&&this.fire("selection:updated",{e:S,selected:q,deselected:O}):L.length>0?this.fire("selection:created",{e:S,selected:q}):o.length>0&&this.fire("selection:cleared",{e:S,deselected:O})},setActiveObject:function(o,S){var l=this.getActiveObjects();return this._setActiveObject(o,S),this._fireSelectionEvents(l,S),this},_setActiveObject:function(o,S){return this._activeObject===o||!this._discardActiveObject(S,o)||o.onSelect({e:S})?!1:(this._activeObject=o,!0)},_discardActiveObject:function(o,S){var l=this._activeObject;if(l){if(l.onDeselect({e:o,object:S}))return!1;this._activeObject=null}return!0},discardActiveObject:function(o){var S=this.getActiveObjects(),l=this.getActiveObject();return S.length&&this.fire("before:selection:cleared",{target:l,e:o}),this._discardActiveObject(o),this._fireSelectionEvents(S,o),this},dispose:function(){var o=this.wrapperEl;return this.removeListeners(),o.removeChild(this.upperCanvasEl),o.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(S){p.util.cleanUpJsdomNode(this[S]),this[S]=void 0}).bind(this)),o.parentNode&&o.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,p.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(o){var S=this._activeObject;S&&S._renderControls(o)},_toObject:function(o,S,l){var L=this._realizeGroupTransformOnObject(o),q=this.callSuper("_toObject",o,S,l);return this._unwindGroupTransformOnObject(o,L),q},_realizeGroupTransformOnObject:function(o){if(o.group&&o.group.type==="activeSelection"&&this._activeObject===o.group){var S=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],l={};return S.forEach(function(L){l[L]=o[L]}),p.util.addTransformToObject(o,this._activeObject.calcOwnMatrix()),l}else return null},_unwindGroupTransformOnObject:function(o,S){S&&o.set(S)},_setSVGObject:function(o,S,l){var L=this._realizeGroupTransformOnObject(S);this.callSuper("_setSVGObject",o,S,l),this._unwindGroupTransformOnObject(S,L)},setViewportTransform:function(o){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),p.StaticCanvas.prototype.setViewportTransform.call(this,o)}});for(var R in p.StaticCanvas)R!=="prototype"&&(p.Canvas[R]=p.StaticCanvas[R])}(),function(){var M=p.util.addListener,E=p.util.removeListener,F=3,R=2,o=1,S={passive:!1};function l(L,q){return L.button&&L.button===q-1}p.util.object.extend(p.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(M,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(L,q){var O=this.upperCanvasEl,X=this._getEventPrefix();L(p.window,"resize",this._onResize),L(O,X+"down",this._onMouseDown),L(O,X+"move",this._onMouseMove,S),L(O,X+"out",this._onMouseOut),L(O,X+"enter",this._onMouseEnter),L(O,"wheel",this._onMouseWheel),L(O,"contextmenu",this._onContextMenu),L(O,"dblclick",this._onDoubleClick),L(O,"dragover",this._onDragOver),L(O,"dragenter",this._onDragEnter),L(O,"dragleave",this._onDragLeave),L(O,"drop",this._onDrop),this.enablePointerEvents||L(O,"touchstart",this._onTouchStart,S),typeof eventjs<"u"&&q in eventjs&&(eventjs[q](O,"gesture",this._onGesture),eventjs[q](O,"drag",this._onDrag),eventjs[q](O,"orientation",this._onOrientationChange),eventjs[q](O,"shake",this._onShake),eventjs[q](O,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(E,"remove");var L=this._getEventPrefix();E(p.document,L+"up",this._onMouseUp),E(p.document,"touchend",this._onTouchEnd,S),E(p.document,L+"move",this._onMouseMove,S),E(p.document,"touchmove",this._onMouseMove,S)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(L,q){this.__onTransformGesture&&this.__onTransformGesture(L,q)},_onDrag:function(L,q){this.__onDrag&&this.__onDrag(L,q)},_onMouseWheel:function(L){this.__onMouseWheel(L)},_onMouseOut:function(L){var q=this._hoveredTarget;this.fire("mouse:out",{target:q,e:L}),this._hoveredTarget=null,q&&q.fire("mouseout",{e:L});var O=this;this._hoveredTargets.forEach(function(X){O.fire("mouse:out",{target:X,e:L}),X&&X.fire("mouseout",{e:L})}),this._hoveredTargets=[]},_onMouseEnter:function(L){!this._currentTransform&&!this.findTarget(L)&&(this.fire("mouse:over",{target:null,e:L}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(L,q){this.__onOrientationChange&&this.__onOrientationChange(L,q)},_onShake:function(L,q){this.__onShake&&this.__onShake(L,q)},_onLongPress:function(L,q){this.__onLongPress&&this.__onLongPress(L,q)},_onDragOver:function(L){L.preventDefault();var q=this._simpleEventHandler("dragover",L);this._fireEnterLeaveEvents(q,L)},_onDrop:function(L){return this._simpleEventHandler("drop:before",L),this._simpleEventHandler("drop",L)},_onContextMenu:function(L){return this.stopContextMenu&&(L.stopPropagation(),L.preventDefault()),!1},_onDoubleClick:function(L){this._cacheTransformEventData(L),this._handleEvent(L,"dblclick"),this._resetTransformEventData(L)},getPointerId:function(L){var q=L.changedTouches;return q?q[0]&&q[0].identifier:this.enablePointerEvents?L.pointerId:-1},_isMainEvent:function(L){return L.isPrimary===!0?!0:L.isPrimary===!1?!1:L.type==="touchend"&&L.touches.length===0?!0:L.changedTouches?L.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(L){L.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(L)),this.__onMouseDown(L),this._resetTransformEventData();var q=this.upperCanvasEl,O=this._getEventPrefix();M(p.document,"touchend",this._onTouchEnd,S),M(p.document,"touchmove",this._onMouseMove,S),E(q,O+"down",this._onMouseDown)},_onMouseDown:function(L){this.__onMouseDown(L),this._resetTransformEventData();var q=this.upperCanvasEl,O=this._getEventPrefix();E(q,O+"move",this._onMouseMove,S),M(p.document,O+"up",this._onMouseUp),M(p.document,O+"move",this._onMouseMove,S)},_onTouchEnd:function(L){if(!(L.touches.length>0)){this.__onMouseUp(L),this._resetTransformEventData(),this.mainTouchId=null;var q=this._getEventPrefix();E(p.document,"touchend",this._onTouchEnd,S),E(p.document,"touchmove",this._onMouseMove,S);var O=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){M(O.upperCanvasEl,q+"down",O._onMouseDown),O._willAddMouseDown=0},400)}},_onMouseUp:function(L){this.__onMouseUp(L),this._resetTransformEventData();var q=this.upperCanvasEl,O=this._getEventPrefix();this._isMainEvent(L)&&(E(p.document,O+"up",this._onMouseUp),E(p.document,O+"move",this._onMouseMove,S),M(q,O+"move",this._onMouseMove,S))},_onMouseMove:function(L){!this.allowTouchScrolling&&L.preventDefault&&L.preventDefault(),this.__onMouseMove(L)},_onResize:function(){this.calcOffset()},_shouldRender:function(L){var q=this._activeObject;return!!q!=!!L||q&&L&&q!==L?!0:(q&&q.isEditing,!1)},__onMouseUp:function(L){var q,O=this._currentTransform,X=this._groupSelector,V=!1,Y=!X||X.left===0&&X.top===0;if(this._cacheTransformEventData(L),q=this._target,this._handleEvent(L,"up:before"),l(L,F)){this.fireRightClick&&this._handleEvent(L,"up",F,Y);return}if(l(L,R)){this.fireMiddleClick&&this._handleEvent(L,"up",R,Y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(L);return}if(this._isMainEvent(L)){if(O&&(this._finalizeCurrentTransform(L),V=O.actionPerformed),!Y){var U=q===this._activeObject;this._maybeGroupObjects(L),V||(V=this._shouldRender(q)||!U&&q===this._activeObject)}var Q,te;if(q){if(Q=q._findTargetCorner(this.getPointer(L,!0),p.util.isTouchEvent(L)),q.selectable&&q!==this._activeObject&&q.activeOn==="up")this.setActiveObject(q,L),V=!0;else{var se=q.controls[Q],fe=se&&se.getMouseUpHandler(L,q,se);fe&&(te=this.getPointer(L),fe(L,O,te.x,te.y))}q.isMoving=!1}if(O&&(O.target!==q||O.corner!==Q)){var Se=O.target&&O.target.controls[O.corner],Te=Se&&Se.getMouseUpHandler(L,q,se);te=te||this.getPointer(L),Te&&Te(L,O,te.x,te.y)}this._setCursorFromEvent(L,q),this._handleEvent(L,"up",o,Y),this._groupSelector=null,this._currentTransform=null,q&&(q.__corner=0),V?this.requestRenderAll():Y||this.renderTop()}},_simpleEventHandler:function(L,q){var O=this.findTarget(q),X=this.targets,V={e:q,target:O,subTargets:X};if(this.fire(L,V),O&&O.fire(L,V),!X)return O;for(var Y=0;Y<X.length;Y++)X[Y].fire(L,V);return O},_handleEvent:function(L,q,O,X){var V=this._target,Y=this.targets||[],U={e:L,target:V,subTargets:Y,button:O||o,isClick:X||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};q==="up"&&(U.currentTarget=this.findTarget(L),U.currentSubTargets=this.targets),this.fire("mouse:"+q,U),V&&V.fire("mouse"+q,U);for(var Q=0;Q<Y.length;Q++)Y[Q].fire("mouse"+q,U)},_finalizeCurrentTransform:function(L){var q=this._currentTransform,O=q.target,X={e:L,target:O,transform:q,action:q.action};O._scaling&&(O._scaling=!1),O.setCoords(),(q.actionPerformed||this.stateful&&O.hasStateChanged())&&this._fire("modified",X)},_onMouseDownInDrawingMode:function(L){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(L).requestRenderAll();var q=this.getPointer(L);this.freeDrawingBrush.onMouseDown(q,{e:L,pointer:q}),this._handleEvent(L,"down")},_onMouseMoveInDrawingMode:function(L){if(this._isCurrentlyDrawing){var q=this.getPointer(L);this.freeDrawingBrush.onMouseMove(q,{e:L,pointer:q})}this.setCursor(this.freeDrawingCursor),this._handleEvent(L,"move")},_onMouseUpInDrawingMode:function(L){var q=this.getPointer(L);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:L,pointer:q}),this._handleEvent(L,"up")},__onMouseDown:function(L){this._cacheTransformEventData(L),this._handleEvent(L,"down:before");var q=this._target;if(l(L,F)){this.fireRightClick&&this._handleEvent(L,"down",F);return}if(l(L,R)){this.fireMiddleClick&&this._handleEvent(L,"down",R);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(L);return}if(this._isMainEvent(L)&&!this._currentTransform){var O=this._pointer;this._previousPointer=O;var X=this._shouldRender(q),V=this._shouldGroup(L,q);if(this._shouldClearSelection(L,q)?this.discardActiveObject(L):V&&(this._handleGrouping(L,q),q=this._activeObject),this.selection&&(!q||!q.selectable&&!q.isEditing&&q!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),q){var Y=q===this._activeObject;q.selectable&&q.activeOn==="down"&&this.setActiveObject(q,L);var U=q._findTargetCorner(this.getPointer(L,!0),p.util.isTouchEvent(L));if(q.__corner=U,q===this._activeObject&&(U||!V)){this._setupCurrentTransform(L,q,Y);var Q=q.controls[U],O=this.getPointer(L),te=Q&&Q.getMouseDownHandler(L,q,Q);te&&te(L,this._currentTransform,O.x,O.y)}}this._handleEvent(L,"down"),(X||V)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(L){this._resetTransformEventData(),this._pointer=this.getPointer(L,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(L)||null},_beforeTransform:function(L){var q=this._currentTransform;this.stateful&&q.target.saveState(),this.fire("before:transform",{e:L,transform:q})},__onMouseMove:function(L){this._handleEvent(L,"move:before"),this._cacheTransformEventData(L);var q,O;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(L);return}if(this._isMainEvent(L)){var X=this._groupSelector;X?(O=this._absolutePointer,X.left=O.x-X.ex,X.top=O.y-X.ey,this.renderTop()):this._currentTransform?this._transformObject(L):(q=this.findTarget(L)||null,this._setCursorFromEvent(L,q),this._fireOverOutEvents(q,L)),this._handleEvent(L,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(L,q){var O=this._hoveredTarget,X=this._hoveredTargets,V=this.targets,Y=Math.max(X.length,V.length);this.fireSyntheticInOutEvents(L,q,{oldTarget:O,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var U=0;U<Y;U++)this.fireSyntheticInOutEvents(V[U],q,{oldTarget:X[U],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=L,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(L,q){var O=this._draggedoverTarget,X=this._hoveredTargets,V=this.targets,Y=Math.max(X.length,V.length);this.fireSyntheticInOutEvents(L,q,{oldTarget:O,evtOut:"dragleave",evtIn:"dragenter"});for(var U=0;U<Y;U++)this.fireSyntheticInOutEvents(V[U],q,{oldTarget:X[U],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=L},fireSyntheticInOutEvents:function(L,q,O){var X,V,Y=O.oldTarget,U,Q,te=Y!==L,se=O.canvasEvtIn,fe=O.canvasEvtOut;te&&(X={e:q,target:L,previousTarget:Y},V={e:q,target:Y,nextTarget:L}),Q=L&&te,U=Y&&te,U&&(fe&&this.fire(fe,V),Y.fire(O.evtOut,V)),Q&&(se&&this.fire(se,X),L.fire(O.evtIn,X))},__onMouseWheel:function(L){this._cacheTransformEventData(L),this._handleEvent(L,"wheel"),this._resetTransformEventData()},_transformObject:function(L){var q=this.getPointer(L),O=this._currentTransform;O.reset=!1,O.shiftKey=L.shiftKey,O.altKey=L[this.centeredKey],this._performTransformAction(L,O,q),O.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(L,q,O){var X=O.x,V=O.y,Y=q.action,U=!1,Q=q.actionHandler;Q&&(U=Q(L,q,X,V)),Y==="drag"&&U&&(q.target.isMoving=!0,this.setCursor(q.target.moveCursor||this.moveCursor)),q.actionPerformed=q.actionPerformed||U},_fire:p.controlsUtils.fireEvent,_setCursorFromEvent:function(L,q){if(!q)return this.setCursor(this.defaultCursor),!1;var O=q.hoverCursor||this.hoverCursor,X=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,V=(!X||!X.contains(q))&&q._findTargetCorner(this.getPointer(L,!0));V?this.setCursor(this.getCornerCursor(V,q,L)):(q.subTargetCheck&&this.targets.concat().reverse().map(function(Y){O=Y.hoverCursor||O}),this.setCursor(O))},getCornerCursor:function(L,q,O){var X=q.controls[L];return X.cursorStyleHandler(O,X,q)}})}(),function(){var M=Math.min,E=Math.max;p.util.object.extend(p.Canvas.prototype,{_shouldGroup:function(F,R){var o=this._activeObject;return o&&this._isSelectionKeyPressed(F)&&R&&R.selectable&&this.selection&&(o!==R||o.type==="activeSelection")&&!R.onSelect({e:F})},_handleGrouping:function(F,R){var o=this._activeObject;o.__corner||R===o&&(R=this.findTarget(F,!0),!R||!R.selectable)||(o&&o.type==="activeSelection"?this._updateActiveSelection(R,F):this._createActiveSelection(R,F))},_updateActiveSelection:function(F,R){var o=this._activeObject,S=o._objects.slice(0);o.contains(F)?(o.removeWithUpdate(F),this._hoveredTarget=F,this._hoveredTargets=this.targets.concat(),o.size()===1&&this._setActiveObject(o.item(0),R)):(o.addWithUpdate(F),this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(S,R)},_createActiveSelection:function(F,R){var o=this.getActiveObjects(),S=this._createGroup(F);this._hoveredTarget=S,this._setActiveObject(S,R),this._fireSelectionEvents(o,R)},_createGroup:function(F){var R=this._objects,o=R.indexOf(this._activeObject)<R.indexOf(F),S=o?[this._activeObject,F]:[F,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new p.ActiveSelection(S,{canvas:this})},_groupSelectedObjects:function(F){var R=this._collectObjects(F),o;R.length===1?this.setActiveObject(R[0],F):R.length>1&&(o=new p.ActiveSelection(R.reverse(),{canvas:this}),this.setActiveObject(o,F))},_collectObjects:function(F){for(var R=[],o,S=this._groupSelector.ex,l=this._groupSelector.ey,L=S+this._groupSelector.left,q=l+this._groupSelector.top,O=new p.Point(M(S,L),M(l,q)),X=new p.Point(E(S,L),E(l,q)),V=!this.selectionFullyContained,Y=S===L&&l===q,U=this._objects.length;U--&&(o=this._objects[U],!(!(!o||!o.selectable||!o.visible)&&(V&&o.intersectsWithRect(O,X,!0)||o.isContainedWithinRect(O,X,!0)||V&&o.containsPoint(O,null,!0)||V&&o.containsPoint(X,null,!0))&&(R.push(o),Y))););return R.length>1&&(R=R.filter(function(Q){return!Q.onSelect({e:F})})),R},_maybeGroupObjects:function(F){this.selection&&this._groupSelector&&this._groupSelectedObjects(F),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){p.util.object.extend(p.StaticCanvas.prototype,{toDataURL:function(M){M||(M={});var E=M.format||"png",F=M.quality||1,R=(M.multiplier||1)*(M.enableRetinaScaling?this.getRetinaScaling():1),o=this.toCanvasElement(R,M);return p.util.toDataURL(o,E,F)},toCanvasElement:function(M,E){M=M||1,E=E||{};var F=(E.width||this.width)*M,R=(E.height||this.height)*M,o=this.getZoom(),S=this.width,l=this.height,L=o*M,q=this.viewportTransform,O=(q[4]-(E.left||0))*M,X=(q[5]-(E.top||0))*M,V=this.interactive,Y=[L,0,0,L,O,X],U=this.enableRetinaScaling,Q=p.util.createCanvasElement(),te=this.contextTop;return Q.width=F,Q.height=R,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=Y,this.width=F,this.height=R,this.calcViewportBoundaries(),this.renderCanvas(Q.getContext("2d"),this._objects),this.viewportTransform=q,this.width=S,this.height=l,this.calcViewportBoundaries(),this.interactive=V,this.enableRetinaScaling=U,this.contextTop=te,Q}})}(),p.util.object.extend(p.StaticCanvas.prototype,{loadFromJSON:function(M,E,F){if(M){var R=typeof M=="string"?JSON.parse(M):p.util.object.clone(M),o=this,S=R.clipPath,l=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete R.clipPath,this._enlivenObjects(R.objects,function(L){o.clear(),o._setBgOverlay(R,function(){S?o._enlivenObjects([S],function(q){o.clipPath=q[0],o.__setupCanvas.call(o,R,L,l,E)}):o.__setupCanvas.call(o,R,L,l,E)})},F),this}},__setupCanvas:function(M,E,F,R){var o=this;E.forEach(function(S,l){o.insertAt(S,l)}),this.renderOnAddRemove=F,delete M.objects,delete M.backgroundImage,delete M.overlayImage,delete M.background,delete M.overlay,this._setOptions(M),this.renderAll(),R&&R()},_setBgOverlay:function(M,E){var F={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!M.backgroundImage&&!M.overlayImage&&!M.background&&!M.overlay){E&&E();return}var R=function(){F.backgroundImage&&F.overlayImage&&F.backgroundColor&&F.overlayColor&&E&&E()};this.__setBgOverlay("backgroundImage",M.backgroundImage,F,R),this.__setBgOverlay("overlayImage",M.overlayImage,F,R),this.__setBgOverlay("backgroundColor",M.background,F,R),this.__setBgOverlay("overlayColor",M.overlay,F,R)},__setBgOverlay:function(M,E,F,R){var o=this;if(!E){F[M]=!0,R&&R();return}M==="backgroundImage"||M==="overlayImage"?p.util.enlivenObjects([E],function(S){o[M]=S[0],F[M]=!0,R&&R()}):this["set"+p.util.string.capitalize(M,!0)](E,function(){F[M]=!0,R&&R()})},_enlivenObjects:function(M,E,F){if(!M||M.length===0){E&&E([]);return}p.util.enlivenObjects(M,function(R){E&&E(R)},null,F)},_toDataURL:function(M,E){this.clone(function(F){E(F.toDataURL(M))})},_toDataURLWithMultiplier:function(M,E,F){this.clone(function(R){F(R.toDataURLWithMultiplier(M,E))})},clone:function(M,E){var F=JSON.stringify(this.toJSON(E));this.cloneWithoutData(function(R){R.loadFromJSON(F,function(){M&&M(R)})})},cloneWithoutData:function(M){var E=p.util.createCanvasElement();E.width=this.width,E.height=this.height;var F=new p.Canvas(E);this.backgroundImage?(F.setBackgroundImage(this.backgroundImage.src,function(){F.renderAll(),M&&M(F)}),F.backgroundImageOpacity=this.backgroundImageOpacity,F.backgroundImageStretch=this.backgroundImageStretch):M&&M(F)}}),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.util.object.clone,o=E.util.toFixed,S=E.util.string.capitalize,l=E.util.degreesToRadians,L=!E.isLikelyNode,q=2;E.Object||(E.Object=E.util.createClass(E.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:L,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(O){O&&this.setOptions(O)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=E.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(O){var X=E.perfLimitSizeTotal,V=O.width,Y=O.height,U=E.maxCacheSideLimit,Q=E.minCacheSideLimit;if(V<=U&&Y<=U&&V*Y<=X)return V<Q&&(O.width=Q),Y<Q&&(O.height=Q),O;var te=V/Y,se=E.util.limitDimsByArea(te,X),fe=E.util.capValue,Se=fe(Q,se.x,U),Te=fe(Q,se.y,U);return V>Se&&(O.zoomX/=V/Se,O.width=Se,O.capped=!0),Y>Te&&(O.zoomY/=Y/Te,O.height=Te,O.capped=!0),O},_getCacheCanvasDimensions:function(){var O=this.getTotalObjectScaling(),X=this._getTransformedDimensions(0,0),V=X.x*O.scaleX/this.scaleX,Y=X.y*O.scaleY/this.scaleY;return{width:V+q,height:Y+q,zoomX:O.scaleX,zoomY:O.scaleY,x:V,y:Y}},_updateCacheCanvas:function(){var O=this.canvas;if(this.noScaleCache&&O&&O._currentTransform){var X=O._currentTransform.target,V=O._currentTransform.action;if(this===X&&V.slice&&V.slice(0,5)==="scale")return!1}var Y=this._cacheCanvas,U=this._limitCacheSize(this._getCacheCanvasDimensions()),Q=E.minCacheSideLimit,te=U.width,se=U.height,fe,Se,Te=U.zoomX,Re=U.zoomY,je=te!==this.cacheWidth||se!==this.cacheHeight,He=this.zoomX!==Te||this.zoomY!==Re,ve=je||He,_e=0,qe=0,Xe=!1;if(je){var Ge=this._cacheCanvas.width,re=this._cacheCanvas.height,ce=te>Ge||se>re,ue=(te<Ge*.9||se<re*.9)&&Ge>Q&&re>Q;Xe=ce||ue,ce&&!U.capped&&(te>Q||se>Q)&&(_e=te*.1,qe=se*.1)}return this instanceof E.Text&&this.path&&(ve=!0,Xe=!0,_e+=this.getHeightOfLine(0)*this.zoomX,qe+=this.getHeightOfLine(0)*this.zoomY),ve?(Xe?(Y.width=Math.ceil(te+_e),Y.height=Math.ceil(se+qe)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,Y.width,Y.height)),fe=U.x/2,Se=U.y/2,this.cacheTranslationX=Math.round(Y.width/2-fe)+fe,this.cacheTranslationY=Math.round(Y.height/2-Se)+Se,this.cacheWidth=te,this.cacheHeight=se,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(Te,Re),this.zoomX=Te,this.zoomY=Re,!0):!1},setOptions:function(O){this._setOptions(O),this._initGradient(O.fill,"fill"),this._initGradient(O.stroke,"stroke"),this._initPattern(O.fill,"fill"),this._initPattern(O.stroke,"stroke")},transform:function(O){var X=this.group&&!this.group._transformDone||this.group&&this.canvas&&O===this.canvas.contextTop,V=this.calcTransformMatrix(!X);O.transform(V[0],V[1],V[2],V[3],V[4],V[5])},toObject:function(O){var X=E.Object.NUM_FRACTION_DIGITS,V={type:this.type,version:E.version,originX:this.originX,originY:this.originY,left:o(this.left,X),top:o(this.top,X),width:o(this.width,X),height:o(this.height,X),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:o(this.strokeWidth,X),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:o(this.strokeMiterLimit,X),scaleX:o(this.scaleX,X),scaleY:o(this.scaleY,X),angle:o(this.angle,X),flipX:this.flipX,flipY:this.flipY,opacity:o(this.opacity,X),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:o(this.skewX,X),skewY:o(this.skewY,X)};return this.clipPath&&!this.clipPath.excludeFromExport&&(V.clipPath=this.clipPath.toObject(O),V.clipPath.inverted=this.clipPath.inverted,V.clipPath.absolutePositioned=this.clipPath.absolutePositioned),E.util.populateWithProperties(this,V,O),this.includeDefaultValues||(V=this._removeDefaultValues(V)),V},toDatalessObject:function(O){return this.toObject(O)},_removeDefaultValues:function(O){var X=E.util.getKlass(O.type).prototype,V=X.stateProperties;return V.forEach(function(Y){Y==="left"||Y==="top"||(O[Y]===X[Y]&&delete O[Y],Array.isArray(O[Y])&&Array.isArray(X[Y])&&O[Y].length===0&&X[Y].length===0&&delete O[Y])}),O},toString:function(){return"#<fabric."+S(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var O=E.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(O.scaleX),scaleY:Math.abs(O.scaleY)}},getTotalObjectScaling:function(){var O=this.getObjectScaling(),X=O.scaleX,V=O.scaleY;if(this.canvas){var Y=this.canvas.getZoom(),U=this.canvas.getRetinaScaling();X*=Y*U,V*=Y*U}return{scaleX:X,scaleY:V}},getObjectOpacity:function(){var O=this.opacity;return this.group&&(O*=this.group.getObjectOpacity()),O},_set:function(O,X){var V=O==="scaleX"||O==="scaleY",Y=this[O]!==X,U=!1;return V&&(X=this._constrainScale(X)),O==="scaleX"&&X<0?(this.flipX=!this.flipX,X*=-1):O==="scaleY"&&X<0?(this.flipY=!this.flipY,X*=-1):O==="shadow"&&X&&!(X instanceof E.Shadow)?X=new E.Shadow(X):O==="dirty"&&this.group&&this.group.set("dirty",X),this[O]=X,Y&&(U=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(O)>-1?(this.dirty=!0,U&&this.group.set("dirty",!0)):U&&this.stateProperties.indexOf(O)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:E.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(O){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(O.save(),this._setupCompositeOperation(O),this.drawSelectionBackground(O),this.transform(O),this._setOpacity(O),this._setShadow(O,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(O)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(O),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),O.restore())},renderCache:function(O){O=O||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,O.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(O,X){if(O.save(),X.inverted?O.globalCompositeOperation="destination-out":O.globalCompositeOperation="destination-in",X.absolutePositioned){var V=E.util.invertTransform(this.calcTransformMatrix());O.transform(V[0],V[1],V[2],V[3],V[4],V[5])}X.transform(O),O.scale(1/X.zoomX,1/X.zoomY),O.drawImage(X._cacheCanvas,-X.cacheTranslationX,-X.cacheTranslationY),O.restore()},drawObject:function(O,X){var V=this.fill,Y=this.stroke;X?(this.fill="black",this.stroke="",this._setClippingProperties(O)):this._renderBackground(O),this._render(O),this._drawClipPath(O,this.clipPath),this.fill=V,this.stroke=Y},_drawClipPath:function(O,X){X&&(X.canvas=this.canvas,X.shouldCache(),X._transformDone=!0,X.renderCache({forClipping:!0}),this.drawClipPathOnCache(O,X))},drawCacheOnCanvas:function(O){O.scale(1/this.zoomX,1/this.zoomY),O.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(O){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!O&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!O){var X=this.cacheWidth/this.zoomX,V=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-X/2,-V/2,X,V)}return!0}return!1},_renderBackground:function(O){if(this.backgroundColor){var X=this._getNonTransformedDimensions();O.fillStyle=this.backgroundColor,O.fillRect(-X.x/2,-X.y/2,X.x,X.y),this._removeShadow(O)}},_setOpacity:function(O){this.group&&!this.group._transformDone?O.globalAlpha=this.getObjectOpacity():O.globalAlpha*=this.opacity},_setStrokeStyles:function(O,X){var V=X.stroke;V&&(O.lineWidth=X.strokeWidth,O.lineCap=X.strokeLineCap,O.lineDashOffset=X.strokeDashOffset,O.lineJoin=X.strokeLineJoin,O.miterLimit=X.strokeMiterLimit,V.toLive?V.gradientUnits==="percentage"||V.gradientTransform||V.patternTransform?this._applyPatternForTransformedGradient(O,V):(O.strokeStyle=V.toLive(O,this),this._applyPatternGradientTransform(O,V)):O.strokeStyle=X.stroke)},_setFillStyles:function(O,X){var V=X.fill;V&&(V.toLive?(O.fillStyle=V.toLive(O,this),this._applyPatternGradientTransform(O,X.fill)):O.fillStyle=V)},_setClippingProperties:function(O){O.globalAlpha=1,O.strokeStyle="transparent",O.fillStyle="#000000"},_setLineDash:function(O,X){!X||X.length===0||(1&X.length&&X.push.apply(X,X),O.setLineDash(X))},_renderControls:function(O,X){var V=this.getViewportTransform(),Y=this.calcTransformMatrix(),U,Q,te;X=X||{},Q=typeof X.hasBorders<"u"?X.hasBorders:this.hasBorders,te=typeof X.hasControls<"u"?X.hasControls:this.hasControls,Y=E.util.multiplyTransformMatrices(V,Y),U=E.util.qrDecompose(Y),O.save(),O.translate(U.translateX,U.translateY),O.lineWidth=1*this.borderScaleFactor,this.group||(O.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(U.angle-=180),O.rotate(l(this.group?U.angle:this.angle)),X.forActiveSelection||this.group?Q&&this.drawBordersInGroup(O,U,X):Q&&this.drawBorders(O,X),te&&this.drawControls(O,X),O.restore()},_setShadow:function(O){if(this.shadow){var X=this.shadow,V=this.canvas,Y,U=V&&V.viewportTransform[0]||1,Q=V&&V.viewportTransform[3]||1;X.nonScaling?Y={scaleX:1,scaleY:1}:Y=this.getObjectScaling(),V&&V._isRetinaScaling()&&(U*=E.devicePixelRatio,Q*=E.devicePixelRatio),O.shadowColor=X.color,O.shadowBlur=X.blur*E.browserShadowBlurConstant*(U+Q)*(Y.scaleX+Y.scaleY)/4,O.shadowOffsetX=X.offsetX*U*Y.scaleX,O.shadowOffsetY=X.offsetY*Q*Y.scaleY}},_removeShadow:function(O){this.shadow&&(O.shadowColor="",O.shadowBlur=O.shadowOffsetX=O.shadowOffsetY=0)},_applyPatternGradientTransform:function(O,X){if(!X||!X.toLive)return{offsetX:0,offsetY:0};var V=X.gradientTransform||X.patternTransform,Y=-this.width/2+X.offsetX||0,U=-this.height/2+X.offsetY||0;return X.gradientUnits==="percentage"?O.transform(this.width,0,0,this.height,Y,U):O.transform(1,0,0,1,Y,U),V&&O.transform(V[0],V[1],V[2],V[3],V[4],V[5]),{offsetX:Y,offsetY:U}},_renderPaintInOrder:function(O){this.paintFirst==="stroke"?(this._renderStroke(O),this._renderFill(O)):(this._renderFill(O),this._renderStroke(O))},_render:function(){},_renderFill:function(O){this.fill&&(O.save(),this._setFillStyles(O,this),this.fillRule==="evenodd"?O.fill("evenodd"):O.fill(),O.restore())},_renderStroke:function(O){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(O),O.save(),this.strokeUniform&&this.group){var X=this.getObjectScaling();O.scale(1/X.scaleX,1/X.scaleY)}else this.strokeUniform&&O.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(O,this.strokeDashArray),this._setStrokeStyles(O,this),O.stroke(),O.restore()}},_applyPatternForTransformedGradient:function(O,X){var V=this._limitCacheSize(this._getCacheCanvasDimensions()),Y=E.util.createCanvasElement(),U,Q=this.canvas.getRetinaScaling(),te=V.x/this.scaleX/Q,se=V.y/this.scaleY/Q;Y.width=Math.ceil(te),Y.height=Math.ceil(se),U=Y.getContext("2d"),U.beginPath(),U.moveTo(0,0),U.lineTo(te,0),U.lineTo(te,se),U.lineTo(0,se),U.closePath(),U.translate(te/2,se/2),U.scale(V.zoomX/this.scaleX/Q,V.zoomY/this.scaleY/Q),this._applyPatternGradientTransform(U,X),U.fillStyle=X.toLive(O),U.fill(),O.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),O.scale(Q*this.scaleX/V.zoomX,Q*this.scaleY/V.zoomY),O.strokeStyle=U.createPattern(Y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var O=E.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",O.scaleX),this.set("scaleY",O.scaleY),this.angle=O.angle,this.skewX=O.skewX,this.skewY=0}},_removeTransformMatrix:function(O){var X=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),X=E.util.transformPoint(X,this.transformMatrix)),this.transformMatrix=null,O&&(this.scaleX*=O.scaleX,this.scaleY*=O.scaleY,this.cropX=O.cropX,this.cropY=O.cropY,X.x+=O.offsetLeft,X.y+=O.offsetTop,this.width=O.width,this.height=O.height),this.setPositionByOrigin(X,"center","center")},clone:function(O,X){var V=this.toObject(X);this.constructor.fromObject?this.constructor.fromObject(V,O):E.Object._fromObject("Object",V,O)},cloneAsImage:function(O,X){var V=this.toCanvasElement(X);return O&&O(new E.Image(V)),this},toCanvasElement:function(O){O||(O={});var X=E.util,V=X.saveObjectTransform(this),Y=this.group,U=this.shadow,Q=Math.abs,te=(O.multiplier||1)*(O.enableRetinaScaling?E.devicePixelRatio:1);delete this.group,O.withoutTransform&&X.resetObjectTransform(this),O.withoutShadow&&(this.shadow=null);var se=E.util.createCanvasElement(),fe=this.getBoundingRect(!0,!0),Se=this.shadow,Te,Re={x:0,y:0},je,He,ve;Se&&(je=Se.blur,Se.nonScaling?Te={scaleX:1,scaleY:1}:Te=this.getObjectScaling(),Re.x=2*Math.round(Q(Se.offsetX)+je)*Q(Te.scaleX),Re.y=2*Math.round(Q(Se.offsetY)+je)*Q(Te.scaleY)),He=fe.width+Re.x,ve=fe.height+Re.y,se.width=Math.ceil(He),se.height=Math.ceil(ve);var _e=new E.StaticCanvas(se,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});O.format==="jpeg"&&(_e.backgroundColor="#fff"),this.setPositionByOrigin(new E.Point(_e.width/2,_e.height/2),"center","center");var qe=this.canvas;_e.add(this);var Xe=_e.toCanvasElement(te||1,O);return this.shadow=U,this.set("canvas",qe),Y&&(this.group=Y),this.set(V).setCoords(),_e._objects=[],_e.dispose(),_e=null,Xe},toDataURL:function(O){return O||(O={}),E.util.toDataURL(this.toCanvasElement(O),O.format||"png",O.quality||1)},isType:function(O){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===O},complexity:function(){return 1},toJSON:function(O){return this.toObject(O)},rotate:function(O){var X=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return X&&this._setOriginToCenter(),this.set("angle",O),X&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(O,X){X=X||this.canvas.getPointer(O);var V=new E.Point(X.x,X.y),Y=this._getLeftTopCoords();return this.angle&&(V=E.util.rotatePoint(V,Y,l(-this.angle))),{x:V.x-Y.x,y:V.y-Y.y}},_setupCompositeOperation:function(O){this.globalCompositeOperation&&(O.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){E.runningAnimations&&E.runningAnimations.cancelByTarget(this)}}),E.util.createAccessors&&E.util.createAccessors(E.Object),F(E.Object.prototype,E.Observable),E.Object.NUM_FRACTION_DIGITS=2,E.Object.ENLIVEN_PROPS=["clipPath"],E.Object._fromObject=function(O,X,V,Y){var U=E[O];X=R(X,!0),E.util.enlivenPatterns([X.fill,X.stroke],function(Q){typeof Q[0]<"u"&&(X.fill=Q[0]),typeof Q[1]<"u"&&(X.stroke=Q[1]),E.util.enlivenObjectEnlivables(X,X,function(){var te=Y?new U(X[Y],X):new U(X);V&&V(te)})})},E.Object.__uid=0)}(B),function(){var M=p.util.degreesToRadians,E={left:-.5,center:0,right:.5},F={top:-.5,center:0,bottom:.5};p.util.object.extend(p.Object.prototype,{translateToGivenOrigin:function(R,o,S,l,L){var q=R.x,O=R.y,X,V,Y;return typeof o=="string"?o=E[o]:o-=.5,typeof l=="string"?l=E[l]:l-=.5,X=l-o,typeof S=="string"?S=F[S]:S-=.5,typeof L=="string"?L=F[L]:L-=.5,V=L-S,(X||V)&&(Y=this._getTransformedDimensions(),q=R.x+X*Y.x,O=R.y+V*Y.y),new p.Point(q,O)},translateToCenterPoint:function(R,o,S){var l=this.translateToGivenOrigin(R,o,S,"center","center");return this.angle?p.util.rotatePoint(l,R,M(this.angle)):l},translateToOriginPoint:function(R,o,S){var l=this.translateToGivenOrigin(R,"center","center",o,S);return this.angle?p.util.rotatePoint(l,R,M(this.angle)):l},getCenterPoint:function(){var R=new p.Point(this.left,this.top);return this.translateToCenterPoint(R,this.originX,this.originY)},getPointByOrigin:function(R,o){var S=this.getCenterPoint();return this.translateToOriginPoint(S,R,o)},toLocalPoint:function(R,o,S){var l=this.getCenterPoint(),L,q;return typeof o<"u"&&typeof S<"u"?L=this.translateToGivenOrigin(l,"center","center",o,S):L=new p.Point(this.left,this.top),q=new p.Point(R.x,R.y),this.angle&&(q=p.util.rotatePoint(q,l,-M(this.angle))),q.subtractEquals(L)},setPositionByOrigin:function(R,o,S){var l=this.translateToCenterPoint(R,o,S),L=this.translateToOriginPoint(l,this.originX,this.originY);this.set("left",L.x),this.set("top",L.y)},adjustPosition:function(R){var o=M(this.angle),S=this.getScaledWidth(),l=p.util.cos(o)*S,L=p.util.sin(o)*S,q,O;typeof this.originX=="string"?q=E[this.originX]:q=this.originX-.5,typeof R=="string"?O=E[R]:O=R-.5,this.left+=l*(O-q),this.top+=L*(O-q),this.setCoords(),this.originX=R},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var R=this.getCenterPoint();this.originX="center",this.originY="center",this.left=R.x,this.top=R.y},_resetOrigin:function(){var R=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=R.x,this.top=R.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function M(S){return[new p.Point(S.tl.x,S.tl.y),new p.Point(S.tr.x,S.tr.y),new p.Point(S.br.x,S.br.y),new p.Point(S.bl.x,S.bl.y)]}var E=p.util,F=E.degreesToRadians,R=E.multiplyTransformMatrices,o=E.transformPoint;E.object.extend(p.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(S,l){return l?S?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),S?this.aCoords:this.lineCoords)},getCoords:function(S,l){return M(this._getCoords(S,l))},intersectsWithRect:function(S,l,L,q){var O=this.getCoords(L,q),X=p.Intersection.intersectPolygonRectangle(O,S,l);return X.status==="Intersection"},intersectsWithObject:function(S,l,L){var q=p.Intersection.intersectPolygonPolygon(this.getCoords(l,L),S.getCoords(l,L));return q.status==="Intersection"||S.isContainedWithinObject(this,l,L)||this.isContainedWithinObject(S,l,L)},isContainedWithinObject:function(S,l,L){for(var q=this.getCoords(l,L),O=l?S.aCoords:S.lineCoords,X=0,V=S._getImageLines(O);X<4;X++)if(!S.containsPoint(q[X],V))return!1;return!0},isContainedWithinRect:function(S,l,L,q){var O=this.getBoundingRect(L,q);return O.left>=S.x&&O.left+O.width<=l.x&&O.top>=S.y&&O.top+O.height<=l.y},containsPoint:function(S,X,L,q){var O=this._getCoords(L,q),X=X||this._getImageLines(O),V=this._findCrossPoints(S,X);return V!==0&&V%2===1},isOnScreen:function(S){if(!this.canvas)return!1;var l=this.canvas.vptCoords.tl,L=this.canvas.vptCoords.br,q=this.getCoords(!0,S);return q.some(function(O){return O.x<=L.x&&O.x>=l.x&&O.y<=L.y&&O.y>=l.y})||this.intersectsWithRect(l,L,!0,S)?!0:this._containsCenterOfCanvas(l,L,S)},_containsCenterOfCanvas:function(S,l,L){var q={x:(S.x+l.x)/2,y:(S.y+l.y)/2};return!!this.containsPoint(q,null,!0,L)},isPartiallyOnScreen:function(S){if(!this.canvas)return!1;var l=this.canvas.vptCoords.tl,L=this.canvas.vptCoords.br;if(this.intersectsWithRect(l,L,!0,S))return!0;var q=this.getCoords(!0,S).every(function(O){return(O.x>=L.x||O.x<=l.x)&&(O.y>=L.y||O.y<=l.y)});return q&&this._containsCenterOfCanvas(l,L,S)},_getImageLines:function(S){var l={topline:{o:S.tl,d:S.tr},rightline:{o:S.tr,d:S.br},bottomline:{o:S.br,d:S.bl},leftline:{o:S.bl,d:S.tl}};return l},_findCrossPoints:function(S,l){var L,q,O,X,V,Y=0,U;for(var Q in l)if(U=l[Q],!(U.o.y<S.y&&U.d.y<S.y)&&!(U.o.y>=S.y&&U.d.y>=S.y)&&(U.o.x===U.d.x&&U.o.x>=S.x?V=U.o.x:(L=0,q=(U.d.y-U.o.y)/(U.d.x-U.o.x),O=S.y-L*S.x,X=U.o.y-q*U.o.x,V=-(O-X)/(L-q)),V>=S.x&&(Y+=1),Y===2))break;return Y},getBoundingRect:function(S,l){var L=this.getCoords(S,l);return E.makeBoundingBoxFromPoints(L)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(S){return Math.abs(S)<this.minScaleLimit?S<0?-this.minScaleLimit:this.minScaleLimit:S===0?1e-4:S},scale:function(S){return this._set("scaleX",S),this._set("scaleY",S),this.setCoords()},scaleToWidth:function(S,l){var L=this.getBoundingRect(l).width/this.getScaledWidth();return this.scale(S/this.width/L)},scaleToHeight:function(S,l){var L=this.getBoundingRect(l).height/this.getScaledHeight();return this.scale(S/this.height/L)},calcLineCoords:function(){var S=this.getViewportTransform(),l=this.padding,L=F(this.angle),q=E.cos(L),O=E.sin(L),X=q*l,V=O*l,Y=X+V,U=X-V,Q=this.calcACoords(),te={tl:o(Q.tl,S),tr:o(Q.tr,S),bl:o(Q.bl,S),br:o(Q.br,S)};return l&&(te.tl.x-=U,te.tl.y-=Y,te.tr.x+=Y,te.tr.y-=U,te.bl.x-=Y,te.bl.y+=U,te.br.x+=U,te.br.y+=Y),te},calcOCoords:function(){var S=this._calcRotateMatrix(),l=this._calcTranslateMatrix(),L=this.getViewportTransform(),q=R(L,l),O=R(q,S),O=R(O,[1/L[0],0,0,1/L[3],0,0]),X=this._calculateCurrentDimensions(),V={};return this.forEachControl(function(Y,U,Q){V[U]=Y.positionHandler(X,O,Q)}),V},calcACoords:function(){var S=this._calcRotateMatrix(),l=this._calcTranslateMatrix(),L=R(l,S),q=this._getTransformedDimensions(),O=q.x/2,X=q.y/2;return{tl:o({x:-O,y:-X},L),tr:o({x:O,y:-X},L),bl:o({x:-O,y:X},L),br:o({x:O,y:X},L)}},setCoords:function(S){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),S?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return E.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var S=this.getCenterPoint();return[1,0,0,1,S.x,S.y]},transformMatrixKey:function(S){var l="_",L="";return!S&&this.group&&(L=this.group.transformMatrixKey(S)+l),L+this.top+l+this.left+l+this.scaleX+l+this.scaleY+l+this.skewX+l+this.skewY+l+this.angle+l+this.originX+l+this.originY+l+this.width+l+this.height+l+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(S){var l=this.calcOwnMatrix();if(S||!this.group)return l;var L=this.transformMatrixKey(S),q=this.matrixCache||(this.matrixCache={});return q.key===L?q.value:(this.group&&(l=R(this.group.calcTransformMatrix(!1),l)),q.key=L,q.value=l,l)},calcOwnMatrix:function(){var S=this.transformMatrixKey(!0),l=this.ownMatrixCache||(this.ownMatrixCache={});if(l.key===S)return l.value;var L=this._calcTranslateMatrix(),q={angle:this.angle,translateX:L[4],translateY:L[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return l.key=S,l.value=E.composeMatrix(q),l.value},_getNonTransformedDimensions:function(){var S=this.strokeWidth,l=this.width+S,L=this.height+S;return{x:l,y:L}},_getTransformedDimensions:function(S,l){typeof S>"u"&&(S=this.skewX),typeof l>"u"&&(l=this.skewY);var L,q,O,X=S===0&&l===0;if(this.strokeUniform?(q=this.width,O=this.height):(L=this._getNonTransformedDimensions(),q=L.x,O=L.y),X)return this._finalizeDimensions(q*this.scaleX,O*this.scaleY);var V=E.sizeAfterTransform(q,O,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:S,skewY:l});return this._finalizeDimensions(V.x,V.y)},_finalizeDimensions:function(S,l){return this.strokeUniform?{x:S+this.strokeWidth,y:l+this.strokeWidth}:{x:S,y:l}},_calculateCurrentDimensions:function(){var S=this.getViewportTransform(),l=this._getTransformedDimensions(),L=o(l,S,!0);return L.scalarAdd(2*this.padding)}})}(),p.util.object.extend(p.Object.prototype,{sendToBack:function(){return this.group?p.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?p.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(M){return this.group?p.StaticCanvas.prototype.sendBackwards.call(this.group,this,M):this.canvas&&this.canvas.sendBackwards(this,M),this},bringForward:function(M){return this.group?p.StaticCanvas.prototype.bringForward.call(this.group,this,M):this.canvas&&this.canvas.bringForward(this,M),this},moveTo:function(M){return this.group&&this.group.type!=="activeSelection"?p.StaticCanvas.prototype.moveTo.call(this.group,this,M):this.canvas&&this.canvas.moveTo(this,M),this}}),function(){function M(F,R){if(R){if(R.toLive)return F+": url(#SVGID_"+R.id+"); ";var o=new p.Color(R),S=F+": "+o.toRgb()+"; ",l=o.getAlpha();return l!==1&&(S+=F+"-opacity: "+l.toString()+"; "),S}else return F+": none; "}var E=p.util.toFixed;p.util.object.extend(p.Object.prototype,{getSvgStyles:function(F){var R=this.fillRule?this.fillRule:"nonzero",o=this.strokeWidth?this.strokeWidth:"0",S=this.strokeDashArray?this.strokeDashArray.join(" "):"none",l=this.strokeDashOffset?this.strokeDashOffset:"0",L=this.strokeLineCap?this.strokeLineCap:"butt",q=this.strokeLineJoin?this.strokeLineJoin:"miter",O=this.strokeMiterLimit?this.strokeMiterLimit:"4",X=typeof this.opacity<"u"?this.opacity:"1",V=this.visible?"":" visibility: hidden;",Y=F?"":this.getSvgFilter(),U=M("fill",this.fill),Q=M("stroke",this.stroke);return[Q,"stroke-width: ",o,"; ","stroke-dasharray: ",S,"; ","stroke-linecap: ",L,"; ","stroke-dashoffset: ",l,"; ","stroke-linejoin: ",q,"; ","stroke-miterlimit: ",O,"; ",U,"fill-rule: ",R,"; ","opacity: ",X,";",Y,V].join("")},getSvgSpanStyles:function(F,R){var o="; ",l=F.fontFamily?"font-family: "+(F.fontFamily.indexOf("'")===-1&&F.fontFamily.indexOf('"')===-1?"'"+F.fontFamily+"'":F.fontFamily)+o:"",S=F.strokeWidth?"stroke-width: "+F.strokeWidth+o:"",l=l,L=F.fontSize?"font-size: "+F.fontSize+"px"+o:"",q=F.fontStyle?"font-style: "+F.fontStyle+o:"",O=F.fontWeight?"font-weight: "+F.fontWeight+o:"",X=F.fill?M("fill",F.fill):"",V=F.stroke?M("stroke",F.stroke):"",Y=this.getSvgTextDecoration(F),U=F.deltaY?"baseline-shift: "+-F.deltaY+"; ":"";return Y&&(Y="text-decoration: "+Y+o),[V,S,l,L,q,O,Y,X,U,R?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(F){return["overline","underline","line-through"].filter(function(R){return F[R.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(F,R){var o=F?this.calcTransformMatrix():this.calcOwnMatrix(),S='transform="'+p.util.matrixToSVG(o);return S+(R||"")+'" '},_setSVGBg:function(F){if(this.backgroundColor){var R=p.Object.NUM_FRACTION_DIGITS;F.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',E(-this.width/2,R),'" y="',E(-this.height/2,R),'" width="',E(this.width,R),'" height="',E(this.height,R),`"></rect>
`)}},toSVG:function(F){return this._createBaseSVGMarkup(this._toSVG(F),{reviver:F})},toClipPathSVG:function(F){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(F),{reviver:F})},_createBaseClipPathSVGMarkup:function(F,R){R=R||{};var o=R.reviver,S=R.additionalTransform||"",l=[this.getSvgTransform(!0,S),this.getSvgCommons()].join(""),L=F.indexOf("COMMON_PARTS");return F[L]=l,o?o(F.join("")):F.join("")},_createBaseSVGMarkup:function(F,R){R=R||{};var o=R.noStyle,S=R.reviver,l=o?"":'style="'+this.getSvgStyles()+'" ',L=R.withShadow?'style="'+this.getSvgFilter()+'" ':"",q=this.clipPath,O=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",X=q&&q.absolutePositioned,V=this.stroke,Y=this.fill,U=this.shadow,Q,te=[],se,fe=F.indexOf("COMMON_PARTS"),Se=R.additionalTransform;return q&&(q.clipPathId="CLIPPATH_"+p.Object.__uid++,se='<clipPath id="'+q.clipPathId+`" >
`+q.toClipPathSVG(S)+`</clipPath>
`),X&&te.push("<g ",L,this.getSvgCommons(),` >
`),te.push("<g ",this.getSvgTransform(!1),X?"":L+this.getSvgCommons(),` >
`),Q=[l,O,o?"":this.addPaintOrder()," ",Se?'transform="'+Se+'" ':""].join(""),F[fe]=Q,Y&&Y.toLive&&te.push(Y.toSVG(this)),V&&V.toLive&&te.push(V.toSVG(this)),U&&te.push(U.toSVG(this)),q&&te.push(se),te.push(F.join("")),te.push(`</g>
`),X&&te.push(`</g>
`),S?S(te.join("")):te.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var M=p.util.object.extend,E="stateProperties";function F(o,S,l){var L={},q=!0;l.forEach(function(O){L[O]=o[O]}),M(o[S],L,q)}function R(o,S,l){if(o===S)return!0;if(Array.isArray(o)){if(!Array.isArray(S)||o.length!==S.length)return!1;for(var L=0,q=o.length;L<q;L++)if(!R(o[L],S[L]))return!1;return!0}else if(o&&typeof o=="object"){var O=Object.keys(o),X;if(!S||typeof S!="object"||!l&&O.length!==Object.keys(S).length)return!1;for(var L=0,q=O.length;L<q;L++)if(X=O[L],!(X==="canvas"||X==="group")&&!R(o[X],S[X]))return!1;return!0}}p.util.object.extend(p.Object.prototype,{hasStateChanged:function(o){o=o||E;var S="_"+o;return Object.keys(this[S]).length<this[o].length?!0:!R(this[S],this,!0)},saveState:function(o){var S=o&&o.propertySet||E,l="_"+S;return this[l]?(F(this,l,this[S]),o&&o.stateProperties&&F(this,l,o.stateProperties),this):this.setupState(o)},setupState:function(o){o=o||{};var S=o.propertySet||E;return o.propertySet=S,this["_"+S]={},this.saveState(o),this}})}(),function(){var M=p.util.degreesToRadians;p.util.object.extend(p.Object.prototype,{_findTargetCorner:function(E,F){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var R=E.x,o=E.y,S,l,L=Object.keys(this.oCoords),q=L.length-1,O;for(this.__corner=0;q>=0;q--)if(O=L[q],!!this.isControlVisible(O)&&(l=this._getImageLines(F?this.oCoords[O].touchCorner:this.oCoords[O].corner),S=this._findCrossPoints({x:R,y:o},l),S!==0&&S%2===1))return this.__corner=O,O;return!1},forEachControl:function(E){for(var F in this.controls)E(this.controls[F],F,this)},_setCornerCoords:function(){var E=this.oCoords;for(var F in E){var R=this.controls[F];E[F].corner=R.calcCornerCoords(this.angle,this.cornerSize,E[F].x,E[F].y,!1),E[F].touchCorner=R.calcCornerCoords(this.angle,this.touchCornerSize,E[F].x,E[F].y,!0)}},drawSelectionBackground:function(E){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;E.save();var F=this.getCenterPoint(),R=this._calculateCurrentDimensions(),o=this.canvas.viewportTransform;return E.translate(F.x,F.y),E.scale(1/o[0],1/o[3]),E.rotate(M(this.angle)),E.fillStyle=this.selectionBackgroundColor,E.fillRect(-R.x/2,-R.y/2,R.x,R.y),E.restore(),this},drawBorders:function(E,F){F=F||{};var R=this._calculateCurrentDimensions(),o=this.borderScaleFactor,S=R.x+o,l=R.y+o,L=typeof F.hasControls<"u"?F.hasControls:this.hasControls,q=!1;return E.save(),E.strokeStyle=F.borderColor||this.borderColor,this._setLineDash(E,F.borderDashArray||this.borderDashArray),E.strokeRect(-S/2,-l/2,S,l),L&&(E.beginPath(),this.forEachControl(function(O,X,V){O.withConnection&&O.getVisibility(V,X)&&(q=!0,E.moveTo(O.x*S,O.y*l),E.lineTo(O.x*S+O.offsetX,O.y*l+O.offsetY))}),q&&E.stroke()),E.restore(),this},drawBordersInGroup:function(E,F,R){R=R||{};var o=p.util.sizeAfterTransform(this.width,this.height,F),S=this.strokeWidth,l=this.strokeUniform,L=this.borderScaleFactor,q=o.x+S*(l?this.canvas.getZoom():F.scaleX)+L,O=o.y+S*(l?this.canvas.getZoom():F.scaleY)+L;return E.save(),this._setLineDash(E,R.borderDashArray||this.borderDashArray),E.strokeStyle=R.borderColor||this.borderColor,E.strokeRect(-q/2,-O/2,q,O),E.restore(),this},drawControls:function(E,F){F=F||{},E.save();var R=1,o,S;return this.canvas&&(R=this.canvas.getRetinaScaling()),E.setTransform(R,0,0,R,0,0),E.strokeStyle=E.fillStyle=F.cornerColor||this.cornerColor,this.transparentCorners||(E.strokeStyle=F.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(E,F.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(o=this.group.calcTransformMatrix()),this.forEachControl(function(l,L,q){S=q.oCoords[L],l.getVisibility(q,L)&&(o&&(S=p.util.transformPoint(S,o)),l.render(E,S.x,S.y,F,q))}),E.restore(),this},isControlVisible:function(E){return this.controls[E]&&this.controls[E].getVisibility(this,E)},setControlVisible:function(E,F){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[E]=F,this},setControlsVisibility:function(E){E||(E={});for(var F in E)this.setControlVisible(F,E[F]);return this},onDeselect:function(){},onSelect:function(){}})}(),p.util.object.extend(p.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(M,E){E=E||{};var F=function(){},R=E.onComplete||F,o=E.onChange||F,S=this;return p.util.animate({target:this,startValue:M.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(l){M.set("left",l),S.requestRenderAll(),o()},onComplete:function(){M.setCoords(),R()}})},fxCenterObjectV:function(M,E){E=E||{};var F=function(){},R=E.onComplete||F,o=E.onChange||F,S=this;return p.util.animate({target:this,startValue:M.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(l){M.set("top",l),S.requestRenderAll(),o()},onComplete:function(){M.setCoords(),R()}})},fxRemove:function(M,E){E=E||{};var F=function(){},R=E.onComplete||F,o=E.onChange||F,S=this;return p.util.animate({target:this,startValue:M.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(l){M.set("opacity",l),S.requestRenderAll(),o()},onComplete:function(){S.remove(M),R()}})}}),p.util.object.extend(p.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var M=[],E,F,R=[];for(E in arguments[0])M.push(E);for(var o=0,S=M.length;o<S;o++)E=M[o],F=o!==S-1,R.push(this._animate(E,arguments[0][E],arguments[1],F));return R}else return this._animate.apply(this,arguments)},_animate:function(M,E,F,R){var o=this,S;E=E.toString(),F?F=p.util.object.clone(F):F={},~M.indexOf(".")&&(S=M.split("."));var l=o.colorProperties.indexOf(M)>-1||S&&o.colorProperties.indexOf(S[1])>-1,L=S?this.get(S[0])[S[1]]:this.get(M);"from"in F||(F.from=L),l||(~E.indexOf("=")?E=L+parseFloat(E.replace("=","")):E=parseFloat(E));var q={target:this,startValue:F.from,endValue:E,byValue:F.by,easing:F.easing,duration:F.duration,abort:F.abort&&function(O,X,V){return F.abort.call(o,O,X,V)},onChange:function(O,X,V){S?o[S[0]][S[1]]=O:o.set(M,O),!R&&F.onChange&&F.onChange(O,X,V)},onComplete:function(O,X,V){R||(o.setCoords(),F.onComplete&&F.onComplete(O,X,V))}};return l?p.util.animateColor(q.startValue,q.endValue,q.duration,q):p.util.animate(q)}}),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.util.object.clone,o={x1:1,x2:1,y1:1,y2:1};if(E.Line){E.warn("fabric.Line is already defined");return}E.Line=E.util.createClass(E.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:E.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(l,L){l||(l=[0,0,0,0]),this.callSuper("initialize",L),this.set("x1",l[0]),this.set("y1",l[1]),this.set("x2",l[2]),this.set("y2",l[3]),this._setWidthHeight(L)},_setWidthHeight:function(l){l||(l={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in l?l.left:this._getLeftToOriginX(),this.top="top"in l?l.top:this._getTopToOriginY()},_set:function(l,L){return this.callSuper("_set",l,L),typeof o[l]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:S({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:S({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(l){l.beginPath();var L=this.calcLinePoints();l.moveTo(L.x1,L.y1),l.lineTo(L.x2,L.y2),l.lineWidth=this.strokeWidth;var q=l.strokeStyle;l.strokeStyle=this.stroke||l.fillStyle,this.stroke&&this._renderStroke(l),l.strokeStyle=q},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(l){return F(this.callSuper("toObject",l),this.calcLinePoints())},_getNonTransformedDimensions:function(){var l=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(l.y-=this.strokeWidth),this.height===0&&(l.x-=this.strokeWidth)),l},calcLinePoints:function(){var l=this.x1<=this.x2?-1:1,L=this.y1<=this.y2?-1:1,q=l*this.width*.5,O=L*this.height*.5,X=l*this.width*-.5,V=L*this.height*-.5;return{x1:q,x2:X,y1:O,y2:V}},_toSVG:function(){var l=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',l.x1,'" y1="',l.y1,'" x2="',l.x2,'" y2="',l.y2,`" />
`]}}),E.Line.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),E.Line.fromElement=function(l,L,q){q=q||{};var O=E.parseAttributes(l,E.Line.ATTRIBUTE_NAMES),X=[O.x1||0,O.y1||0,O.x2||0,O.y2||0];L(new E.Line(X,F(O,q)))},E.Line.fromObject=function(l,L){function q(X){delete X.points,L&&L(X)}var O=R(l,!0);O.points=[l.x1,l.y1,l.x2,l.y2],E.Object._fromObject("Line",O,q,"points")};function S(l,L){var q=l.origin,O=l.axis1,X=l.axis2,V=l.dimension,Y=L.nearest,U=L.center,Q=L.farthest;return function(){switch(this.get(q)){case Y:return Math.min(this.get(O),this.get(X));case U:return Math.min(this.get(O),this.get(X))+.5*this.get(V);case Q:return Math.max(this.get(O),this.get(X))}}}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.degreesToRadians;if(E.Circle){E.warn("fabric.Circle is already defined.");return}E.Circle=E.util.createClass(E.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:E.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(o,S){return this.callSuper("_set",o,S),o==="radius"&&this.setRadius(S),this},toObject:function(o){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(o))},_toSVG:function(){var o,S=0,l=0,L=(this.endAngle-this.startAngle)%360;if(L===0)o=["<circle ","COMMON_PARTS",'cx="'+S+'" cy="'+l+'" ','r="',this.radius,`" />
`];else{var q=F(this.startAngle),O=F(this.endAngle),X=this.radius,V=E.util.cos(q)*X,Y=E.util.sin(q)*X,U=E.util.cos(O)*X,Q=E.util.sin(O)*X,te=L>180?"1":"0";o=['<path d="M '+V+" "+Y," A "+X+" "+X," 0 ",+te+" 1"," "+U+" "+Q,'" ',"COMMON_PARTS",` />
`]}return o},_render:function(o){o.beginPath(),o.arc(0,0,this.radius,F(this.startAngle),F(this.endAngle),!1),this._renderPaintInOrder(o)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(o){return this.radius=o,this.set("width",o*2).set("height",o*2)}}),E.Circle.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),E.Circle.fromElement=function(o,S){var l=E.parseAttributes(o,E.Circle.ATTRIBUTE_NAMES);if(!R(l))throw new Error("value of `r` attribute is required and can not be negative");l.left=(l.left||0)-l.radius,l.top=(l.top||0)-l.radius,S(new E.Circle(l))};function R(o){return"radius"in o&&o.radius>=0}E.Circle.fromObject=function(o,S){E.Object._fromObject("Circle",o,S)}}(B),function(M){var E=M.fabric||(M.fabric={});if(E.Triangle){E.warn("fabric.Triangle is already defined");return}E.Triangle=E.util.createClass(E.Object,{type:"triangle",width:100,height:100,_render:function(F){var R=this.width/2,o=this.height/2;F.beginPath(),F.moveTo(-R,o),F.lineTo(0,-o),F.lineTo(R,o),F.closePath(),this._renderPaintInOrder(F)},_toSVG:function(){var F=this.width/2,R=this.height/2,o=[-F+" "+R,"0 "+-R,F+" "+R].join(",");return["<polygon ","COMMON_PARTS",'points="',o,'" />']}}),E.Triangle.fromObject=function(F,R){return E.Object._fromObject("Triangle",F,R)}}(B),function(M){var E=M.fabric||(M.fabric={}),F=Math.PI*2;if(E.Ellipse){E.warn("fabric.Ellipse is already defined.");return}E.Ellipse=E.util.createClass(E.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:E.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(R){this.callSuper("initialize",R),this.set("rx",R&&R.rx||0),this.set("ry",R&&R.ry||0)},_set:function(R,o){switch(this.callSuper("_set",R,o),R){case"rx":this.rx=o,this.set("width",o*2);break;case"ry":this.ry=o,this.set("height",o*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(R){return this.callSuper("toObject",["rx","ry"].concat(R))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(R){R.beginPath(),R.save(),R.transform(1,0,0,this.ry/this.rx,0,0),R.arc(0,0,this.rx,0,F,!1),R.restore(),this._renderPaintInOrder(R)}}),E.Ellipse.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),E.Ellipse.fromElement=function(R,o){var S=E.parseAttributes(R,E.Ellipse.ATTRIBUTE_NAMES);S.left=(S.left||0)-S.rx,S.top=(S.top||0)-S.ry,o(new E.Ellipse(S))},E.Ellipse.fromObject=function(R,o){E.Object._fromObject("Ellipse",R,o)}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend;if(E.Rect){E.warn("fabric.Rect is already defined");return}E.Rect=E.util.createClass(E.Object,{stateProperties:E.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:E.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(R){this.callSuper("initialize",R),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(R){var o=this.rx?Math.min(this.rx,this.width/2):0,S=this.ry?Math.min(this.ry,this.height/2):0,l=this.width,L=this.height,q=-this.width/2,O=-this.height/2,X=o!==0||S!==0,V=1-.5522847498;R.beginPath(),R.moveTo(q+o,O),R.lineTo(q+l-o,O),X&&R.bezierCurveTo(q+l-V*o,O,q+l,O+V*S,q+l,O+S),R.lineTo(q+l,O+L-S),X&&R.bezierCurveTo(q+l,O+L-V*S,q+l-V*o,O+L,q+l-o,O+L),R.lineTo(q+o,O+L),X&&R.bezierCurveTo(q+V*o,O+L,q,O+L-V*S,q,O+L-S),R.lineTo(q,O+S),X&&R.bezierCurveTo(q,O+V*S,q+V*o,O,q+o,O),R.closePath(),this._renderPaintInOrder(R)},toObject:function(R){return this.callSuper("toObject",["rx","ry"].concat(R))},_toSVG:function(){var R=-this.width/2,o=-this.height/2;return["<rect ","COMMON_PARTS",'x="',R,'" y="',o,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),E.Rect.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),E.Rect.fromElement=function(R,o,S){if(!R)return o(null);S=S||{};var l=E.parseAttributes(R,E.Rect.ATTRIBUTE_NAMES);l.left=l.left||0,l.top=l.top||0,l.height=l.height||0,l.width=l.width||0;var L=new E.Rect(F(S?E.util.object.clone(S):{},l));L.visible=L.visible&&L.width>0&&L.height>0,o(L)},E.Rect.fromObject=function(R,o){return E.Object._fromObject("Rect",R,o)}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.util.array.min,o=E.util.array.max,S=E.util.toFixed,l=E.util.projectStrokeOnPoints;if(E.Polyline){E.warn("fabric.Polyline is already defined");return}E.Polyline=E.util.createClass(E.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:E.Object.prototype.cacheProperties.concat("points"),initialize:function(L,q){q=q||{},this.points=L||[],this.callSuper("initialize",q),this._setPositionDimensions(q)},_projectStrokeOnPoints:function(){return l(this.points,this,!0)},_setPositionDimensions:function(L){var q=this._calcDimensions(L),O,X=this.exactBoundingBox?this.strokeWidth:0;this.width=q.width-X,this.height=q.height-X,L.fromSVG||(O=this.translateToGivenOrigin({x:q.left-this.strokeWidth/2+X/2,y:q.top-this.strokeWidth/2+X/2},"left","top",this.originX,this.originY)),typeof L.left>"u"&&(this.left=L.fromSVG?q.left:O.x),typeof L.top>"u"&&(this.top=L.fromSVG?q.top:O.y),this.pathOffset={x:q.left+this.width/2+X/2,y:q.top+this.height/2+X/2}},_calcDimensions:function(){var L=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,q=R(L,"x")||0,O=R(L,"y")||0,X=o(L,"x")||0,V=o(L,"y")||0,Y=X-q,U=V-O;return{left:q,top:O,width:Y,height:U}},toObject:function(L){return F(this.callSuper("toObject",L),{points:this.points.concat()})},_toSVG:function(){for(var L=[],q=this.pathOffset.x,O=this.pathOffset.y,X=E.Object.NUM_FRACTION_DIGITS,V=0,Y=this.points.length;V<Y;V++)L.push(S(this.points[V].x-q,X),",",S(this.points[V].y-O,X)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',L.join(""),`" />
`]},commonRender:function(L){var q,O=this.points.length,X=this.pathOffset.x,V=this.pathOffset.y;if(!O||isNaN(this.points[O-1].y))return!1;L.beginPath(),L.moveTo(this.points[0].x-X,this.points[0].y-V);for(var Y=0;Y<O;Y++)q=this.points[Y],L.lineTo(q.x-X,q.y-V);return!0},_render:function(L){this.commonRender(L)&&this._renderPaintInOrder(L)},complexity:function(){return this.get("points").length}}),E.Polyline.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(),E.Polyline.fromElementGenerator=function(L){return function(q,O,X){if(!q)return O(null);X||(X={});var V=E.parsePointsAttribute(q.getAttribute("points")),Y=E.parseAttributes(q,E[L].ATTRIBUTE_NAMES);Y.fromSVG=!0,O(new E[L](V,F(Y,X)))}},E.Polyline.fromElement=E.Polyline.fromElementGenerator("Polyline"),E.Polyline.fromObject=function(L,q){return E.Object._fromObject("Polyline",L,q,"points")}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.projectStrokeOnPoints;if(E.Polygon){E.warn("fabric.Polygon is already defined");return}E.Polygon=E.util.createClass(E.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return F(this.points,this)},_render:function(R){this.commonRender(R)&&(R.closePath(),this._renderPaintInOrder(R))}}),E.Polygon.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(),E.Polygon.fromElement=E.Polyline.fromElementGenerator("Polygon"),E.Polygon.fromObject=function(R,o){E.Object._fromObject("Polygon",R,o,"points")}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.array.min,R=E.util.array.max,o=E.util.object.extend,S=E.util.object.clone,l=E.util.toFixed;if(E.Path){E.warn("fabric.Path is already defined");return}E.Path=E.util.createClass(E.Object,{type:"path",path:null,cacheProperties:E.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:E.Object.prototype.stateProperties.concat("path"),initialize:function(L,q){q=S(q||{}),delete q.path,this.callSuper("initialize",q),this._setPath(L||[],q)},_setPath:function(L,q){this.path=E.util.makePathSimpler(Array.isArray(L)?L:E.util.parsePath(L)),E.Polyline.prototype._setPositionDimensions.call(this,q||{})},_renderPathCommands:function(L){var q,O=0,X=0,V=0,Y=0,U=0,Q=0,te=-this.pathOffset.x,se=-this.pathOffset.y;L.beginPath();for(var fe=0,Se=this.path.length;fe<Se;++fe)switch(q=this.path[fe],q[0]){case"L":V=q[1],Y=q[2],L.lineTo(V+te,Y+se);break;case"M":V=q[1],Y=q[2],O=V,X=Y,L.moveTo(V+te,Y+se);break;case"C":V=q[5],Y=q[6],U=q[3],Q=q[4],L.bezierCurveTo(q[1]+te,q[2]+se,U+te,Q+se,V+te,Y+se);break;case"Q":L.quadraticCurveTo(q[1]+te,q[2]+se,q[3]+te,q[4]+se),V=q[3],Y=q[4],U=q[1],Q=q[2];break;case"z":case"Z":V=O,Y=X,L.closePath();break}},_render:function(L){this._renderPathCommands(L),this._renderPaintInOrder(L)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(L){return o(this.callSuper("toObject",L),{path:this.path.map(function(q){return q.slice()})})},toDatalessObject:function(L){var q=this.toObject(["sourcePath"].concat(L));return q.sourcePath&&delete q.path,q},_toSVG:function(){var L=E.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',L,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var L=E.Object.NUM_FRACTION_DIGITS;return" translate("+l(-this.pathOffset.x,L)+", "+l(-this.pathOffset.y,L)+")"},toClipPathSVG:function(L){var q=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:L,additionalTransform:q})},toSVG:function(L){var q=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:L,additionalTransform:q})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var L=[],q=[],O,X=0,V=0,Y=0,U=0,Q,te=0,se=this.path.length;te<se;++te){switch(O=this.path[te],O[0]){case"L":Y=O[1],U=O[2],Q=[];break;case"M":Y=O[1],U=O[2],X=Y,V=U,Q=[];break;case"C":Q=E.util.getBoundsOfCurve(Y,U,O[1],O[2],O[3],O[4],O[5],O[6]),Y=O[5],U=O[6];break;case"Q":Q=E.util.getBoundsOfCurve(Y,U,O[1],O[2],O[1],O[2],O[3],O[4]),Y=O[3],U=O[4];break;case"z":case"Z":Y=X,U=V;break}Q.forEach(function(ve){L.push(ve.x),q.push(ve.y)}),L.push(Y),q.push(U)}var fe=F(L)||0,Se=F(q)||0,Te=R(L)||0,Re=R(q)||0,je=Te-fe,He=Re-Se;return{left:fe,top:Se,width:je,height:He}}}),E.Path.fromObject=function(L,q){if(typeof L.sourcePath=="string"){var O=L.sourcePath;E.loadSVGFromURL(O,function(X){var V=X[0];V.setOptions(L),L.clipPath?E.util.enlivenObjects([L.clipPath],function(Y){V.clipPath=Y[0],q&&q(V)}):q&&q(V)})}else E.Object._fromObject("Path",L,q,"path")},E.Path.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat(["d"]),E.Path.fromElement=function(L,q,O){var X=E.parseAttributes(L,E.Path.ATTRIBUTE_NAMES);X.fromSVG=!0,q(new E.Path(X.d,o(X,O)))}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.array.min,R=E.util.array.max;E.Group||(E.Group=E.util.createClass(E.Object,E.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(o,S,l){S=S||{},this._objects=[],l&&this.callSuper("initialize",S),this._objects=o||[];for(var L=this._objects.length;L--;)this._objects[L].group=this;if(l)this._updateObjectsACoords();else{var q=S&&S.centerPoint;S.originX!==void 0&&(this.originX=S.originX),S.originY!==void 0&&(this.originY=S.originY),q||this._calcBounds(),this._updateObjectsCoords(q),delete S.centerPoint,this.callSuper("initialize",S)}this.setCoords()},_updateObjectsACoords:function(){for(var o=!0,S=this._objects.length;S--;)this._objects[S].setCoords(o)},_updateObjectsCoords:function(S){for(var S=S||this.getCenterPoint(),l=this._objects.length;l--;)this._updateObjectCoords(this._objects[l],S)},_updateObjectCoords:function(o,S){var l=o.left,L=o.top,q=!0;o.set({left:l-S.x,top:L-S.y}),o.group=this,o.setCoords(q)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(o){var S=!!this.group;return this._restoreObjectsState(),E.util.resetObjectTransform(this),o&&(S&&E.util.removeTransformFromObject(o,this.group.calcTransformMatrix()),this._objects.push(o),o.group=this,o._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,S?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(o){return this._restoreObjectsState(),E.util.resetObjectTransform(this),this.remove(o),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(o){this.dirty=!0,o.group=this,o._set("canvas",this.canvas)},_onObjectRemoved:function(o){this.dirty=!0,delete o.group},_set:function(o,S){var l=this._objects.length;if(this.useSetOnGroup)for(;l--;)this._objects[l].setOnGroup(o,S);if(o==="canvas")for(;l--;)this._objects[l]._set(o,S);E.Object.prototype._set.call(this,o,S)},toObject:function(o){var S=this.includeDefaultValues,l=this._objects.filter(function(q){return!q.excludeFromExport}).map(function(q){var O=q.includeDefaultValues;q.includeDefaultValues=S;var X=q.toObject(o);return q.includeDefaultValues=O,X}),L=E.Object.prototype.toObject.call(this,o);return L.objects=l,L},toDatalessObject:function(o){var S,l=this.sourcePath;if(l)S=l;else{var L=this.includeDefaultValues;S=this._objects.map(function(O){var X=O.includeDefaultValues;O.includeDefaultValues=L;var V=O.toDatalessObject(o);return O.includeDefaultValues=X,V})}var q=E.Object.prototype.toDatalessObject.call(this,o);return q.objects=S,q},render:function(o){this._transformDone=!0,this.callSuper("render",o),this._transformDone=!1},shouldCache:function(){var o=E.Object.prototype.shouldCache.call(this);if(o){for(var S=0,l=this._objects.length;S<l;S++)if(this._objects[S].willDrawShadow())return this.ownCaching=!1,!1}return o},willDrawShadow:function(){if(E.Object.prototype.willDrawShadow.call(this))return!0;for(var o=0,S=this._objects.length;o<S;o++)if(this._objects[o].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(o){for(var S=0,l=this._objects.length;S<l;S++)this._objects[S].render(o);this._drawClipPath(o,this.clipPath)},isCacheDirty:function(o){if(this.callSuper("isCacheDirty",o))return!0;if(!this.statefullCache)return!1;for(var S=0,l=this._objects.length;S<l;S++)if(this._objects[S].isCacheDirty(!0)){if(this._cacheCanvas){var L=this.cacheWidth/this.zoomX,q=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-L/2,-q/2,L,q)}return!0}return!1},_restoreObjectsState:function(){var o=this.calcOwnMatrix();return this._objects.forEach(function(S){E.util.addTransformToObject(S,o),delete S.group,S.setCoords()}),this},destroy:function(){return this._objects.forEach(function(o){o.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(o){o.dispose&&o.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var o=this._objects,S=this.canvas;this._objects=[];var l=this.toObject();delete l.objects;var L=new E.ActiveSelection([]);return L.set(l),L.type="activeSelection",S.remove(this),o.forEach(function(q){q.group=L,q.dirty=!0,S.add(q)}),L.canvas=S,L._objects=o,S._activeObject=L,L.setCoords(),L}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var o=!0;return this.forEachObject(function(S){S.setCoords(o)}),this},_calcBounds:function(o){for(var S=[],l=[],L,q,O,X=["tr","br","bl","tl"],V=0,Y=this._objects.length,U,Q=X.length;V<Y;++V){for(L=this._objects[V],O=L.calcACoords(),U=0;U<Q;U++)q=X[U],S.push(O[q].x),l.push(O[q].y);L.aCoords=O}this._getBounds(S,l,o)},_getBounds:function(o,S,l){var L=new E.Point(F(o),F(S)),q=new E.Point(R(o),R(S)),O=L.y||0,X=L.x||0,V=q.x-L.x||0,Y=q.y-L.y||0;this.width=V,this.height=Y,l||this.setPositionByOrigin({x:X,y:O},"left","top")},_toSVG:function(o){for(var S=["<g ","COMMON_PARTS",` >
`],l=0,L=this._objects.length;l<L;l++)S.push("		",this._objects[l].toSVG(o));return S.push(`</g>
`),S},getSvgStyles:function(){var o=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",S=this.visible?"":" visibility: hidden;";return[o,this.getSvgFilter(),S].join("")},toClipPathSVG:function(o){for(var S=[],l=0,L=this._objects.length;l<L;l++)S.push("	",this._objects[l].toClipPathSVG(o));return this._createBaseClipPathSVGMarkup(S,{reviver:o})}}),E.Group.fromObject=function(o,S){var l=o.objects,L=E.util.object.clone(o,!0);if(delete L.objects,typeof l=="string"){E.loadSVGFromURL(l,function(q){var O=E.util.groupSVGElements(q,o,l),X=L.clipPath;delete L.clipPath,O.set(L),X?E.util.enlivenObjects([X],function(V){O.clipPath=V[0],S&&S(O)}):S&&S(O)});return}E.util.enlivenObjects(l,function(q){E.util.enlivenObjectEnlivables(o,L,function(){S&&S(new E.Group(q,L,!0))})})})}(B),function(M){var E=M.fabric||(M.fabric={});E.ActiveSelection||(E.ActiveSelection=E.util.createClass(E.Group,{type:"activeSelection",initialize:function(F,R){R=R||{},this._objects=F||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;R.originX&&(this.originX=R.originX),R.originY&&(this.originY=R.originY),this._calcBounds(),this._updateObjectsCoords(),E.Object.prototype.initialize.call(this,R),this.setCoords()},toGroup:function(){var F=this._objects.concat();this._objects=[];var R=E.Object.prototype.toObject.call(this),o=new E.Group([]);if(delete R.type,o.set(R),F.forEach(function(l){l.canvas.remove(l),l.group=o}),o._objects=F,!this.canvas)return o;var S=this.canvas;return S.add(o),S._activeObject=o,o.setCoords(),o},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(F,R,o){F.save(),F.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,o=o||{},typeof o.hasControls>"u"&&(o.hasControls=!1),o.forActiveSelection=!0;for(var S=0,l=this._objects.length;S<l;S++)this._objects[S]._renderControls(F,o);this.callSuper("_renderControls",F,R),F.restore()}}),E.ActiveSelection.fromObject=function(F,R){E.util.enlivenObjects(F.objects,function(o){delete F.objects,R&&R(new E.ActiveSelection(o,F,!0))})})}(B),function(M){var E=p.util.object.extend;if(M.fabric||(M.fabric={}),M.fabric.Image){p.warn("fabric.Image is already defined.");return}p.Image=p.util.createClass(p.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:p.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:p.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(F,R){R||(R={}),this.filters=[],this.cacheKey="texture"+p.Object.__uid++,this.callSuper("initialize",R),this._initElement(F,R)},getElement:function(){return this._element||{}},setElement:function(F,R){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=F,this._originalElement=F,this._initConfig(R),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(F){var R=p.filterBackend;R&&R.evictCachesForKey&&R.evictCachesForKey(F)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(F){p.util.cleanUpJsdomNode(this[F]),this[F]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var F=this.getElement();return{width:F.naturalWidth||F.width,height:F.naturalHeight||F.height}},_stroke:function(F){if(!(!this.stroke||this.strokeWidth===0)){var R=this.width/2,o=this.height/2;F.beginPath(),F.moveTo(-R,-o),F.lineTo(R,-o),F.lineTo(R,o),F.lineTo(-R,o),F.lineTo(-R,-o),F.closePath()}},toObject:function(F){var R=[];this.filters.forEach(function(S){S&&R.push(S.toObject())});var o=E(this.callSuper("toObject",["cropX","cropY"].concat(F)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:R});return this.resizeFilter&&(o.resizeFilter=this.resizeFilter.toObject()),o},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var F=[],R=[],o,S=this._element,l=-this.width/2,L=-this.height/2,q="",O="";if(!S)return[];if(this.hasCrop()){var X=p.Object.__uid++;F.push('<clipPath id="imageCrop_'+X+`">
`,'	<rect x="'+l+'" y="'+L+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),q=' clip-path="url(#imageCrop_'+X+')" '}if(this.imageSmoothing||(O='" image-rendering="optimizeSpeed'),R.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',l-this.cropX,'" y="',L-this.cropY,'" width="',S.width||S.naturalWidth,'" height="',S.height||S.height,O,'"',q,`></image>
`),this.stroke||this.strokeDashArray){var V=this.fill;this.fill=null,o=["	<rect ",'x="',l,'" y="',L,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=V}return this.paintFirst!=="fill"?F=F.concat(o,R):F=F.concat(R,o),F},getSrc:function(F){var R=F?this._element:this._originalElement;return R?R.toDataURL?R.toDataURL():this.srcFromAttribute?R.getAttribute("src"):R.src:this.src||""},setSrc:function(F,R,o){return p.util.loadImage(F,function(S,l){this.setElement(S,o),this._setWidthHeight(),R&&R(this,l)},this,o&&o.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var F=this.resizeFilter,R=this.minimumScaleTrigger,o=this.getTotalObjectScaling(),S=o.scaleX,l=o.scaleY,L=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!F||S>R&&l>R){this._element=L,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=S,this._lastScaleY=l;return}p.filterBackend||(p.filterBackend=p.initFilterBackend());var q=p.util.createCanvasElement(),O=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,X=L.width,V=L.height;q.width=X,q.height=V,this._element=q,this._lastScaleX=F.scaleX=S,this._lastScaleY=F.scaleY=l,p.filterBackend.applyFilters([F],L,X,V,this._element,O),this._filterScalingX=q.width/this._originalElement.width,this._filterScalingY=q.height/this._originalElement.height},applyFilters:function(F){if(F=F||this.filters||[],F=F.filter(function(L){return L&&!L.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),F.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var R=this._originalElement,o=R.naturalWidth||R.width,S=R.naturalHeight||R.height;if(this._element===this._originalElement){var l=p.util.createCanvasElement();l.width=o,l.height=S,this._element=l,this._filteredEl=l}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,o,S),this._lastScaleX=1,this._lastScaleY=1;return p.filterBackend||(p.filterBackend=p.initFilterBackend()),p.filterBackend.applyFilters(F,this._originalElement,o,S,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(F){p.util.setImageSmoothing(F,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(F),this._renderPaintInOrder(F)},drawCacheOnCanvas:function(F){p.util.setImageSmoothing(F,this.imageSmoothing),p.Object.prototype.drawCacheOnCanvas.call(this,F)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(F){var R=this._element;if(R){var o=this._filterScalingX,S=this._filterScalingY,l=this.width,L=this.height,q=Math.min,O=Math.max,X=O(this.cropX,0),V=O(this.cropY,0),Y=R.naturalWidth||R.width,U=R.naturalHeight||R.height,Q=X*o,te=V*S,se=q(l*o,Y-Q),fe=q(L*S,U-te),Se=-l/2,Te=-L/2,Re=q(l,Y/o-X),je=q(L,U/S-V);R&&F.drawImage(R,Q,te,se,fe,Se,Te,Re,je)}},_needsResize:function(){var F=this.getTotalObjectScaling();return F.scaleX!==this._lastScaleX||F.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(F,R){this.setElement(p.util.getById(F),R),p.util.addClass(this.getElement(),p.Image.CSS_CANVAS)},_initConfig:function(F){F||(F={}),this.setOptions(F),this._setWidthHeight(F)},_initFilters:function(F,R){F&&F.length?p.util.enlivenObjects(F,function(o){R&&R(o)},"fabric.Image.filters"):R&&R()},_setWidthHeight:function(F){F||(F={});var R=this.getElement();this.width=F.width||R.naturalWidth||R.width||0,this.height=F.height||R.naturalHeight||R.height||0},parsePreserveAspectRatioAttribute:function(){var F=p.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),R=this._element.width,o=this._element.height,S=1,l=1,L=0,q=0,O=0,X=0,V,Y=this.width,U=this.height,Q={width:Y,height:U};return F&&(F.alignX!=="none"||F.alignY!=="none")?(F.meetOrSlice==="meet"&&(S=l=p.util.findScaleToFit(this._element,Q),V=(Y-R*S)/2,F.alignX==="Min"&&(L=-V),F.alignX==="Max"&&(L=V),V=(U-o*l)/2,F.alignY==="Min"&&(q=-V),F.alignY==="Max"&&(q=V)),F.meetOrSlice==="slice"&&(S=l=p.util.findScaleToCover(this._element,Q),V=R-Y/S,F.alignX==="Mid"&&(O=V/2),F.alignX==="Max"&&(O=V),V=o-U/l,F.alignY==="Mid"&&(X=V/2),F.alignY==="Max"&&(X=V),R=Y/S,o=U/l)):(S=Y/R,l=U/o),{width:R,height:o,scaleX:S,scaleY:l,offsetLeft:L,offsetTop:q,cropX:O,cropY:X}}}),p.Image.CSS_CANVAS="canvas-img",p.Image.prototype.getSvgSrc=p.Image.prototype.getSrc,p.Image.fromObject=function(F,R){var o=p.util.object.clone(F);p.util.loadImage(o.src,function(S,l){if(l){R&&R(null,!0);return}p.Image.prototype._initFilters.call(o,o.filters,function(L){o.filters=L||[],p.Image.prototype._initFilters.call(o,[o.resizeFilter],function(q){o.resizeFilter=q[0],p.util.enlivenObjectEnlivables(o,o,function(){var O=new p.Image(S,o);R(O,!1)})})})},null,o.crossOrigin)},p.Image.fromURL=function(F,R,o){p.util.loadImage(F,function(S,l){R&&R(new p.Image(S,o),l)},null,o&&o.crossOrigin)},p.Image.ATTRIBUTE_NAMES=p.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),p.Image.fromElement=function(F,R,o){var S=p.parseAttributes(F,p.Image.ATTRIBUTE_NAMES);p.Image.fromURL(S["xlink:href"],R,E(o?p.util.object.clone(o):{},S))}}(B),p.util.object.extend(p.Object.prototype,{_getAngleValueForStraighten:function(){var M=this.angle%360;return M>0?Math.round((M-1)/90)*90:Math.round(M/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(M){M=M||{};var E=function(){},F=M.onComplete||E,R=M.onChange||E,o=this;return p.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(S){o.rotate(S),R()},onComplete:function(){o.setCoords(),F()}})}}),p.util.object.extend(p.StaticCanvas.prototype,{straightenObject:function(M){return M.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(M){return M.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function M(F,R){var o="precision "+R+` float;
void main(){}`,S=F.createShader(F.FRAGMENT_SHADER);return F.shaderSource(S,o),F.compileShader(S),!!F.getShaderParameter(S,F.COMPILE_STATUS)}p.isWebglSupported=function(F){if(p.isLikelyNode)return!1;F=F||p.WebglFilterBackend.prototype.tileSize;var R=document.createElement("canvas"),o=R.getContext("webgl")||R.getContext("experimental-webgl"),S=!1;if(o){p.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),S=p.maxTextureSize>=F;for(var l=["highp","mediump","lowp"],L=0;L<3;L++)if(M(o,l[L])){p.webGlPrecision=l[L];break}}return this.isSupported=S,S},p.WebglFilterBackend=E;function E(F){F&&F.tileSize&&(this.tileSize=F.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}E.prototype={tileSize:2048,resources:{},setupGLContext:function(F,R){this.dispose(),this.createWebGLCanvas(F,R),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(F,R)},chooseFastestCopyGLTo2DMethod:function(F,R){var o=typeof window.performance<"u",S;try{new ImageData(1,1),S=!0}catch{S=!1}var l=typeof ArrayBuffer<"u",L=typeof Uint8ClampedArray<"u";if(o&&S&&l&&L){var q=p.util.createCanvasElement(),O=new ArrayBuffer(F*R*4);if(p.forceGLPutImageData){this.imageBuffer=O,this.copyGLTo2D=Z;return}var X={imageBuffer:O,destinationWidth:F,destinationHeight:R,targetCanvas:q},V,Y,U;q.width=F,q.height=R,V=window.performance.now(),J.call(X,this.gl,X),Y=window.performance.now()-V,V=window.performance.now(),Z.call(X,this.gl,X),U=window.performance.now()-V,Y>U?(this.imageBuffer=O,this.copyGLTo2D=Z):this.copyGLTo2D=J}},createWebGLCanvas:function(F,R){var o=p.util.createCanvasElement();o.width=F,o.height=R;var S={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},l=o.getContext("webgl",S);l||(l=o.getContext("experimental-webgl",S)),l&&(l.clearColor(0,0,0,0),this.canvas=o,this.gl=l)},applyFilters:function(F,R,o,S,l,L){var q=this.gl,O;L&&(O=this.getCachedTexture(L,R));var X={originalWidth:R.width||R.originalWidth,originalHeight:R.height||R.originalHeight,sourceWidth:o,sourceHeight:S,destinationWidth:o,destinationHeight:S,context:q,sourceTexture:this.createTexture(q,o,S,!O&&R),targetTexture:this.createTexture(q,o,S),originalTexture:O||this.createTexture(q,o,S,!O&&R),passes:F.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:l},V=q.createFramebuffer();return q.bindFramebuffer(q.FRAMEBUFFER,V),F.forEach(function(Y){Y&&Y.applyTo(X)}),K(X),this.copyGLTo2D(q,X),q.bindTexture(q.TEXTURE_2D,null),q.deleteTexture(X.sourceTexture),q.deleteTexture(X.targetTexture),q.deleteFramebuffer(V),l.getContext("2d").setTransform(1,0,0,1,0,0),X},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(F,R,o,S,l){var L=F.createTexture();return F.bindTexture(F.TEXTURE_2D,L),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,l||F.NEAREST),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,l||F.NEAREST),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),S?F.texImage2D(F.TEXTURE_2D,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,S):F.texImage2D(F.TEXTURE_2D,0,F.RGBA,R,o,0,F.RGBA,F.UNSIGNED_BYTE,null),L},getCachedTexture:function(F,R){if(this.textureCache[F])return this.textureCache[F];var o=this.createTexture(this.gl,R.width,R.height,R);return this.textureCache[F]=o,o},evictCachesForKey:function(F){this.textureCache[F]&&(this.gl.deleteTexture(this.textureCache[F]),delete this.textureCache[F])},copyGLTo2D:J,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var F=this.gl,R={renderer:"",vendor:""};if(!F)return R;var o=F.getExtension("WEBGL_debug_renderer_info");if(o){var S=F.getParameter(o.UNMASKED_RENDERER_WEBGL),l=F.getParameter(o.UNMASKED_VENDOR_WEBGL);S&&(R.renderer=S.toLowerCase()),l&&(R.vendor=l.toLowerCase())}return this.gpuInfo=R,R}}}();function K(M){var E=M.targetCanvas,F=E.width,R=E.height,o=M.destinationWidth,S=M.destinationHeight;(F!==o||R!==S)&&(E.width=o,E.height=S)}function J(M,E){var F=M.canvas,R=E.targetCanvas,o=R.getContext("2d");o.translate(0,R.height),o.scale(1,-1);var S=F.height-R.height;o.drawImage(F,0,S,R.width,R.height,0,0,R.width,R.height)}function Z(M,E){var F=E.targetCanvas,R=F.getContext("2d"),o=E.destinationWidth,S=E.destinationHeight,l=o*S*4,L=new Uint8Array(this.imageBuffer,0,l),q=new Uint8ClampedArray(this.imageBuffer,0,l);M.readPixels(0,0,o,S,M.RGBA,M.UNSIGNED_BYTE,L);var O=new ImageData(q,o,S);R.putImageData(O,0,0)}(function(){var M=function(){};p.Canvas2dFilterBackend=E;function E(){}E.prototype={evictCachesForKey:M,dispose:M,clearWebGLCaches:M,resources:{},applyFilters:function(F,R,o,S,l){var L=l.getContext("2d");L.drawImage(R,0,0,o,S);var q=L.getImageData(0,0,o,S),O=L.getImageData(0,0,o,S),X={sourceWidth:o,sourceHeight:S,imageData:q,originalEl:R,originalImageData:O,canvasEl:l,ctx:L,filterBackend:this};return F.forEach(function(V){V.applyTo(X)}),(X.imageData.width!==o||X.imageData.height!==S)&&(l.width=X.imageData.width,l.height=X.imageData.height),L.putImageData(X.imageData,0,0),X}}})(),p.Image=p.Image||{},p.Image.filters=p.Image.filters||{},p.Image.filters.BaseFilter=p.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(M){M&&this.setOptions(M)},setOptions:function(M){for(var E in M)this[E]=M[E]},createProgram:function(M,E,F){E=E||this.fragmentSource,F=F||this.vertexSource,p.webGlPrecision!=="highp"&&(E=E.replace(/precision highp float/g,"precision "+p.webGlPrecision+" float"));var R=M.createShader(M.VERTEX_SHADER);if(M.shaderSource(R,F),M.compileShader(R),!M.getShaderParameter(R,M.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+M.getShaderInfoLog(R));var o=M.createShader(M.FRAGMENT_SHADER);if(M.shaderSource(o,E),M.compileShader(o),!M.getShaderParameter(o,M.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+M.getShaderInfoLog(o));var S=M.createProgram();if(M.attachShader(S,R),M.attachShader(S,o),M.linkProgram(S),!M.getProgramParameter(S,M.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+M.getProgramInfoLog(S));var l=this.getAttributeLocations(M,S),L=this.getUniformLocations(M,S)||{};return L.uStepW=M.getUniformLocation(S,"uStepW"),L.uStepH=M.getUniformLocation(S,"uStepH"),{program:S,attributeLocations:l,uniformLocations:L}},getAttributeLocations:function(M,E){return{aPosition:M.getAttribLocation(E,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(M,E,F){var R=E.aPosition,o=M.createBuffer();M.bindBuffer(M.ARRAY_BUFFER,o),M.enableVertexAttribArray(R),M.vertexAttribPointer(R,2,M.FLOAT,!1,0,0),M.bufferData(M.ARRAY_BUFFER,F,M.STATIC_DRAW)},_setupFrameBuffer:function(M){var E=M.context,F,R;M.passes>1?(F=M.destinationWidth,R=M.destinationHeight,(M.sourceWidth!==F||M.sourceHeight!==R)&&(E.deleteTexture(M.targetTexture),M.targetTexture=M.filterBackend.createTexture(E,F,R)),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,M.targetTexture,0)):(E.bindFramebuffer(E.FRAMEBUFFER,null),E.finish())},_swapTextures:function(M){M.passes--,M.pass++;var E=M.targetTexture;M.targetTexture=M.sourceTexture,M.sourceTexture=E},isNeutralState:function(){var M=this.mainParameter,E=p.Image.filters[this.type].prototype;if(M)if(Array.isArray(E[M])){for(var F=E[M].length;F--;)if(this[M][F]!==E[M][F])return!1;return!0}else return E[M]===this[M];else return!1},applyTo:function(M){M.webgl?(this._setupFrameBuffer(M),this.applyToWebGL(M),this._swapTextures(M)):this.applyTo2d(M)},retrieveShader:function(M){return M.programCache.hasOwnProperty(this.type)||(M.programCache[this.type]=this.createProgram(M.context)),M.programCache[this.type]},applyToWebGL:function(M){var E=M.context,F=this.retrieveShader(M);M.pass===0&&M.originalTexture?E.bindTexture(E.TEXTURE_2D,M.originalTexture):E.bindTexture(E.TEXTURE_2D,M.sourceTexture),E.useProgram(F.program),this.sendAttributeData(E,F.attributeLocations,M.aPosition),E.uniform1f(F.uniformLocations.uStepW,1/M.sourceWidth),E.uniform1f(F.uniformLocations.uStepH,1/M.sourceHeight),this.sendUniformData(E,F.uniformLocations),E.viewport(0,0,M.destinationWidth,M.destinationHeight),E.drawArrays(E.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(M,E,F){M.activeTexture(F),M.bindTexture(M.TEXTURE_2D,E),M.activeTexture(M.TEXTURE0)},unbindAdditionalTexture:function(M,E){M.activeTexture(E),M.bindTexture(M.TEXTURE_2D,null),M.activeTexture(M.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(M){this[this.mainParameter]=M},sendUniformData:function(){},createHelpLayer:function(M){if(!M.helpLayer){var E=document.createElement("canvas");E.width=M.sourceWidth,E.height=M.sourceHeight,M.helpLayer=E}},toObject:function(){var M={type:this.type},E=this.mainParameter;return E&&(M[E]=this[E]),M},toJSON:function(){return this.toObject()}}),p.Image.filters.BaseFilter.fromObject=function(M,E){var F=new p.Image.filters[M.type](M);return E&&E(F),F},function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.ColorMatrix=R(F.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(o){this.callSuper("initialize",o),this.matrix=this.matrix.slice(0)},applyTo2d:function(o){var S=o.imageData,l=S.data,L=l.length,q=this.matrix,O,X,V,Y,U,Q=this.colorsOnly;for(U=0;U<L;U+=4)O=l[U],X=l[U+1],V=l[U+2],Q?(l[U]=O*q[0]+X*q[1]+V*q[2]+q[4]*255,l[U+1]=O*q[5]+X*q[6]+V*q[7]+q[9]*255,l[U+2]=O*q[10]+X*q[11]+V*q[12]+q[14]*255):(Y=l[U+3],l[U]=O*q[0]+X*q[1]+V*q[2]+Y*q[3]+q[4]*255,l[U+1]=O*q[5]+X*q[6]+V*q[7]+Y*q[8]+q[9]*255,l[U+2]=O*q[10]+X*q[11]+V*q[12]+Y*q[13]+q[14]*255,l[U+3]=O*q[15]+X*q[16]+V*q[17]+Y*q[18]+q[19]*255)},getUniformLocations:function(o,S){return{uColorMatrix:o.getUniformLocation(S,"uColorMatrix"),uConstants:o.getUniformLocation(S,"uConstants")}},sendUniformData:function(o,S){var l=this.matrix,L=[l[0],l[1],l[2],l[3],l[5],l[6],l[7],l[8],l[10],l[11],l[12],l[13],l[15],l[16],l[17],l[18]],q=[l[4],l[9],l[14],l[19]];o.uniformMatrix4fv(S.uColorMatrix,!1,L),o.uniform4fv(S.uConstants,q)}}),E.Image.filters.ColorMatrix.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Brightness=R(F.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(o){if(this.brightness!==0){var S=o.imageData,l=S.data,L,q=l.length,O=Math.round(this.brightness*255);for(L=0;L<q;L+=4)l[L]=l[L]+O,l[L+1]=l[L+1]+O,l[L+2]=l[L+2]+O}},getUniformLocations:function(o,S){return{uBrightness:o.getUniformLocation(S,"uBrightness")}},sendUniformData:function(o,S){o.uniform1f(S.uBrightness,this.brightness)}}),E.Image.filters.Brightness.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.Convolute=o(R.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(S){var l=Math.sqrt(this.matrix.length),L=this.type+"_"+l+"_"+(this.opaque?1:0),q=this.fragmentSource[L];return S.programCache.hasOwnProperty(L)||(S.programCache[L]=this.createProgram(S.context,q)),S.programCache[L]},applyTo2d:function(S){var l=S.imageData,L=l.data,q=this.matrix,O=Math.round(Math.sqrt(q.length)),X=Math.floor(O/2),V=l.width,Y=l.height,U=S.ctx.createImageData(V,Y),Q=U.data,te=this.opaque?1:0,se,fe,Se,Te,Re,je,He,ve,_e,qe,Xe,Ge,re;for(Xe=0;Xe<Y;Xe++)for(qe=0;qe<V;qe++){for(Re=(Xe*V+qe)*4,se=0,fe=0,Se=0,Te=0,re=0;re<O;re++)for(Ge=0;Ge<O;Ge++)He=Xe+re-X,je=qe+Ge-X,!(He<0||He>=Y||je<0||je>=V)&&(ve=(He*V+je)*4,_e=q[re*O+Ge],se+=L[ve]*_e,fe+=L[ve+1]*_e,Se+=L[ve+2]*_e,te||(Te+=L[ve+3]*_e));Q[Re]=se,Q[Re+1]=fe,Q[Re+2]=Se,te?Q[Re+3]=L[Re+3]:Q[Re+3]=Te}S.imageData=U},getUniformLocations:function(S,l){return{uMatrix:S.getUniformLocation(l,"uMatrix"),uOpaque:S.getUniformLocation(l,"uOpaque"),uHalfSize:S.getUniformLocation(l,"uHalfSize"),uSize:S.getUniformLocation(l,"uSize")}},sendUniformData:function(S,l){S.uniform1fv(l.uMatrix,this.matrix)},toObject:function(){return F(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),E.Image.filters.Convolute.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Grayscale=R(F.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(o){var S=o.imageData,l=S.data,L,q=l.length,O,X=this.mode;for(L=0;L<q;L+=4)X==="average"?O=(l[L]+l[L+1]+l[L+2])/3:X==="lightness"?O=(Math.min(l[L],l[L+1],l[L+2])+Math.max(l[L],l[L+1],l[L+2]))/2:X==="luminosity"&&(O=.21*l[L]+.72*l[L+1]+.07*l[L+2]),l[L]=O,l[L+1]=O,l[L+2]=O},retrieveShader:function(o){var S=this.type+"_"+this.mode;if(!o.programCache.hasOwnProperty(S)){var l=this.fragmentSource[this.mode];o.programCache[S]=this.createProgram(o.context,l)}return o.programCache[S]},getUniformLocations:function(o,S){return{uMode:o.getUniformLocation(S,"uMode")}},sendUniformData:function(o,S){var l=1;o.uniform1i(S.uMode,l)},isNeutralState:function(){return!1}}),E.Image.filters.Grayscale.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Invert=R(F.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(o){var S=o.imageData,l=S.data,L,q=l.length;for(L=0;L<q;L+=4)l[L]=255-l[L],l[L+1]=255-l[L+1],l[L+2]=255-l[L+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(o,S){return{uInvert:o.getUniformLocation(S,"uInvert")}},sendUniformData:function(o,S){o.uniform1i(S.uInvert,this.invert)}}),E.Image.filters.Invert.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.Noise=o(R.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(S){if(this.noise!==0){var l=S.imageData,L=l.data,q,O=L.length,X=this.noise,V;for(q=0,O=L.length;q<O;q+=4)V=(.5-Math.random())*X,L[q]+=V,L[q+1]+=V,L[q+2]+=V}},getUniformLocations:function(S,l){return{uNoise:S.getUniformLocation(l,"uNoise"),uSeed:S.getUniformLocation(l,"uSeed")}},sendUniformData:function(S,l){S.uniform1f(l.uNoise,this.noise/255),S.uniform1f(l.uSeed,Math.random())},toObject:function(){return F(this.callSuper("toObject"),{noise:this.noise})}}),E.Image.filters.Noise.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Pixelate=R(F.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(o){var S=o.imageData,l=S.data,L=S.height,q=S.width,O,X,V,Y,U,Q,te,se,fe,Se,Te;for(X=0;X<L;X+=this.blocksize)for(V=0;V<q;V+=this.blocksize)for(O=X*4*q+V*4,Y=l[O],U=l[O+1],Q=l[O+2],te=l[O+3],Se=Math.min(X+this.blocksize,L),Te=Math.min(V+this.blocksize,q),se=X;se<Se;se++)for(fe=V;fe<Te;fe++)O=se*4*q+fe*4,l[O]=Y,l[O+1]=U,l[O+2]=Q,l[O+3]=te},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(o,S){return{uBlocksize:o.getUniformLocation(S,"uBlocksize"),uStepW:o.getUniformLocation(S,"uStepW"),uStepH:o.getUniformLocation(S,"uStepH")}},sendUniformData:function(o,S){o.uniform1f(S.uBlocksize,this.blocksize)}}),E.Image.filters.Pixelate.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.extend,R=E.Image.filters,o=E.util.createClass;R.RemoveColor=o(R.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(S){var l=S.imageData,L=l.data,q,O=this.distance*255,X,V,Y,U=new E.Color(this.color).getSource(),Q=[U[0]-O,U[1]-O,U[2]-O],te=[U[0]+O,U[1]+O,U[2]+O];for(q=0;q<L.length;q+=4)X=L[q],V=L[q+1],Y=L[q+2],X>Q[0]&&V>Q[1]&&Y>Q[2]&&X<te[0]&&V<te[1]&&Y<te[2]&&(L[q+3]=0)},getUniformLocations:function(S,l){return{uLow:S.getUniformLocation(l,"uLow"),uHigh:S.getUniformLocation(l,"uHigh")}},sendUniformData:function(S,l){var L=new E.Color(this.color).getSource(),q=parseFloat(this.distance),O=[0+L[0]/255-q,0+L[1]/255-q,0+L[2]/255-q,1],X=[L[0]/255+q,L[1]/255+q,L[2]/255+q,1];S.uniform4fv(l.uLow,O),S.uniform4fv(l.uHigh,X)},toObject:function(){return F(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),E.Image.filters.RemoveColor.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass,o={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var S in o)F[S]=R(F.ColorMatrix,{type:S,matrix:o[S],mainParameter:!1,colorsOnly:!0}),E.Image.filters[S].fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric,F=E.Image.filters,R=E.util.createClass;F.BlendColor=R(F.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(o){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[o]+`}
}`},retrieveShader:function(o){var S=this.type+"_"+this.mode,l;return o.programCache.hasOwnProperty(S)||(l=this.buildSource(this.mode),o.programCache[S]=this.createProgram(o.context,l)),o.programCache[S]},applyTo2d:function(o){var S=o.imageData,l=S.data,L=l.length,q,O,X,V,Y,U,Q,te=1-this.alpha;Q=new E.Color(this.color).getSource(),q=Q[0]*this.alpha,O=Q[1]*this.alpha,X=Q[2]*this.alpha;for(var se=0;se<L;se+=4)switch(V=l[se],Y=l[se+1],U=l[se+2],this.mode){case"multiply":l[se]=V*q/255,l[se+1]=Y*O/255,l[se+2]=U*X/255;break;case"screen":l[se]=255-(255-V)*(255-q)/255,l[se+1]=255-(255-Y)*(255-O)/255,l[se+2]=255-(255-U)*(255-X)/255;break;case"add":l[se]=V+q,l[se+1]=Y+O,l[se+2]=U+X;break;case"diff":case"difference":l[se]=Math.abs(V-q),l[se+1]=Math.abs(Y-O),l[se+2]=Math.abs(U-X);break;case"subtract":l[se]=V-q,l[se+1]=Y-O,l[se+2]=U-X;break;case"darken":l[se]=Math.min(V,q),l[se+1]=Math.min(Y,O),l[se+2]=Math.min(U,X);break;case"lighten":l[se]=Math.max(V,q),l[se+1]=Math.max(Y,O),l[se+2]=Math.max(U,X);break;case"overlay":l[se]=q<128?2*V*q/255:255-2*(255-V)*(255-q)/255,l[se+1]=O<128?2*Y*O/255:255-2*(255-Y)*(255-O)/255,l[se+2]=X<128?2*U*X/255:255-2*(255-U)*(255-X)/255;break;case"exclusion":l[se]=q+V-2*q*V/255,l[se+1]=O+Y-2*O*Y/255,l[se+2]=X+U-2*X*U/255;break;case"tint":l[se]=q+V*te,l[se+1]=O+Y*te,l[se+2]=X+U*te}},getUniformLocations:function(o,S){return{uColor:o.getUniformLocation(S,"uColor")}},sendUniformData:function(o,S){var l=new E.Color(this.color).getSource();l[0]=this.alpha*l[0]/255,l[1]=this.alpha*l[1]/255,l[2]=this.alpha*l[2]/255,l[3]=this.alpha,o.uniform4fv(S.uColor,l)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),E.Image.filters.BlendColor.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric,F=E.Image.filters,R=E.util.createClass;F.BlendImage=R(F.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(o){var S=this.type+"_"+this.mode,l=this.fragmentSource[this.mode];return o.programCache.hasOwnProperty(S)||(o.programCache[S]=this.createProgram(o.context,l)),o.programCache[S]},applyToWebGL:function(o){var S=o.context,l=this.createTexture(o.filterBackend,this.image);this.bindAdditionalTexture(S,l,S.TEXTURE1),this.callSuper("applyToWebGL",o),this.unbindAdditionalTexture(S,S.TEXTURE1)},createTexture:function(o,S){return o.getCachedTexture(S.cacheKey,S._element)},calculateMatrix:function(){var o=this.image,S=o._element.width,l=o._element.height;return[1/o.scaleX,0,0,0,1/o.scaleY,0,-o.left/S,-o.top/l,1]},applyTo2d:function(o){var S=o.imageData,l=o.filterBackend.resources,L=S.data,q=L.length,O=S.width,X=S.height,V,Y,U,Q,te,se,fe,Se,Te,Re,je=this.image,He;l.blendImage||(l.blendImage=E.util.createCanvasElement()),Te=l.blendImage,Re=Te.getContext("2d"),Te.width!==O||Te.height!==X?(Te.width=O,Te.height=X):Re.clearRect(0,0,O,X),Re.setTransform(je.scaleX,0,0,je.scaleY,je.left,je.top),Re.drawImage(je._element,0,0,O,X),He=Re.getImageData(0,0,O,X).data;for(var ve=0;ve<q;ve+=4)switch(te=L[ve],se=L[ve+1],fe=L[ve+2],Se=L[ve+3],V=He[ve],Y=He[ve+1],U=He[ve+2],Q=He[ve+3],this.mode){case"multiply":L[ve]=te*V/255,L[ve+1]=se*Y/255,L[ve+2]=fe*U/255,L[ve+3]=Se*Q/255;break;case"mask":L[ve+3]=Q;break}},getUniformLocations:function(o,S){return{uTransformMatrix:o.getUniformLocation(S,"uTransformMatrix"),uImage:o.getUniformLocation(S,"uImage")}},sendUniformData:function(o,S){var l=this.calculateMatrix();o.uniform1i(S.uImage,1),o.uniformMatrix3fv(S.uTransformMatrix,!1,l)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),E.Image.filters.BlendImage.fromObject=function(o,S){E.Image.fromObject(o.image,function(l){var L=E.util.object.clone(o);L.image=l,S(new E.Image.filters.BlendImage(L))})}}(B),function(M){var E=M.fabric||(M.fabric={}),F=Math.pow,R=Math.floor,o=Math.sqrt,S=Math.abs,l=Math.round,L=Math.sin,q=Math.ceil,O=E.Image.filters,X=E.util.createClass;O.Resize=X(O.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(V,Y){return{uDelta:V.getUniformLocation(Y,"uDelta"),uTaps:V.getUniformLocation(Y,"uTaps")}},sendUniformData:function(V,Y){V.uniform2fv(Y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),V.uniform1fv(Y.uTaps,this.taps)},retrieveShader:function(V){var Y=this.getFilterWindow(),U=this.type+"_"+Y;if(!V.programCache.hasOwnProperty(U)){var Q=this.generateShader(Y);V.programCache[U]=this.createProgram(V.context,Q)}return V.programCache[U]},getFilterWindow:function(){var V=this.tempScale;return Math.ceil(this.lanczosLobes/V)},getTaps:function(){for(var V=this.lanczosCreate(this.lanczosLobes),Y=this.tempScale,U=this.getFilterWindow(),Q=new Array(U),te=1;te<=U;te++)Q[te-1]=V(te*Y);return Q},generateShader:function(Q){for(var Y=new Array(Q),U=this.fragmentSourceTOP,Q,te=1;te<=Q;te++)Y[te-1]=te+".0 * uDelta";return U+="uniform float uTaps["+Q+`];
`,U+=`void main() {
`,U+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,U+=`  float sum = 1.0;
`,Y.forEach(function(se,fe){U+="  color += texture2D(uTexture, vTexCoord + "+se+") * uTaps["+fe+`];
`,U+="  color += texture2D(uTexture, vTexCoord - "+se+") * uTaps["+fe+`];
`,U+="  sum += 2.0 * uTaps["+fe+`];
`}),U+=`  gl_FragColor = color / sum;
`,U+="}",U},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(V){V.webgl?(V.passes++,this.width=V.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=V.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),V.destinationWidth=this.dW,this._setupFrameBuffer(V),this.applyToWebGL(V),this._swapTextures(V),V.sourceWidth=V.destinationWidth,this.height=V.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),V.destinationHeight=this.dH,this._setupFrameBuffer(V),this.applyToWebGL(V),this._swapTextures(V),V.sourceHeight=V.destinationHeight):this.applyTo2d(V)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(V){return function(Y){if(Y>=V||Y<=-V)return 0;if(Y<11920929e-14&&Y>-11920929e-14)return 1;Y*=Math.PI;var U=Y/V;return L(Y)/Y*L(U)/U}},applyTo2d:function(V){var Y=V.imageData,U=this.scaleX,Q=this.scaleY;this.rcpScaleX=1/U,this.rcpScaleY=1/Q;var te=Y.width,se=Y.height,fe=l(te*U),Se=l(se*Q),Te;this.resizeType==="sliceHack"?Te=this.sliceByTwo(V,te,se,fe,Se):this.resizeType==="hermite"?Te=this.hermiteFastResize(V,te,se,fe,Se):this.resizeType==="bilinear"?Te=this.bilinearFiltering(V,te,se,fe,Se):this.resizeType==="lanczos"&&(Te=this.lanczosResize(V,te,se,fe,Se)),V.imageData=Te},sliceByTwo:function(V,Y,U,Q,te){var se=V.imageData,fe=.5,Se=!1,Te=!1,Re=Y*fe,je=U*fe,He=E.filterBackend.resources,ve,_e,qe=0,Xe=0,Ge=Y,re=0;for(He.sliceByTwo||(He.sliceByTwo=document.createElement("canvas")),ve=He.sliceByTwo,(ve.width<Y*1.5||ve.height<U)&&(ve.width=Y*1.5,ve.height=U),_e=ve.getContext("2d"),_e.clearRect(0,0,Y*1.5,U),_e.putImageData(se,0,0),Q=R(Q),te=R(te);!Se||!Te;)Y=Re,U=je,Q<R(Re*fe)?Re=R(Re*fe):(Re=Q,Se=!0),te<R(je*fe)?je=R(je*fe):(je=te,Te=!0),_e.drawImage(ve,qe,Xe,Y,U,Ge,re,Re,je),qe=Ge,Xe=re,re+=je;return _e.getImageData(qe,Xe,Q,te)},lanczosResize:function(V,Y,U,Q,te){function se(ue){var he,pe,oe,ne,ge,ye,ke,xe,Fe,Me,ze;for(re.x=(ue+.5)*je,ce.x=R(re.x),he=0;he<te;he++){for(re.y=(he+.5)*He,ce.y=R(re.y),ge=0,ye=0,ke=0,xe=0,Fe=0,pe=ce.x-qe;pe<=ce.x+qe;pe++)if(!(pe<0||pe>=Y)){Me=R(1e3*S(pe-re.x)),Ge[Me]||(Ge[Me]={});for(var we=ce.y-Xe;we<=ce.y+Xe;we++)we<0||we>=U||(ze=R(1e3*S(we-re.y)),Ge[Me][ze]||(Ge[Me][ze]=Re(o(F(Me*ve,2)+F(ze*_e,2))/1e3)),oe=Ge[Me][ze],oe>0&&(ne=(we*Y+pe)*4,ge+=oe,ye+=oe*fe[ne],ke+=oe*fe[ne+1],xe+=oe*fe[ne+2],Fe+=oe*fe[ne+3]))}ne=(he*Q+ue)*4,Te[ne]=ye/ge,Te[ne+1]=ke/ge,Te[ne+2]=xe/ge,Te[ne+3]=Fe/ge}return++ue<Q?se(ue):Se}var fe=V.imageData.data,Se=V.ctx.createImageData(Q,te),Te=Se.data,Re=this.lanczosCreate(this.lanczosLobes),je=this.rcpScaleX,He=this.rcpScaleY,ve=2/this.rcpScaleX,_e=2/this.rcpScaleY,qe=q(je*this.lanczosLobes/2),Xe=q(He*this.lanczosLobes/2),Ge={},re={},ce={};return se(0)},bilinearFiltering:function(V,Y,U,Q,te){var se,fe,Se,Te,Re,je,He,ve,_e,qe,Xe,Ge,re=0,ce,ue=this.rcpScaleX,he=this.rcpScaleY,pe=4*(Y-1),oe=V.imageData,ne=oe.data,ge=V.ctx.createImageData(Q,te),ye=ge.data;for(He=0;He<te;He++)for(ve=0;ve<Q;ve++)for(Re=R(ue*ve),je=R(he*He),_e=ue*ve-Re,qe=he*He-je,ce=4*(je*Y+Re),Xe=0;Xe<4;Xe++)se=ne[ce+Xe],fe=ne[ce+4+Xe],Se=ne[ce+pe+Xe],Te=ne[ce+pe+4+Xe],Ge=se*(1-_e)*(1-qe)+fe*_e*(1-qe)+Se*qe*(1-_e)+Te*_e*qe,ye[re++]=Ge;return ge},hermiteFastResize:function(V,Y,U,Q,te){for(var se=this.rcpScaleX,fe=this.rcpScaleY,Se=q(se/2),Te=q(fe/2),Re=V.imageData,je=Re.data,He=V.ctx.createImageData(Q,te),ve=He.data,_e=0;_e<te;_e++)for(var qe=0;qe<Q;qe++){for(var Xe=(qe+_e*Q)*4,Ge=0,re=0,ce=0,ue=0,he=0,pe=0,oe=0,ne=(_e+.5)*fe,ge=R(_e*fe);ge<(_e+1)*fe;ge++)for(var ye=S(ne-(ge+.5))/Te,ke=(qe+.5)*se,xe=ye*ye,Fe=R(qe*se);Fe<(qe+1)*se;Fe++){var Me=S(ke-(Fe+.5))/Se,ze=o(xe+Me*Me);ze>1&&ze<-1||(Ge=2*ze*ze*ze-3*ze*ze+1,Ge>0&&(Me=4*(Fe+ge*Y),oe+=Ge*je[Me+3],ce+=Ge,je[Me+3]<255&&(Ge=Ge*je[Me+3]/250),ue+=Ge*je[Me],he+=Ge*je[Me+1],pe+=Ge*je[Me+2],re+=Ge))}ve[Xe]=ue/re,ve[Xe+1]=he/re,ve[Xe+2]=pe/re,ve[Xe+3]=oe/ce}return He},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),E.Image.filters.Resize.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Contrast=R(F.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(o){if(this.contrast!==0){var S=o.imageData,l,q,L=S.data,q=L.length,O=Math.floor(this.contrast*255),X=259*(O+255)/(255*(259-O));for(l=0;l<q;l+=4)L[l]=X*(L[l]-128)+128,L[l+1]=X*(L[l+1]-128)+128,L[l+2]=X*(L[l+2]-128)+128}},getUniformLocations:function(o,S){return{uContrast:o.getUniformLocation(S,"uContrast")}},sendUniformData:function(o,S){o.uniform1f(S.uContrast,this.contrast)}}),E.Image.filters.Contrast.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Saturation=R(F.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(o){if(this.saturation!==0){var S=o.imageData,l=S.data,L=l.length,q=-this.saturation,O,X;for(O=0;O<L;O+=4)X=Math.max(l[O],l[O+1],l[O+2]),l[O]+=X!==l[O]?(X-l[O])*q:0,l[O+1]+=X!==l[O+1]?(X-l[O+1])*q:0,l[O+2]+=X!==l[O+2]?(X-l[O+2])*q:0}},getUniformLocations:function(o,S){return{uSaturation:o.getUniformLocation(S,"uSaturation")}},sendUniformData:function(o,S){o.uniform1f(S.uSaturation,-this.saturation)}}),E.Image.filters.Saturation.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Vibrance=R(F.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(o){if(this.vibrance!==0){var S=o.imageData,l=S.data,L=l.length,q=-this.vibrance,O,X,V,Y;for(O=0;O<L;O+=4)X=Math.max(l[O],l[O+1],l[O+2]),V=(l[O]+l[O+1]+l[O+2])/3,Y=Math.abs(X-V)*2/255*q,l[O]+=X!==l[O]?(X-l[O])*Y:0,l[O+1]+=X!==l[O+1]?(X-l[O+1])*Y:0,l[O+2]+=X!==l[O+2]?(X-l[O+2])*Y:0}},getUniformLocations:function(o,S){return{uVibrance:o.getUniformLocation(S,"uVibrance")}},sendUniformData:function(o,S){o.uniform1f(S.uVibrance,-this.vibrance)}}),E.Image.filters.Vibrance.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Blur=R(F.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(o){o.webgl?(this.aspectRatio=o.sourceWidth/o.sourceHeight,o.passes++,this._setupFrameBuffer(o),this.horizontal=!0,this.applyToWebGL(o),this._swapTextures(o),this._setupFrameBuffer(o),this.horizontal=!1,this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},applyTo2d:function(o){o.imageData=this.simpleBlur(o)},simpleBlur:function(o){var S=o.filterBackend.resources,l,L,q=o.imageData.width,O=o.imageData.height;S.blurLayer1||(S.blurLayer1=E.util.createCanvasElement(),S.blurLayer2=E.util.createCanvasElement()),l=S.blurLayer1,L=S.blurLayer2,(l.width!==q||l.height!==O)&&(L.width=l.width=q,L.height=l.height=O);var X=l.getContext("2d"),V=L.getContext("2d"),Y=15,U,Q,te,se,fe=this.blur*.06*.5;for(X.putImageData(o.imageData,0,0),V.clearRect(0,0,q,O),se=-Y;se<=Y;se++)U=(Math.random()-.5)/4,Q=se/Y,te=fe*Q*q+U,V.globalAlpha=1-Math.abs(Q),V.drawImage(l,te,U),X.drawImage(L,0,0),V.globalAlpha=1,V.clearRect(0,0,L.width,L.height);for(se=-Y;se<=Y;se++)U=(Math.random()-.5)/4,Q=se/Y,te=fe*Q*O+U,V.globalAlpha=1-Math.abs(Q),V.drawImage(l,U,te),X.drawImage(L,0,0),V.globalAlpha=1,V.clearRect(0,0,L.width,L.height);o.ctx.drawImage(l,0,0);var Se=o.ctx.getImageData(0,0,l.width,l.height);return X.globalAlpha=1,X.clearRect(0,0,l.width,l.height),Se},getUniformLocations:function(o,S){return{delta:o.getUniformLocation(S,"uDelta")}},sendUniformData:function(o,S){var l=this.chooseRightDelta();o.uniform2fv(S.delta,l)},chooseRightDelta:function(){var o=1,S=[0,0],l;return this.horizontal?this.aspectRatio>1&&(o=1/this.aspectRatio):this.aspectRatio<1&&(o=this.aspectRatio),l=o*this.blur*.12,this.horizontal?S[0]=l:S[1]=l,S}}),F.Blur.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Gamma=R(F.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(o){this.gamma=[1,1,1],F.BaseFilter.prototype.initialize.call(this,o)},applyTo2d:function(o){var S=o.imageData,l=S.data,L=this.gamma,q=l.length,O=1/L[0],X=1/L[1],V=1/L[2],Y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),Y=0,q=256;Y<q;Y++)this.rVals[Y]=Math.pow(Y/255,O)*255,this.gVals[Y]=Math.pow(Y/255,X)*255,this.bVals[Y]=Math.pow(Y/255,V)*255;for(Y=0,q=l.length;Y<q;Y+=4)l[Y]=this.rVals[l[Y]],l[Y+1]=this.gVals[l[Y+1]],l[Y+2]=this.bVals[l[Y+2]]},getUniformLocations:function(o,S){return{uGamma:o.getUniformLocation(S,"uGamma")}},sendUniformData:function(o,S){o.uniform3fv(S.uGamma,this.gamma)}}),E.Image.filters.Gamma.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.Composed=R(F.BaseFilter,{type:"Composed",subFilters:[],initialize:function(o){this.callSuper("initialize",o),this.subFilters=this.subFilters.slice(0)},applyTo:function(o){o.passes+=this.subFilters.length-1,this.subFilters.forEach(function(S){S.applyTo(o)})},toObject:function(){return E.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(o){return o.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(o){return!o.isNeutralState()})}}),E.Image.filters.Composed.fromObject=function(o,S){var l=o.subFilters||[],L=l.map(function(O){return new E.Image.filters[O.type](O)}),q=new E.Image.filters.Composed({subFilters:L});return S&&S(q),q}}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.Image.filters,R=E.util.createClass;F.HueRotation=R(F.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var o=this.rotation*Math.PI,S=E.util.cos(o),l=E.util.sin(o),L=1/3,q=Math.sqrt(L)*l,O=1-S;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=S+O/3,this.matrix[1]=L*O-q,this.matrix[2]=L*O+q,this.matrix[5]=L*O+q,this.matrix[6]=S+L*O,this.matrix[7]=L*O-q,this.matrix[10]=L*O-q,this.matrix[11]=L*O+q,this.matrix[12]=S+L*O},isNeutralState:function(o){return this.calculateMatrix(),F.BaseFilter.prototype.isNeutralState.call(this,o)},applyTo:function(o){this.calculateMatrix(),F.BaseFilter.prototype.applyTo.call(this,o)}}),E.Image.filters.HueRotation.fromObject=E.Image.filters.BaseFilter.fromObject}(B),function(M){var E=M.fabric||(M.fabric={}),F=E.util.object.clone;if(E.Text){E.warn("fabric.Text is already defined");return}var R="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");E.Text=E.util.createClass(E.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:E.Object.prototype.stateProperties.concat(R),cacheProperties:E.Object.prototype.cacheProperties.concat(R),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(o,S){this.styles=S?S.styles||{}:{},this.text=o,this.__skipDimension=!0,this.callSuper("initialize",S),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var o=this.path;o&&(o.segmentsInfo=E.util.getPathSegmentsInfo(o.path))},getMeasuringContext:function(){return E._measuringContext||(E._measuringContext=this.canvas&&this.canvas.contextCache||E.util.createCanvasElement().getContext("2d")),E._measuringContext},_splitText:function(){var o=this._splitTextIntoLines(this.text);return this.textLines=o.lines,this._textLines=o.graphemeLines,this._unwrappedTextLines=o._unwrappedLines,this._text=o.graphemeText,o},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var o,S,l,L,q,O,X,V=0,Y=this._textLines.length;V<Y;V++)if(!(this.textAlign!=="justify"&&(V===Y-1||this.isEndOfWrapping(V)))&&(L=0,q=this._textLines[V],S=this.getLineWidth(V),S<this.width&&(X=this.textLines[V].match(this._reSpacesAndTabs)))){l=X.length,o=(this.width-S)/l;for(var U=0,Q=q.length;U<=Q;U++)O=this.__charBounds[V][U],this._reSpaceAndTab.test(q[U])?(O.width+=o,O.kernedWidth+=o,O.left+=L,L+=o):O.left+=L}},isEndOfWrapping:function(o){return o===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var o=this.callSuper("_getCacheCanvasDimensions"),S=this.fontSize;return o.width+=S*o.zoomX,o.height+=S*o.zoomY,o},_render:function(o){var S=this.path;S&&!S.isNotVisible()&&S._render(o),this._setTextStyles(o),this._renderTextLinesBackground(o),this._renderTextDecoration(o,"underline"),this._renderText(o),this._renderTextDecoration(o,"overline"),this._renderTextDecoration(o,"linethrough")},_renderText:function(o){this.paintFirst==="stroke"?(this._renderTextStroke(o),this._renderTextFill(o)):(this._renderTextFill(o),this._renderTextStroke(o))},_setTextStyles:function(o,S,l){if(o.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":o.textBaseline="middle";break;case"ascender":o.textBaseline="top";break;case"descender":o.textBaseline="bottom";break}o.font=this._getFontDeclaration(S,l)},calcTextWidth:function(){for(var o=this.getLineWidth(0),S=1,l=this._textLines.length;S<l;S++){var L=this.getLineWidth(S);L>o&&(o=L)}return o},_renderTextLine:function(o,S,l,L,q,O){this._renderChars(o,S,l,L,q,O)},_renderTextLinesBackground:function(o){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var S,l,L=o.fillStyle,q,O,X=this._getLeftOffset(),V=this._getTopOffset(),Y=0,U=0,Q,te,se=this.path,fe,Se=0,Te=this._textLines.length;Se<Te;Se++){if(S=this.getHeightOfLine(Se),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",Se)){V+=S;continue}q=this._textLines[Se],l=this._getLineLeftOffset(Se),U=0,Y=0,O=this.getValueOfPropertyAt(Se,0,"textBackgroundColor");for(var Re=0,je=q.length;Re<je;Re++)Q=this.__charBounds[Se][Re],te=this.getValueOfPropertyAt(Se,Re,"textBackgroundColor"),se?(o.save(),o.translate(Q.renderLeft,Q.renderTop),o.rotate(Q.angle),o.fillStyle=te,te&&o.fillRect(-Q.width/2,-S/this.lineHeight*(1-this._fontSizeFraction),Q.width,S/this.lineHeight),o.restore()):te!==O?(fe=X+l+Y,this.direction==="rtl"&&(fe=this.width-fe-U),o.fillStyle=O,O&&o.fillRect(fe,V,U,S/this.lineHeight),Y=Q.left,U=Q.width,O=te):U+=Q.kernedWidth;te&&!se&&(fe=X+l+Y,this.direction==="rtl"&&(fe=this.width-fe-U),o.fillStyle=te,o.fillRect(fe,V,U,S/this.lineHeight)),V+=S}o.fillStyle=L,this._removeShadow(o)}},getFontCache:function(o){var S=o.fontFamily.toLowerCase();E.charWidthsCache[S]||(E.charWidthsCache[S]={});var l=E.charWidthsCache[S],L=o.fontStyle.toLowerCase()+"_"+(o.fontWeight+"").toLowerCase();return l[L]||(l[L]={}),l[L]},_measureChar:function(o,S,l,L){var q=this.getFontCache(S),O=this._getFontDeclaration(S),X=this._getFontDeclaration(L),V=l+o,Y=O===X,U,Q,te,se=S.fontSize/this.CACHE_FONT_SIZE,fe;if(l&&q[l]!==void 0&&(te=q[l]),q[o]!==void 0&&(fe=U=q[o]),Y&&q[V]!==void 0&&(Q=q[V],fe=Q-te),U===void 0||te===void 0||Q===void 0){var Se=this.getMeasuringContext();this._setTextStyles(Se,S,!0)}return U===void 0&&(fe=U=Se.measureText(o).width,q[o]=U),te===void 0&&Y&&l&&(te=Se.measureText(l).width,q[l]=te),Y&&Q===void 0&&(Q=Se.measureText(V).width,q[V]=Q,fe=Q-te),{width:U*se,kernedWidth:fe*se}},getHeightOfChar:function(o,S){return this.getValueOfPropertyAt(o,S,"fontSize")},measureLine:function(o){var S=this._measureLine(o);return this.charSpacing!==0&&(S.width-=this._getWidthOfCharSpacing()),S.width<0&&(S.width=0),S},_measureLine:function(o){var S=0,l,L,q=this._textLines[o],O,X,V=0,Y=new Array(q.length),U=0,Q,te,se=this.path,fe=this.pathSide==="right";for(this.__charBounds[o]=Y,l=0;l<q.length;l++)L=q[l],X=this._getGraphemeBox(L,o,l,O),Y[l]=X,S+=X.kernedWidth,O=L;if(Y[l]={left:X?X.left+X.width:0,width:0,kernedWidth:0,height:this.fontSize},se){switch(te=se.segmentsInfo[se.segmentsInfo.length-1].length,Q=E.util.getPointOnPath(se.path,0,se.segmentsInfo),Q.x+=se.pathOffset.x,Q.y+=se.pathOffset.y,this.textAlign){case"left":U=fe?te-S:0;break;case"center":U=(te-S)/2;break;case"right":U=fe?0:te-S;break}for(U+=this.pathStartOffset*(fe?-1:1),l=fe?q.length-1:0;fe?l>=0:l<q.length;fe?l--:l++)X=Y[l],U>te?U%=te:U<0&&(U+=te),this._setGraphemeOnPath(U,X,Q),U+=X.kernedWidth}return{width:S,numOfSpaces:V}},_setGraphemeOnPath:function(o,S,l){var L=o+S.kernedWidth/2,q=this.path,O=E.util.getPointOnPath(q.path,L,q.segmentsInfo);S.renderLeft=O.x-l.x,S.renderTop=O.y-l.y,S.angle=O.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(o,S,l,L,q){var O=this.getCompleteStyleDeclaration(S,l),X=L?this.getCompleteStyleDeclaration(S,l-1):{},V=this._measureChar(o,O,L,X),Y=V.kernedWidth,U=V.width,Q;this.charSpacing!==0&&(Q=this._getWidthOfCharSpacing(),U+=Q,Y+=Q);var te={width:U,left:0,height:O.fontSize,kernedWidth:Y,deltaY:O.deltaY};if(l>0&&!q){var se=this.__charBounds[S][l-1];te.left=se.left+se.width+V.kernedWidth-V.width}return te},getHeightOfLine:function(o){if(this.__lineHeights[o])return this.__lineHeights[o];for(var S=this._textLines[o],l=this.getHeightOfChar(o,0),L=1,q=S.length;L<q;L++)l=Math.max(this.getHeightOfChar(o,L),l);return this.__lineHeights[o]=l*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var o,S=0,l=0,L=this._textLines.length;l<L;l++)o=this.getHeightOfLine(l),S+=l===L-1?o/this.lineHeight:o;return S},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(o,S){o.save();for(var l=0,L=this._getLeftOffset(),q=this._getTopOffset(),O=0,X=this._textLines.length;O<X;O++){var V=this.getHeightOfLine(O),Y=V/this.lineHeight,U=this._getLineLeftOffset(O);this._renderTextLine(S,o,this._textLines[O],L+U,q+l+Y,O),l+=V}o.restore()},_renderTextFill:function(o){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(o,"fillText")},_renderTextStroke:function(o){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(o),o.save(),this._setLineDash(o,this.strokeDashArray),o.beginPath(),this._renderTextCommon(o,"strokeText"),o.closePath(),o.restore())},_renderChars:function(o,S,l,L,q,O){var X=this.getHeightOfLine(O),V=this.textAlign.indexOf("justify")!==-1,Y,U,Q="",te,se=0,fe,Se=this.path,Te=!V&&this.charSpacing===0&&this.isEmptyStyles(O)&&!Se,Re=this.direction==="ltr",je=this.direction==="ltr"?1:-1,He,ve=S.canvas.getAttribute("dir");if(S.save(),ve!==this.direction&&(S.canvas.setAttribute("dir",Re?"ltr":"rtl"),S.direction=Re?"ltr":"rtl",S.textAlign=Re?"left":"right"),q-=X*this._fontSizeFraction/this.lineHeight,Te){this._renderChar(o,S,O,0,l.join(""),L,q,X),S.restore();return}for(var _e=0,qe=l.length-1;_e<=qe;_e++)fe=_e===qe||this.charSpacing||Se,Q+=l[_e],te=this.__charBounds[O][_e],se===0?(L+=je*(te.kernedWidth-te.width),se+=te.width):se+=te.kernedWidth,V&&!fe&&this._reSpaceAndTab.test(l[_e])&&(fe=!0),fe||(Y=Y||this.getCompleteStyleDeclaration(O,_e),U=this.getCompleteStyleDeclaration(O,_e+1),fe=E.util.hasStyleChanged(Y,U,!1)),fe&&(Se?(S.save(),S.translate(te.renderLeft,te.renderTop),S.rotate(te.angle),this._renderChar(o,S,O,_e,Q,-se/2,0,X),S.restore()):(He=L,this._renderChar(o,S,O,_e,Q,He,q,X)),Q="",Y=U,L+=je*se,se=0);S.restore()},_applyPatternGradientTransformText:function(o){var S=E.util.createCanvasElement(),l,L=this.width+this.strokeWidth,q=this.height+this.strokeWidth;return S.width=L,S.height=q,l=S.getContext("2d"),l.beginPath(),l.moveTo(0,0),l.lineTo(L,0),l.lineTo(L,q),l.lineTo(0,q),l.closePath(),l.translate(L/2,q/2),l.fillStyle=o.toLive(l),this._applyPatternGradientTransform(l,o),l.fill(),l.createPattern(S,"no-repeat")},handleFiller:function(o,S,l){var L,q;return l.toLive?l.gradientUnits==="percentage"||l.gradientTransform||l.patternTransform?(L=-this.width/2,q=-this.height/2,o.translate(L,q),o[S]=this._applyPatternGradientTransformText(l),{offsetX:L,offsetY:q}):(o[S]=l.toLive(o,this),this._applyPatternGradientTransform(o,l)):(o[S]=l,{offsetX:0,offsetY:0})},_setStrokeStyles:function(o,S){return o.lineWidth=S.strokeWidth,o.lineCap=this.strokeLineCap,o.lineDashOffset=this.strokeDashOffset,o.lineJoin=this.strokeLineJoin,o.miterLimit=this.strokeMiterLimit,this.handleFiller(o,"strokeStyle",S.stroke)},_setFillStyles:function(o,S){return this.handleFiller(o,"fillStyle",S.fill)},_renderChar:function(o,S,l,L,q,O,X){var V=this._getStyleDeclaration(l,L),Y=this.getCompleteStyleDeclaration(l,L),U=o==="fillText"&&Y.fill,Q=o==="strokeText"&&Y.stroke&&Y.strokeWidth,te,se;!Q&&!U||(S.save(),U&&(te=this._setFillStyles(S,Y)),Q&&(se=this._setStrokeStyles(S,Y)),S.font=this._getFontDeclaration(Y),V&&V.textBackgroundColor&&this._removeShadow(S),V&&V.deltaY&&(X+=V.deltaY),U&&S.fillText(q,O-te.offsetX,X-te.offsetY),Q&&S.strokeText(q,O-se.offsetX,X-se.offsetY),S.restore())},setSuperscript:function(o,S){return this._setScript(o,S,this.superscript)},setSubscript:function(o,S){return this._setScript(o,S,this.subscript)},_setScript:function(o,S,l){var L=this.get2DCursorLocation(o,!0),q=this.getValueOfPropertyAt(L.lineIndex,L.charIndex,"fontSize"),O=this.getValueOfPropertyAt(L.lineIndex,L.charIndex,"deltaY"),X={fontSize:q*l.size,deltaY:O+q*l.baseline};return this.setSelectionStyles(X,o,S),this},_getLineLeftOffset:function(o){var S=this.getLineWidth(o),l=this.width-S,L=this.textAlign,q=this.direction,X,O=0,X=this.isEndOfWrapping(o);return L==="justify"||L==="justify-center"&&!X||L==="justify-right"&&!X||L==="justify-left"&&!X?0:(L==="center"&&(O=l/2),L==="right"&&(O=l),L==="justify-center"&&(O=l/2),L==="justify-right"&&(O=l),q==="rtl"&&(O-=l),O)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var o=this._forceClearCache;return o||(o=this.hasStateChanged("_dimensionAffectingProps")),o&&(this.dirty=!0,this._forceClearCache=!1),o},getLineWidth:function(o){if(this.__lineWidths[o]!==void 0)return this.__lineWidths[o];var S=this.measureLine(o),l=S.width;return this.__lineWidths[o]=l,l},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(o,S,l){var L=this._getStyleDeclaration(o,S);return L&&typeof L[l]<"u"?L[l]:this[l]},_renderTextDecoration:function(o,S){if(!(!this[S]&&!this.styleHas(S))){o.save(),(S==="overline"||S==="linethrough")&&this._removeShadow(o);for(var l,L,q,O,X,V,Y,U,Q=this._getLeftOffset(),te=this._getTopOffset(),se,fe,Se,Te,Re,je,He,ve,_e=this.path,qe=this._getWidthOfCharSpacing(),Xe=this.offsets[S],Ge=0,re=this._textLines.length;Ge<re;Ge++){if(l=this.getHeightOfLine(Ge),!this[S]&&!this.styleHas(S,Ge)){te+=l;continue}Y=this._textLines[Ge],je=l/this.lineHeight,O=this._getLineLeftOffset(Ge),fe=0,Se=0,U=this.getValueOfPropertyAt(Ge,0,S),ve=this.getValueOfPropertyAt(Ge,0,"fill"),se=te+je*(1-this._fontSizeFraction),L=this.getHeightOfChar(Ge,0),X=this.getValueOfPropertyAt(Ge,0,"deltaY");for(var ce=0,ue=Y.length;ce<ue;ce++)if(Te=this.__charBounds[Ge][ce],Re=this.getValueOfPropertyAt(Ge,ce,S),He=this.getValueOfPropertyAt(Ge,ce,"fill"),q=this.getHeightOfChar(Ge,ce),V=this.getValueOfPropertyAt(Ge,ce,"deltaY"),_e&&Re&&He)o.save(),o.fillStyle=ve,o.translate(Te.renderLeft,Te.renderTop),o.rotate(Te.angle),o.fillRect(-Te.kernedWidth/2,Xe*q+V,Te.kernedWidth,this.fontSize/15),o.restore();else if((Re!==U||He!==ve||q!==L||V!==X)&&Se>0){var he=Q+O+fe;this.direction==="rtl"&&(he=this.width-he-Se),U&&ve&&(o.fillStyle=ve,o.fillRect(he,se+Xe*L+X,Se,this.fontSize/15)),fe=Te.left,Se=Te.width,U=Re,ve=He,L=q,X=V}else Se+=Te.kernedWidth;var he=Q+O+fe;this.direction==="rtl"&&(he=this.width-he-Se),o.fillStyle=He,Re&&He&&o.fillRect(he,se+Xe*L+X,Se-qe,this.fontSize/15),te+=l}o.restore()}},_getFontDeclaration:function(o,S){var l=o||this,L=this.fontFamily,q=E.Text.genericFonts.indexOf(L.toLowerCase())>-1,O=L===void 0||L.indexOf("'")>-1||L.indexOf(",")>-1||L.indexOf('"')>-1||q?l.fontFamily:'"'+l.fontFamily+'"';return[E.isLikelyNode?l.fontWeight:l.fontStyle,E.isLikelyNode?l.fontStyle:l.fontWeight,S?this.CACHE_FONT_SIZE+"px":l.fontSize+"px",O].join(" ")},render:function(o){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",o)))},_splitTextIntoLines:function(o){for(var S=o.split(this._reNewline),l=new Array(S.length),L=[`
`],q=[],O=0;O<S.length;O++)l[O]=E.util.string.graphemeSplit(S[O]),q=q.concat(l[O],L);return q.pop(),{_unwrappedLines:l,lines:S,graphemeText:q,graphemeLines:l}},toObject:function(o){var S=R.concat(o),l=this.callSuper("toObject",S);return l.styles=E.util.stylesToArray(this.styles,this.text),l.path&&(l.path=this.path.toObject()),l},set:function(o,S){this.callSuper("set",o,S);var l=!1,L=!1;if(typeof o=="object")for(var q in o)q==="path"&&this.setPathInfo(),l=l||this._dimensionAffectingProps.indexOf(q)!==-1,L=L||q==="path";else l=this._dimensionAffectingProps.indexOf(o)!==-1,L=o==="path";return L&&this.setPathInfo(),l&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),E.Text.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),E.Text.DEFAULT_SVG_FONT_SIZE=16,E.Text.fromElement=function(o,S,l){if(!o)return S(null);var L=E.parseAttributes(o,E.Text.ATTRIBUTE_NAMES),q=L.textAnchor||"left";if(l=E.util.object.extend(l?F(l):{},L),l.top=l.top||0,l.left=l.left||0,L.textDecoration){var O=L.textDecoration;O.indexOf("underline")!==-1&&(l.underline=!0),O.indexOf("overline")!==-1&&(l.overline=!0),O.indexOf("line-through")!==-1&&(l.linethrough=!0),delete l.textDecoration}"dx"in L&&(l.left+=L.dx),"dy"in L&&(l.top+=L.dy),"fontSize"in l||(l.fontSize=E.Text.DEFAULT_SVG_FONT_SIZE);var X="";"textContent"in o?X=o.textContent:"firstChild"in o&&o.firstChild!==null&&"data"in o.firstChild&&o.firstChild.data!==null&&(X=o.firstChild.data),X=X.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var V=l.strokeWidth;l.strokeWidth=0;var Y=new E.Text(X,l),U=Y.getScaledHeight()/Y.height,Q=(Y.height+Y.strokeWidth)*Y.lineHeight-Y.height,te=Q*U,se=Y.getScaledHeight()+te,fe=0;q==="center"&&(fe=Y.getScaledWidth()/2),q==="right"&&(fe=Y.getScaledWidth()),Y.set({left:Y.left-fe,top:Y.top-(se-Y.fontSize*(.07+Y._fontSizeFraction))/Y.lineHeight,strokeWidth:typeof V<"u"?V:1}),S(Y)},E.Text.fromObject=function(o,S){var l=F(o),L=o.path;return delete l.path,E.Object._fromObject("Text",l,function(q){q.styles=E.util.stylesFromArray(o.styles,o.text),L?E.Object._fromObject("Path",L,function(O){q.set("path",O),S(q)},"path"):S(q)},"text")},E.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],E.util.createAccessors&&E.util.createAccessors(E.Text)}(B),function(){p.util.object.extend(p.Text.prototype,{isEmptyStyles:function(M){if(!this.styles||typeof M<"u"&&!this.styles[M])return!0;var E=typeof M>"u"?this.styles:{line:this.styles[M]};for(var F in E)for(var R in E[F])for(var o in E[F][R])return!1;return!0},styleHas:function(M,E){if(!this.styles||!M||M===""||typeof E<"u"&&!this.styles[E])return!1;var F=typeof E>"u"?this.styles:{0:this.styles[E]};for(var R in F)for(var o in F[R])if(typeof F[R][o][M]<"u")return!0;return!1},cleanStyle:function(M){if(!this.styles||!M||M==="")return!1;var E=this.styles,F=0,R,o,S=!0,l=0,L;for(var q in E){R=0;for(var O in E[q]){var L=E[q][O],X=L.hasOwnProperty(M);F++,X?(o?L[M]!==o&&(S=!1):o=L[M],L[M]===this[M]&&delete L[M]):S=!1,Object.keys(L).length!==0?R++:delete E[q][O]}R===0&&delete E[q]}for(var V=0;V<this._textLines.length;V++)l+=this._textLines[V].length;S&&F===l&&(this[M]=o,this.removeStyle(M))},removeStyle:function(M){if(!(!this.styles||!M||M==="")){var E=this.styles,F,R,o;for(R in E){F=E[R];for(o in F)delete F[o][M],Object.keys(F[o]).length===0&&delete F[o];Object.keys(F).length===0&&delete E[R]}}},_extendStyles:function(M,E){var F=this.get2DCursorLocation(M);this._getLineStyle(F.lineIndex)||this._setLineStyle(F.lineIndex),this._getStyleDeclaration(F.lineIndex,F.charIndex)||this._setStyleDeclaration(F.lineIndex,F.charIndex,{}),p.util.object.extend(this._getStyleDeclaration(F.lineIndex,F.charIndex),E)},get2DCursorLocation:function(M,E){typeof M>"u"&&(M=this.selectionStart);for(var F=E?this._unwrappedTextLines:this._textLines,R=F.length,o=0;o<R;o++){if(M<=F[o].length)return{lineIndex:o,charIndex:M};M-=F[o].length+this.missingNewlineOffset(o,E)}return{lineIndex:o-1,charIndex:F[o-1].length<M?F[o-1].length:M}},getSelectionStyles:function(M,E,F){typeof M>"u"&&(M=this.selectionStart||0),typeof E>"u"&&(E=this.selectionEnd||M);for(var R=[],o=M;o<E;o++)R.push(this.getStyleAtPosition(o,F));return R},getStyleAtPosition:function(M,E){var F=this.get2DCursorLocation(M),R=E?this.getCompleteStyleDeclaration(F.lineIndex,F.charIndex):this._getStyleDeclaration(F.lineIndex,F.charIndex);return R||{}},setSelectionStyles:function(M,E,F){typeof E>"u"&&(E=this.selectionStart||0),typeof F>"u"&&(F=this.selectionEnd||E);for(var R=E;R<F;R++)this._extendStyles(R,M);return this._forceClearCache=!0,this},_getStyleDeclaration:function(M,E){var F=this.styles&&this.styles[M];return F?F[E]:null},getCompleteStyleDeclaration:function(M,E){for(var F=this._getStyleDeclaration(M,E)||{},R={},o,S=0;S<this._styleProperties.length;S++)o=this._styleProperties[S],R[o]=typeof F[o]>"u"?this[o]:F[o];return R},_setStyleDeclaration:function(M,E,F){this.styles[M][E]=F},_deleteStyleDeclaration:function(M,E){delete this.styles[M][E]},_getLineStyle:function(M){return!!this.styles[M]},_setLineStyle:function(M){this.styles[M]={}},_deleteLineStyle:function(M){delete this.styles[M]}})}(),function(){function M(E){E.textDecoration&&(E.textDecoration.indexOf("underline")>-1&&(E.underline=!0),E.textDecoration.indexOf("line-through")>-1&&(E.linethrough=!0),E.textDecoration.indexOf("overline")>-1&&(E.overline=!0),delete E.textDecoration)}p.IText=p.util.createClass(p.Text,p.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(E,F){this.callSuper("initialize",E,F),this.initBehavior()},setSelectionStart:function(E){E=Math.max(E,0),this._updateAndFire("selectionStart",E)},setSelectionEnd:function(E){E=Math.min(E,this.text.length),this._updateAndFire("selectionEnd",E)},_updateAndFire:function(E,F){this[E]!==F&&(this._fireSelectionChanged(),this[E]=F),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(E){this.clearContextTop(),this.callSuper("render",E),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(E){this.callSuper("_render",E)},clearContextTop:function(E){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var F=this.canvas.contextTop,R=this.canvas.viewportTransform;F.save(),F.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this.transform(F),this._clearTextArea(F),E||F.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var E=this._getCursorBoundaries(),F=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(E,F):this.renderSelection(E,F),F.restore()}},_clearTextArea:function(E){var F=this.width+4,R=this.height+4;E.clearRect(-F/2,-R/2,F,R)},_getCursorBoundaries:function(E){typeof E>"u"&&(E=this.selectionStart);var F=this._getLeftOffset(),R=this._getTopOffset(),o=this._getCursorBoundariesOffsets(E);return{left:F,top:R,leftOffset:o.left,topOffset:o.top}},_getCursorBoundariesOffsets:function(E){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var F,R,o,S=0,l=0,L,q=this.get2DCursorLocation(E);o=q.charIndex,R=q.lineIndex;for(var O=0;O<R;O++)S+=this.getHeightOfLine(O);F=this._getLineLeftOffset(R);var X=this.__charBounds[R][o];return X&&(l=X.left),this.charSpacing!==0&&o===this._textLines[R].length&&(l-=this._getWidthOfCharSpacing()),L={top:S,left:F+(l>0?l:0)},this.direction==="rtl"&&(L.left*=-1),this.cursorOffsetCache=L,this.cursorOffsetCache},renderCursor:function(E,F){var R=this.get2DCursorLocation(),o=R.lineIndex,S=R.charIndex>0?R.charIndex-1:0,l=this.getValueOfPropertyAt(o,S,"fontSize"),L=this.scaleX*this.canvas.getZoom(),q=this.cursorWidth/L,O=E.topOffset,X=this.getValueOfPropertyAt(o,S,"deltaY");O+=(1-this._fontSizeFraction)*this.getHeightOfLine(o)/this.lineHeight-l*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(E,F),F.fillStyle=this.cursorColor||this.getValueOfPropertyAt(o,S,"fill"),F.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,F.fillRect(E.left+E.leftOffset-q/2,O+E.top+X,q,l)},renderSelection:function(E,F){for(var R=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,o=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,S=this.textAlign.indexOf("justify")!==-1,l=this.get2DCursorLocation(R),L=this.get2DCursorLocation(o),q=l.lineIndex,O=L.lineIndex,X=l.charIndex<0?0:l.charIndex,V=L.charIndex<0?0:L.charIndex,Y=q;Y<=O;Y++){var U=this._getLineLeftOffset(Y)||0,Q=this.getHeightOfLine(Y),te=0,se=0,fe=0;if(Y===q&&(se=this.__charBounds[q][X].left),Y>=q&&Y<O)fe=S&&!this.isEndOfWrapping(Y)?this.width:this.getLineWidth(Y)||5;else if(Y===O)if(V===0)fe=this.__charBounds[O][V].left;else{var Se=this._getWidthOfCharSpacing();fe=this.__charBounds[O][V-1].left+this.__charBounds[O][V-1].width-Se}te=Q,(this.lineHeight<1||Y===O&&this.lineHeight>1)&&(Q/=this.lineHeight);var Te=E.left+U+se,Re=fe-se,je=Q,He=0;this.inCompositionMode?(F.fillStyle=this.compositionColor||"black",je=1,He=Q):F.fillStyle=this.selectionColor,this.direction==="rtl"&&(Te=this.width-Te-Re),F.fillRect(Te,E.top+E.topOffset+He,Re,je),E.topOffset+=te}},getCurrentCharFontSize:function(){var E=this._getCurrentCharIndex();return this.getValueOfPropertyAt(E.l,E.c,"fontSize")},getCurrentCharColor:function(){var E=this._getCurrentCharIndex();return this.getValueOfPropertyAt(E.l,E.c,"fill")},_getCurrentCharIndex:function(){var E=this.get2DCursorLocation(this.selectionStart,!0),F=E.charIndex>0?E.charIndex-1:0;return{l:E.lineIndex,c:F}}}),p.IText.fromObject=function(E,F){var R=p.util.stylesFromArray(E.styles,E.text),o=Object.assign({},E,{styles:R});if(delete o.path,M(o),o.styles)for(var S in o.styles)for(var l in o.styles[S])M(o.styles[S][l]);p.Object._fromObject("IText",o,function(L){E.path?p.Object._fromObject("Path",E.path,function(q){L.set("path",q),F(L)},"path"):F(L)},"text")}}(),function(){var M=p.util.object.clone;p.util.object.extend(p.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var E=this;this.on("added",function(){var F=E.canvas;F&&(F._hasITextHandlers||(F._hasITextHandlers=!0,E._initCanvasHandlers(F)),F._iTextInstances=F._iTextInstances||[],F._iTextInstances.push(E))})},initRemovedHandler:function(){var E=this;this.on("removed",function(){var F=E.canvas;F&&(F._iTextInstances=F._iTextInstances||[],p.util.removeFromArray(F._iTextInstances,E),F._iTextInstances.length===0&&(F._hasITextHandlers=!1,E._removeCanvasHandlers(F)))})},_initCanvasHandlers:function(E){E._mouseUpITextHandler=function(){E._iTextInstances&&E._iTextInstances.forEach(function(F){F.__isMousedown=!1})},E.on("mouse:up",E._mouseUpITextHandler)},_removeCanvasHandlers:function(E){E.off("mouse:up",E._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(E,F,R,o){var S;return S={isAborted:!1,abort:function(){this.isAborted=!0}},E.animate("_currentCursorOpacity",F,{duration:R,onComplete:function(){S.isAborted||E[o]()},onChange:function(){E.canvas&&E.selectionStart===E.selectionEnd&&E.renderCursorOrSelection()},abort:function(){return S.isAborted}}),S},_onTickComplete:function(){var E=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){E._currentTickCompleteState=E._animateCursor(E,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(E){var F=this,R=E?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){F._tick()},R)},abortCursorAnimation:function(){var E=this._currentTickState||this._currentTickCompleteState,F=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,E&&F&&F.clearContext(F.contextTop||F.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(E){var F=0,R=E-1;if(this._reSpace.test(this._text[R]))for(;this._reSpace.test(this._text[R]);)F++,R--;for(;/\S/.test(this._text[R])&&R>-1;)F++,R--;return E-F},findWordBoundaryRight:function(E){var F=0,R=E;if(this._reSpace.test(this._text[R]))for(;this._reSpace.test(this._text[R]);)F++,R++;for(;/\S/.test(this._text[R])&&R<this._text.length;)F++,R++;return E+F},findLineBoundaryLeft:function(E){for(var F=0,R=E-1;!/\n/.test(this._text[R])&&R>-1;)F++,R--;return E-F},findLineBoundaryRight:function(E){for(var F=0,R=E;!/\n/.test(this._text[R])&&R<this._text.length;)F++,R++;return E+F},searchWordBoundary:function(E,F){for(var R=this._text,o=this._reSpace.test(R[E])?E-1:E,S=R[o],l=p.reNonWord;!l.test(S)&&o>0&&o<R.length;)o+=F,S=R[o];return l.test(S)&&(o+=F===1?0:1),o},selectWord:function(E){E=E||this.selectionStart;var F=this.searchWordBoundary(E,-1),R=this.searchWordBoundary(E,1);this.selectionStart=F,this.selectionEnd=R,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(E){E=E||this.selectionStart;var F=this.findLineBoundaryLeft(E),R=this.findLineBoundaryRight(E);return this.selectionStart=F,this.selectionEnd=R,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(E){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(E),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(E){E._iTextInstances&&E._iTextInstances.forEach(function(F){F.selected=!1,F.isEditing&&F.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(E){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var F=this.getSelectionStartFromPointer(E.e),R=this.selectionStart,o=this.selectionEnd;(F!==this.__selectionStartOnMouseDown||R===o)&&(R===F||o===F)||(F>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=F):(this.selectionStart=F,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==R||this.selectionEnd!==o)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(E,F,R){var o=R.slice(0,E),S=p.util.string.graphemeSplit(o).length;if(E===F)return{selectionStart:S,selectionEnd:S};var l=R.slice(E,F),L=p.util.string.graphemeSplit(l).length;return{selectionStart:S,selectionEnd:S+L}},fromGraphemeToStringSelection:function(E,F,R){var o=R.slice(0,E),S=o.join("").length;if(E===F)return{selectionStart:S,selectionEnd:S};var l=R.slice(E,F),L=l.join("").length;return{selectionStart:S,selectionEnd:S+L}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var E=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=E.selectionStart,this.hiddenTextarea.selectionEnd=E.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var E=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=E.selectionEnd,this.inCompositionMode||(this.selectionStart=E.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var E=this._calcTextareaPosition();this.hiddenTextarea.style.left=E.left,this.hiddenTextarea.style.top=E.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var E=this.inCompositionMode?this.compositionStart:this.selectionStart,F=this._getCursorBoundaries(E),R=this.get2DCursorLocation(E),o=R.lineIndex,S=R.charIndex,l=this.getValueOfPropertyAt(o,S,"fontSize")*this.lineHeight,L=F.leftOffset,q=this.calcTransformMatrix(),O={x:F.left+L,y:F.top+F.topOffset+l},X=this.canvas.getRetinaScaling(),V=this.canvas.upperCanvasEl,Y=V.width/X,U=V.height/X,Q=Y-l,te=U-l,se=V.clientWidth/Y,fe=V.clientHeight/U;return O=p.util.transformPoint(O,q),O=p.util.transformPoint(O,this.canvas.viewportTransform),O.x*=se,O.y*=fe,O.x<0&&(O.x=0),O.x>Q&&(O.x=Q),O.y<0&&(O.y=0),O.y>te&&(O.y=te),O.x+=this.canvas._offset.left,O.y+=this.canvas._offset.top,{left:O.x+"px",top:O.y+"px",fontSize:l+"px",charHeight:l}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var E=this._textBeforeEdit!==this.text,F=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,F&&(F.blur&&F.blur(),F.parentNode&&F.parentNode.removeChild(F)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),E&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),E&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var E in this.styles)this._textLines[E]||delete this.styles[E]},removeStyleFromTo:function(E,F){var R=this.get2DCursorLocation(E,!0),o=this.get2DCursorLocation(F,!0),S=R.lineIndex,l=R.charIndex,L=o.lineIndex,q=o.charIndex,O,X;if(S!==L){if(this.styles[S])for(O=l;O<this._unwrappedTextLines[S].length;O++)delete this.styles[S][O];if(this.styles[L])for(O=q;O<this._unwrappedTextLines[L].length;O++)X=this.styles[L][O],X&&(this.styles[S]||(this.styles[S]={}),this.styles[S][l+O-q]=X);for(O=S+1;O<=L;O++)delete this.styles[O];this.shiftLineStyles(L,S-L)}else if(this.styles[S]){X=this.styles[S];var V=q-l,Y,U;for(O=l;O<q;O++)delete X[O];for(U in this.styles[S])Y=parseInt(U,10),Y>=q&&(X[Y-V]=X[U],delete X[U])}},shiftLineStyles:function(E,F){var R=M(this.styles);for(var o in this.styles){var S=parseInt(o,10);S>E&&(this.styles[S+F]=R[S],R[S-F]||delete this.styles[S])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(E,F,R,o){var S,l={},L=!1,q=this._unwrappedTextLines[E].length,O=q===F;R||(R=1),this.shiftLineStyles(E,R),this.styles[E]&&(S=this.styles[E][F===0?F:F-1]);for(var X in this.styles[E]){var V=parseInt(X,10);V>=F&&(L=!0,l[V-F]=this.styles[E][X],O&&F===0||delete this.styles[E][X])}var Y=!1;for(L&&!O&&(this.styles[E+R]=l,Y=!0),(Y||q>F)&&R--;R>0;)o&&o[R-1]?this.styles[E+R]={0:M(o[R-1])}:S?this.styles[E+R]={0:M(S)}:delete this.styles[E+R],R--;this._forceClearCache=!0},insertCharStyleObject:function(E,F,R,o){this.styles||(this.styles={});var S=this.styles[E],l=S?M(S):{};R||(R=1);for(var L in l){var q=parseInt(L,10);q>=F&&(S[q+R]=l[q],l[q-R]||delete S[q])}if(this._forceClearCache=!0,o){for(;R--;)Object.keys(o[R]).length&&(this.styles[E]||(this.styles[E]={}),this.styles[E][F+R]=M(o[R]));return}if(S)for(var O=S[F?F-1:1];O&&R--;)this.styles[E][F+R]=M(O)},insertNewStyleBlock:function(E,F,R){for(var o=this.get2DCursorLocation(F,!0),S=[0],l=0,L=0;L<E.length;L++)E[L]===`
`?(l++,S[l]=0):S[l]++;S[0]>0&&(this.insertCharStyleObject(o.lineIndex,o.charIndex,S[0],R),R=R&&R.slice(S[0]+1)),l&&this.insertNewlineStyleObject(o.lineIndex,o.charIndex+S[0],l);for(var L=1;L<l;L++)S[L]>0?this.insertCharStyleObject(o.lineIndex+L,0,S[L],R):R&&this.styles[o.lineIndex+L]&&R[0]&&(this.styles[o.lineIndex+L][0]=R[0]),R=R&&R.slice(S[L]+1);S[L]>0&&this.insertCharStyleObject(o.lineIndex+L,0,S[L],R)},setSelectionStartEndWithShift:function(E,F,R){R<=E?(F===E?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=E),this.selectionStart=R):R>E&&R<F?this._selectionDirection==="right"?this.selectionEnd=R:this.selectionStart=R:(F===E?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=F),this.selectionEnd=R)},setSelectionInBoundaries:function(){var E=this.text.length;this.selectionStart>E?this.selectionStart=E:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>E?this.selectionEnd=E:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),p.util.object.extend(p.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(M){if(this.canvas){this.__newClickTime=+new Date;var E=M.pointer;this.isTripleClick(E)&&(this.fire("tripleclick",M),this._stopEvent(M.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=E,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(M){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===M.x&&this.__lastPointer.y===M.y},_stopEvent:function(M){M.preventDefault&&M.preventDefault(),M.stopPropagation&&M.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(M){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(M.e))},tripleClickHandler:function(M){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(M.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(M){!this.canvas||!this.editable||M.e.button&&M.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(M.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(M){!this.canvas||!this.editable||M.e.button&&M.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(M){if(this.__isMousedown=!1,!(!this.editable||this.group||M.transform&&M.transform.actionPerformed||M.e.button&&M.e.button!==1)){if(this.canvas){var E=this.canvas._activeObject;if(E&&E!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(M.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(M){var E=this.getSelectionStartFromPointer(M),F=this.selectionStart,R=this.selectionEnd;M.shiftKey?this.setSelectionStartEndWithShift(F,R,E):(this.selectionStart=E,this.selectionEnd=E),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(M){for(var E=this.getLocalPointer(M),F=0,R=0,o=0,S=0,l=0,L,q,O=0,X=this._textLines.length;O<X&&o<=E.y;O++)o+=this.getHeightOfLine(O)*this.scaleY,l=O,O>0&&(S+=this._textLines[O-1].length+this.missingNewlineOffset(O-1));L=this._getLineLeftOffset(l),R=L*this.scaleX,q=this._textLines[l],this.direction==="rtl"&&(E.x=this.width*this.scaleX-E.x+R);for(var V=0,Y=q.length;V<Y&&(F=R,R+=this.__charBounds[l][V].kernedWidth*this.scaleX,R<=E.x);V++)S++;return this._getNewSelectionStartFromOffset(E,F,R,S,Y)},_getNewSelectionStartFromOffset:function(M,E,F,R,o){var S=M.x-E,l=F-M.x,L=l>S||l<0?0:1,q=R+L;return this.flipX&&(q=o-q),q>this._text.length&&(q=this._text.length),q}}),p.util.object.extend(p.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=p.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var M=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+M.top+"; left: "+M.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+M.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):p.document.body.appendChild(this.hiddenTextarea),p.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),p.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),p.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),p.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),p.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),p.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),p.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),p.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),p.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(p.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(M){if(this.isEditing){var E=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(M.keyCode in E)this[E[M.keyCode]](M);else if(M.keyCode in this.ctrlKeysMapDown&&(M.ctrlKey||M.metaKey))this[this.ctrlKeysMapDown[M.keyCode]](M);else return;M.stopImmediatePropagation(),M.preventDefault(),M.keyCode>=33&&M.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(M){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(M.keyCode in this.ctrlKeysMapUp&&(M.ctrlKey||M.metaKey))this[this.ctrlKeysMapUp[M.keyCode]](M);else return;M.stopImmediatePropagation(),M.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(M){var E=this.fromPaste;if(this.fromPaste=!1,M&&M.stopPropagation(),!!this.isEditing){var F=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,R=this._text.length,o=F.length,S,l,L=o-R,q=this.selectionStart,O=this.selectionEnd,X=q!==O,V,Y,U;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var Q=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),te=q>Q.selectionStart;X?(S=this._text.slice(q,O),L+=O-q):o<R&&(te?S=this._text.slice(O+L,O):S=this._text.slice(q,q-L)),l=F.slice(Q.selectionEnd-L,Q.selectionEnd),S&&S.length&&(l.length&&(V=this.getSelectionStyles(q,q+1,!1),V=l.map(function(){return V[0]})),X?(Y=q,U=O):te?(Y=O-S.length,U=O):(Y=O,U=O+S.length),this.removeStyleFromTo(Y,U)),l.length&&(E&&l.join("")===p.copiedText&&!p.disableStyleCopyPaste&&(V=p.copiedTextStyle),this.insertNewStyleBlock(l,q,V)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(M){this.compositionStart=M.target.selectionStart,this.compositionEnd=M.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(p.copiedText=this.getSelectedText(),p.disableStyleCopyPaste?p.copiedTextStyle=null:p.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(M){return M&&M.clipboardData||p.window.clipboardData},_getWidthBeforeCursor:function(M,E){var F=this._getLineLeftOffset(M),R;return E>0&&(R=this.__charBounds[M][E-1],F+=R.left+R.width),F},getDownCursorOffset:function(M,E){var F=this._getSelectionForOffset(M,E),R=this.get2DCursorLocation(F),o=R.lineIndex;if(o===this._textLines.length-1||M.metaKey||M.keyCode===34)return this._text.length-F;var S=R.charIndex,l=this._getWidthBeforeCursor(o,S),L=this._getIndexOnLine(o+1,l),q=this._textLines[o].slice(S);return q.length+L+1+this.missingNewlineOffset(o)},_getSelectionForOffset:function(M,E){return M.shiftKey&&this.selectionStart!==this.selectionEnd&&E?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(M,E){var F=this._getSelectionForOffset(M,E),R=this.get2DCursorLocation(F),o=R.lineIndex;if(o===0||M.metaKey||M.keyCode===33)return-F;var S=R.charIndex,l=this._getWidthBeforeCursor(o,S),L=this._getIndexOnLine(o-1,l),q=this._textLines[o].slice(0,S),O=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+L-q.length+(1-O)},_getIndexOnLine:function(M,E){for(var F=this._textLines[M],R=this._getLineLeftOffset(M),o=R,S=0,l,L,q=0,O=F.length;q<O;q++)if(l=this.__charBounds[M][q].width,o+=l,o>E){L=!0;var X=o-l,V=o,Y=Math.abs(X-E),U=Math.abs(V-E);S=U<Y?q:q-1;break}return L||(S=F.length-1),S},moveCursorDown:function(M){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",M)},moveCursorUp:function(M){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",M)},_moveCursorUpOrDown:function(M,E){var F="get"+M+"CursorOffset",R=this[F](E,this._selectionDirection==="right");E.shiftKey?this.moveCursorWithShift(R):this.moveCursorWithoutShift(R),R!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(M){var E=this._selectionDirection==="left"?this.selectionStart+M:this.selectionEnd+M;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,E),M!==0},moveCursorWithoutShift:function(M){return M<0?(this.selectionStart+=M,this.selectionEnd=this.selectionStart):(this.selectionEnd+=M,this.selectionStart=this.selectionEnd),M!==0},moveCursorLeft:function(M){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",M)},_move:function(M,E,F){var R;if(M.altKey)R=this["findWordBoundary"+F](this[E]);else if(M.metaKey||M.keyCode===35||M.keyCode===36)R=this["findLineBoundary"+F](this[E]);else return this[E]+=F==="Left"?-1:1,!0;if(typeof R<"u"&&this[E]!==R)return this[E]=R,!0},_moveLeft:function(M,E){return this._move(M,E,"Left")},_moveRight:function(M,E){return this._move(M,E,"Right")},moveCursorLeftWithoutShift:function(M){var E=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(E=this._moveLeft(M,"selectionStart")),this.selectionEnd=this.selectionStart,E},moveCursorLeftWithShift:function(M){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(M,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(M,"selectionStart")},moveCursorRight:function(M){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",M)},_moveCursorLeftOrRight:function(M,E){var F="moveCursor"+M+"With";this._currentCursorOpacity=1,E.shiftKey?F+="Shift":F+="outShift",this[F](E)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(M){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(M,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(M,"selectionEnd")},moveCursorRightWithoutShift:function(M){var E=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(E=this._moveRight(M,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,E},removeChars:function(M,E){typeof E>"u"&&(E=M+1),this.removeStyleFromTo(M,E),this._text.splice(M,E-M),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(M,E,F,R){typeof R>"u"&&(R=F),R>F&&this.removeStyleFromTo(F,R);var o=p.util.string.graphemeSplit(M);this.insertNewStyleBlock(o,F,E),this._text=[].concat(this._text.slice(0,F),o,this._text.slice(R)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var M=p.util.toFixed,E=p.util.radiansToDegrees,F=p.util.calcRotateMatrix,R=p.util.transformPoint,o=/  +/g;p.util.object.extend(p.Text.prototype,{_toSVG:function(){var S=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(S.textTop,S.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(S){var l=this._createBaseSVGMarkup(this._toSVG(),{reviver:S,noStyle:!0,withShadow:!0}),L=this.path;return L?l+L._createBaseSVGMarkup(L._toSVG(),{reviver:S,withShadow:!0}):l},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(S){var l=!0,L=this.getSvgTextDecoration(this);return[S.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",L?'text-decoration="'+L+'" ':"",'style="',this.getSvgStyles(l),'"',this.addPaintOrder()," >",S.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(S,l){var L=[],q=[],O=S,X;this._setSVGBg(q);for(var V=0,Y=this._textLines.length;V<Y;V++)X=this._getLineLeftOffset(V),(this.textBackgroundColor||this.styleHas("textBackgroundColor",V))&&this._setSVGTextLineBg(q,V,l+X,O),this._setSVGTextLineText(L,V,l+X,O),O+=this.getHeightOfLine(V);return{textSpans:L,textBgRects:q}},_createTextCharSpan:function(S,l,L,q,O){var X=S!==S.trim()||S.match(o),V=this.getSvgSpanStyles(l,X),Y=V?'style="'+V+'"':"",U=l.deltaY,Q="",te=p.Object.NUM_FRACTION_DIGITS,se="";if(U&&(Q=' dy="'+M(U,te)+'" '),O.renderLeft!==void 0){var fe=O.angle;se=' rotate="'+M(E(fe),p.Object.NUM_FRACTION_DIGITS)+'" ';var Se=O.width/2,Te=F({angle:E(fe)});Te[4]=O.renderLeft,Te[5]=O.renderTop;var Re=R({x:-Se,y:0},Te);L=Re.x,q=Re.y}return['<tspan x="',M(L,te),'" y="',M(q,te),'" ',Q,Y,se,">",p.util.string.escapeXml(S),"</tspan>"].join("")},_setSVGTextLineText:function(S,l,L,q){var O=this.getHeightOfLine(l),X=this.textAlign.indexOf("justify")!==-1,V,Y,U="",Q,te,se=0,fe=this._textLines[l],Se;q+=O*(1-this._fontSizeFraction)/this.lineHeight;for(var Te=0,Re=fe.length-1;Te<=Re;Te++)Se=Te===Re||this.charSpacing||this.path,U+=fe[Te],Q=this.__charBounds[l][Te],se===0?(L+=Q.kernedWidth-Q.width,se+=Q.width):se+=Q.kernedWidth,X&&!Se&&this._reSpaceAndTab.test(fe[Te])&&(Se=!0),Se||(V=V||this.getCompleteStyleDeclaration(l,Te),Y=this.getCompleteStyleDeclaration(l,Te+1),Se=p.util.hasStyleChanged(V,Y,!0)),Se&&(te=this._getStyleDeclaration(l,Te)||{},S.push(this._createTextCharSpan(U,te,L,q,Q)),U="",V=Y,L+=se,se=0)},_pushTextBgRect:function(S,l,L,q,O,X){var V=p.Object.NUM_FRACTION_DIGITS;S.push("		<rect ",this._getFillAttributes(l),' x="',M(L,V),'" y="',M(q,V),'" width="',M(O,V),'" height="',M(X,V),`"></rect>
`)},_setSVGTextLineBg:function(S,l,L,q){for(var O=this._textLines[l],X=this.getHeightOfLine(l)/this.lineHeight,V=0,Y=0,U,Q,te=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),se=0,fe=O.length;se<fe;se++)U=this.__charBounds[l][se],Q=this.getValueOfPropertyAt(l,se,"textBackgroundColor"),Q!==te?(te&&this._pushTextBgRect(S,te,L+Y,q,V,X),Y=U.left,V=U.width,te=Q):V+=U.kernedWidth;Q&&this._pushTextBgRect(S,Q,L+Y,q,V,X)},_getFillAttributes:function(S){var l=S&&typeof S=="string"?new p.Color(S):"";return!l||!l.getSource()||l.getAlpha()===1?'fill="'+S+'"':'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(S){for(var l=0,L=0,q=0;q<S;q++)l+=this.getHeightOfLine(q);return L=this.getHeightOfLine(q),{lineTop:l,offset:(this._fontSizeMult-this._fontSizeFraction)*L/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(S){var l=p.Object.prototype.getSvgStyles.call(this,S);return l+" white-space: pre;"}})}(),function(M){var E=M.fabric||(M.fabric={});E.Textbox=E.util.createClass(E.IText,E.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:E.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(F){for(var R=0,o=0,S=0,l={},L=0;L<F.graphemeLines.length;L++)F.graphemeText[S]===`
`&&L>0?(o=0,S++,R++):!this.splitByGrapheme&&this._reSpaceAndTab.test(F.graphemeText[S])&&L>0&&(o++,S++),l[L]={line:R,offset:o},S+=F.graphemeLines[L].length,o+=F.graphemeLines[L].length;return l},styleHas:function(F,R){if(this._styleMap&&!this.isWrapping){var o=this._styleMap[R];o&&(R=o.line)}return E.Text.prototype.styleHas.call(this,F,R)},isEmptyStyles:function(F){if(!this.styles)return!0;var R=0,o=F+1,S,l,L=!1,q=this._styleMap[F],O=this._styleMap[F+1];q&&(F=q.line,R=q.offset),O&&(o=O.line,L=o===F,S=O.offset),l=typeof F>"u"?this.styles:{line:this.styles[F]};for(var X in l)for(var V in l[X])if(V>=R&&(!L||V<S))for(var Y in l[X][V])return!1;return!0},_getStyleDeclaration:function(F,R){if(this._styleMap&&!this.isWrapping){var o=this._styleMap[F];if(!o)return null;F=o.line,R=o.offset+R}return this.callSuper("_getStyleDeclaration",F,R)},_setStyleDeclaration:function(F,R,o){var S=this._styleMap[F];F=S.line,R=S.offset+R,this.styles[F][R]=o},_deleteStyleDeclaration:function(F,R){var o=this._styleMap[F];F=o.line,R=o.offset+R,delete this.styles[F][R]},_getLineStyle:function(F){var R=this._styleMap[F];return!!this.styles[R.line]},_setLineStyle:function(F){var R=this._styleMap[F];this.styles[R.line]={}},_wrapText:function(F,R){var o=[],S;for(this.isWrapping=!0,S=0;S<F.length;S++)o=o.concat(this._wrapLine(F[S],S,R));return this.isWrapping=!1,o},_measureWord:function(F,R,o){var S=0,l,L=!0;o=o||0;for(var q=0,O=F.length;q<O;q++){var X=this._getGraphemeBox(F[q],R,q+o,l,L);S+=X.kernedWidth,l=F[q]}return S},_wrapLine:function(F,R,o,Te){var l=0,L=this.splitByGrapheme,q=[],O=[],X=L?E.util.string.graphemeSplit(F):F.split(this._wordJoiners),V="",Y=0,U=L?"":" ",Q=0,te=0,se=0,fe=!0,Se=this._getWidthOfCharSpacing(),Te=Te||0;X.length===0&&X.push([]),o-=Te;for(var Re=0;Re<X.length;Re++)V=L?X[Re]:E.util.string.graphemeSplit(X[Re]),Q=this._measureWord(V,R,Y),Y+=V.length,l+=te+Q-Se,l>o&&!fe?(q.push(O),O=[],l=Q,fe=!0):l+=Se,!fe&&!L&&O.push(U),O=O.concat(V),te=L?0:this._measureWord([U],R,Y),Y++,fe=!1,Q>se&&(se=Q);return Re&&q.push(O),se+Te>this.dynamicMinWidth&&(this.dynamicMinWidth=se-Se+Te),q},isEndOfWrapping:function(F){return!this._styleMap[F+1]||this._styleMap[F+1].line!==this._styleMap[F].line},missingNewlineOffset:function(F,R){return this.splitByGrapheme&&!R?this.isEndOfWrapping(F)?1:0:1},_splitTextIntoLines:function(F){for(var R=E.Text.prototype._splitTextIntoLines.call(this,F),o=this._wrapText(R.lines,this.width),S=new Array(o.length),l=0;l<o.length;l++)S[l]=o[l].join("");return R.lines=S,R.graphemeLines=o,R},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var F={};for(var R in this._styleMap)this._textLines[R]&&(F[this._styleMap[R].line]=1);for(var R in this.styles)F[R]||delete this.styles[R]},toObject:function(F){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(F))}}),E.Textbox.fromObject=function(F,R){var o=E.util.stylesFromArray(F.styles,F.text),S=Object.assign({},F,{styles:o});return delete S.path,E.Object._fromObject("Textbox",S,function(l){F.path?E.Object._fromObject("Path",F.path,function(L){l.set("path",L),R(l)},"path"):R(l)},"text")}}(B),function(){var M=p.controlsUtils,E=M.scaleSkewCursorStyleHandler,F=M.scaleCursorStyleHandler,R=M.scalingEqually,o=M.scalingYOrSkewingX,S=M.scalingXOrSkewingY,l=M.scaleOrSkewActionName,L=p.Object.prototype.controls;if(L.ml=new p.Control({x:-.5,y:0,cursorStyleHandler:E,actionHandler:S,getActionName:l}),L.mr=new p.Control({x:.5,y:0,cursorStyleHandler:E,actionHandler:S,getActionName:l}),L.mb=new p.Control({x:0,y:.5,cursorStyleHandler:E,actionHandler:o,getActionName:l}),L.mt=new p.Control({x:0,y:-.5,cursorStyleHandler:E,actionHandler:o,getActionName:l}),L.tl=new p.Control({x:-.5,y:-.5,cursorStyleHandler:F,actionHandler:R}),L.tr=new p.Control({x:.5,y:-.5,cursorStyleHandler:F,actionHandler:R}),L.bl=new p.Control({x:-.5,y:.5,cursorStyleHandler:F,actionHandler:R}),L.br=new p.Control({x:.5,y:.5,cursorStyleHandler:F,actionHandler:R}),L.mtr=new p.Control({x:0,y:-.5,actionHandler:M.rotationWithSnapping,cursorStyleHandler:M.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),p.Textbox){var q=p.Textbox.prototype.controls={};q.mtr=L.mtr,q.tr=L.tr,q.br=L.br,q.tl=L.tl,q.bl=L.bl,q.mt=L.mt,q.mb=L.mb,q.mr=new p.Control({x:.5,y:0,actionHandler:M.changeWidth,cursorStyleHandler:E,actionName:"resizing"}),q.ml=new p.Control({x:-.5,y:0,actionHandler:M.changeWidth,cursorStyleHandler:E,actionName:"resizing"})}}()})(fabric$1);class CreateLayerSection{constructor(p,W="desktop"){this.layers=p,this.deviceType=W}create(p,W,G=null){if(p!=null&&p.text)return;function K(F=30){let R="0123456789",o="abcdefghijklmnopqrstuvwxyz",S="",l=F;for(let L=0;L<l;L++)L%2==0?S+=R[Math.floor(Math.random()*R.length)]:S+=o[Math.floor(Math.random()*o.length)];return S}const J=K();p.set("layerId",J);const Z=document.createElement("img");Z.className="layer-img",Z.src=p.toDataURL();const M=document.createElement("span");M.className="layer-span",M.textContent=`Layer ${W+1}`;const E=document.createElement("div");return E.setAttribute("tabindex","0"),E.className="layer-container",this.deviceType==="mobile"&&(Z.style.width="15px",Z.style.height="15px",M.style.fontSize="12px",M.style.width="max-width",E.style.textAlign="center",E.style.gap="0px",E.style.margin=0,M.style.width="60px",M.style.marginInline="7px",E.style.textAlign="left"),E.setAttribute("data_layer",W),E.setAttribute("data-id",J),E.append(Z,M),G?G.insertAdjacentHTML("afterend",E.outerHTML):this.layers.append(E),J}}function CanvasGuides(B){console.log.bind(this);function p(){return Math.random().toString(36).substr(2,9)}function W(o,S,l){let L=S+o,q=B._objects.find(U=>U.name===L),O={};o==="X"&&(O.top=S-.25),o==="Y"&&(O.left=S-.25);let X=[0,0,0,0],V=B.getActiveObject(),{p2:Y}=l;if(o==="X"){let U=V.left+V.getScaledWidth()/2;l.pointType=="canvas"&&(U=B.getWidth()),X=[Y,0,U,0]}else if(o==="Y"){let U=V.top+V.getScaledHeight()/2;l.pointType=="canvas"&&(U=B.getHeight()),X=[0,Y,0,U]}if(q)return q.set({opacity:1,x1:X[0],y1:X[1],x2:X[2],y2:X[3],...O}),B.renderAll(),!0;q=new fabric.Line(X,{stroke:"red",strokeWidth:.5,selectable:!1,opacity:1,id:p(),name:L,isPositioningLine:!0,...O}),B.add(q)}function G(){let o=B._objects.filter(S=>S.isPositioningLine);for(let S=0;S<o.length;S++)B.remove(o[S])}function K(o,S){let l=S+o,L=B._objects.find(q=>q.name===l);L&&L.set({opacity:0})}function J(o){let S=o.getScaledWidth(),l=o.getScaledHeight(),L=o.left,q=o.top,O=[L,L+S/2,L+S],X=[q,q+l/2,q+l];O=O.map(U=>Math.round(U)),X=X.map(U=>Math.round(U));let V=[];O.forEach((U,Q)=>{V.push({point:U,p2:X[0]})});let Y=[];return X.forEach((U,Q)=>{Y.push({point:U,p2:O[0]})}),{x:V,y:Y}}function Z(){let o=B.getWidth(),S=B.getHeight(),l=[0,o/2,o],L=[0,S/2,S],q=l.map(X=>({point:X,p2:0,pointType:"canvas"})),O=L.map(X=>({point:X,p2:0,pointType:"canvas"}));return{x:q,y:O}}function M(o){let S=null;return B._objects.forEach(l=>{if(S)return!0;if(l.id==o)S=l;else if(l._objects){let L=l._objects.find(q=>q.id==o);L&&(S=L)}}),S}function E(){let o=[],S=[],l=Z(),L=B.getActiveObject(),q=L==null?void 0:L.id;o=o.concat(l.x),S=S.concat(l.y),O(q)&&L.group&&(q=L.group.id);function O(X){let V=M(X);return V?V.group!=null:!1}return B._objects.forEach(X=>{if(X.id==q||L.type==="activeSelection"&&L._objects.find(U=>U.id==X.id))return!0;let V=J(X);o=o.concat(V.x),S=S.concat(V.y)}),{x:o,y:S}}function F(o,S,l){let L={onPoint:!1};return S.forEach(q=>{let{point:O,p2:X}=q;if(K(l,O),L.onPoint)return!0;let V=O-5,Y=O+5,U=["left","center","right"];o.forEach((Q,te)=>{let se=Q.point;if(se>=V&&se<=Y)return L=q,L.onPoint=!0,L.position=U[te],!1})}),L}let R=!1;B.on("object:moving",function(o){R=!0;let S=o.target;S.type=="curved-text"&&S.refreshCtx(),S.left,S.top;let l=S.getScaledWidth(),L=S.getScaledHeight(),q=J(S),O=E(),X=F(q.x,O.x,"Y");if(X.onPoint){let Y=X.point,U=Y;X.position==="center"?U=U-l/2:X.position==="right"&&(U=U-l),S.set("left",U),W("Y",Y,X)}else O.x.forEach(Y=>{K("Y",Y)});let V=F(q.y,O.y,"X");if(V.onPoint){let Y=V.point,U=Y;V.position==="center"?U=U-L/2:V.position==="right"&&(U=U-L),S.set("top",U),W("X",Y,V)}else O.y.forEach(Y=>{K("X",Y)});B.renderAll()}),B.on("mouse:up",function(o){if(G(),R){B.save();let S=o.target;R=!1,S.type=="curved-text"&&S.refreshCtx(!0)}}),B.on("object:scaling",function(o){let S=o.target;S.type=="curved-text"&&(S.refreshCtx(!0),S._updateObj("scaleX",S.scaleX),S._updateObj("scaleY",S.scaleY))}),document.onkeydown=function(o){let S=B.getActiveObject();if(!S)return!0;let l=o.keyCode||o.which,L=[37,38,39,40],q={left:S.left,top:S.top};if(!L.includes(l)||$(":focus").length)return!0;o.preventDefault(),l==37?q.left-=1:l==38?q.top-=1:l==39?q.left+=1:l==40&&(q.top+=1),S.set(q),B.renderAll()}}var toastify$1={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */(function(B){(function(p,W){B.exports?B.exports=W():p.Toastify=W()})(commonjsGlobal,function(p){var W=function(Z){return new W.lib.init(Z)},G="1.12.0";W.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},W.lib=W.prototype={toastify:G,constructor:W,init:function(Z){return Z||(Z={}),this.options={},this.toastElement=null,this.options.text=Z.text||W.defaults.text,this.options.node=Z.node||W.defaults.node,this.options.duration=Z.duration===0?0:Z.duration||W.defaults.duration,this.options.selector=Z.selector||W.defaults.selector,this.options.callback=Z.callback||W.defaults.callback,this.options.destination=Z.destination||W.defaults.destination,this.options.newWindow=Z.newWindow||W.defaults.newWindow,this.options.close=Z.close||W.defaults.close,this.options.gravity=Z.gravity==="bottom"?"toastify-bottom":W.defaults.gravity,this.options.positionLeft=Z.positionLeft||W.defaults.positionLeft,this.options.position=Z.position||W.defaults.position,this.options.backgroundColor=Z.backgroundColor||W.defaults.backgroundColor,this.options.avatar=Z.avatar||W.defaults.avatar,this.options.className=Z.className||W.defaults.className,this.options.stopOnFocus=Z.stopOnFocus===void 0?W.defaults.stopOnFocus:Z.stopOnFocus,this.options.onClick=Z.onClick||W.defaults.onClick,this.options.offset=Z.offset||W.defaults.offset,this.options.escapeMarkup=Z.escapeMarkup!==void 0?Z.escapeMarkup:W.defaults.escapeMarkup,this.options.ariaLive=Z.ariaLive||W.defaults.ariaLive,this.options.style=Z.style||W.defaults.style,Z.backgroundColor&&(this.options.style.background=Z.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var Z=document.createElement("div");Z.className="toastify on "+this.options.className,this.options.position?Z.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(Z.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):Z.className+=" toastify-right",Z.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var M in this.options.style)Z.style[M]=this.options.style[M];if(this.options.ariaLive&&Z.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)Z.appendChild(this.options.node);else if(this.options.escapeMarkup?Z.innerText=this.options.text:Z.innerHTML=this.options.text,this.options.avatar!==""){var E=document.createElement("img");E.src=this.options.avatar,E.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?Z.appendChild(E):Z.insertAdjacentElement("afterbegin",E)}if(this.options.close===!0){var F=document.createElement("button");F.type="button",F.setAttribute("aria-label","Close"),F.className="toast-close",F.innerHTML="&#10006;",F.addEventListener("click",(function(O){O.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var R=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&R>360?Z.insertAdjacentElement("afterbegin",F):Z.appendChild(F)}if(this.options.stopOnFocus&&this.options.duration>0){var o=this;Z.addEventListener("mouseover",function(O){window.clearTimeout(Z.timeOutValue)}),Z.addEventListener("mouseleave",function(){Z.timeOutValue=window.setTimeout(function(){o.removeElement(Z)},o.options.duration)})}if(typeof this.options.destination<"u"&&Z.addEventListener("click",(function(O){O.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&Z.addEventListener("click",(function(O){O.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var S=K("x",this.options),l=K("y",this.options),L=this.options.position=="left"?S:"-"+S,q=this.options.gravity=="toastify-top"?l:"-"+l;Z.style.transform="translate("+L+","+q+")"}return Z},showToast:function(){this.toastElement=this.buildToast();var Z;if(typeof this.options.selector=="string"?Z=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?Z=this.options.selector:Z=document.body,!Z)throw"Root element is not defined";var M=W.defaults.oldestFirst?Z.firstChild:Z.lastChild;return Z.insertBefore(this.toastElement,M),W.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(Z){Z.className=Z.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),Z.parentNode&&Z.parentNode.removeChild(Z),this.options.callback.call(Z),W.reposition()}).bind(this),400)}},W.reposition=function(){for(var Z={top:15,bottom:15},M={top:15,bottom:15},E={top:15,bottom:15},F=document.getElementsByClassName("toastify"),R,o=0;o<F.length;o++){J(F[o],"toastify-top")===!0?R="toastify-top":R="toastify-bottom";var S=F[o].offsetHeight;R=R.substr(9,R.length-1);var l=15,L=window.innerWidth>0?window.innerWidth:screen.width;L<=360?(F[o].style[R]=E[R]+"px",E[R]+=S+l):J(F[o],"toastify-left")===!0?(F[o].style[R]=Z[R]+"px",Z[R]+=S+l):(F[o].style[R]=M[R]+"px",M[R]+=S+l)}return this};function K(Z,M){return M.offset[Z]?isNaN(M.offset[Z])?M.offset[Z]:M.offset[Z]+"px":"0px"}function J(Z,M){return!Z||typeof M!="string"?!1:!!(Z.className&&Z.className.trim().split(/\s+/gi).indexOf(M)>-1)}return W.lib.init.prototype=W.lib,W})})(toastify$1);var toastifyExports=toastify$1.exports;const Toastify=getDefaultExportFromCjs(toastifyExports),toastify="",toastNotification=B=>Toastify({text:B,duration:3e3,newWindow:!0,close:!1,gravity:"top",position:"center",stopOnFocus:!0,style:{background:"var(--gold)",color:"#ffffff",borderRadius:"8px",cursor:"context-menu"},onClick:null}).showToast(),alwan_min="";/*!
 * iro.js v5.5.2
 * 2016-2021 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */var n,u,t,i,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function s(B,p){for(var W in p)B[W]=p[W];return B}function a(B){var p=B.parentNode;p&&p.removeChild(B)}function h(B,p,W){var G,K,J,Z,M=arguments;if(p=s({},p),arguments.length>3)for(W=[W],G=3;G<arguments.length;G++)W.push(M[G]);if(W!=null&&(p.children=W),B!=null&&B.defaultProps!=null)for(K in B.defaultProps)p[K]===void 0&&(p[K]=B.defaultProps[K]);return Z=p.key,(J=p.ref)!=null&&delete p.ref,Z!=null&&delete p.key,v(B,p,Z,J)}function v(B,p,W,G){var K={type:B,props:p,key:W,ref:G,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return n.vnode&&n.vnode(K),K}function d(B){return B.children}function y(B){if(B==null||typeof B=="boolean")return null;if(typeof B=="string"||typeof B=="number")return v(null,B,null,null);if(B.__e!=null||B.__c!=null){var p=v(B.type,B.props,B.key,null);return p.__e=B.__e,p}return B}function m(B,p){this.props=B,this.context=p}function w(B,p){if(p==null)return B.__p?w(B.__p,B.__p.__k.indexOf(B)+1):null;for(var W;p<B.__k.length;p++)if((W=B.__k[p])!=null&&W.__e!=null)return W.__e;return typeof B.type=="function"?w(B):null}function g(B){var p,W;if((B=B.__p)!=null&&B.__c!=null){for(B.__e=B.__c.base=null,p=0;p<B.__k.length;p++)if((W=B.__k[p])!=null&&W.__e!=null){B.__e=B.__c.base=W.__e;break}return g(B)}}function k(B){(!B.__d&&(B.__d=!0)&&u.push(B)===1||i!==n.debounceRendering)&&(i=n.debounceRendering,(n.debounceRendering||t)(_))}function _(){var B,p,W,G,K,J,Z,M;for(u.sort(function(E,F){return F.__v.__b-E.__v.__b});B=u.pop();)B.__d&&(W=void 0,G=void 0,J=(K=(p=B).__v).__e,Z=p.__P,M=p.u,p.u=!1,Z&&(W=[],G=$$1(Z,K,s({},K),p.__n,Z.ownerSVGElement!==void 0,null,W,M,J??w(K)),j(W,K),G!=J&&g(K)))}function b(B,p,W,G,K,J,Z,M,E){var F,R,o,S,l,L,q,O=W&&W.__k||e,X=O.length;if(M==f&&(M=J!=null?J[0]:X?w(W,0):null),F=0,p.__k=x(p.__k,function(V){if(V!=null){if(V.__p=p,V.__b=p.__b+1,(o=O[F])===null||o&&V.key==o.key&&V.type===o.type)O[F]=void 0;else for(R=0;R<X;R++){if((o=O[R])&&V.key==o.key&&V.type===o.type){O[R]=void 0;break}o=null}if(S=$$1(B,V,o=o||f,G,K,J,Z,null,M,E),(R=V.ref)&&o.ref!=R&&(q||(q=[])).push(R,V.__c||S,V),S!=null){if(L==null&&(L=S),V.l!=null)S=V.l,V.l=null;else if(J==o||S!=M||S.parentNode==null){e:if(M==null||M.parentNode!==B)B.appendChild(S);else{for(l=M,R=0;(l=l.nextSibling)&&R<X;R+=2)if(l==S)break e;B.insertBefore(S,M)}p.type=="option"&&(B.value="")}M=S.nextSibling,typeof p.type=="function"&&(p.l=S)}}return F++,V}),p.__e=L,J!=null&&typeof p.type!="function")for(F=J.length;F--;)J[F]!=null&&a(J[F]);for(F=X;F--;)O[F]!=null&&D(O[F],O[F]);if(q)for(F=0;F<q.length;F++)A(q[F],q[++F],q[++F])}function x(B,p,W){if(W==null&&(W=[]),B==null||typeof B=="boolean")p&&W.push(p(null));else if(Array.isArray(B))for(var G=0;G<B.length;G++)x(B[G],p,W);else W.push(p?p(y(B)):B);return W}function C(B,p,W,G,K){var J;for(J in W)J in p||N(B,J,null,W[J],G);for(J in p)K&&typeof p[J]!="function"||J==="value"||J==="checked"||W[J]===p[J]||N(B,J,p[J],W[J],G)}function P(B,p,W){p[0]==="-"?B.setProperty(p,W):B[p]=typeof W=="number"&&c.test(p)===!1?W+"px":W??""}function N(B,p,W,G,K){var J,Z,M,E,F;if(!((p=K?p==="className"?"class":p:p==="class"?"className":p)==="key"||p==="children"))if(p==="style")if(J=B.style,typeof W=="string")J.cssText=W;else{if(typeof G=="string"&&(J.cssText="",G=null),G)for(Z in G)W&&Z in W||P(J,Z,"");if(W)for(M in W)G&&W[M]===G[M]||P(J,M,W[M])}else p[0]==="o"&&p[1]==="n"?(E=p!==(p=p.replace(/Capture$/,"")),F=p.toLowerCase(),p=(F in B?F:p).slice(2),W?(G||B.addEventListener(p,T,E),(B.t||(B.t={}))[p]=W):B.removeEventListener(p,T,E)):p!=="list"&&p!=="tagName"&&p!=="form"&&!K&&p in B?B[p]=W??"":typeof W!="function"&&p!=="dangerouslySetInnerHTML"&&(p!==(p=p.replace(/^xlink:?/,""))?W==null||W===!1?B.removeAttributeNS("http://www.w3.org/1999/xlink",p.toLowerCase()):B.setAttributeNS("http://www.w3.org/1999/xlink",p.toLowerCase(),W):W==null||W===!1?B.removeAttribute(p):B.setAttribute(p,W))}function T(B){return this.t[B.type](n.event?n.event(B):B)}function $$1(B,p,W,G,K,J,Z,M,E,F){var R,o,S,l,L,q,O,X,V,Y,U=p.type;if(p.constructor!==void 0)return null;(R=n.__b)&&R(p);try{e:if(typeof U=="function"){if(X=p.props,V=(R=U.contextType)&&G[R.__c],Y=R?V?V.props.value:R.__p:G,W.__c?O=(o=p.__c=W.__c).__p=o.__E:("prototype"in U&&U.prototype.render?p.__c=o=new U(X,Y):(p.__c=o=new m(X,Y),o.constructor=U,o.render=H),V&&V.sub(o),o.props=X,o.state||(o.state={}),o.context=Y,o.__n=G,S=o.__d=!0,o.__h=[]),o.__s==null&&(o.__s=o.state),U.getDerivedStateFromProps!=null&&s(o.__s==o.state?o.__s=s({},o.__s):o.__s,U.getDerivedStateFromProps(X,o.__s)),S)U.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),o.componentDidMount!=null&&Z.push(o);else{if(U.getDerivedStateFromProps==null&&M==null&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(X,Y),!M&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(X,o.__s,Y)===!1){for(o.props=X,o.state=o.__s,o.__d=!1,o.__v=p,p.__e=E!=null?E!==W.__e?E:W.__e:null,p.__k=W.__k,R=0;R<p.__k.length;R++)p.__k[R]&&(p.__k[R].__p=p);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(X,o.__s,Y)}for(l=o.props,L=o.state,o.context=Y,o.props=X,o.state=o.__s,(R=n.__r)&&R(p),o.__d=!1,o.__v=p,o.__P=B,R=o.render(o.props,o.state,o.context),p.__k=x(R!=null&&R.type==d&&R.key==null?R.props.children:R),o.getChildContext!=null&&(G=s(s({},G),o.getChildContext())),S||o.getSnapshotBeforeUpdate==null||(q=o.getSnapshotBeforeUpdate(l,L)),b(B,p,W,G,K,J,Z,E,F),o.base=p.__e;R=o.__h.pop();)o.__s&&(o.state=o.__s),R.call(o);S||l==null||o.componentDidUpdate==null||o.componentDidUpdate(l,L,q),O&&(o.__E=o.__p=null)}else p.__e=z(W.__e,p,W,G,K,J,Z,F);(R=n.diffed)&&R(p)}catch(Q){n.__e(Q,p,W)}return p.__e}function j(B,p){for(var W;W=B.pop();)try{W.componentDidMount()}catch(G){n.__e(G,W.__v)}n.__c&&n.__c(p)}function z(B,p,W,G,K,J,Z,M){var E,F,R,o,S=W.props,l=p.props;if(K=p.type==="svg"||K,B==null&&J!=null){for(E=0;E<J.length;E++)if((F=J[E])!=null&&(p.type===null?F.nodeType===3:F.localName===p.type)){B=F,J[E]=null;break}}if(B==null){if(p.type===null)return document.createTextNode(l);B=K?document.createElementNS("http://www.w3.org/2000/svg",p.type):document.createElement(p.type),J=null}return p.type===null?S!==l&&(J!=null&&(J[J.indexOf(B)]=null),B.data=l):p!==W&&(J!=null&&(J=e.slice.call(B.childNodes)),R=(S=W.props||f).dangerouslySetInnerHTML,o=l.dangerouslySetInnerHTML,M||(o||R)&&(o&&R&&o.__html==R.__html||(B.innerHTML=o&&o.__html||"")),C(B,l,S,K,M),p.__k=p.props.children,o||b(B,p,W,G,p.type!=="foreignObject"&&K,J,Z,f,M),M||("value"in l&&l.value!==void 0&&l.value!==B.value&&(B.value=l.value==null?"":l.value),"checked"in l&&l.checked!==void 0&&l.checked!==B.checked&&(B.checked=l.checked))),B}function A(B,p,W){try{typeof B=="function"?B(p):B.current=p}catch(G){n.__e(G,W)}}function D(B,p,W){var G,K,J;if(n.unmount&&n.unmount(B),(G=B.ref)&&A(G,null,p),W||typeof B.type=="function"||(W=(K=B.__e)!=null),B.__e=B.l=null,(G=B.__c)!=null){if(G.componentWillUnmount)try{G.componentWillUnmount()}catch(Z){n.__e(Z,p)}G.base=G.__P=null}if(G=B.__k)for(J=0;J<G.length;J++)G[J]&&D(G[J],p,W);K!=null&&a(K)}function H(B,p,W){return this.constructor(B,W)}function I(B,p,W){var G,K,J;n.__p&&n.__p(B,p),K=(G=W===r)?null:W&&W.__k||p.__k,B=h(d,null,[B]),J=[],$$1(p,G?p.__k=B:(W||p).__k=B,K||f,f,p.ownerSVGElement!==void 0,W&&!G?[W]:K?null:e.slice.call(p.childNodes),J,!1,W||f,G),j(J,B)}n={},m.prototype.setState=function(B,p){var W=this.__s!==this.state&&this.__s||(this.__s=s({},this.state));(typeof B!="function"||(B=B(W,this.props)))&&s(W,B),B!=null&&this.__v&&(this.u=!1,p&&this.__h.push(p),k(this))},m.prototype.forceUpdate=function(B){this.__v&&(B&&this.__h.push(B),this.u=!0,k(this))},m.prototype.render=d,u=[],t=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,i=n.debounceRendering,n.__e=function(B,p,W){for(var G;p=p.__p;)if((G=p.__c)&&!G.__p)try{if(G.constructor&&G.constructor.getDerivedStateFromError!=null)G.setState(G.constructor.getDerivedStateFromError(B));else{if(G.componentDidCatch==null)continue;G.componentDidCatch(B)}return k(G.__E=G)}catch(K){B=K}throw B},r=f;function _defineProperties(B,p){for(var W=0;W<p.length;W++){var G=p[W];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(B,G.key,G)}}function _createClass(B,p,W){return p&&_defineProperties(B.prototype,p),W&&_defineProperties(B,W),B}function _extends(){return _extends=Object.assign||function(B){for(var p=arguments,W=1;W<arguments.length;W++){var G=p[W];for(var K in G)Object.prototype.hasOwnProperty.call(G,K)&&(B[K]=G[K])}return B},_extends.apply(this,arguments)}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH_3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH_4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",REGEX_FUNCTIONAL_RGB=new RegExp("rgb"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_RGBA=new RegExp("rgba"+PERMISSIVE_MATCH_4),REGEX_FUNCTIONAL_HSL=new RegExp("hsl"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_HSLA=new RegExp("hsla"+PERMISSIVE_MATCH_4),HEX_START="^(?:#?|0x?)",HEX_INT_SINGLE="([0-9a-fA-F]{1})",HEX_INT_DOUBLE="([0-9a-fA-F]{2})",REGEX_HEX_3=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_4=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_6=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),REGEX_HEX_8=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),KELVIN_MIN=2e3,KELVIN_MAX=4e4,log=Math.log,round=Math.round,floor=Math.floor;function clamp(B,p,W){return Math.min(Math.max(B,p),W)}function parseUnit(B,p){var W=B.indexOf("%")>-1,G=parseFloat(B);return W?p/100*G:G}function parseHexInt(B){return parseInt(B,16)}function intToHex(B){return B.toString(16).padStart(2,"0")}var IroColor=function(){function B(W,G){this.$={h:0,s:0,v:0,a:1},W&&this.set(W),this.onChange=G,this.initialValue=_extends({},this.$)}var p=B.prototype;return p.set=function(G){if(typeof G=="string")/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(G)?this.hexString=G:/^rgba?/.test(G)?this.rgbString=G:/^hsla?/.test(G)&&(this.hslString=G);else if(typeof G=="object")G instanceof B?this.hsva=G.hsva:"r"in G&&"g"in G&&"b"in G?this.rgb=G:"h"in G&&"s"in G&&"v"in G?this.hsv=G:"h"in G&&"s"in G&&"l"in G?this.hsl=G:"kelvin"in G&&(this.kelvin=G.kelvin);else throw new Error("Invalid color value")},p.setChannel=function(G,K,J){var Z;this[G]=_extends({},this[G],(Z={},Z[K]=J,Z))},p.reset=function(){this.hsva=this.initialValue},p.clone=function(){return new B(this)},p.unbind=function(){this.onChange=void 0},B.hsvToRgb=function(G){var K=G.h/60,J=G.s/100,Z=G.v/100,M=floor(K),E=K-M,F=Z*(1-J),R=Z*(1-E*J),o=Z*(1-(1-E)*J),S=M%6,l=[Z,R,F,F,o,Z][S],L=[o,Z,Z,R,F,F][S],q=[F,F,o,Z,Z,R][S];return{r:clamp(l*255,0,255),g:clamp(L*255,0,255),b:clamp(q*255,0,255)}},B.rgbToHsv=function(G){var K=G.r/255,J=G.g/255,Z=G.b/255,M=Math.max(K,J,Z),E=Math.min(K,J,Z),F=M-E,R=0,o=M,S=M===0?0:F/M;switch(M){case E:R=0;break;case K:R=(J-Z)/F+(J<Z?6:0);break;case J:R=(Z-K)/F+2;break;case Z:R=(K-J)/F+4;break}return{h:R*60%360,s:clamp(S*100,0,100),v:clamp(o*100,0,100)}},B.hsvToHsl=function(G){var K=G.s/100,J=G.v/100,Z=(2-K)*J,M=Z<=1?Z:2-Z,E=M<1e-9?0:K*J/M;return{h:G.h,s:clamp(E*100,0,100),l:clamp(Z*50,0,100)}},B.hslToHsv=function(G){var K=G.l*2,J=G.s*(K<=100?K:200-K)/100,Z=K+J<1e-9?0:2*J/(K+J);return{h:G.h,s:clamp(Z*100,0,100),v:clamp((K+J)/2,0,100)}},B.kelvinToRgb=function(G){var K=G/100,J,Z,M;return K<66?(J=255,Z=-155.25485562709179-.44596950469579133*(Z=K-2)+104.49216199393888*log(Z),M=K<20?0:-254.76935184120902+.8274096064007395*(M=K-10)+115.67994401066147*log(M)):(J=351.97690566805693+.114206453784165*(J=K-55)-40.25366309332127*log(J),Z=325.4494125711974+.07943456536662342*(Z=K-50)-28.0852963507957*log(Z),M=255),{r:clamp(floor(J),0,255),g:clamp(floor(Z),0,255),b:clamp(floor(M),0,255)}},B.rgbToKelvin=function(G){for(var K=G.r,J=G.b,Z=.4,M=KELVIN_MIN,E=KELVIN_MAX,F;E-M>Z;){F=(E+M)*.5;var R=B.kelvinToRgb(F);R.b/R.r>=J/K?E=F:M=F}return F},_createClass(B,[{key:"hsv",get:function(){var G=this.$;return{h:G.h,s:G.s,v:G.v}},set:function(G){var K=this.$;if(G=_extends({},K,G),this.onChange){var J={h:!1,v:!1,s:!1,a:!1};for(var Z in K)J[Z]=G[Z]!=K[Z];this.$=G,(J.h||J.s||J.v||J.a)&&this.onChange(this,J)}else this.$=G}},{key:"hsva",get:function(){return _extends({},this.$)},set:function(G){this.hsv=G}},{key:"hue",get:function(){return this.$.h},set:function(G){this.hsv={h:G}}},{key:"saturation",get:function(){return this.$.s},set:function(G){this.hsv={s:G}}},{key:"value",get:function(){return this.$.v},set:function(G){this.hsv={v:G}}},{key:"alpha",get:function(){return this.$.a},set:function(G){this.hsv=_extends({},this.hsv,{a:G})}},{key:"kelvin",get:function(){return B.rgbToKelvin(this.rgb)},set:function(G){this.rgb=B.kelvinToRgb(G)}},{key:"red",get:function(){var G=this.rgb;return G.r},set:function(G){this.rgb=_extends({},this.rgb,{r:G})}},{key:"green",get:function(){var G=this.rgb;return G.g},set:function(G){this.rgb=_extends({},this.rgb,{g:G})}},{key:"blue",get:function(){var G=this.rgb;return G.b},set:function(G){this.rgb=_extends({},this.rgb,{b:G})}},{key:"rgb",get:function(){var G=B.hsvToRgb(this.$),K=G.r,J=G.g,Z=G.b;return{r:round(K),g:round(J),b:round(Z)}},set:function(G){this.hsv=_extends({},B.rgbToHsv(G),{a:G.a===void 0?1:G.a})}},{key:"rgba",get:function(){return _extends({},this.rgb,{a:this.alpha})},set:function(G){this.rgb=G}},{key:"hsl",get:function(){var G=B.hsvToHsl(this.$),K=G.h,J=G.s,Z=G.l;return{h:round(K),s:round(J),l:round(Z)}},set:function(G){this.hsv=_extends({},B.hslToHsv(G),{a:G.a===void 0?1:G.a})}},{key:"hsla",get:function(){return _extends({},this.hsl,{a:this.alpha})},set:function(G){this.hsl=G}},{key:"rgbString",get:function(){var G=this.rgb;return"rgb("+G.r+", "+G.g+", "+G.b+")"},set:function(G){var K,J,Z,M,E=1;if((K=REGEX_FUNCTIONAL_RGB.exec(G))?(J=parseUnit(K[1],255),Z=parseUnit(K[2],255),M=parseUnit(K[3],255)):(K=REGEX_FUNCTIONAL_RGBA.exec(G))&&(J=parseUnit(K[1],255),Z=parseUnit(K[2],255),M=parseUnit(K[3],255),E=parseUnit(K[4],1)),K)this.rgb={r:J,g:Z,b:M,a:E};else throw new Error("Invalid rgb string")}},{key:"rgbaString",get:function(){var G=this.rgba;return"rgba("+G.r+", "+G.g+", "+G.b+", "+G.a+")"},set:function(G){this.rgbString=G}},{key:"hexString",get:function(){var G=this.rgb;return"#"+intToHex(G.r)+intToHex(G.g)+intToHex(G.b)},set:function(G){var K,J,Z,M,E=255;if((K=REGEX_HEX_3.exec(G))?(J=parseHexInt(K[1])*17,Z=parseHexInt(K[2])*17,M=parseHexInt(K[3])*17):(K=REGEX_HEX_4.exec(G))?(J=parseHexInt(K[1])*17,Z=parseHexInt(K[2])*17,M=parseHexInt(K[3])*17,E=parseHexInt(K[4])*17):(K=REGEX_HEX_6.exec(G))?(J=parseHexInt(K[1]),Z=parseHexInt(K[2]),M=parseHexInt(K[3])):(K=REGEX_HEX_8.exec(G))&&(J=parseHexInt(K[1]),Z=parseHexInt(K[2]),M=parseHexInt(K[3]),E=parseHexInt(K[4])),K)this.rgb={r:J,g:Z,b:M,a:E/255};else throw new Error("Invalid hex string")}},{key:"hex8String",get:function(){var G=this.rgba;return"#"+intToHex(G.r)+intToHex(G.g)+intToHex(G.b)+intToHex(floor(G.a*255))},set:function(G){this.hexString=G}},{key:"hslString",get:function(){var G=this.hsl;return"hsl("+G.h+", "+G.s+"%, "+G.l+"%)"},set:function(G){var K,J,Z,M,E=1;if((K=REGEX_FUNCTIONAL_HSL.exec(G))?(J=parseUnit(K[1],360),Z=parseUnit(K[2],100),M=parseUnit(K[3],100)):(K=REGEX_FUNCTIONAL_HSLA.exec(G))&&(J=parseUnit(K[1],360),Z=parseUnit(K[2],100),M=parseUnit(K[3],100),E=parseUnit(K[4],1)),K)this.hsl={h:J,s:Z,l:M,a:E};else throw new Error("Invalid hsl string")}},{key:"hslaString",get:function(){var G=this.hsla;return"hsla("+G.h+", "+G.s+"%, "+G.l+"%, "+G.a+")"},set:function(G){this.hslString=G}}]),B}(),sliderDefaultOptions={sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3};function getSliderDimensions(B){var p,W=B.width,G=B.sliderSize,K=B.borderWidth,J=B.handleRadius,Z=B.padding,M=B.sliderShape,E=B.layoutDirection==="horizontal";return G=(p=G)!=null?p:Z*2+J*2,M==="circle"?{handleStart:B.padding+B.handleRadius,handleRange:W-Z*2-J*2,width:W,height:W,cx:W/2,cy:W/2,radius:W/2-K/2}:{handleStart:G/2,handleRange:W-G,radius:G/2,x:0,y:0,width:E?G:W,height:E?W:G}}function getCurrentSliderValue(B,p){var W=p.hsva,G=p.rgb;switch(B.sliderType){case"red":return G.r/2.55;case"green":return G.g/2.55;case"blue":return G.b/2.55;case"alpha":return W.a*100;case"kelvin":var K=B.minTemperature,J=B.maxTemperature,Z=J-K,M=(p.kelvin-K)/Z*100;return Math.max(0,Math.min(M,100));case"hue":return W.h/=3.6;case"saturation":return W.s;case"value":default:return W.v}}function getSliderValueFromInput(B,p,W){var G=getSliderDimensions(B),K=G.handleRange,J=G.handleStart,Z;B.layoutDirection==="horizontal"?Z=-1*W+K+J:Z=p-J,Z=Math.max(Math.min(Z,K),0);var M=Math.round(100/K*Z);switch(B.sliderType){case"kelvin":var E=B.minTemperature,F=B.maxTemperature,R=F-E;return E+R*(M/100);case"alpha":return M/100;case"hue":return M*3.6;case"red":case"blue":case"green":return M*2.55;default:return M}}function getSliderHandlePosition(B,p){var W=getSliderDimensions(B),G=W.width,K=W.height,J=W.handleRange,Z=W.handleStart,M=B.layoutDirection==="horizontal",E=getCurrentSliderValue(B,p),F=M?G/2:K/2,R=Z+E/100*J;return M&&(R=-1*R+J+Z*2),{x:M?F:R,y:M?R:F}}function getSliderGradient(B,p){var W=p.hsv,G=p.rgb;switch(B.sliderType){case"red":return[[0,"rgb(0,"+G.g+","+G.b+")"],[100,"rgb(255,"+G.g+","+G.b+")"]];case"green":return[[0,"rgb("+G.r+",0,"+G.b+")"],[100,"rgb("+G.r+",255,"+G.b+")"]];case"blue":return[[0,"rgb("+G.r+","+G.g+",0)"],[100,"rgb("+G.r+","+G.g+",255)"]];case"alpha":return[[0,"rgba("+G.r+","+G.g+","+G.b+",0)"],[100,"rgb("+G.r+","+G.g+","+G.b+")"]];case"kelvin":for(var K=[],J=B.minTemperature,Z=B.maxTemperature,M=8,E=Z-J,F=J,R=0;F<Z;F+=E/M,R+=1){var o=IroColor.kelvinToRgb(F),S=o.r,l=o.g,L=o.b;K.push([100/M*R,"rgb("+S+","+l+","+L+")"])}return K;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var q=IroColor.hsvToHsl({h:W.h,s:0,v:W.v}),O=IroColor.hsvToHsl({h:W.h,s:100,v:W.v});return[[0,"hsl("+q.h+","+q.s+"%,"+q.l+"%)"],[100,"hsl("+O.h+","+O.s+"%,"+O.l+"%)"]];case"value":default:var X=IroColor.hsvToHsl({h:W.h,s:W.s,v:100});return[[0,"#000"],[100,"hsl("+X.h+","+X.s+"%,"+X.l+"%)"]]}}var TAU=Math.PI*2,mod=function(p,W){return(p%W+W)%W},dist=function(p,W){return Math.sqrt(p*p+W*W)};function getHandleRange(B){return B.width/2-B.padding-B.handleRadius-B.borderWidth}function isInputInsideWheel(B,p,W){var G=getWheelDimensions(B),K=G.cx,J=G.cy,Z=B.width/2;return dist(K-p,J-W)<Z}function getWheelDimensions(B){var p=B.width/2;return{width:B.width,radius:p-B.borderWidth,cx:p,cy:p}}function translateWheelAngle(B,p,W){var G=B.wheelAngle,K=B.wheelDirection;return W&&K==="clockwise"?p=G+p:K==="clockwise"?p=360-G+p:W&&K==="anticlockwise"?p=G+180-p:K==="anticlockwise"&&(p=G-p),mod(p,360)}function getWheelHandlePosition(B,p){var W=p.hsv,G=getWheelDimensions(B),K=G.cx,J=G.cy,Z=getHandleRange(B),M=(180+translateWheelAngle(B,W.h,!0))*(TAU/360),E=W.s/100*Z,F=B.wheelDirection==="clockwise"?-1:1;return{x:K+E*Math.cos(M)*F,y:J+E*Math.sin(M)*F}}function getWheelValueFromInput(B,p,W){var G=getWheelDimensions(B),K=G.cx,J=G.cy,Z=getHandleRange(B);p=K-p,W=J-W;var M=translateWheelAngle(B,Math.atan2(-W,-p)*(360/TAU)),E=Math.min(dist(p,W),Z);return{h:Math.round(M),s:Math.round(100/Z*E)}}function getBoxDimensions(B){var p=B.width,W=B.boxHeight,G=B.padding,K=B.handleRadius;return{width:p,height:W??p,radius:G+K}}function getBoxValueFromInput(B,p,W){var G=getBoxDimensions(B),K=G.width,J=G.height,Z=G.radius,M=Z,E=K-Z*2,F=J-Z*2,R=(p-M)/E*100,o=(W-M)/F*100;return{s:Math.max(0,Math.min(R,100)),v:Math.max(0,Math.min(100-o,100))}}function getBoxHandlePosition(B,p){var W=getBoxDimensions(B),G=W.width,K=W.height,J=W.radius,Z=p.hsv,M=J,E=G-J*2,F=K-J*2;return{x:M+Z.s/100*E,y:M+(F-Z.v/100*F)}}function getBoxGradients(B,p){var W=p.hue;return[[[0,"#fff"],[100,"hsl("+W+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]]}var BASE_ELEMENTS;function resolveSvgUrl(B){BASE_ELEMENTS||(BASE_ELEMENTS=document.getElementsByTagName("base"));var p=window.navigator.userAgent,W=/^((?!chrome|android).)*safari/i.test(p),G=/iPhone|iPod|iPad/i.test(p),K=window.location;return(W||G)&&BASE_ELEMENTS.length>0?K.protocol+"//"+K.host+K.pathname+K.search+B:B}function getHandleAtPoint(B,p,W,G){for(var K=0;K<G.length;K++){var J=G[K].x-p,Z=G[K].y-W,M=Math.sqrt(J*J+Z*Z);if(M<B.handleRadius)return K}return null}function cssBorderStyles(B){return{boxSizing:"border-box",border:B.borderWidth+"px solid "+B.borderColor}}function cssGradient(B,p,W){return B+"-gradient("+p+", "+W.map(function(G){var K=G[0],J=G[1];return J+" "+K+"%"}).join(",")+")"}function cssValue(B){return typeof B=="string"?B:B+"px"}var iroColorPickerOptionDefaults={width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},SECONDARY_EVENTS=["mousemove","touchmove","mouseup","touchend"],IroComponentWrapper=function(B){function p(W){B.call(this,W),this.uid=(Math.random()+1).toString(36).substring(5)}return B&&(p.__proto__=B),p.prototype=Object.create(B&&B.prototype),p.prototype.constructor=p,p.prototype.render=function(G){var K=this.handleEvent.bind(this),J={onMouseDown:K,ontouchstart:K},Z=G.layoutDirection==="horizontal",M=G.margin===null?G.sliderMargin:G.margin,E={overflow:"visible",display:Z?"inline-block":"block"};return G.index>0&&(E[Z?"marginLeft":"marginTop"]=M),h(d,null,G.children(this.uid,J,E))},p.prototype.handleEvent=function(G){var K=this,J=this.props.onInput,Z=this.base.getBoundingClientRect();G.preventDefault();var M=G.touches?G.changedTouches[0]:G,E=M.clientX-Z.left,F=M.clientY-Z.top;switch(G.type){case"mousedown":case"touchstart":var R=J(E,F,0);R!==!1&&SECONDARY_EVENTS.forEach(function(o){document.addEventListener(o,K,{passive:!1})});break;case"mousemove":case"touchmove":J(E,F,1);break;case"mouseup":case"touchend":J(E,F,2),SECONDARY_EVENTS.forEach(function(o){document.removeEventListener(o,K,{passive:!1})});break}},p}(m);function IroHandle(B){var p=B.r,W=B.url,G=p,K=p;return h("svg",{className:"IroHandle IroHandle--"+B.index+" "+(B.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+cssValue(B.x)+", "+cssValue(B.y)+")",willChange:"transform",top:cssValue(-p),left:cssValue(-p),width:cssValue(p*2),height:cssValue(p*2),position:"absolute",overflow:"visible"}},W&&h("use",Object.assign({xlinkHref:resolveSvgUrl(W)},B.props)),!W&&h("circle",{cx:G,cy:K,r:p,fill:"none","stroke-width":2,stroke:"#000"}),!W&&h("circle",{cx:G,cy:K,r:p-2,fill:B.fill,"stroke-width":2,stroke:"#fff"}))}IroHandle.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}};function IroSlider(B){var p=B.activeIndex,W=p!==void 0&&p<B.colors.length?B.colors[p]:B.color,G=getSliderDimensions(B),K=G.width,J=G.height,Z=G.radius,M=getSliderHandlePosition(B,W),E=getSliderGradient(B,W);function F(R,o,S){var l=getSliderValueFromInput(B,R,o);B.parent.inputActive=!0,W[B.sliderType]=l,B.onInput(S,B.id)}return h(IroComponentWrapper,Object.assign({},B,{onInput:F}),function(R,o,S){return h("div",Object.assign({},o,{className:"IroSlider",style:Object.assign({},{position:"relative",width:cssValue(K),height:cssValue(J),borderRadius:cssValue(Z),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},S)}),h("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:cssValue(Z),background:cssGradient("linear",B.layoutDirection==="horizontal"?"to top":"to right",E)},cssBorderStyles(B))}),h(IroHandle,{isActive:!0,index:W.index,r:B.handleRadius,url:B.handleSvg,props:B.handleProps,x:M.x,y:M.y}))})}IroSlider.defaultProps=Object.assign({},sliderDefaultOptions);function IroBox(B){var p=getBoxDimensions(B),W=p.width,G=p.height,K=p.radius,J=B.colors,Z=B.parent,M=B.activeIndex,E=M!==void 0&&M<B.colors.length?B.colors[M]:B.color,F=getBoxGradients(B,E),R=J.map(function(S){return getBoxHandlePosition(B,S)});function o(S,l,L){if(L===0){var q=getHandleAtPoint(B,S,l,R);q!==null?Z.setActiveColor(q):(Z.inputActive=!0,E.hsv=getBoxValueFromInput(B,S,l),B.onInput(L,B.id))}else L===1&&(Z.inputActive=!0,E.hsv=getBoxValueFromInput(B,S,l));B.onInput(L,B.id)}return h(IroComponentWrapper,Object.assign({},B,{onInput:o}),function(S,l,L){return h("div",Object.assign({},l,{className:"IroBox",style:Object.assign({},{width:cssValue(W),height:cssValue(G),position:"relative"},L)}),h("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:cssValue(K)},cssBorderStyles(B),{background:cssGradient("linear","to bottom",F[1])+","+cssGradient("linear","to right",F[0])})}),J.filter(function(q){return q!==E}).map(function(q){return h(IroHandle,{isActive:!1,index:q.index,fill:q.hslString,r:B.handleRadius,url:B.handleSvg,props:B.handleProps,x:R[q.index].x,y:R[q.index].y})}),h(IroHandle,{isActive:!0,index:E.index,fill:E.hslString,r:B.activeHandleRadius||B.handleRadius,url:B.handleSvg,props:B.handleProps,x:R[E.index].x,y:R[E.index].y}))})}var HUE_GRADIENT_CLOCKWISE="conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",HUE_GRADIENT_ANTICLOCKWISE="conic-gradient(red, magenta, blue, aqua, lime, yellow, red)";function IroWheel(B){var p=getWheelDimensions(B),W=p.width,G=B.colors;B.borderWidth;var K=B.parent,J=B.color,Z=J.hsv,M=G.map(function(R){return getWheelHandlePosition(B,R)}),E={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};function F(R,o,S){if(S===0){if(!isInputInsideWheel(B,R,o))return!1;var l=getHandleAtPoint(B,R,o,M);l!==null?K.setActiveColor(l):(K.inputActive=!0,J.hsv=getWheelValueFromInput(B,R,o),B.onInput(S,B.id))}else S===1&&(K.inputActive=!0,J.hsv=getWheelValueFromInput(B,R,o));B.onInput(S,B.id)}return h(IroComponentWrapper,Object.assign({},B,{onInput:F}),function(R,o,S){return h("div",Object.assign({},o,{className:"IroWheel",style:Object.assign({},{width:cssValue(W),height:cssValue(W),position:"relative"},S)}),h("div",{className:"IroWheelHue",style:Object.assign({},E,{transform:"rotateZ("+(B.wheelAngle+90)+"deg)",background:B.wheelDirection==="clockwise"?HUE_GRADIENT_CLOCKWISE:HUE_GRADIENT_ANTICLOCKWISE})}),h("div",{className:"IroWheelSaturation",style:Object.assign({},E,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),B.wheelLightness&&h("div",{className:"IroWheelLightness",style:Object.assign({},E,{background:"#000",opacity:1-Z.v/100})}),h("div",{className:"IroWheelBorder",style:Object.assign({},E,cssBorderStyles(B))}),G.filter(function(l){return l!==J}).map(function(l){return h(IroHandle,{isActive:!1,index:l.index,fill:l.hslString,r:B.handleRadius,url:B.handleSvg,props:B.handleProps,x:M[l.index].x,y:M[l.index].y})}),h(IroHandle,{isActive:!0,index:J.index,fill:J.hslString,r:B.activeHandleRadius||B.handleRadius,url:B.handleSvg,props:B.handleProps,x:M[J.index].x,y:M[J.index].y}))})}function createWidget(B){var p=function(W,G){var K,J=document.createElement("div");I(h(B,Object.assign({},{ref:function(M){return K=M}},G)),J);function Z(){var M=W instanceof Element?W:document.querySelector(W);M.appendChild(K.base),K.onMount(M)}return document.readyState!=="loading"?Z():document.addEventListener("DOMContentLoaded",Z),K};return p.prototype=B.prototype,Object.assign(p,B),p.__component=B,p}var IroColorPicker=function(B){function p(W){var G=this;B.call(this,W),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=W.id;var K=W.colors.length>0?W.colors:[W.color];K.forEach(function(J){return G.addColor(J)}),this.setActiveColor(0),this.state=Object.assign({},W,{color:this.color,colors:this.colors,layout:W.layout})}return B&&(p.__proto__=B),p.prototype=Object.create(B&&B.prototype),p.prototype.constructor=p,p.prototype.addColor=function(G,K){K===void 0&&(K=this.colors.length);var J=new IroColor(G,this.onColorChange.bind(this));this.colors.splice(K,0,J),this.colors.forEach(function(Z,M){return Z.index=M}),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",J)},p.prototype.removeColor=function(G){var K=this.colors.splice(G,1)[0];K.unbind(),this.colors.forEach(function(J,Z){return J.index=Z}),this.state&&this.setState({colors:this.colors}),K.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",K)},p.prototype.setActiveColor=function(G){this.color=this.colors[G],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},p.prototype.setColors=function(G,K){var J=this;K===void 0&&(K=0),this.colors.forEach(function(Z){return Z.unbind()}),this.colors=[],G.forEach(function(Z){return J.addColor(Z)}),this.setActiveColor(K),this.emit("color:setAll",this.colors)},p.prototype.on=function(G,K){var J=this,Z=this.events;(Array.isArray(G)?G:[G]).forEach(function(M){(Z[M]||(Z[M]=[])).push(K),J.deferredEvents[M]&&(J.deferredEvents[M].forEach(function(E){K.apply(null,E)}),J.deferredEvents[M]=[])})},p.prototype.off=function(G,K){var J=this;(Array.isArray(G)?G:[G]).forEach(function(Z){var M=J.events[Z];M&&M.splice(M.indexOf(K),1)})},p.prototype.emit=function(G){for(var K=this,J=[],Z=arguments.length-1;Z-- >0;)J[Z]=arguments[Z+1];var M=this.activeEvents,E=M.hasOwnProperty(G)?M[G]:!1;if(!E){M[G]=!0;var F=this.events[G]||[];F.forEach(function(R){return R.apply(K,J)}),M[G]=!1}},p.prototype.deferredEmit=function(G){for(var K,J=[],Z=arguments.length-1;Z-- >0;)J[Z]=arguments[Z+1];var M=this.deferredEvents;(K=this).emit.apply(K,[G].concat(J)),(M[G]||(M[G]=[])).push(J)},p.prototype.setOptions=function(G){this.setState(G)},p.prototype.resize=function(G){this.setOptions({width:G})},p.prototype.reset=function(){this.colors.forEach(function(G){return G.reset()}),this.setState({colors:this.colors})},p.prototype.onMount=function(G){this.el=G,this.deferredEmit("mount",this)},p.prototype.onColorChange=function(G,K){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",G,K)),this.emit("color:change",G,K)},p.prototype.emitInputEvent=function(G,K){G===0?this.emit("input:start",this.color,K):G===1?this.emit("input:move",this.color,K):G===2&&this.emit("input:end",this.color,K)},p.prototype.render=function(G,K){var J=this,Z=K.layout;if(!Array.isArray(Z)){switch(Z){default:Z=[{component:IroWheel},{component:IroSlider}]}K.transparency&&Z.push({component:IroSlider,options:{sliderType:"alpha"}})}return h("div",{class:"IroColorPicker",id:K.id,style:{display:K.display}},Z.map(function(M,E){var F=M.component,R=M.options;return h(F,Object.assign({},K,R,{ref:void 0,onInput:J.emitInputEvent.bind(J),parent:J,index:E}))}))},p}(m);IroColorPicker.defaultProps=Object.assign({},iroColorPickerOptionDefaults,{colors:[],display:"block",id:null,layout:"default",margin:null});var IroColorPickerWidget=createWidget(IroColorPicker),iro;(function(B){B.version="5.5.2",B.Color=IroColor,B.ColorPicker=IroColorPickerWidget,function(p){p.h=h,p.ComponentBase=IroComponentWrapper,p.Handle=IroHandle,p.Slider=IroSlider,p.Wheel=IroWheel,p.Box=IroBox}(B.ui||(B.ui={}))})(iro||(iro={}));var iro$1=iro,webfontloader={exports:{}};(function(B){(function(){function p(ae,me,Ie){return ae.call.apply(ae.bind,arguments)}function W(ae,me,Ie){if(!ae)throw Error();if(2<arguments.length){var Ee=Array.prototype.slice.call(arguments,2);return function(){var Ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ve,Ee),ae.apply(me,Ve)}}return function(){return ae.apply(me,arguments)}}function G(ae,me,Ie){return G=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:W,G.apply(null,arguments)}var K=Date.now||function(){return+new Date};function J(ae,me){this.a=ae,this.o=me||ae,this.c=this.o.document}var Z=!!window.FontFace;function M(ae,me,Ie,Ee){if(me=ae.c.createElement(me),Ie)for(var Ve in Ie)Ie.hasOwnProperty(Ve)&&(Ve=="style"?me.style.cssText=Ie[Ve]:me.setAttribute(Ve,Ie[Ve]));return Ee&&me.appendChild(ae.c.createTextNode(Ee)),me}function E(ae,me,Ie){ae=ae.c.getElementsByTagName(me)[0],ae||(ae=document.documentElement),ae.insertBefore(Ie,ae.lastChild)}function F(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}function R(ae,me,Ie){me=me||[],Ie=Ie||[];for(var Ee=ae.className.split(/\s+/),Ve=0;Ve<me.length;Ve+=1){for(var Je=!1,Qe=0;Qe<Ee.length;Qe+=1)if(me[Ve]===Ee[Qe]){Je=!0;break}Je||Ee.push(me[Ve])}for(me=[],Ve=0;Ve<Ee.length;Ve+=1){for(Je=!1,Qe=0;Qe<Ie.length;Qe+=1)if(Ee[Ve]===Ie[Qe]){Je=!0;break}Je||me.push(Ee[Ve])}ae.className=me.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function o(ae,me){for(var Ie=ae.className.split(/\s+/),Ee=0,Ve=Ie.length;Ee<Ve;Ee++)if(Ie[Ee]==me)return!0;return!1}function S(ae){return ae.o.location.hostname||ae.a.location.hostname}function l(ae,me,Ie){function Ee(){nt&&Ve&&Je&&(nt(Qe),nt=null)}me=M(ae,"link",{rel:"stylesheet",href:me,media:"all"});var Ve=!1,Je=!0,Qe=null,nt=Ie||null;Z?(me.onload=function(){Ve=!0,Ee()},me.onerror=function(){Ve=!0,Qe=Error("Stylesheet failed to load"),Ee()}):setTimeout(function(){Ve=!0,Ee()},0),E(ae,"head",me)}function L(ae,me,Ie,Ee){var Ve=ae.c.getElementsByTagName("head")[0];if(Ve){var Je=M(ae,"script",{src:me}),Qe=!1;return Je.onload=Je.onreadystatechange=function(){Qe||this.readyState&&this.readyState!="loaded"&&this.readyState!="complete"||(Qe=!0,Ie&&Ie(null),Je.onload=Je.onreadystatechange=null,Je.parentNode.tagName=="HEAD"&&Ve.removeChild(Je))},Ve.appendChild(Je),setTimeout(function(){Qe||(Qe=!0,Ie&&Ie(Error("Script load timeout")))},Ee||5e3),Je}return null}function q(){this.a=0,this.c=null}function O(ae){return ae.a++,function(){ae.a--,V(ae)}}function X(ae,me){ae.c=me,V(ae)}function V(ae){ae.a==0&&ae.c&&(ae.c(),ae.c=null)}function Y(ae){this.a=ae||"-"}Y.prototype.c=function(ae){for(var me=[],Ie=0;Ie<arguments.length;Ie++)me.push(arguments[Ie].replace(/[\W_]+/g,"").toLowerCase());return me.join(this.a)};function U(ae,me){this.c=ae,this.f=4,this.a="n";var Ie=(me||"n4").match(/^([nio])([1-9])$/i);Ie&&(this.a=Ie[1],this.f=parseInt(Ie[2],10))}function Q(ae){return fe(ae)+" "+(ae.f+"00")+" 300px "+te(ae.c)}function te(ae){var me=[];ae=ae.split(/,\s*/);for(var Ie=0;Ie<ae.length;Ie++){var Ee=ae[Ie].replace(/['"]/g,"");Ee.indexOf(" ")!=-1||/^\d/.test(Ee)?me.push("'"+Ee+"'"):me.push(Ee)}return me.join(",")}function se(ae){return ae.a+ae.f}function fe(ae){var me="normal";return ae.a==="o"?me="oblique":ae.a==="i"&&(me="italic"),me}function Se(ae){var me=4,Ie="n",Ee=null;return ae&&((Ee=ae.match(/(normal|oblique|italic)/i))&&Ee[1]&&(Ie=Ee[1].substr(0,1).toLowerCase()),(Ee=ae.match(/([1-9]00|normal|bold)/i))&&Ee[1]&&(/bold/i.test(Ee[1])?me=7:/[1-9]00/.test(Ee[1])&&(me=parseInt(Ee[1].substr(0,1),10)))),Ie+me}function Te(ae,me){this.c=ae,this.f=ae.o.document.documentElement,this.h=me,this.a=new Y("-"),this.j=me.events!==!1,this.g=me.classes!==!1}function Re(ae){ae.g&&R(ae.f,[ae.a.c("wf","loading")]),He(ae,"loading")}function je(ae){if(ae.g){var me=o(ae.f,ae.a.c("wf","active")),Ie=[],Ee=[ae.a.c("wf","loading")];me||Ie.push(ae.a.c("wf","inactive")),R(ae.f,Ie,Ee)}He(ae,"inactive")}function He(ae,me,Ie){ae.j&&ae.h[me]&&(Ie?ae.h[me](Ie.c,se(Ie)):ae.h[me]())}function ve(){this.c={}}function _e(ae,me,Ie){var Ee=[],Ve;for(Ve in me)if(me.hasOwnProperty(Ve)){var Je=ae.c[Ve];Je&&Ee.push(Je(me[Ve],Ie))}return Ee}function qe(ae,me){this.c=ae,this.f=me,this.a=M(this.c,"span",{"aria-hidden":"true"},this.f)}function Xe(ae){E(ae.c,"body",ae.a)}function Ge(ae){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+te(ae.c)+";"+("font-style:"+fe(ae)+";font-weight:"+(ae.f+"00")+";")}function re(ae,me,Ie,Ee,Ve,Je){this.g=ae,this.j=me,this.a=Ee,this.c=Ie,this.f=Ve||3e3,this.h=Je||void 0}re.prototype.start=function(){var ae=this.c.o.document,me=this,Ie=K(),Ee=new Promise(function(Qe,nt){function st(){K()-Ie>=me.f?nt():ae.fonts.load(Q(me.a),me.h).then(function(ht){1<=ht.length?Qe():setTimeout(st,25)},function(){nt()})}st()}),Ve=null,Je=new Promise(function(Qe,nt){Ve=setTimeout(nt,me.f)});Promise.race([Je,Ee]).then(function(){Ve&&(clearTimeout(Ve),Ve=null),me.g(me.a)},function(){me.j(me.a)})};function ce(ae,me,Ie,Ee,Ve,Je,Qe){this.v=ae,this.B=me,this.c=Ie,this.a=Ee,this.s=Qe||"BESbswy",this.f={},this.w=Ve||3e3,this.u=Je||null,this.m=this.j=this.h=this.g=null,this.g=new qe(this.c,this.s),this.h=new qe(this.c,this.s),this.j=new qe(this.c,this.s),this.m=new qe(this.c,this.s),ae=new U(this.a.c+",serif",se(this.a)),ae=Ge(ae),this.g.a.style.cssText=ae,ae=new U(this.a.c+",sans-serif",se(this.a)),ae=Ge(ae),this.h.a.style.cssText=ae,ae=new U("serif",se(this.a)),ae=Ge(ae),this.j.a.style.cssText=ae,ae=new U("sans-serif",se(this.a)),ae=Ge(ae),this.m.a.style.cssText=ae,Xe(this.g),Xe(this.h),Xe(this.j),Xe(this.m)}var ue={D:"serif",C:"sans-serif"},he=null;function pe(){if(he===null){var ae=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);he=!!ae&&(536>parseInt(ae[1],10)||parseInt(ae[1],10)===536&&11>=parseInt(ae[2],10))}return he}ce.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=K(),ne(this)};function oe(ae,me,Ie){for(var Ee in ue)if(ue.hasOwnProperty(Ee)&&me===ae.f[ue[Ee]]&&Ie===ae.f[ue[Ee]])return!0;return!1}function ne(ae){var me=ae.g.a.offsetWidth,Ie=ae.h.a.offsetWidth,Ee;(Ee=me===ae.f.serif&&Ie===ae.f["sans-serif"])||(Ee=pe()&&oe(ae,me,Ie)),Ee?K()-ae.A>=ae.w?pe()&&oe(ae,me,Ie)&&(ae.u===null||ae.u.hasOwnProperty(ae.a.c))?ye(ae,ae.v):ye(ae,ae.B):ge(ae):ye(ae,ae.v)}function ge(ae){setTimeout(G(function(){ne(this)},ae),50)}function ye(ae,me){setTimeout(G(function(){F(this.g.a),F(this.h.a),F(this.j.a),F(this.m.a),me(this.a)},ae),0)}function ke(ae,me,Ie){this.c=ae,this.a=me,this.f=0,this.m=this.j=!1,this.s=Ie}var xe=null;ke.prototype.g=function(ae){var me=this.a;me.g&&R(me.f,[me.a.c("wf",ae.c,se(ae).toString(),"active")],[me.a.c("wf",ae.c,se(ae).toString(),"loading"),me.a.c("wf",ae.c,se(ae).toString(),"inactive")]),He(me,"fontactive",ae),this.m=!0,Fe(this)},ke.prototype.h=function(ae){var me=this.a;if(me.g){var Ie=o(me.f,me.a.c("wf",ae.c,se(ae).toString(),"active")),Ee=[],Ve=[me.a.c("wf",ae.c,se(ae).toString(),"loading")];Ie||Ee.push(me.a.c("wf",ae.c,se(ae).toString(),"inactive")),R(me.f,Ee,Ve)}He(me,"fontinactive",ae),Fe(this)};function Fe(ae){--ae.f==0&&ae.j&&(ae.m?(ae=ae.a,ae.g&&R(ae.f,[ae.a.c("wf","active")],[ae.a.c("wf","loading"),ae.a.c("wf","inactive")]),He(ae,"active")):je(ae.a))}function Me(ae){this.j=ae,this.a=new ve,this.h=0,this.f=this.g=!0}Me.prototype.load=function(ae){this.c=new J(this.j,ae.context||this.j),this.g=ae.events!==!1,this.f=ae.classes!==!1,we(this,new Te(this.c,ae),ae)};function ze(ae,me,Ie,Ee,Ve){var Je=--ae.h==0;(ae.f||ae.g)&&setTimeout(function(){var Qe=Ve||null,nt=Ee||null||{};if(Ie.length===0&&Je)je(me.a);else{me.f+=Ie.length,Je&&(me.j=Je);var st,ht=[];for(st=0;st<Ie.length;st++){var ot=Ie[st],mt=nt[ot.c],_t=me.a,Ct=ot;if(_t.g&&R(_t.f,[_t.a.c("wf",Ct.c,se(Ct).toString(),"loading")]),He(_t,"fontloading",Ct),_t=null,xe===null)if(window.FontFace){var Ct=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),Lt=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);xe=Ct?42<parseInt(Ct[1],10):!Lt}else xe=!1;xe?_t=new re(G(me.g,me),G(me.h,me),me.c,ot,me.s,mt):_t=new ce(G(me.g,me),G(me.h,me),me.c,ot,me.s,Qe,mt),ht.push(_t)}for(st=0;st<ht.length;st++)ht[st].start()}},0)}function we(ae,me,Ie){var Ve=[],Ee=Ie.timeout;Re(me);var Ve=_e(ae.a,Ie,ae.c),Je=new ke(ae.c,me,Ee);for(ae.h=Ve.length,me=0,Ie=Ve.length;me<Ie;me++)Ve[me].load(function(Qe,nt,st){ze(ae,Je,Qe,nt,st)})}function be(ae,me){this.c=ae,this.a=me}be.prototype.load=function(ae){function me(){if(Je["__mti_fntLst"+Ee]){var Qe=Je["__mti_fntLst"+Ee](),nt=[],st;if(Qe)for(var ht=0;ht<Qe.length;ht++){var ot=Qe[ht].fontfamily;Qe[ht].fontStyle!=null&&Qe[ht].fontWeight!=null?(st=Qe[ht].fontStyle+Qe[ht].fontWeight,nt.push(new U(ot,st))):nt.push(new U(ot))}ae(nt)}else setTimeout(function(){me()},50)}var Ie=this,Ee=Ie.a.projectId,Ve=Ie.a.version;if(Ee){var Je=Ie.c.o;L(this.c,(Ie.a.api||"https://fast.fonts.net/jsapi")+"/"+Ee+".js"+(Ve?"?v="+Ve:""),function(Qe){Qe?ae([]):(Je["__MonotypeConfiguration__"+Ee]=function(){return Ie.a},me())}).id="__MonotypeAPIScript__"+Ee}else ae([])};function Pe(ae,me){this.c=ae,this.a=me}Pe.prototype.load=function(ae){var me,Ie,Ee=this.a.urls||[],Ve=this.a.families||[],Je=this.a.testStrings||{},Qe=new q;for(me=0,Ie=Ee.length;me<Ie;me++)l(this.c,Ee[me],O(Qe));var nt=[];for(me=0,Ie=Ve.length;me<Ie;me++)if(Ee=Ve[me].split(":"),Ee[1])for(var st=Ee[1].split(","),ht=0;ht<st.length;ht+=1)nt.push(new U(Ee[0],st[ht]));else nt.push(new U(Ee[0]));X(Qe,function(){ae(nt,Je)})};function Le(ae,me){ae?this.c=ae:this.c=Ce,this.a=[],this.f=[],this.g=me||""}var Ce="https://fonts.googleapis.com/css";function De(ae,me){for(var Ie=me.length,Ee=0;Ee<Ie;Ee++){var Ve=me[Ee].split(":");Ve.length==3&&ae.f.push(Ve.pop());var Je="";Ve.length==2&&Ve[1]!=""&&(Je=":"),ae.a.push(Ve.join(Je))}}function We(ae){if(ae.a.length==0)throw Error("No fonts to load!");if(ae.c.indexOf("kit=")!=-1)return ae.c;for(var me=ae.a.length,Ie=[],Ee=0;Ee<me;Ee++)Ie.push(ae.a[Ee].replace(/ /g,"+"));return me=ae.c+"?family="+Ie.join("%7C"),0<ae.f.length&&(me+="&subset="+ae.f.join(",")),0<ae.g.length&&(me+="&text="+encodeURIComponent(ae.g)),me}function et(ae){this.f=ae,this.a=[],this.c={}}var $e={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},Oe={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Ke={i:"i",italic:"i",n:"n",normal:"n"},tt=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function it(ae){for(var me=ae.f.length,Ie=0;Ie<me;Ie++){var Ee=ae.f[Ie].split(":"),Ve=Ee[0].replace(/\+/g," "),Je=["n4"];if(2<=Ee.length){var Qe,nt=Ee[1];if(Qe=[],nt)for(var nt=nt.split(","),st=nt.length,ht=0;ht<st;ht++){var ot;if(ot=nt[ht],ot.match(/^[\w-]+$/)){var mt=tt.exec(ot.toLowerCase());if(mt==null)ot="";else{if(ot=mt[2],ot=ot==null||ot==""?"n":Ke[ot],mt=mt[1],mt==null||mt=="")mt="4";else var _t=Oe[mt],mt=_t||(isNaN(mt)?"4":mt.substr(0,1));ot=[ot,mt].join("")}}else ot="";ot&&Qe.push(ot)}0<Qe.length&&(Je=Qe),Ee.length==3&&(Ee=Ee[2],Qe=[],Ee=Ee?Ee.split(","):Qe,0<Ee.length&&(Ee=$e[Ee[0]])&&(ae.c[Ve]=Ee))}for(ae.c[Ve]||(Ee=$e[Ve])&&(ae.c[Ve]=Ee),Ee=0;Ee<Je.length;Ee+=1)ae.a.push(new U(Ve,Je[Ee]))}}function lt(ae,me){this.c=ae,this.a=me}var rt={Arimo:!0,Cousine:!0,Tinos:!0};lt.prototype.load=function(ae){var me=new q,Ie=this.c,Ee=new Le(this.a.api,this.a.text),Ve=this.a.families;De(Ee,Ve);var Je=new et(Ve);it(Je),l(Ie,We(Ee),O(me)),X(me,function(){ae(Je.a,Je.c,rt)})};function dt(ae,me){this.c=ae,this.a=me}dt.prototype.load=function(ae){var me=this.a.id,Ie=this.c.o;me?L(this.c,(this.a.api||"https://use.typekit.net")+"/"+me+".js",function(Ee){if(Ee)ae([]);else if(Ie.Typekit&&Ie.Typekit.config&&Ie.Typekit.config.fn){Ee=Ie.Typekit.config.fn;for(var Ve=[],Je=0;Je<Ee.length;Je+=2)for(var Qe=Ee[Je],nt=Ee[Je+1],st=0;st<nt.length;st++)Ve.push(new U(Qe,nt[st]));try{Ie.Typekit.load({events:!1,classes:!1,async:!0})}catch{}ae(Ve)}},2e3):ae([])};function ct(ae,me){this.c=ae,this.f=me,this.a=[]}ct.prototype.load=function(ae){var me=this.f.id,Ie=this.c.o,Ee=this;me?(Ie.__webfontfontdeckmodule__||(Ie.__webfontfontdeckmodule__={}),Ie.__webfontfontdeckmodule__[me]=function(Ve,Je){for(var Qe=0,nt=Je.fonts.length;Qe<nt;++Qe){var st=Je.fonts[Qe];Ee.a.push(new U(st.name,Se("font-weight:"+st.weight+";font-style:"+st.style)))}ae(Ee.a)},L(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+S(this.c)+"/"+me+".js",function(Ve){Ve&&ae([])})):ae([])};var vt=new Me(window);vt.a.c.custom=function(ae,me){return new Pe(me,ae)},vt.a.c.fontdeck=function(ae,me){return new ct(me,ae)},vt.a.c.monotype=function(ae,me){return new be(me,ae)},vt.a.c.typekit=function(ae,me){return new dt(me,ae)},vt.a.c.google=function(ae,me){return new lt(me,ae)};var wt={load:G(vt.load,vt)};B.exports?B.exports=wt:(window.WebFont=wt,window.WebFontConfig&&vt.load(window.WebFontConfig))})()})(webfontloader);var webfontloaderExports=webfontloader.exports;const WebFont=getDefaultExportFromCjs(webfontloaderExports);function bind(B,p){return function(){return B.apply(p,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(B=>p=>{const W=toString.call(p);return B[W]||(B[W]=W.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=B=>(B=B.toLowerCase(),p=>kindOf(p)===B),typeOfTest=B=>p=>typeof p===B,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(B){return B!==null&&!isUndefined(B)&&B.constructor!==null&&!isUndefined(B.constructor)&&isFunction(B.constructor.isBuffer)&&B.constructor.isBuffer(B)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(B){let p;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?p=ArrayBuffer.isView(B):p=B&&B.buffer&&isArrayBuffer(B.buffer),p}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=B=>B!==null&&typeof B=="object",isBoolean=B=>B===!0||B===!1,isPlainObject=B=>{if(kindOf(B)!=="object")return!1;const p=getPrototypeOf(B);return(p===null||p===Object.prototype||Object.getPrototypeOf(p)===null)&&!(Symbol.toStringTag in B)&&!(Symbol.iterator in B)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=B=>isObject(B)&&isFunction(B.pipe),isFormData=B=>{let p;return B&&(typeof FormData=="function"&&B instanceof FormData||isFunction(B.append)&&((p=kindOf(B))==="formdata"||p==="object"&&isFunction(B.toString)&&B.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=B=>B.trim?B.trim():B.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(B,p,{allOwnKeys:W=!1}={}){if(B===null||typeof B>"u")return;let G,K;if(typeof B!="object"&&(B=[B]),isArray(B))for(G=0,K=B.length;G<K;G++)p.call(null,B[G],G,B);else{const J=W?Object.getOwnPropertyNames(B):Object.keys(B),Z=J.length;let M;for(G=0;G<Z;G++)M=J[G],p.call(null,B[M],M,B)}}function findKey(B,p){p=p.toLowerCase();const W=Object.keys(B);let G=W.length,K;for(;G-- >0;)if(K=W[G],p===K.toLowerCase())return K;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=B=>!isUndefined(B)&&B!==_global;function merge(){const{caseless:B}=isContextDefined(this)&&this||{},p={},W=(G,K)=>{const J=B&&findKey(p,K)||K;isPlainObject(p[J])&&isPlainObject(G)?p[J]=merge(p[J],G):isPlainObject(G)?p[J]=merge({},G):isArray(G)?p[J]=G.slice():p[J]=G};for(let G=0,K=arguments.length;G<K;G++)arguments[G]&&forEach(arguments[G],W);return p}const extend=(B,p,W,{allOwnKeys:G}={})=>(forEach(p,(K,J)=>{W&&isFunction(K)?B[J]=bind(K,W):B[J]=K},{allOwnKeys:G}),B),stripBOM=B=>(B.charCodeAt(0)===65279&&(B=B.slice(1)),B),inherits=(B,p,W,G)=>{B.prototype=Object.create(p.prototype,G),B.prototype.constructor=B,Object.defineProperty(B,"super",{value:p.prototype}),W&&Object.assign(B.prototype,W)},toFlatObject=(B,p,W,G)=>{let K,J,Z;const M={};if(p=p||{},B==null)return p;do{for(K=Object.getOwnPropertyNames(B),J=K.length;J-- >0;)Z=K[J],(!G||G(Z,B,p))&&!M[Z]&&(p[Z]=B[Z],M[Z]=!0);B=W!==!1&&getPrototypeOf(B)}while(B&&(!W||W(B,p))&&B!==Object.prototype);return p},endsWith=(B,p,W)=>{B=String(B),(W===void 0||W>B.length)&&(W=B.length),W-=p.length;const G=B.indexOf(p,W);return G!==-1&&G===W},toArray=B=>{if(!B)return null;if(isArray(B))return B;let p=B.length;if(!isNumber(p))return null;const W=new Array(p);for(;p-- >0;)W[p]=B[p];return W},isTypedArray=(B=>p=>B&&p instanceof B)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(B,p)=>{const G=(B&&B[Symbol.iterator]).call(B);let K;for(;(K=G.next())&&!K.done;){const J=K.value;p.call(B,J[0],J[1])}},matchAll=(B,p)=>{let W;const G=[];for(;(W=B.exec(p))!==null;)G.push(W);return G},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=B=>B.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(W,G,K){return G.toUpperCase()+K}),hasOwnProperty=(({hasOwnProperty:B})=>(p,W)=>B.call(p,W))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(B,p)=>{const W=Object.getOwnPropertyDescriptors(B),G={};forEach(W,(K,J)=>{let Z;(Z=p(K,J,B))!==!1&&(G[J]=Z||K)}),Object.defineProperties(B,G)},freezeMethods=B=>{reduceDescriptors(B,(p,W)=>{if(isFunction(B)&&["arguments","caller","callee"].indexOf(W)!==-1)return!1;const G=B[W];if(isFunction(G)){if(p.enumerable=!1,"writable"in p){p.writable=!1;return}p.set||(p.set=()=>{throw Error("Can not rewrite read-only method '"+W+"'")})}})},toObjectSet=(B,p)=>{const W={},G=K=>{K.forEach(J=>{W[J]=!0})};return isArray(B)?G(B):G(String(B).split(p)),W},noop=()=>{},toFiniteNumber=(B,p)=>B!=null&&Number.isFinite(B=+B)?B:p,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(B=16,p=ALPHABET.ALPHA_DIGIT)=>{let W="";const{length:G}=p;for(;B--;)W+=p[Math.random()*G|0];return W};function isSpecCompliantForm(B){return!!(B&&isFunction(B.append)&&B[Symbol.toStringTag]==="FormData"&&B[Symbol.iterator])}const toJSONObject=B=>{const p=new Array(10),W=(G,K)=>{if(isObject(G)){if(p.indexOf(G)>=0)return;if(!("toJSON"in G)){p[K]=G;const J=isArray(G)?[]:{};return forEach(G,(Z,M)=>{const E=W(Z,K+1);!isUndefined(E)&&(J[M]=E)}),p[K]=void 0,J}}return G};return W(B,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=B=>B&&(isObject(B)||isFunction(B))&&isFunction(B.then)&&isFunction(B.catch),_setImmediate=((B,p)=>B?setImmediate:p?((W,G)=>(_global.addEventListener("message",({source:K,data:J})=>{K===_global&&J===W&&G.length&&G.shift()()},!1),K=>{G.push(K),_global.postMessage(W,"*")}))(`axios@${Math.random()}`,[]):W=>setTimeout(W))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError(B,p,W,G,K){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=B,this.name="AxiosError",p&&(this.code=p),W&&(this.config=W),G&&(this.request=G),K&&(this.response=K,this.status=K.status?K.status:null)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(B=>{descriptors[B]={value:B}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(B,p,W,G,K,J)=>{const Z=Object.create(prototype$1);return utils$1.toFlatObject(B,Z,function(E){return E!==Error.prototype},M=>M!=="isAxiosError"),AxiosError.call(Z,B.message,p,W,G,K),Z.cause=B,Z.name=B.name,J&&Object.assign(Z,J),Z};const httpAdapter=null;function isVisitable(B){return utils$1.isPlainObject(B)||utils$1.isArray(B)}function removeBrackets(B){return utils$1.endsWith(B,"[]")?B.slice(0,-2):B}function renderKey(B,p,W){return B?B.concat(p).map(function(K,J){return K=removeBrackets(K),!W&&J?"["+K+"]":K}).join(W?".":""):p}function isFlatArray(B){return utils$1.isArray(B)&&!B.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(p){return/^is[A-Z]/.test(p)});function toFormData(B,p,W){if(!utils$1.isObject(B))throw new TypeError("target must be an object");p=p||new FormData,W=utils$1.toFlatObject(W,{metaTokens:!0,dots:!1,indexes:!1},!1,function(q,O){return!utils$1.isUndefined(O[q])});const G=W.metaTokens,K=W.visitor||R,J=W.dots,Z=W.indexes,E=(W.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(p);if(!utils$1.isFunction(K))throw new TypeError("visitor must be a function");function F(L){if(L===null)return"";if(utils$1.isDate(L))return L.toISOString();if(!E&&utils$1.isBlob(L))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(L)||utils$1.isTypedArray(L)?E&&typeof Blob=="function"?new Blob([L]):Buffer.from(L):L}function R(L,q,O){let X=L;if(L&&!O&&typeof L=="object"){if(utils$1.endsWith(q,"{}"))q=G?q:q.slice(0,-2),L=JSON.stringify(L);else if(utils$1.isArray(L)&&isFlatArray(L)||(utils$1.isFileList(L)||utils$1.endsWith(q,"[]"))&&(X=utils$1.toArray(L)))return q=removeBrackets(q),X.forEach(function(Y,U){!(utils$1.isUndefined(Y)||Y===null)&&p.append(Z===!0?renderKey([q],U,J):Z===null?q:q+"[]",F(Y))}),!1}return isVisitable(L)?!0:(p.append(renderKey(O,q,J),F(L)),!1)}const o=[],S=Object.assign(predicates,{defaultVisitor:R,convertValue:F,isVisitable});function l(L,q){if(!utils$1.isUndefined(L)){if(o.indexOf(L)!==-1)throw Error("Circular reference detected in "+q.join("."));o.push(L),utils$1.forEach(L,function(X,V){(!(utils$1.isUndefined(X)||X===null)&&K.call(p,X,utils$1.isString(V)?V.trim():V,q,S))===!0&&l(X,q?q.concat(V):[V])}),o.pop()}}if(!utils$1.isObject(B))throw new TypeError("data must be an object");return l(B),p}function encode$1(B){const p={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(B).replace(/[!'()~]|%20|%00/g,function(G){return p[G]})}function AxiosURLSearchParams(B,p){this._pairs=[],B&&toFormData(B,this,p)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(p,W){this._pairs.push([p,W])};prototype.toString=function(p){const W=p?function(G){return p.call(this,G,encode$1)}:encode$1;return this._pairs.map(function(K){return W(K[0])+"="+W(K[1])},"").join("&")};function encode(B){return encodeURIComponent(B).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(B,p,W){if(!p)return B;const G=W&&W.encode||encode;utils$1.isFunction(W)&&(W={serialize:W});const K=W&&W.serialize;let J;if(K?J=K(p,W):J=utils$1.isURLSearchParams(p)?p.toString():new AxiosURLSearchParams(p,W).toString(G),J){const Z=B.indexOf("#");Z!==-1&&(B=B.slice(0,Z)),B+=(B.indexOf("?")===-1?"?":"&")+J}return B}class InterceptorManager{constructor(){this.handlers=[]}use(p,W,G){return this.handlers.push({fulfilled:p,rejected:W,synchronous:G?G.synchronous:!1,runWhen:G?G.runWhen:null}),this.handlers.length-1}eject(p){this.handlers[p]&&(this.handlers[p]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(p){utils$1.forEach(this.handlers,function(G){G!==null&&p(G)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(B,p){return toFormData(B,new platform.classes.URLSearchParams,Object.assign({visitor:function(W,G,K,J){return platform.isNode&&utils$1.isBuffer(W)?(this.append(G,W.toString("base64")),!1):J.defaultVisitor.apply(this,arguments)}},p))}function parsePropPath(B){return utils$1.matchAll(/\w+|\[(\w*)]/g,B).map(p=>p[0]==="[]"?"":p[1]||p[0])}function arrayToObject(B){const p={},W=Object.keys(B);let G;const K=W.length;let J;for(G=0;G<K;G++)J=W[G],p[J]=B[J];return p}function formDataToJSON(B){function p(W,G,K,J){let Z=W[J++];if(Z==="__proto__")return!0;const M=Number.isFinite(+Z),E=J>=W.length;return Z=!Z&&utils$1.isArray(K)?K.length:Z,E?(utils$1.hasOwnProp(K,Z)?K[Z]=[K[Z],G]:K[Z]=G,!M):((!K[Z]||!utils$1.isObject(K[Z]))&&(K[Z]=[]),p(W,G,K[Z],J)&&utils$1.isArray(K[Z])&&(K[Z]=arrayToObject(K[Z])),!M)}if(utils$1.isFormData(B)&&utils$1.isFunction(B.entries)){const W={};return utils$1.forEachEntry(B,(G,K)=>{p(parsePropPath(G),K,W,0)}),W}return null}function stringifySafely(B,p,W){if(utils$1.isString(B))try{return(p||JSON.parse)(B),utils$1.trim(B)}catch(G){if(G.name!=="SyntaxError")throw G}return(W||JSON.stringify)(B)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(p,W){const G=W.getContentType()||"",K=G.indexOf("application/json")>-1,J=utils$1.isObject(p);if(J&&utils$1.isHTMLForm(p)&&(p=new FormData(p)),utils$1.isFormData(p))return K?JSON.stringify(formDataToJSON(p)):p;if(utils$1.isArrayBuffer(p)||utils$1.isBuffer(p)||utils$1.isStream(p)||utils$1.isFile(p)||utils$1.isBlob(p)||utils$1.isReadableStream(p))return p;if(utils$1.isArrayBufferView(p))return p.buffer;if(utils$1.isURLSearchParams(p))return W.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),p.toString();let M;if(J){if(G.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(p,this.formSerializer).toString();if((M=utils$1.isFileList(p))||G.indexOf("multipart/form-data")>-1){const E=this.env&&this.env.FormData;return toFormData(M?{"files[]":p}:p,E&&new E,this.formSerializer)}}return J||K?(W.setContentType("application/json",!1),stringifySafely(p)):p}],transformResponse:[function(p){const W=this.transitional||defaults.transitional,G=W&&W.forcedJSONParsing,K=this.responseType==="json";if(utils$1.isResponse(p)||utils$1.isReadableStream(p))return p;if(p&&utils$1.isString(p)&&(G&&!this.responseType||K)){const Z=!(W&&W.silentJSONParsing)&&K;try{return JSON.parse(p)}catch(M){if(Z)throw M.name==="SyntaxError"?AxiosError.from(M,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):M}}return p}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(p){return p>=200&&p<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],B=>{defaults.headers[B]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=B=>{const p={};let W,G,K;return B&&B.split(`
`).forEach(function(Z){K=Z.indexOf(":"),W=Z.substring(0,K).trim().toLowerCase(),G=Z.substring(K+1).trim(),!(!W||p[W]&&ignoreDuplicateOf[W])&&(W==="set-cookie"?p[W]?p[W].push(G):p[W]=[G]:p[W]=p[W]?p[W]+", "+G:G)}),p},$internals=Symbol("internals");function normalizeHeader(B){return B&&String(B).trim().toLowerCase()}function normalizeValue(B){return B===!1||B==null?B:utils$1.isArray(B)?B.map(normalizeValue):String(B)}function parseTokens(B){const p=Object.create(null),W=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let G;for(;G=W.exec(B);)p[G[1]]=G[2];return p}const isValidHeaderName=B=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(B.trim());function matchHeaderValue(B,p,W,G,K){if(utils$1.isFunction(G))return G.call(this,p,W);if(K&&(p=W),!!utils$1.isString(p)){if(utils$1.isString(G))return p.indexOf(G)!==-1;if(utils$1.isRegExp(G))return G.test(p)}}function formatHeader(B){return B.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(p,W,G)=>W.toUpperCase()+G)}function buildAccessors(B,p){const W=utils$1.toCamelCase(" "+p);["get","set","has"].forEach(G=>{Object.defineProperty(B,G+W,{value:function(K,J,Z){return this[G].call(this,p,K,J,Z)},configurable:!0})})}class AxiosHeaders{constructor(p){p&&this.set(p)}set(p,W,G){const K=this;function J(M,E,F){const R=normalizeHeader(E);if(!R)throw new Error("header name must be a non-empty string");const o=utils$1.findKey(K,R);(!o||K[o]===void 0||F===!0||F===void 0&&K[o]!==!1)&&(K[o||E]=normalizeValue(M))}const Z=(M,E)=>utils$1.forEach(M,(F,R)=>J(F,R,E));if(utils$1.isPlainObject(p)||p instanceof this.constructor)Z(p,W);else if(utils$1.isString(p)&&(p=p.trim())&&!isValidHeaderName(p))Z(parseHeaders(p),W);else if(utils$1.isHeaders(p))for(const[M,E]of p.entries())J(E,M,G);else p!=null&&J(W,p,G);return this}get(p,W){if(p=normalizeHeader(p),p){const G=utils$1.findKey(this,p);if(G){const K=this[G];if(!W)return K;if(W===!0)return parseTokens(K);if(utils$1.isFunction(W))return W.call(this,K,G);if(utils$1.isRegExp(W))return W.exec(K);throw new TypeError("parser must be boolean|regexp|function")}}}has(p,W){if(p=normalizeHeader(p),p){const G=utils$1.findKey(this,p);return!!(G&&this[G]!==void 0&&(!W||matchHeaderValue(this,this[G],G,W)))}return!1}delete(p,W){const G=this;let K=!1;function J(Z){if(Z=normalizeHeader(Z),Z){const M=utils$1.findKey(G,Z);M&&(!W||matchHeaderValue(G,G[M],M,W))&&(delete G[M],K=!0)}}return utils$1.isArray(p)?p.forEach(J):J(p),K}clear(p){const W=Object.keys(this);let G=W.length,K=!1;for(;G--;){const J=W[G];(!p||matchHeaderValue(this,this[J],J,p,!0))&&(delete this[J],K=!0)}return K}normalize(p){const W=this,G={};return utils$1.forEach(this,(K,J)=>{const Z=utils$1.findKey(G,J);if(Z){W[Z]=normalizeValue(K),delete W[J];return}const M=p?formatHeader(J):String(J).trim();M!==J&&delete W[J],W[M]=normalizeValue(K),G[M]=!0}),this}concat(...p){return this.constructor.concat(this,...p)}toJSON(p){const W=Object.create(null);return utils$1.forEach(this,(G,K)=>{G!=null&&G!==!1&&(W[K]=p&&utils$1.isArray(G)?G.join(", "):G)}),W}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([p,W])=>p+": "+W).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(p){return p instanceof this?p:new this(p)}static concat(p,...W){const G=new this(p);return W.forEach(K=>G.set(K)),G}static accessor(p){const G=(this[$internals]=this[$internals]={accessors:{}}).accessors,K=this.prototype;function J(Z){const M=normalizeHeader(Z);G[M]||(buildAccessors(K,Z),G[M]=!0)}return utils$1.isArray(p)?p.forEach(J):J(p),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:B},p)=>{let W=p[0].toUpperCase()+p.slice(1);return{get:()=>B,set(G){this[W]=G}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(B,p){const W=this||defaults$1,G=p||W,K=AxiosHeaders$1.from(G.headers);let J=G.data;return utils$1.forEach(B,function(M){J=M.call(W,J,K.normalize(),p?p.status:void 0)}),K.normalize(),J}function isCancel(B){return!!(B&&B.__CANCEL__)}function CanceledError(B,p,W){AxiosError.call(this,B??"canceled",AxiosError.ERR_CANCELED,p,W),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(B,p,W){const G=W.config.validateStatus;!W.status||!G||G(W.status)?B(W):p(new AxiosError("Request failed with status code "+W.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(W.status/100)-4],W.config,W.request,W))}function parseProtocol(B){const p=/^([-+\w]{1,25})(:?\/\/|:)/.exec(B);return p&&p[1]||""}function speedometer(B,p){B=B||10;const W=new Array(B),G=new Array(B);let K=0,J=0,Z;return p=p!==void 0?p:1e3,function(E){const F=Date.now(),R=G[J];Z||(Z=F),W[K]=E,G[K]=F;let o=J,S=0;for(;o!==K;)S+=W[o++],o=o%B;if(K=(K+1)%B,K===J&&(J=(J+1)%B),F-Z<p)return;const l=R&&F-R;return l?Math.round(S*1e3/l):void 0}}function throttle(B,p){let W=0,G=1e3/p,K,J;const Z=(F,R=Date.now())=>{W=R,K=null,J&&(clearTimeout(J),J=null),B.apply(null,F)};return[(...F)=>{const R=Date.now(),o=R-W;o>=G?Z(F,R):(K=F,J||(J=setTimeout(()=>{J=null,Z(K)},G-o)))},()=>K&&Z(K)]}const progressEventReducer=(B,p,W=3)=>{let G=0;const K=speedometer(50,250);return throttle(J=>{const Z=J.loaded,M=J.lengthComputable?J.total:void 0,E=Z-G,F=K(E),R=Z<=M;G=Z;const o={loaded:Z,total:M,progress:M?Z/M:void 0,bytes:E,rate:F||void 0,estimated:F&&M&&R?(M-Z)/F:void 0,event:J,lengthComputable:M!=null,[p?"download":"upload"]:!0};B(o)},W)},progressEventDecorator=(B,p)=>{const W=B!=null;return[G=>p[0]({lengthComputable:W,total:B,loaded:G}),p[1]]},asyncDecorator=B=>(...p)=>utils$1.asap(()=>B(...p)),isURLSameOrigin=platform.hasStandardBrowserEnv?((B,p)=>W=>(W=new URL(W,platform.origin),B.protocol===W.protocol&&B.host===W.host&&(p||B.port===W.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(B,p,W,G,K,J){const Z=[B+"="+encodeURIComponent(p)];utils$1.isNumber(W)&&Z.push("expires="+new Date(W).toGMTString()),utils$1.isString(G)&&Z.push("path="+G),utils$1.isString(K)&&Z.push("domain="+K),J===!0&&Z.push("secure"),document.cookie=Z.join("; ")},read(B){const p=document.cookie.match(new RegExp("(^|;\\s*)("+B+")=([^;]*)"));return p?decodeURIComponent(p[3]):null},remove(B){this.write(B,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(B){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(B)}function combineURLs(B,p){return p?B.replace(/\/?\/$/,"")+"/"+p.replace(/^\/+/,""):B}function buildFullPath(B,p){return B&&!isAbsoluteURL(p)?combineURLs(B,p):p}const headersToObject=B=>B instanceof AxiosHeaders$1?{...B}:B;function mergeConfig(B,p){p=p||{};const W={};function G(F,R,o,S){return utils$1.isPlainObject(F)&&utils$1.isPlainObject(R)?utils$1.merge.call({caseless:S},F,R):utils$1.isPlainObject(R)?utils$1.merge({},R):utils$1.isArray(R)?R.slice():R}function K(F,R,o,S){if(utils$1.isUndefined(R)){if(!utils$1.isUndefined(F))return G(void 0,F,o,S)}else return G(F,R,o,S)}function J(F,R){if(!utils$1.isUndefined(R))return G(void 0,R)}function Z(F,R){if(utils$1.isUndefined(R)){if(!utils$1.isUndefined(F))return G(void 0,F)}else return G(void 0,R)}function M(F,R,o){if(o in p)return G(F,R);if(o in B)return G(void 0,F)}const E={url:J,method:J,data:J,baseURL:Z,transformRequest:Z,transformResponse:Z,paramsSerializer:Z,timeout:Z,timeoutMessage:Z,withCredentials:Z,withXSRFToken:Z,adapter:Z,responseType:Z,xsrfCookieName:Z,xsrfHeaderName:Z,onUploadProgress:Z,onDownloadProgress:Z,decompress:Z,maxContentLength:Z,maxBodyLength:Z,beforeRedirect:Z,transport:Z,httpAgent:Z,httpsAgent:Z,cancelToken:Z,socketPath:Z,responseEncoding:Z,validateStatus:M,headers:(F,R,o)=>K(headersToObject(F),headersToObject(R),o,!0)};return utils$1.forEach(Object.keys(Object.assign({},B,p)),function(R){const o=E[R]||K,S=o(B[R],p[R],R);utils$1.isUndefined(S)&&o!==M||(W[R]=S)}),W}const resolveConfig=B=>{const p=mergeConfig({},B);let{data:W,withXSRFToken:G,xsrfHeaderName:K,xsrfCookieName:J,headers:Z,auth:M}=p;p.headers=Z=AxiosHeaders$1.from(Z),p.url=buildURL(buildFullPath(p.baseURL,p.url),B.params,B.paramsSerializer),M&&Z.set("Authorization","Basic "+btoa((M.username||"")+":"+(M.password?unescape(encodeURIComponent(M.password)):"")));let E;if(utils$1.isFormData(W)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)Z.setContentType(void 0);else if((E=Z.getContentType())!==!1){const[F,...R]=E?E.split(";").map(o=>o.trim()).filter(Boolean):[];Z.setContentType([F||"multipart/form-data",...R].join("; "))}}if(platform.hasStandardBrowserEnv&&(G&&utils$1.isFunction(G)&&(G=G(p)),G||G!==!1&&isURLSameOrigin(p.url))){const F=K&&J&&cookies.read(J);F&&Z.set(K,F)}return p},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(B){return new Promise(function(W,G){const K=resolveConfig(B);let J=K.data;const Z=AxiosHeaders$1.from(K.headers).normalize();let{responseType:M,onUploadProgress:E,onDownloadProgress:F}=K,R,o,S,l,L;function q(){l&&l(),L&&L(),K.cancelToken&&K.cancelToken.unsubscribe(R),K.signal&&K.signal.removeEventListener("abort",R)}let O=new XMLHttpRequest;O.open(K.method.toUpperCase(),K.url,!0),O.timeout=K.timeout;function X(){if(!O)return;const Y=AxiosHeaders$1.from("getAllResponseHeaders"in O&&O.getAllResponseHeaders()),Q={data:!M||M==="text"||M==="json"?O.responseText:O.response,status:O.status,statusText:O.statusText,headers:Y,config:B,request:O};settle(function(se){W(se),q()},function(se){G(se),q()},Q),O=null}"onloadend"in O?O.onloadend=X:O.onreadystatechange=function(){!O||O.readyState!==4||O.status===0&&!(O.responseURL&&O.responseURL.indexOf("file:")===0)||setTimeout(X)},O.onabort=function(){O&&(G(new AxiosError("Request aborted",AxiosError.ECONNABORTED,B,O)),O=null)},O.onerror=function(){G(new AxiosError("Network Error",AxiosError.ERR_NETWORK,B,O)),O=null},O.ontimeout=function(){let U=K.timeout?"timeout of "+K.timeout+"ms exceeded":"timeout exceeded";const Q=K.transitional||transitionalDefaults;K.timeoutErrorMessage&&(U=K.timeoutErrorMessage),G(new AxiosError(U,Q.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,B,O)),O=null},J===void 0&&Z.setContentType(null),"setRequestHeader"in O&&utils$1.forEach(Z.toJSON(),function(U,Q){O.setRequestHeader(Q,U)}),utils$1.isUndefined(K.withCredentials)||(O.withCredentials=!!K.withCredentials),M&&M!=="json"&&(O.responseType=K.responseType),F&&([S,L]=progressEventReducer(F,!0),O.addEventListener("progress",S)),E&&O.upload&&([o,l]=progressEventReducer(E),O.upload.addEventListener("progress",o),O.upload.addEventListener("loadend",l)),(K.cancelToken||K.signal)&&(R=Y=>{O&&(G(!Y||Y.type?new CanceledError(null,B,O):Y),O.abort(),O=null)},K.cancelToken&&K.cancelToken.subscribe(R),K.signal&&(K.signal.aborted?R():K.signal.addEventListener("abort",R)));const V=parseProtocol(K.url);if(V&&platform.protocols.indexOf(V)===-1){G(new AxiosError("Unsupported protocol "+V+":",AxiosError.ERR_BAD_REQUEST,B));return}O.send(J||null)})},composeSignals=(B,p)=>{const{length:W}=B=B?B.filter(Boolean):[];if(p||W){let G=new AbortController,K;const J=function(F){if(!K){K=!0,M();const R=F instanceof Error?F:this.reason;G.abort(R instanceof AxiosError?R:new CanceledError(R instanceof Error?R.message:R))}};let Z=p&&setTimeout(()=>{Z=null,J(new AxiosError(`timeout ${p} of ms exceeded`,AxiosError.ETIMEDOUT))},p);const M=()=>{B&&(Z&&clearTimeout(Z),Z=null,B.forEach(F=>{F.unsubscribe?F.unsubscribe(J):F.removeEventListener("abort",J)}),B=null)};B.forEach(F=>F.addEventListener("abort",J));const{signal:E}=G;return E.unsubscribe=()=>utils$1.asap(M),E}},composeSignals$1=composeSignals,streamChunk=function*(B,p){let W=B.byteLength;if(!p||W<p){yield B;return}let G=0,K;for(;G<W;)K=G+p,yield B.slice(G,K),G=K},readBytes=async function*(B,p){for await(const W of readStream(B))yield*streamChunk(W,p)},readStream=async function*(B){if(B[Symbol.asyncIterator]){yield*B;return}const p=B.getReader();try{for(;;){const{done:W,value:G}=await p.read();if(W)break;yield G}}finally{await p.cancel()}},trackStream=(B,p,W,G)=>{const K=readBytes(B,p);let J=0,Z,M=E=>{Z||(Z=!0,G&&G(E))};return new ReadableStream({async pull(E){try{const{done:F,value:R}=await K.next();if(F){M(),E.close();return}let o=R.byteLength;if(W){let S=J+=o;W(S)}E.enqueue(new Uint8Array(R))}catch(F){throw M(F),F}},cancel(E){return M(E),K.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(B=>p=>B.encode(p))(new TextEncoder):async B=>new Uint8Array(await new Response(B).arrayBuffer())),test=(B,...p)=>{try{return!!B(...p)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let B=!1;const p=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return B=!0,"half"}}).headers.has("Content-Type");return B&&!p}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(B=>B.body)};isFetchSupported&&(B=>{["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!resolvers[p]&&(resolvers[p]=utils$1.isFunction(B[p])?W=>W[p]():(W,G)=>{throw new AxiosError(`Response type '${p}' is not supported`,AxiosError.ERR_NOT_SUPPORT,G)})})})(new Response);const getBodyLength=async B=>{if(B==null)return 0;if(utils$1.isBlob(B))return B.size;if(utils$1.isSpecCompliantForm(B))return(await new Request(platform.origin,{method:"POST",body:B}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(B)||utils$1.isArrayBuffer(B))return B.byteLength;if(utils$1.isURLSearchParams(B)&&(B=B+""),utils$1.isString(B))return(await encodeText(B)).byteLength},resolveBodyLength=async(B,p)=>{const W=utils$1.toFiniteNumber(B.getContentLength());return W??getBodyLength(p)},fetchAdapter=isFetchSupported&&(async B=>{let{url:p,method:W,data:G,signal:K,cancelToken:J,timeout:Z,onDownloadProgress:M,onUploadProgress:E,responseType:F,headers:R,withCredentials:o="same-origin",fetchOptions:S}=resolveConfig(B);F=F?(F+"").toLowerCase():"text";let l=composeSignals$1([K,J&&J.toAbortSignal()],Z),L;const q=l&&l.unsubscribe&&(()=>{l.unsubscribe()});let O;try{if(E&&supportsRequestStream&&W!=="get"&&W!=="head"&&(O=await resolveBodyLength(R,G))!==0){let Q=new Request(p,{method:"POST",body:G,duplex:"half"}),te;if(utils$1.isFormData(G)&&(te=Q.headers.get("content-type"))&&R.setContentType(te),Q.body){const[se,fe]=progressEventDecorator(O,progressEventReducer(asyncDecorator(E)));G=trackStream(Q.body,DEFAULT_CHUNK_SIZE,se,fe)}}utils$1.isString(o)||(o=o?"include":"omit");const X="credentials"in Request.prototype;L=new Request(p,{...S,signal:l,method:W.toUpperCase(),headers:R.normalize().toJSON(),body:G,duplex:"half",credentials:X?o:void 0});let V=await fetch(L);const Y=supportsResponseStream&&(F==="stream"||F==="response");if(supportsResponseStream&&(M||Y&&q)){const Q={};["status","statusText","headers"].forEach(Se=>{Q[Se]=V[Se]});const te=utils$1.toFiniteNumber(V.headers.get("content-length")),[se,fe]=M&&progressEventDecorator(te,progressEventReducer(asyncDecorator(M),!0))||[];V=new Response(trackStream(V.body,DEFAULT_CHUNK_SIZE,se,()=>{fe&&fe(),q&&q()}),Q)}F=F||"text";let U=await resolvers[utils$1.findKey(resolvers,F)||"text"](V,B);return!Y&&q&&q(),await new Promise((Q,te)=>{settle(Q,te,{data:U,headers:AxiosHeaders$1.from(V.headers),status:V.status,statusText:V.statusText,config:B,request:L})})}catch(X){throw q&&q(),X&&X.name==="TypeError"&&/fetch/i.test(X.message)?Object.assign(new AxiosError("Network Error",AxiosError.ERR_NETWORK,B,L),{cause:X.cause||X}):AxiosError.from(X,X&&X.code,B,L)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(B,p)=>{if(B){try{Object.defineProperty(B,"name",{value:p})}catch{}Object.defineProperty(B,"adapterName",{value:p})}});const renderReason=B=>`- ${B}`,isResolvedHandle=B=>utils$1.isFunction(B)||B===null||B===!1,adapters={getAdapter:B=>{B=utils$1.isArray(B)?B:[B];const{length:p}=B;let W,G;const K={};for(let J=0;J<p;J++){W=B[J];let Z;if(G=W,!isResolvedHandle(W)&&(G=knownAdapters[(Z=String(W)).toLowerCase()],G===void 0))throw new AxiosError(`Unknown adapter '${Z}'`);if(G)break;K[Z||"#"+J]=G}if(!G){const J=Object.entries(K).map(([M,E])=>`adapter ${M} `+(E===!1?"is not supported by the environment":"is not available in the build"));let Z=p?J.length>1?`since :
`+J.map(renderReason).join(`
`):" "+renderReason(J[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+Z,"ERR_NOT_SUPPORT")}return G},adapters:knownAdapters};function throwIfCancellationRequested(B){if(B.cancelToken&&B.cancelToken.throwIfRequested(),B.signal&&B.signal.aborted)throw new CanceledError(null,B)}function dispatchRequest(B){return throwIfCancellationRequested(B),B.headers=AxiosHeaders$1.from(B.headers),B.data=transformData.call(B,B.transformRequest),["post","put","patch"].indexOf(B.method)!==-1&&B.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(B.adapter||defaults$1.adapter)(B).then(function(G){return throwIfCancellationRequested(B),G.data=transformData.call(B,B.transformResponse,G),G.headers=AxiosHeaders$1.from(G.headers),G},function(G){return isCancel(G)||(throwIfCancellationRequested(B),G&&G.response&&(G.response.data=transformData.call(B,B.transformResponse,G.response),G.response.headers=AxiosHeaders$1.from(G.response.headers))),Promise.reject(G)})}const VERSION="1.7.9",validators$1={};["object","boolean","number","function","string","symbol"].forEach((B,p)=>{validators$1[B]=function(G){return typeof G===B||"a"+(p<1?"n ":" ")+B}});const deprecatedWarnings={};validators$1.transitional=function(p,W,G){function K(J,Z){return"[Axios v"+VERSION+"] Transitional option '"+J+"'"+Z+(G?". "+G:"")}return(J,Z,M)=>{if(p===!1)throw new AxiosError(K(Z," has been removed"+(W?" in "+W:"")),AxiosError.ERR_DEPRECATED);return W&&!deprecatedWarnings[Z]&&(deprecatedWarnings[Z]=!0,console.warn(K(Z," has been deprecated since v"+W+" and will be removed in the near future"))),p?p(J,Z,M):!0}};validators$1.spelling=function(p){return(W,G)=>(console.warn(`${G} is likely a misspelling of ${p}`),!0)};function assertOptions(B,p,W){if(typeof B!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const G=Object.keys(B);let K=G.length;for(;K-- >0;){const J=G[K],Z=p[J];if(Z){const M=B[J],E=M===void 0||Z(M,J,B);if(E!==!0)throw new AxiosError("option "+J+" must be "+E,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(W!==!0)throw new AxiosError("Unknown option "+J,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(p){this.defaults=p,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}async request(p,W){try{return await this._request(p,W)}catch(G){if(G instanceof Error){let K={};Error.captureStackTrace?Error.captureStackTrace(K):K=new Error;const J=K.stack?K.stack.replace(/^.+\n/,""):"";try{G.stack?J&&!String(G.stack).endsWith(J.replace(/^.+\n.+\n/,""))&&(G.stack+=`
`+J):G.stack=J}catch{}}throw G}}_request(p,W){typeof p=="string"?(W=W||{},W.url=p):W=p||{},W=mergeConfig(this.defaults,W);const{transitional:G,paramsSerializer:K,headers:J}=W;G!==void 0&&validator.assertOptions(G,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),K!=null&&(utils$1.isFunction(K)?W.paramsSerializer={serialize:K}:validator.assertOptions(K,{encode:validators.function,serialize:validators.function},!0)),validator.assertOptions(W,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),W.method=(W.method||this.defaults.method||"get").toLowerCase();let Z=J&&utils$1.merge(J.common,J[W.method]);J&&utils$1.forEach(["delete","get","head","post","put","patch","common"],L=>{delete J[L]}),W.headers=AxiosHeaders$1.concat(Z,J);const M=[];let E=!0;this.interceptors.request.forEach(function(q){typeof q.runWhen=="function"&&q.runWhen(W)===!1||(E=E&&q.synchronous,M.unshift(q.fulfilled,q.rejected))});const F=[];this.interceptors.response.forEach(function(q){F.push(q.fulfilled,q.rejected)});let R,o=0,S;if(!E){const L=[dispatchRequest.bind(this),void 0];for(L.unshift.apply(L,M),L.push.apply(L,F),S=L.length,R=Promise.resolve(W);o<S;)R=R.then(L[o++],L[o++]);return R}S=M.length;let l=W;for(o=0;o<S;){const L=M[o++],q=M[o++];try{l=L(l)}catch(O){q.call(this,O);break}}try{R=dispatchRequest.call(this,l)}catch(L){return Promise.reject(L)}for(o=0,S=F.length;o<S;)R=R.then(F[o++],F[o++]);return R}getUri(p){p=mergeConfig(this.defaults,p);const W=buildFullPath(p.baseURL,p.url);return buildURL(W,p.params,p.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(p){Axios.prototype[p]=function(W,G){return this.request(mergeConfig(G||{},{method:p,url:W,data:(G||{}).data}))}});utils$1.forEach(["post","put","patch"],function(p){function W(G){return function(J,Z,M){return this.request(mergeConfig(M||{},{method:p,headers:G?{"Content-Type":"multipart/form-data"}:{},url:J,data:Z}))}}Axios.prototype[p]=W(),Axios.prototype[p+"Form"]=W(!0)});const Axios$1=Axios;class CancelToken{constructor(p){if(typeof p!="function")throw new TypeError("executor must be a function.");let W;this.promise=new Promise(function(J){W=J});const G=this;this.promise.then(K=>{if(!G._listeners)return;let J=G._listeners.length;for(;J-- >0;)G._listeners[J](K);G._listeners=null}),this.promise.then=K=>{let J;const Z=new Promise(M=>{G.subscribe(M),J=M}).then(K);return Z.cancel=function(){G.unsubscribe(J)},Z},p(function(J,Z,M){G.reason||(G.reason=new CanceledError(J,Z,M),W(G.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(p){if(this.reason){p(this.reason);return}this._listeners?this._listeners.push(p):this._listeners=[p]}unsubscribe(p){if(!this._listeners)return;const W=this._listeners.indexOf(p);W!==-1&&this._listeners.splice(W,1)}toAbortSignal(){const p=new AbortController,W=G=>{p.abort(G)};return this.subscribe(W),p.signal.unsubscribe=()=>this.unsubscribe(W),p.signal}static source(){let p;return{token:new CancelToken(function(K){p=K}),cancel:p}}}const CancelToken$1=CancelToken;function spread(B){return function(W){return B.apply(null,W)}}function isAxiosError(B){return utils$1.isObject(B)&&B.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([B,p])=>{HttpStatusCode[p]=B});const HttpStatusCode$1=HttpStatusCode;function createInstance(B){const p=new Axios$1(B),W=bind(Axios$1.prototype.request,p);return utils$1.extend(W,Axios$1.prototype,p,{allOwnKeys:!0}),utils$1.extend(W,p,null,{allOwnKeys:!0}),W.create=function(K){return createInstance(mergeConfig(B,K))},W}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(p){return Promise.all(p)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=B=>formDataToJSON(utils$1.isHTMLForm(B)?new FormData(B):B);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios,convertRGBtoHex=(B,p,W)=>{const G=ColorChannelToHex(B),K=ColorChannelToHex(p),J=ColorChannelToHex(W);return`#${G}${K}${J}`},rgbToHex=B=>{let p=B.replace("rgb(","").replace(")","").split(","),W=parseInt(p[0],10),G=parseInt(p[1],10),K=parseInt(p[2],10);return W=W.toString(16),G=G.toString(16),K=K.toString(16),W.length<2&&(W="0"+W),G.length<2&&(G="0"+G),K.length<2&&(K="0"+K),"#"+W+G+K},hexToRgb=B=>{B=B.replace(/^#/,"");let p=parseInt(B,16),W=p>>16&255,G=p>>8&255,K=p&255;return`rgb(${W}, ${G}, ${K})`},hexToHsl=B=>{B=B.replace(/^#/,"");let p=parseInt(B,16),W=p>>16&255,G=p>>8&255,K=p&255;W/=255,G/=255,K/=255;let J=Math.max(W,G,K),Z=Math.min(W,G,K),M,E,F=(J+Z)/2;if(J==Z)M=E=0;else{let R=J-Z;switch(E=F>.5?R/(2-J-Z):R/(J+Z),J){case W:M=(G-K)/R+(G<K?6:0);break;case G:M=(K-W)/R+2;break;case K:M=(W-G)/R+4;break}M/=6}return M=Math.round(M*360),E=Math.round(E*100),F=Math.round(F*100),`hsl(${M}, ${E}%, ${F}%)`},rgbaToHex=B=>{let p=B.toString().match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)$/);if(!p&&(p=B.toString().match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),!p))return"HEX";const W=parseInt(p[1]),G=parseInt(p[2]),K=parseInt(p[3]),J=M=>{const E=M.toString(16);return E.length==1?"0"+E:E};return"#"+J(W)+J(G)+J(K)},ColorChannelToHex=B=>{const p=B==null?void 0:B.toString(16);return(p==null?void 0:p.length)===1?"0"+p:p};function rotateReset(B){if(B)if(B._objects&&B._objects.length){const p=B.getObjects(),W=B.getCenterPoint();p.forEach(G=>{const K=G.getCenterPoint();G.set("angle",0),G.set("matrix",[1,0,0,1,0,0]),G.set({originX:"center",originY:"center"}),G.setPositionByOrigin(new fabric.Point(K.x,K.y),"center","center")}),B.set("angle",0),B.set("matrix",[1,0,0,1,0,0]),B.set({originX:"center",originY:"center"}),B.setPositionByOrigin(new fabric.Point(W.x,W.y),"center","center"),B.canvas.renderAll()}else{const p=B.getCenterPoint();B.set("angle",0),B.set("matrix",[1,0,0,1,0,0]),B.set({originX:"center",originY:"center"}),B.setPositionByOrigin(new fabric.Point(p.x,p.y),"center","center"),B.canvas.renderAll()}}const querySelect=B=>document.querySelector(B),querySelectAll=B=>document.querySelectorAll(B),getAttr=(B,p)=>querySelect(B).getAttribute(p);function getTextCase(B){return B===B.toUpperCase()?"Uppercase":B===B.toLowerCase()?"Lowercase":B===B.charAt(0).toUpperCase()+B.slice(1).toLowerCase()?"Sentence Case":"Title Case"}async function saveCanvas(B,p,W,G,K,J,Z=!1){var Xe,Ge;let M=p._objects.filter(re=>re.id&&re.id.includes("external_layer_")),E=[],F=[],R=[];M.map(re=>{let ce=re.toJSON(["itemId","category","cacheHeight","cacheWidth","id","layerType","dataUrl","ext"]);re.text?F.push(ce):re.id.includes("upload_external_layer_")?R.push(ce):E.push(ce),p.remove(re)});const o=p.get("backgroundColor");p.setBackgroundColor(null,p.renderAll.bind(p));function S(re){if(!(re instanceof SVGElement))return console.error("The provided parameter is not a valid SVG element."),null;const ce=parseFloat(re.getAttribute("width")),ue=parseFloat(re.getAttribute("height")),he=ce/2,pe=ue/2,oe=document.createElementNS("http://www.w3.org/2000/svg","g");for(;re.firstChild;)oe.appendChild(re.firstChild);return re.appendChild(oe),oe.setAttribute("transform",`translate(${he}, ${pe})`),new XMLSerializer().serializeToString(re)}let l=[];const L=p.getObjects(),q=L.filter(re=>!re.text),O=p.get("width"),X=p.get("height"),V=new fabric$1.fabric.Group(q),Y=V.get("scaleY"),U=V.get("scaleX"),Q=V.get("left"),te=V.get("top");let se=null;(()=>{L.forEach(oe=>{oe.text&&(l.push(oe),p.remove(oe))}),p.set("width",300),p.set("height",300),p.renderAll();const re=3.2;V.set("scaleX",re),V.set("scaleY",re),p.viewportCenterObject(V),p.renderAll();const ce=p.toSVG(),pe=new DOMParser().parseFromString(ce,"image/svg+xml").querySelector("svg");return se=S(pe),console.log(se),se})(),p.set("width",O),p.set("height",X),p.renderAll(),V.set("scaleY",Y),V.set("scaleX",U),V.set("left",Q),V.set("top",te),V.ungroupOnCanvas(),l.forEach(re=>{p.add(re),re.setCoords()}),p.renderAll(),document.querySelector("#top_bottom_1").click();const Te=await(re=>new Promise(ce=>{re.map(he=>{p.add(he),p.renderAll()});const ue=p.toSVG();ce(ue)}))(M),Re=re=>{if(!re)return null;const{blur:ce,offsetX:ue,offsetY:he}=re,pe=[ce??0,ue??0,he??0],oe=pe.join(",");for(let ne=0;ne<pe.length;ne++)if(pe[ne]===pe[ne+1])return"0";return oe},je=G.get("fill"),He=K.get("fill"),ve=querySelect("#api_check").value,_e=Array.from(querySelect("#logo_colors_pallete").children).map(re=>rgbToHex(re.style.backgroundColor)),qe={buyer_logo_id:(Xe=querySelect("#buyer_logo_id"))==null?void 0:Xe.value,buyer_id:(Ge=querySelect("#buyer_Id"))==null?void 0:Ge.value,logo_id:B,brand_name:querySelect("#logoMainField").value,slogan:querySelect("#sloganNameField").value,svg_data:Te&&Te,logo_position:J,icon:se,layer_colors:_e.join(","),logo_backgroundcolor:o==="#efefef"?"transparent":o,brandName_color:je.includes("#")?je:rgbToHex(je),brandName_fontFamely:G.get("fontFamily"),brandName_fontSize:G.get("fontSize"),brandName_curve_diameter:G.diameter,brand_curve_percentage:G.get("percentage"),brandName_letterCase:getTextCase(G.text),brandName_fontStyle:G.get("fontStyle"),brandName_letterSpace:G.get("charSpacing")/10,brandName_droupShadow:Re(G.get("shadow")),slogan_color:He.includes("#")?He:rgbToHex(He),slogan_fontFamely:K.get("fontFamily"),slogan_fontSize:K.get("fontSize"),slogan_curve_diameter:K.get("diameter"),slogan_curve_percentage:K.get("percentage"),slogan_letterCase:getTextCase(K.text),slogan_fontStyle:K.get("fontStyle"),slogan_letterSpace:K.get("charSpacing")/10,slogan_droupShadow:Re(K.get("shadow")),externalLayerElements:JSON.stringify(E),externalTextElements:JSON.stringify(F),images:JSON.stringify(R),api_check:ve};try{if(p.get("backgroundColor")!==null)return toastNotification("backgroundColor issue while saving api");const re=await axios$1.post("https://www.mybrande.com/api/buyer/logo/store",qe);if((re==null?void 0:re.status)===200){const{buyer_logo_id:ce}=re.data;if(!ce)return toastNotification("Error encountered with buyer logo ID");querySelect("#buyer_logo_id").value=ce,p.setBackgroundColor(o,p.renderAll.bind(p)),Z?location.href=`https://www.mybrande.com/buyer/logo/downloadandpayment/${ce}`:location.href=`https://www.mybrande.com/user/logo/preview/${ce}`,toastNotification("Logo Saved Successfully")}}catch(re){console.log(re)}}class SaveHistory{constructor(p){Ft(this,"editorHistory",{state:!1,undo:[],redo:[]});Ft(this,"undoBtn",querySelect("#undo-btn"));Ft(this,"redoBtn",querySelect("#redo-btn"));this.canvas=p,this.eventListeners()}undoChanges(){let p=this;return new Promise(async W=>{p.editorHistory.undo.length==0?W(!0):await p.changeHistory(p.editorHistory.undo,p.editorHistory.redo),W(!0)})}redoChanges(){let p=this;return new Promise(async W=>{p.editorHistory.redo.length==0?W(!0):await p.changeHistory(p.editorHistory.redo,p.editorHistory.undo),W(!0)})}eventListeners(){let p=this;this.undoBtn.addEventListener("click",async function(){this.style.pointerEvents="none";let W=this.querySelector(".fa-undo");W.classList.add("spin"),p.editorHistory.undo&&await p.undoChanges(),this.style.pointerEvents="auto",W.classList.remove("spin"),p.canvas.undoCB()}),this.redoBtn.addEventListener("click",async function(){this.style.pointerEvents="none";let W=this.querySelector(".fa-redo");W.classList.add("spin"),p.editorHistory.redo.length&&await p.redoChanges(),this.style.pointerEvents="auto",W.classList.remove("spin"),p.canvas.undoCB()})}saveHistory(){this.editorHistory.redo=[],this.editorHistory.state&&this.editorHistory.undo.push(this.editorHistory.state);let p=this.canvas.toJSON(["id","layerId"]),W=[];p.objects.forEach((G,K)=>{G.type=="curved-text"&&(W.push(G),p.objects.splice(K,1))}),p.curvedTextObjects=W,this.editorHistory.state={json:p}}async changeHistory(p,W){W.push(this.editorHistory.state),this.editorHistory.state=p.pop(),this.canvas.clear();let G=this.editorHistory.state;if(!G)return!1;await this.canvasLoadFromJSON(G.json),this.canvas.updatePreview()}canvasLoadFromJSON(p){let W=this;return new Promise(async G=>{this.canvas.loadFromJSON(p,function(){p.curvedTextObjects.forEach(K=>{W.canvas.add(new fabric.CurvedText(K.text,K))}),W.canvas.renderAll(),G(!0)})})}}const curvedText=fabric.util.createClass(fabric.Object,{type:"curved-text",diameter:250,kerning:0,text:"",flipped:!1,cacheProperties:fabric.Object.prototype.cacheProperties.concat("diameter","text","kerning","flipped","fill","fontFamily","fontSize","fontWeight","fontStyle","strokeStyle","strokeWidth"),strokeStyle:null,_refresh:!0,strokeWidth:0,_cachedCanvas:null,_needsRecalculate:!0,initialize:function(B,p){p||(p={}),this.text=B,this.callSuper("initialize",p),this.set("lockUniScaling",!0),this._needsRecalculate=!0;var W=this.getCircularText();W=this._trimCanvas(W),this.set("width",W.width),this.set("height",W.height)},_getFontDeclaration:function(){return[fabric.isLikelyNode?this.fontWeight:this.fontStyle,fabric.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",fabric.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},_trimCanvas:function(B){try{for(var p=B.getContext("2d",{willReadFrequently:!0}),W=B.width,G=B.height,K={x:[],y:[]},J,Z=p.getImageData(0,0,W,G),M=function(o,S){return o-S},E=0;E<G;E++)for(var F=0;F<W;F++)Z.data[(E*W+F)*4+3]>0&&(K.x.push(F),K.y.push(E));K.x.sort(M),K.y.sort(M),J=K.x.length-1,W=K.x[J]-K.x[0],G=K.y[J]-K.y[0];var R=p.getImageData(K.x[0],K.y[0],W,G);return B.width=W,B.height=G,p.putImageData(R,0,0),B}catch{return!1}},getCircularText:function(){if(this._cachedCanvas&&!this._needsRecalculate)return this._cachedCanvas;var B=this.text.trim().length>1?this.text:"You don't set empty value in curved text",p=this.diameter,W=this.flipped,G=this.kerning,K=this.fill,J=!0,Z=0,M=fabric.util.createCanvasElement(),E=M.getContext("2d",{willReadFrequently:!0}),F,R,o=-1;W&&(Z=180,J=!1),Z*=Math.PI/180;var S=document.createElement("div");S.style.fontFamily=this.fontFamily,S.style.whiteSpace="nowrap",S.style.fontSize=this.fontSize+"px",S.style.fontWeight=this.fontWeight,S.style.fontStyle=this.fontStyle,S.textContent=B,document.body.appendChild(S);var l=S.offsetHeight;for(document.body.removeChild(S),M.width=M.height=p,E.font=this._getFontDeclaration(),J&&(B=B.split("").reverse().join("")),E.translate(p/2,p/2),Z+=Math.PI*!J,E.textBaseline="middle",E.textAlign="center",R=0;R<B.length;R++)F=E.measureText(B[R]).width,Z+=(F+(R==B.length-1?0:G))/(p/2-l)/2*-o;for(E.rotate(Z),R=0;R<B.length;R++)F=E.measureText(B[R]).width,E.rotate(F/2/(p/2-l)*o),this.strokeStyle&&this.strokeWidth&&(E.strokeStyle=this.strokeStyle,E.lineWidth=this.strokeWidth,E.miterLimit=2,E.strokeText(B[R],0,(J?1:-1)*(0-p/2+l/2))),E.fillStyle=K,E.fillText(B[R],0,(J?1:-1)*(0-p/2+l/2)),E.rotate((F/2+G)/(p/2-l)*o);return this._cachedCanvas=M,this._needsRecalculate=!1,this._cachedCanvas},_set:function(B,p){this.callSuper("_set",B,p),this._needsRecalculate=!0},_updateObj(B,p){switch(B){case"scaleX":this.fontSize*=p,this.diameter*=p,this.width*=p,this.scaleX=1,this.width<1&&(this.width=1);break;case"scaleY":this.height*=p,this.scaleY=1,this.height<1&&(this.height=1);break;default:this.callSuper("_set",B,p);break}this._needsRecalculate=!0},refreshCtx(B=!1){this._refresh=B},_render:function(B){if(!this._refresh&&this._cachedCanvas){B.drawImage(this._cachedCanvas,-this.width/2,-this.height/2,this.width,this.height);return}if(!this._cachedCanvas||this._needsRecalculate){var p=this.getCircularText();p=this._trimCanvas(p),this.set("width",p.width),this.set("height",p.height)}B.drawImage(p,-this.width/2,-this.height/2,this.width,this.height),this.setCoords()},toObject:function(B){return this.callSuper("toObject",["text","diameter","kerning","flipped","fill","fontFamily","fontSize","fontWeight","fontStyle","strokeStyle","strokeWidth"].concat(B))}});class applyLinearGradient{constructor(p,W,G){console.log(W,G),this.canvas=p,this.grad1=W,this.grad2=G,this.active=p.getActiveObject()}setColor(p=!1){const W=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:p?this.canvas.width:this.active.width,y2:p?this.canvas.height:this.active.height},colorStops:[{offset:0,color:this.grad1?this.grad1:"#ffffff"},{offset:1,color:this.grad2?this.grad2:"#000000"}]});p?this.canvas.setBackgroundColor(W):this.active.set("fill",W),this.canvas.renderAll()}}const getParsedColor=B=>{var p;if(B&&typeof B=="string")return B!=null&&B.includes("#")?B:B&&B.colorStops?rgbToHex((p=B==null?void 0:B.colorStops[0])==null?void 0:p.color):rgbToHex(B)};function updateColorPickers(B,p){if(!B||!p)throw new Error("couldn't find canvas");for(let W=0;W<=1;W++){let G=new Set;const K=querySelectAll("#logo_colors_pallete")[W],J=B==null?void 0:B.getObjects();if(!J)return;J==null||J.forEach(Z=>{let M=Z.get("fill");const E=document.createElement("div");if(getParsedColor(M)!==void 0){let F=getParsedColor(M);F=F.padEnd(7,"0"),G.has(F)||(G.add(F),E.setAttribute("id","color-layers-pickers"),E.style.background=M,E.className="color-picker",E.style.borderRadius="5px",K.append(E),F.includes("#ffffff")&&(E.style.border="1px solid #aaaaaa")),E.addEventListener("click",R=>{const o=rgbToHex(R.target.style.backgroundColor),S=B.getActiveObject();S&&S._objects&&S._objects.forEach(X=>{X.set("fill",o)}),S.set("fill",o),B.renderAll(),p.color.set(o),querySelect("#HEX").value=o;let L=hexToRgb(o).match(/\d+/g);L&&L.length===3&&(querySelect("#R").value=L[0],querySelect("#G").value=L[1],querySelect("#B").value=L[2]);let O=hexToHsl(o).match(/\d+/g);O&&O.length===3&&(querySelect("#H").value=O[0],querySelect("#S").value=O[1],querySelect("#L").value=O[2]),B.renderAll(),updatePreview(),S&&B.save()})}})}}function updateColorTextPickers(B,p){let W,G;const K=B==null?void 0:B.getObjects();K==null||K.forEach(J=>{if(W=J.get("fill"),G=document.createElement("input"),G.setAttribute("id","color-layers-pickers"),G.setAttribute("type","color"),typeof W=="string")G.setAttribute("value",W);else{const M=W.colorStops[0].color.match(/\d+/g);if(M&&M.length===3){const E=convertRGBtoHex(parseInt(M[0]),parseInt(M[1]),parseInt(M[2]));G.setAttribute("value",E)}}G.className="color-picker",G.style.borderRadius="5px",G.addEventListener("input",Z=>{const M=Z.target.value;J.set("fill",M),this.canvas.requestRenderAll()})}),p()}function applyColorAction(B,p,W,G,K,J,Z){B.addEventListener("click",M=>{if(!p)return;const E=p.getActiveObject();if(!E)return;const F=M.target.style.backgroundColor,R=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(F);if(!R)return;const[o,S,l]=R.slice(1,4).map(Number),L=convertRGBtoHex(o,S,l);if(E._objects?E._objects.forEach(q=>q.set("fill",L)):E.set("fill",L),W&&W.color.set(L),K&&(querySelect(K).value=L),J){const q=hexToHsl(L).match(/\d+/g);q&&q.forEach((O,X)=>{J[X]&&(querySelect(J[X]).value=O)})}if(Z){const q=hexToRgb(L).match(/\d+/g);q&&q.forEach((O,X)=>{Z[X]&&(querySelect(Z[X]).value=O)})}querySelectAll("#color-layers-pickers").forEach(q=>q.remove()),updateColorPickers(p,G),p.renderAll(),G&&G(),p.save()})}function solidColorAction(B,p,W,G){applyColorAction(B,p,W,G,"#HEX",["#H","#S","#L"],["#R","#G","#B"])}function solidColorTextAction(B,p,W,G){applyColorAction(B,p,W,G,"#HEX2",["#H2","#S2","#L2"],["#R2","#G2","#B2"])}function bgColorAction(B,p,W=null,G=!1){B.addEventListener("click",K=>{if(p){const J=K.target.style.backgroundColor,Z=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(J);if(Z){const M=parseInt(Z[1]),E=parseInt(Z[2]),F=parseInt(Z[3]),R=convertRGBtoHex(M,E,F);p.setBackgroundColor(R);const S=hexToHsl(R).match(/\d+/g);querySelect("#HEX_BG").value=R,S&&S.length===3&&(querySelect("#H_BG").value=S[0],querySelect("#S_BG").value=S[1],querySelect("#L_BG").value=S[2]);const L=hexToRgb(R).match(/\d+/g);L&&L.length===3&&(querySelect("#R_BG").value=L[0],querySelect("#G_BG").value=L[1],querySelect("#B_BG").value=L[2]),querySelectAll("#color-layers-pickers").forEach(O=>O.remove()),G||updateColorPickers(p,W),p.renderAll(),p.save()}W&&W()}})}function resizeCanvas(B){var L;((L=navigator==null?void 0:navigator.userAgent)==null?void 0:L.includes("Mobile"))?(B.canvas.setHeight(window.innerHeight),B.canvas.setWidth(window.innerWidth),B.canvas.setZoom(.6),document.querySelector("#mobile-top-bar").style.display="flex",document.querySelector("#mobile-nav-bar").style.display="flex"):(document.querySelector("#mobile-top-bar").style.display="none",document.querySelector("#mobile-nav-bar").style.display="none",window.innerWidth<=1400?(window.innerWidth<=1280?(B.canvas.setHeight(window.innerHeight/1),B.canvas.setWidth(window.innerWidth),B.canvas.setZoom(.6)):(B.canvas.setHeight(window.innerHeight/1.8),B.canvas.setWidth(window.innerWidth/2),B.canvas.setZoom(.8)),B.canvas.getObjects().forEach(function(q){q.scaleX*=.8,q.scaleY*=.8,q.left*=.8,q.top*=.8,q.setCoords()}),B.canvas.renderAll()):window.innerWidth<=2560&&window.innerWidth>=2048?B.canvas.setHeight(window.innerHeight/2):(B.canvas.setHeight(window.innerHeight/1.3),B.canvas.setWidth(window.innerWidth/2))),B.canvas.renderAll()}const renderCanvas=({SVG:B,fabric:p,canvas:W,logoNameElement:G,sloganNameElement:K,layers:J,initialRotation:Z,isFlipY:M,isFlipX:E,colorPicker:F,refreshLayerNames:R})=>{let o,S;p.loadSVGFromString(B,(L,q)=>{o=new p.Group(L,q),L.forEach((te,se)=>{const fe=L.length-1,Se=L.length-2;if(te.id&&te.id.includes("external_layer_"))return;fe===se?(te.scale(800),K=te,te.text=querySelect("#sloganNameField").value):Se===se&&(te.scale(800),G=te,te.text=querySelect("#logoMainField").value),W.add(te),new CreateLayerSection(J).create(te,se),te.on("mousedown",Re=>{var ce;M=te.get("flipY"),E=te.get("flipX"),querySelect("#flip-y").checked=M,querySelect("#flip-x").checked=E;const je=!!((ce=te==null?void 0:te.shadow)!=null&&ce.blur);querySelect("#logo-drop-shadow").checked=je,je||querySelect("#logo-shadow-adjust").classList.remove("active"),S=je,je?(querySelect("#logo-shadow-adjust").style.display="block",querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block"):(querySelect("#logo-shadow-adjust").style.display="none",querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none"),querySelect("#rotate_info").innerText=`Rotate: ${parseInt(te.get("angle"))}deg`,querySelect("#rotate-bar").value=te.get("angle");const He=te.get("angle");querySelect("#rotate-bar").value=He;let ve;const _e=Re.target.fill;typeof _e=="object"?ve=_e.colorStops[0].color:_e&&_e.includes("#")?ve=_e:ve=rgbaToHex(_e),F.color.set(ve),querySelect("#HEX").value=ve;let Xe=hexToRgb(ve).match(/\d+/g);Xe&&Xe.length===3&&(querySelect("#R").value=Xe[0],querySelect("#G").value=Xe[1],querySelect("#B").value=Xe[2]);let re=hexToHsl(ve).match(/\d+/g);re&&re.length===3&&(querySelect("#H").value=re[0],querySelect("#S").value=re[1],querySelect("#L").value=re[2]),W.requestRenderAll()})}),R();var O=o.width,X=o.height;const V=200,Y=200,U=V/O,Q=Y/X;o.set({scaleX:U,scaleY:Q,width:V,height:Y}),o.setCoords(),W.viewportCenterObject(o),Z={centerPoint:o.getCenterPoint(),coords:o.getCoords()},o.scaleToWidth(U),o.ungroupOnCanvas(),W.renderAll()}),G.viewportCenter(),K.viewportCenter();const l=new p.ActiveSelection(W.getObjects(),{canvas:W});return W.setActiveObject(l),W.discardActiveObject(l),W.renderAll(),{logoLayerGroup:o,isLogoShadowAdjust:S,initialRotation:Z}},centerAndResizeElements=(B,p,W,G,K,J,Z=!1,M,E,F)=>{const R=M==null?void 0:M.getObjects().filter(Q=>{var te;return!((te=Q.id)!=null&&te.includes("external_layer_"))&&!(Q!=null&&Q.duplicate)});E.charSpacing=0,F.charSpacing=0;const o=5,S=Q=>Q.replace(/\w\S*/g,te=>te.charAt(0).toUpperCase()+te.substr(1).toLowerCase());function l(Q,te){te&&M.setActiveObject(te);const se=querySelect("#text-curve-range");se.value=Q;const fe=new Event("input",{bubbles:!0});se.dispatchEvent(fe),M.discardActiveObject(),M.renderAll()}const L=(...Q)=>{Q.forEach(te=>{te.centerH()})},q=Q=>{const te=[];te.push(Q[0].toUpperCase());for(let se=1;se<Q.length;se++)te.push(Q[se].toLowerCase());return te.join("")};let O=R.find(Q=>(Q.type==="text"||Q.type==="curved-text")&&Q.text.toLowerCase()===querySelect("#logoMainField").value.toLowerCase()),X=R.find(Q=>(Q.type==="text"||Q.type==="curved-text")&&Q.text.toLowerCase()===querySelect("#sloganNameField").value.toLowerCase());if(!(!O&&!X))switch(B){case"topBottom":if(O.type==="curved-text"){const{diameter:ve,_percentage:_e,...qe}=O,Xe=new fabric$1.fabric.Text(O.text,qe);M.remove(O),M.add(Xe),O=Xe,M.requestRenderAll()}if(X.type==="curved-text"){const{diameter:ve,_percentage:_e,...qe}=X,Xe=new fabric$1.fabric.Text(X.text,qe);M.remove(X),M.add(Xe),X=Xe,M.requestRenderAll()}O.set("fontSize",p),X.set("fontSize",W),M.renderAll();const Q=M.height/J,te=M.height/K;if(O.set("top",Q),X.set("top",te),M.renderAll(),O.set("charSpacing",0),X.set("charSpacing",0),M.renderAll(),Z){O.text=S(O.text),X.text=q(X.text),O.set("fontFamily","Poppins"),X.set("fontFamily","Poppins");const ve=O.width;X.set("width",ve),X.set("charSpacing",322),X.set("fontSize",27),M.renderAll(),O.set("top",O.top+=30),X.set("top",X.top+=60)}L(O,X);const se=new fabric$1.fabric.Group(R);M.viewportCenterObject(se),se.ungroupOnCanvas(),M.renderAll();break;case"bottomTop":if(O.type==="curved-text"){const{diameter:ve,_percentage:_e,...qe}=O,Xe=new fabric$1.fabric.Text(O.text,qe);M.remove(O),M.add(Xe),M.requestRenderAll()}if(X.type==="curved-text"){const{diameter:ve,_percentage:_e,...qe}=X,Xe=new fabric$1.fabric.Text(X.text,qe);M.remove(X),M.add(Xe),M.requestRenderAll()}O.set("fontSize",p),X.set("fontSize",W),M.renderAll(),L(O,X);const fe=M.height/J,Se=M.height/K;O.set("top",fe),X.set("top",Se),M.requestRenderAll(),M.discardActiveObject();const Te=new fabric$1.fabric.Group(R);M.viewportCenterObject(Te),Te.top-=40,Te.ungroupOnCanvas(),M.renderAll();break;case"leftRight":setTimeout(()=>{const ve=O,_e=X;ve.center(),_e.center(),ve.set("top",M.height/2.3),_e.set("top",M.height/1.8),ve.set("fontSize",46),_e.set("fontSize",22),ve.set("charSpacing",0),_e.set("charSpacing",0),M.renderAll(),G==="left"?(ve.viewportCenter(),_e.viewportCenter(),ve.set("top",M.height/2.3),_e.set("top",M.height/1.8),ve.text.length<=40?(ve.set("left",M.width/1.6),_e.set("left",ve.left)):(ve.set("left",M.width/2.4),_e.set("left",ve.left))):(ve.viewportCenterH(),_e.viewportCenterH(),ve.text.length<=20?(ve.set("left",M.width/1.6),_e.set("left",ve.left+(ve.width-_e.width)/2)):(ve.text.length<=30||ve.text.length<=40)&&(ve.set("left",M.width/1.6),_e.set("left",ve.left+ve.width/2.5-_e.width/2.5))),Z&&(ve.text=S(ve.text),_e.text=q(_e.text),ve.set("fontFamily","Poppins"),_e.set("fontFamily","Poppins"),_e.set("charSpacing",322),_e.set("fontSize",27),M.renderAll(),ve.set("left",M.width/1.6),_e.set("left",ve.left));const qe=new fabric$1.fabric.Group(R);M.viewportCenterObjectH(qe),M.viewportCenterObjectV(qe),qe.ungroupOnCanvas(),M.requestRenderAll()},o);break;case"rightLeft":setTimeout(()=>{const ve=O,_e=X;if(ve.center(),_e.center(),ve.set("top",M.height/2.3),_e.set("top",M.height/1.8),ve.set("fontSize",46),_e.set("fontSize",22),ve.set("charSpacing",0),_e.set("charSpacing",0),M.renderAll(),G==="left"){if(ve.viewportCenter(),_e.viewportCenter(),ve.set("top",M.height/2.3),_e.set("top",M.height/1.8),ve.text.length<=20?(ve.set("left",-Math.round(M.width/10)),_e.set("left",ve.left+ve.width-_e.width)):ve.text.length<=30?(ve.set("left",-Math.round(M.width/3)),_e.set("left",ve.left+ve.width-_e.width)):ve.text.length<=40?(ve.set("left",-Math.round(M.width/3.5)),_e.set("left",ve.left+ve.width/1.25-_e.width/1.25)):(ve.set("left",M.width/6),_e.set("left",ve.left+ve.width/2-_e.width/2)),Z){ve.text=S(ve.text),_e.text=q(_e.text),ve.set("fontFamily","Poppins"),_e.set("fontFamily","Poppins"),_e.set("charSpacing",322),_e.set("fontSize",27),M.renderAll();const Xe=ve.width;_e==null||_e.set("width",Xe)}}else ve.viewportCenterH(),_e.viewportCenterH(),ve.text.length<=20?(ve.set("left",-Math.round(M.width/10)),_e.set("left",ve.left+(ve.width-_e.width)/2)):ve.text.length<=30?(ve.set("left",-Math.round(M.width/3)),_e.set("left",ve.left+ve.width/2-_e.width/2)):ve.text.length<=40&&(ve.set("left",-(M.width/3)),_e.set("left",ve.left+ve.width/2.5-_e.width/2.5));Z&&(ve.text=S(ve.text),_e.text=q(_e.text),ve.set("fontFamily","Poppins"),_e.set("fontFamily","Poppins"),_e.set("charSpacing",322),_e.set("fontSize",27),ve.text.length<=20?(ve.set("left",-Math.round(M.width/10)),_e.set("left",ve.left+ve.width-_e.width)):ve.text.length<=30?(ve.set("left",-Math.round(M.width/3)),_e.set("left",ve.left+ve.width/2.5-_e.width/2.5)):ve.text.length<=40&&(ve.set("left",-(M.width/2.7)),_e.set("left",ve.left+ve.width/2.5-_e.width/2.5)));const qe=new fabric$1.fabric.Group(R);M.viewportCenterObjectH(qe),M.viewportCenterObjectV(qe),qe.ungroupOnCanvas(),M.requestRenderAll()},o);break;case"curve_1":let Re=function(){O.set("fontSize",p),X.set("fontSize",W),M.renderAll(),L(X);const ve=M.height/J,_e=M.height/K;O.set("top",ve),X.set("top",_e),M.setActiveObject(O),l(4500),L(O),M.setActiveObject(X),l(2500),M.discardActiveObject();const qe=new fabric$1.fabric.Group(R);M.viewportCenterObject(qe),qe.ungroupOnCanvas(),M.renderAll()};var V=Re;console.log("CURVE_1"),Re();break;case"curve_2":let je=function(){O.set("fontSize",p),X.set("fontSize",W),M.renderAll();const ve=M.height/J,_e=M.height/K;O.set("top",ve),X.set("top",_e),M.setActiveObject(O),l(500),M.setActiveObject(X),l(2500),L(O,X)};var Y=je;console.log("CURVE_2"),je();break;case"curve_3":let He=function(){O.set("fontSize",p),X.set("fontSize",W),M.renderAll(),L(O,X);const ve=M.height/J,_e=M.height/K;O.set("top",ve),X.set("top",_e),M.setActiveObject(X),l(500),M.setActiveObject(O),l(4500),M.discardActiveObject();const qe=new fabric$1.fabric.Group(R);M.viewportCenterObject(qe),qe.ungroupOnCanvas(),M.renderAll()};var U=He;console.log("CURVE_3"),He();break}};function setlogoPosition(B,{logoPosition:p,logoNameElement:W,sloganNameElement:G,scaleLogo:K}){const J=B.canvas,Z=p;if(!J)throw new Error("Canvas",J);switch(querySelectAll(".right-bar .svg__icon").forEach(M=>{M.classList.remove("active")}),querySelect(`.svg__icon[data-align-id="${Z}"]`).classList.add("active"),Z){case"1":centerAndResizeElements("topBottom",46,22,"center",1.5,1.7,!1,J,W,G),centerAndResizeElements("topBottom",46,22,"center",1.3,1.5,!1,J,W,G);break;case"2":centerAndResizeElements("topBottom",40,20,"center",1.3,1.5,!1,J,W,G);break;case"3":centerAndResizeElements("topBottom",46,22,"center",1.3,1.5,!1,J,W,G),centerAndResizeElements("topBottom",46,22,"center",1.3,1.5,!1,J,W,G);break;case"4":centerAndResizeElements("bottomTop",46,22,"center",4,7,!1,J,W,G),centerAndResizeElements("bottomTop",46,22,"center",4,7,!1,J,W,G);break;case"5":centerAndResizeElements("bottomTop",40,18,"center",4,7,!1,J,W,G),centerAndResizeElements("bottomTop",40,18,"center",4,7,!1,J,W,G);break;case"6":centerAndResizeElements("bottomTop",46,22,"center",4,7,!1,J,W,G),centerAndResizeElements("bottomTop",46,22,"center",4,7,!1,J,W,G);break;case"7":centerAndResizeElements("leftRight",32,25,"center",1.1,1.8,!1,J,W,G);break;case"8":centerAndResizeElements("leftRight",32,25,"left",1.32,1.5,!1,J,W,G);break;case"9":centerAndResizeElements("leftRight",32,25,"left",1.32,1.5,!1,J,W,G);break;case"10":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!1,J,W,G);break;case"11":centerAndResizeElements("rightLeft",32,25,"left",1.32,1.5,!1,J,W,G);break;case"12":centerAndResizeElements("rightLeft",32,25,"left",1.32,1.5,!1,J,W,G);break;case"13":centerAndResizeElements("topBottom",46,22,"center",1.32,1.5,!0,J,W,G);break;case"14":centerAndResizeElements("leftRight",32,25,"center",1.32,1.5,!0,J,W,G);break;case"15":centerAndResizeElements("rightLeft",32,25,"center",1.32,1.5,!0,J,W,G);break;case"16":K(200),centerAndResizeElements("curve_2",46,32,"center",1.3,8,!1,J,W,G),centerAndResizeElements("curve_1",46,32,"center",1.3,8,!1,J,W,G);break;case"17":centerAndResizeElements("curve_1",46,32,"center",5,2,!1,J,W,G),centerAndResizeElements("curve_2",46,32,"center",5,2,!1,J,W,G);break;case"18":centerAndResizeElements("curve_3",46,38,"center",1.4,8,!1,J,W,G),centerAndResizeElements("curve_3",46,38,"center",1.4,8,!1,J,W,G);break}J.renderAll(),B.canvas.updatePreview()}const initMultiSelectList=function(){const B=document.querySelectorAll(".ms-select-list"),p=(J,Z)=>{const M=J.getAttribute("value"),E=J.innerText;Z.classList.remove("show");const F=Z.querySelector(".ms-list-toggle");F.querySelector(".ms-list-value").innerText=E,Z.setAttribute("data-value",M),Z.dispatchEvent(new Event("change")),J.classList.add("selected")},W=J=>{if(J.classList.contains("initialized"))return!0;J.addEventListener("click",function(Z){Z.stopPropagation();let M=this.parentElement.parentElement;this.parentElement.classList.contains("collection")&&(M=this.parentElement.parentElement.parentElement),p(this,M)}),J.classList.add("initialized")},G=function(J){J.stopPropagation();const Z=this.getAttribute("data-value"),M=this.querySelector(".ms-list-toggle");let E=this.querySelector(`.ms-select-list-menu li[value="${Z}"]`);Z=="undefined"?E=this.getAttribute("data-default-value"):E&&(E=E.innerText),M.querySelector(".ms-list-value").innerText=E},K=J=>{const Z=J.querySelector(".ms-select-list-menu"),M=J.querySelector(".ms-list-toggle .ms-list-value").getAttribute("value");if(J.setAttribute("data-default-value",M),Z.querySelectorAll("li").forEach(W),J.addEventListener("valueChange",G),J.classList.contains("initialized"))return!0;J.querySelector(".ms-list-toggle").addEventListener("click",function(E){E.stopPropagation();const F=document.querySelectorAll(".ms-select-list"),R=this.parentElement;F.forEach(o=>o!=R?o.classList.remove("show"):o),R.classList.toggle("show")}),J.classList.add("initialized")};B.forEach(K),document.onclick=function(J){var E;const Z=((E=J.target.parentElement)==null?void 0:E.tagName)==="LI"?J.target.parentElement:J.target;if(!Z.classList.contains("ms-select-list")&&!Z.classList.contains("live-search")&&B.forEach(F=>F.classList.remove("show")),Z.tagName!=="LI")return!0;J.stopPropagation();let M=Z.parentElement.parentElement;if(Z.parentElement.classList.contains("collection")&&(M=Z.parentElement.parentElement.parentElement),!M.classList.contains("ms-select-list"))return!0;p(Z,M)}};function attachRGBHandlers(B,p,W=""){[`#R${W}`,`#G${W}`,`#B${W}`].forEach(G=>{document.querySelector(G).addEventListener("input",()=>{const K=document.querySelector(`#R${W}`).value,J=document.querySelector(`#G${W}`).value,Z=document.querySelector(`#B${W}`).value;B.color.rgb={r:K,g:J,b:Z},updateActiveObjectColor(p,B.color.hexString)})})}function attachHSLHandlers(B,p,W=""){[`#H${W}`,`#S${W}`,`#L${W}`].forEach(G=>{document.querySelector(G).addEventListener("input",()=>{const K=document.querySelector(`#H${W}`).value,J=document.querySelector(`#S${W}`).value,Z=document.querySelector(`#L${W}`).value;B.color.hsl={h:K,s:J,l:Z},updateActiveObjectColor(p,B.color.hexString)})})}function updateActiveObjectColor(B,p){const W=B.getActiveObject();W&&(W._objects&&W._objects.forEach(G=>G.set("fill",p)),W.set("fill",p),B.requestRenderAll())}const loadExternalLayers$1=async(B,p)=>{const W=(K,J,Z)=>{J.map(E=>{E.set({fill:K.fill})});let M=fabric.util.groupSVGElements(J,Z);return M.scaleToWidth(K.cacheWidth),M.scaleToHeight(K.cacheHeight),M.set({left:K.left,top:K.top,angle:K.angle,scaleX:K.scaleX,scaleY:K.scaleY,opacity:K.opacity,flipX:K.flipX,flipY:K.flipY,selectable:!0,id:K.id,layerType:K.layerType,fill:K.fill}),B.add(M),B.requestRenderAll(),M};return async(K=null,J=null,Z=null)=>{K=K?JSON.parse(K):[],J=J?JSON.parse(J):[],Z=Z?JSON.parse(Z):[];let M=0;const E=[...K,...J,...Z];if(!E.length)return!1;for(const F of E){let{layerType:R,ext:o}=F;if(R=="text"){let S=new fabric.IText(F.text,F);B.add(S)}else if(o=="svg")await new Promise(S=>{fabric.loadSVGFromURL(F.dataUrl,(l,L)=>{W(F,l,L).set("dataUrl",F.dataUrl),S()})});else if(R==="image")await new Promise(S=>{fabric.Image.fromURL(F.dataUrl,l=>{l.set({dataUrl:F.dataUrl,left:F.left,top:F.top,angle:F.angle,scaleX:F.scaleX,scaleY:F.scaleY,opacity:F.opacity,flipX:F.flipX,flipY:F.flipY,selectable:!0,id:"upload_external_layer_"+M,layerType:F.layerType,fill:F.fill}),B.add(l),B.requestRenderAll(),M++,S()})});else{let{category:S,itemId:l}=F;if(!S)continue;let L=p[S][parseInt(l)];if(!L)return!1;L=L.svg,await new Promise(q=>{fabric.loadSVGFromString(L,(O,X)=>{W(F,O,X).set({itemId:l,category:S}),B.requestRenderAll(),q()})})}B.requestRenderAll()}}};fabric$1.fabric.CurvedText=curvedText;class EditorScreen{constructor(){this.canvasBG="#ffffff",this.canvas=new fabric$1.fabric.Canvas("c",{backgroundColor:this.canvasBG}),this.loadedFonts={},this.magnifier=new fabric$1.fabric.Canvas("magnifier",{backgroundColor:this.canvasBG}),CanvasGuides(this.canvas),this.currentGradiantColors={grad1Value:"#ffffff",grad2Value:"#000000"},this.loadedIcons={},this.allFonts={},this.changeFontWeight=!0,this.activeSection="",this.textMode=querySelect('.nav-item[data-name="text"]'),this.logoMode=querySelect('.nav-item[data-name="logo"]'),this.uploadsMode=querySelect('.nav-item[data-name="upload"]'),this.backgroundMode=querySelect('.nav-item[data-name="background"]'),this.previewMode=querySelect('.nav-item[data-name="preview"]'),this.galleryMode=querySelect('.nav-item[data-name="gallery"]'),this.logoName="My Brand Name",this.sloganName="Slogan goes here",this.iconList=null,this.rotateRange=querySelect("#rotate-bar"),this.saveBtn=querySelect("#save-btn"),this.scaleRangeUploads=querySelect("#progress-bar-uploads"),this.flipHorizontal=querySelect("#flip-x"),this.flipVertical=querySelect("#flip-y"),this.activeLayerIndex=null,this.logoFile=localStorage.getItem("logo-file"),this.layers=querySelect("#layers"),this.textLayers=querySelect("#text-layers"),this.rotateValue=null,this.isRotating=!1,this.scaleValue=3,this.urlParams=new URLSearchParams(document.location.search),this.isScaling=null,this.isFlipX=!1,this.isFlipY=!1,this.textcolorPicker=querySelect("#color-picker"),this.logoColorPicker=querySelect("#logo-color-picker"),this.logoColorPicker1=querySelect("#logo-color-picker1"),this.logoColorPicker2=querySelect("#logo-color-picker2"),this.logoNameInput=querySelect("#logoNameInput"),this.sloganNameInput=querySelect("#sloganNameInput"),this.logoSettingsContainer=querySelect(".setting-container"),this.textSettingsContainer=querySelect(".text-settings-container"),this.backgroundSettingsContainer=querySelect(".bg-settings-container"),this.uploadSettingsContainer=querySelect(".uploads-settings-container"),this.textColorPickerContainer=querySelect(".color-picker-container"),this.letterSpacingSlider=querySelect("#letter-spacing-slider"),this.textColorPickerValue="#eeeeee",this.letterSpacing="0",this.textSelector=querySelect("#text-selector"),this.shadowBlurSlider=querySelect("#shadow-blur-slider"),this.shadowOffsetXSlider=querySelect("#shadow-offsetX-slider"),this.shadowOffsetYSlider=querySelect("#shadow-offsetY-slider"),this.logoShadowOffsetXSlider=querySelect("#logo-shadow-offsetX-slider"),this.logoShadowOffsetYSlider=querySelect("#logo-shadow-offsetY-slider"),this.shadowBlur=null,this.shadowOffsetX=null,this.shadowOffsetY=null,this.logoShadowBlur=null,this.logoShadowOffsetX=null,this.logoShadowOffsetY=null,this.textSettingsContainer.style.display="none",this.canvasZoomLevel=1,this.settingsListTitle=querySelect(".setting-list-item__title"),this.settingsList=querySelect(".setting-list-items-li"),this.fontSizeList=querySelect(".font_size-list-items-li"),this.caseList=querySelect(".case-list-items-li"),this.fontSelector=querySelect(".font-selector"),this.textSelectorValue="LogoName",this.logoFillColor=null,this.zoomSlider=querySelect("#zoom-slider"),this.colorMode="Solid",this.activeNavbarSetting="logo",this.initialRotation=null,this.logoOrientation=null,this.alignId=1,this.fontItems=[];let p=this;this.fetchFonts=async()=>{let G=await fetch("https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyBoi7l2IikHgIpoQXsFocf3MzLOWx2mD9A");return G=await G.json(),this.fontItems=G.items,this.fontItems.map(K=>{this.allFonts[K.family]=K}),G==null?void 0:G.items},this.fetchFonts().then(async(W=[])=>{let G=0,K=20;const J=W.slice(G,G+K);G+=K;let Z="";for(const M of J){const{family:E,variants:F}=M;p.loadedFonts[E]={variants:F},p.allFonts[E].loaded=!0;const R=F.map(o=>`${E}:${o}`);await new Promise((o,S)=>{WebFont.load({google:{families:R},active:o,inactive:S})}),Z+=`<li value="${E}" class="font-family-item" data-loaded="true">
          <span style="font-family:${E}; font-weight: 500" class="text">${E}</span></li>`}querySelect("#font-family-con .collection").innerHTML+=Z,initMultiSelectList()}),querySelect("#logoMainField").addEventListener("change",()=>{this.canvasHistory.saveHistory()}),this.canvas.save=function(){var W;(W=p==null?void 0:p.canvasHistory)==null||W.saveHistory()},this.canvas.undoCB=()=>{querySelectAll("#layers .layer-container").forEach(G=>{G.style.display="none"}),this.canvas._objects.forEach(G=>{if(G.layerId){let K=querySelect(`.layer-container[data-id="${G.layerId}"]`);if(!K)return!0;K.style.display="flex",K.querySelector(".layer-img").classList.remove("selected"),K.querySelector(".layer-span").classList.remove("selected")}}),this.canvas.refreshLayerNames()},querySelect("#sloganNameField").addEventListener("change",()=>{this.canvasHistory.saveHistory()}),this.transparentLoader=(W=!0)=>{querySelect("#loader_font").style.display=W?"block":"none",querySelect("#loader_font").style.background="#ffffffbb"},this.rotateObject=()=>{const W=this.canvas.getActiveObject();this.isRotating&&W&&this.rotateValue&&(W.rotate(this.rotateValue),this.canvas.requestRenderAll()),this.isRotating=!1},this.scaleObject=()=>{const W=this.canvas.getActiveObject(),G=W==null?void 0:W.getCenterPoint();this.isScaling&&W&&this.scaleValue&&(W.scale(this.scaleValue),W.setPositionByOrigin(new fabric$1.fabric.Point(G.x,G.y),"center","center"),W.setCoords(),W.scaleValue=this.scaleValue),this.isScaling=!1},querySelect("#rotate_reset").addEventListener("click",()=>{const W=this.canvas.getActiveObject();if(!W)return!0;if(W.angle==0)return!1;rotateReset(W),this.canvas.requestRenderAll(),querySelect("#rotate_info").innerText="Rotate: 0deg",this.rotateRange.value=0,W&&this.canvas.save(),this.canvas.renderAll(),this.canvas.updatePreview()}),querySelect("#text-rotate_reset").addEventListener("click",()=>{const W=this.canvas.getActiveObject();if(!W)return!0;if(W.angle==0)return!1;rotateReset(W),this.canvas.requestRenderAll(),querySelect("#rotate_info").innerText="Rotate: 0deg",this.rotateRange.value=0,W&&this.canvas.save(),this.canvas.renderAll(),this.canvas.updatePreview()}),this.shadowChanger=(W,G)=>{(this.textSelectorValue==="SloganName"?W:G).set("shadow",{offsetX:this.shadowOffsetX,offsetY:this.shadowOffsetY,blur:this.shadowBlur})},this.canvas.on("after:render",()=>{querySelect("#loader_font").style.display="none"})}hideCanvasGuides(){let p=this.canvas._objects.filter(W=>W.isPositioningLine);for(let W=0;W<p.length;W++)this.canvas.remove(p[W])}initialize(){var jt,Bt;var p=this;const W=()=>{const ee=this.canvas.lowerCanvasEl.toDataURL({format:"png",multiplier:.5});querySelect("#magnifier_img").src=ee};this.canvas.updatePreview=W;const G=()=>{let ee=Array.from(this.layers.childNodes).filter(le=>le.style.display!=="none"),ie=1;ee.forEach(le=>{let de=le.querySelector(".layer-span");le.setAttribute("data_layer",ie),de.innerText=`Layer ${ie}`,ie++})};this.canvas.refreshLayerNames=G,W(),fabric$1.fabric.Object.prototype.setControlsVisibility({mt:!1,mb:!1,ml:!1,mr:!1,mtr:!1,bl:!0,br:!0,tl:!0,tr:!0}),this.canvas.requestRenderAll();let K;function J(){localStorage.getItem("mainEditorCounter")==="1"&&(clearTimeout(K),K=setTimeout(()=>{resizeCanvas(p),location.reload()},100))}resizeCanvas(p),window.addEventListener("resize",J),this.updateActiveNavbar=()=>{querySelectAll(".nav-item").forEach(ee=>{this.activeNavbarSetting.includes(ee.innerText.toLowerCase())?ee.style.backgroundColor="var(--gold-darker)":ee.style.backgroundColor="var(--gold)"})},this.updateActiveNavbar();const Z=ee=>ee.replace(/\w\S*/g,ie=>ie.charAt(0).toUpperCase()+ie.substr(1).toLowerCase()),M=ee=>{const ie=[];ie.push(ee[0].toUpperCase());for(let le=1;le<ee.length;le++)ie.push(ee[le].toLowerCase());return ie.join("")};querySelect(".font-family-selectbox").addEventListener("change",function(){const ee=this.getAttribute("data-value"),ie=this.getAttribute("data-loaded"),le=p.canvas.getActiveObject(),de=le==null?void 0:le.getCenterPoint();if(!le)return!1;let{variants:Ae}=p.loadedFonts[ee];if(ie=="false"){const Ye=`${ee}:${Ae.join(",")}`;WebFont.load({google:{families:[Ye]},active:function(){le.set("fontFamily",ee),p.canvas.renderAll()}})}p.changeFontWeight&&(le.set("fontStyle","normal"),le.set("fontWeight","normal"),le.set("orgFontWeight","normal")),le.set("fontFamily",ee);let Ne="",Be={};function Ue(Ye){const at={100:"Thin",200:"Extra Light",300:"Light",400:"Regular",500:"Medium",600:"Semi Bold",700:"Bold",800:"Extra Bold",900:"Black"};let ut=Ye.replace(/([0-9]+)/g,ft=>{let gt=parseInt(ft);return at[gt]+" "+gt+" "});return Z(ut)}Ae.map(Ye=>{const at=Be[Ye]?Be[Ye]:Ye;Ne+=`<li value="${at=="regular"?"normal":at}" style="text-transform:capitalize">${Ue(at)}</li>`});let Ze=querySelect(".font-weight-selector .ms-select-list-menu");Ze.innerHTML=Ne,initMultiSelectList(),le.setPositionByOrigin(new fabric$1.fabric.Point(de.x,de.y),"center","center"),le.setCoords(),p.canvas.requestRenderAll(),W(),p.canvas.save()}),querySelect(".text-case-select-box").addEventListener("change",function(){const ee=this.getAttribute("data-value"),ie=p.canvas.getActiveObject();if(!ie)return!1;let le=ie.getCenterPoint(),de=ie.get("fontFamily"),Ae=ie.get("fill"),Ne=ie.get("selectable"),Be=ie.get("hasRotatingPoint"),Ue=ie.get("diameter"),Ze=ie.get("left"),Ye=ie.get("top"),at=ie.get("flipped"),ut=ie.get("fontSize");ie.set("letterCase",ee),ie.set("fontSize",40);const ft=ie==null?void 0:ie.text;ee==="Uppercase"?ie.text=ft.toUpperCase():ee==="Lowercase"?ie.text=ft.toLowerCase():ee==="Title Case"?ie.text=Z(ft):ee==="Sentence Case"&&(ie.text=M(ft)),ie.set("fontFamily",de),ie.set("fill",Ae),ie.set("selectable",Ne),ie.set("hasRotatingPoint",Be),ie.set("diameter",Ue),ie.set("left",Ze),ie.set("top",Ye),ie.set("flipped",at),ie.set("fontSize",ut),ie.setPositionByOrigin(new fabric$1.fabric.Point(le.x,le.y),"center","center"),ie.setCoords(),p.canvas.renderAll(),W(),p.canvas.save()}),querySelect(".font-weight-selector").addEventListener("change",async function(){const ee=this.getAttribute("data-value"),ie=p.canvas.getActiveObject();if(!ie)return!1;const le=ie.get("fontFamily");if(p.loadedFonts[le]){const de=`${le}:${ee}`;await new Promise((Ae,Ne)=>{WebFont.load({google:{families:[de]},active:Ae,inactive:Ne})}),ee.includes("italic")?(ee=ee.replace("italic","").trim(),ie.set("fontStyle","italic"),ie.set("fontweightapply",!0)):ie.get("fontweightapply")&&ie.set("fontStyle","normal"),ie.set("fontWeight",ee||"normal"),ie.set("orgFontWeight",ee||"normal"),p.canvas.renderAll(),W(),p.canvas.save()}}),p.canvas.on("object:selected",function(){const ee=p.canvas.getActiveObject();ee&&ee.get("fontWeight")&&(ee.set("fontWeight",ee.get("fontWeight")),ee.get("fontStyle")==="italic"&&ee.set("fontStyle","italic"),p.canvas.renderAll())}),querySelect(".font-style-selector").addEventListener("change",function(){let ee=this.getAttribute("data-value"),ie=p.canvas.getActiveObject();if(!ie)return!1;ee=="Underline"?ie.set("underline",!0):(ie.set("underline",!1),ie.set("fontStyle",ee),ie.set("fontStyle_",ee)),p.canvas.renderAll(),W(),p.canvas.save()}),this.rotateRange.addEventListener("input",ee=>{this.isRotating=!0,this.rotateValue=ee.target.value,querySelect("#rotate_info").innerText=`Rotate: ${parseInt(this.rotateValue)}deg`,this.rotateObject()}),this.rotateRange.addEventListener("change",()=>{W(),p.canvas.save()}),querySelect("#rotate-bar-uploads").addEventListener("input",ee=>{this.isRotating=!0,this.rotateValue=parseInt(ee.target.value,10),this.rotateObject()}),querySelect("#text-rotate-bar").addEventListener("input",ee=>{this.isRotating=!0,this.rotateValue=parseInt(ee.target.value,10),this.rotateObject()}),this.saveBtn.addEventListener("click",async()=>{var ie;if(!this.canvasBG||!U||!Q||!this.alignId)return toastNotification("Data Error");const ee=(ie=querySelect("#logo_id"))==null?void 0:ie.value;saveCanvas(ee,this.canvas,this.canvasBG,U,Q,this.alignId)}),querySelect("#save-package").addEventListener("click",()=>{var ie;if(!this.canvasBG||!U||!Q||!this.alignId)return toastNotification("Data Error");const ee=(ie=querySelect("#logo_id"))==null?void 0:ie.value;saveCanvas(ee,this.canvas,this.canvasBG,U,Q,this.alignId,!0)}),querySelect("#third_page_btn").addEventListener("click",()=>{const ee={format:"jpg",multiplier:1},ie=this.canvas.toDataURL(ee);localStorage.setItem("logo-file",ie),localStorage.setItem("mainEditorCounter",3),location.reload(),setTimeout(()=>{querySelect("#drag_drop_view").style.display="none",querySelect("#main_editor_view").style.display="none",querySelect("#details_view").style.display="block"},50)});function E(ee,ie,le){let de=le-ie,Ae=(ee-ie)/de*2;return Math.min(Ae,2).toFixed(3)}var F;function R(){const ee=p.canvas.getActiveObject();if(ee){const ie=ee.getScaledWidth();F=(ie-1)*2;const le=querySelect("#scale-range");le.max=F,le.min=0,le.value=ie-1,querySelect("#scale-value").value=E(ie,0,F)}}p.canvas.on("selection:updated",R),p.canvas.on("selection:created",R),querySelect("#scale-range").addEventListener("input",ee=>{const ie=ee.target.value;querySelect("#scale-value").value=E(ie,0,F);const le=p.canvas.getActiveObject();le&&(le.scaleToWidth(ie),p.canvas.requestRenderAll())}),querySelect("#scale_up").addEventListener("click",()=>{querySelect("#scale-range").value=parseInt(querySelect("#scale-range").value)+1,querySelect("#scale-range").dispatchEvent(new Event("input"))}),querySelect("#scale_down").addEventListener("click",()=>{querySelect("#scale-range").value=parseInt(querySelect("#scale-range").value)-1,querySelect("#scale-range").dispatchEvent(new Event("input"))}),querySelect("#scale-range").addEventListener("change",function(){W(),p.canvas.save()}),this.flipHorizontal.addEventListener("change",()=>{const ee=this.canvas.getActiveObject(),ie=ee.getCenterPoint();ee&&(this.isFlipX=!this.isFlipX,ee.set("flipX",this.isFlipX),ee.setPositionByOrigin(new fabric$1.fabric.Point(ie.x,ie.y),"center","center"),ee.setCoords(),this.canvas.renderAll()),W(),ee&&this.canvas.save()}),this.flipVertical.addEventListener("change",()=>{const ee=this.canvas.getActiveObject(),ie=ee.getCenterPoint();ee&&(this.isFlipY=!this.isFlipY,ee.set("flipY",this.isFlipY),ee.setPositionByOrigin(new fabric$1.fabric.Point(ie.x,ie.y),"center","center"),ee.setCoords(),this.canvas.renderAll(),ee&&this.canvas.save(),W())}),this.layers.addEventListener("click",ee=>{let le=ee.target.closest(".layer-container").getAttribute("data-id"),de=null;if(this.canvas._objects.forEach(Ae=>{Ae.layerId&&Ae.layerId==le&&(de=Ae)}),!de)return!1;this.canvas.setActiveObject(de),this.canvas.requestRenderAll()});let o=!1;this.canvas.on("object:scaling",()=>{o=!0}),this.canvas.on("mouse:up",function(){o&&(o=!1,p.canvas.save())});let S="block",l="block",L="#fff",q=new iro$1.ColorPicker("#open_picker",{display:l,width:210,marginTop:20,color:L,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]});q.on("input:end",()=>{W(),this.canvas.save()});const O=ee=>{const ie=Array.isArray(ee.get("fill").colorStops)?rgbToHex(ee.get("fill").colorStops[0].color):ee.get("fill");q.color.set(ie)},X=ee=>()=>O(ee),V=()=>{var le;this.hideCanvasGuides();const ee=this.canvas.getActiveObject(),ie=ee;if(this.activeLayerIndex=this.canvas.getObjects().indexOf(ee),!ee.text&&ee.on("mousedown",X(ee)),ee){if(ee.text){querySelect('.nav-item[data-name="text"]').dispatchEvent(new Event("click")),this.activeSection="text";const Ye=!!((le=ee==null?void 0:ee.shadow)!=null&&le.blur);if(querySelect("#drop-shadow").checked=Ye,Ye?(querySelect("#shadow-adjust").style.display="block",querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block"):(querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none"),Ye){let{offsetX:at,offsetY:ut,blur:ft}=ee.shadow;querySelect("#shadow-blur-slider").value=ft,querySelect("#shadow-offsetX-slider").value=at,querySelect("#shadow-offsetY-slider").value=ut,this.shadowBlur=ft,this.shadowOffsetX=at,this.shadowOffsetY=ut}}else if(this.activeSection="text",querySelect('.nav-item[data-name="logo"]').dispatchEvent(new Event("click")),ee.shadow){let{offsetX:Ye,offsetY:at,blur:ut}=ee.shadow;querySelect("#logo-shadow-blur-slider").value=ut,querySelect("#logo-shadow-offsetX-slider").value=Ye,querySelect("#logo-shadow-offsetY-slider").value=at,this.logoShadowOffsetX=Ye,this.logoShadowOffsetY=at,this.logoShadowBlur=ut}if(ee.type==="curved-text"){let Ye=ee.percentage;Ye>=90&&(Ye=100),Ye<=-90&&(Ye=0),querySelect("#curve-text").value=(Ye*3.6).toFixed(0),querySelect("#text-curve-range").value=_e(Ye)}else querySelect("#curve-text").value=0,querySelect("#text-curve-range").value=2500;querySelectAll(".layer-container").forEach((Ye,at)=>{const ut=Ye.querySelector(".layer-img"),ft=Ye.querySelector(".layer-span");let gt;const yt=ee.get("fill");typeof yt=="object"?gt=yt.colorStops[0].color:yt&&yt.includes("#")?gt=yt:gt=rgbaToHex(yt),q.color.set(gt),querySelect("#HEX").value=gt;let pt=hexToRgb(gt).match(/\d+/g);pt&&pt.length===3&&(querySelect("#R").value=pt[0],querySelect("#G").value=pt[1],querySelect("#B").value=pt[2]);let bt=hexToHsl(gt).match(/\d+/g);bt&&bt.length===3&&(querySelect("#H").value=bt[0],querySelect("#S").value=bt[1],querySelect("#L").value=bt[2]);let Tt=Ye.getAttribute("data-id");Tt&&ie.layerId&&(Tt==ie.layerId?(ft.scrollIntoView({block:"center",behavior:"smooth"}),ut.classList.add("selected"),ft.classList.add("selected")):(ut.classList.remove("selected"),ft.classList.remove("selected")))});let Ae={"font-weight-selector":"fontWeight","font-style-selector":"fontStyle_","text-case-select-box":"letterCase"};for(const Ye in Ae){let at=querySelect(`.${Ye}`);at.setAttribute("data-value",ie[Ae[Ye]]),at.dispatchEvent(new Event("valueChange"))}let Ne=querySelect(".font-family-selectbox");const Be=Ye=>{Ne.setAttribute("data-value",Ye),p.changeFontWeight=!1,Ne.dispatchEvent(new Event("valueChange")),Ne.dispatchEvent(new Event("change")),p.changeFontWeight=!0,Ne.querySelector(".ms-list-value").innerText=Ye;let at=querySelect(".font-weight-selector");at.setAttribute("data-value",ie.orgFontWeight?ie.orgFontWeight:"normal"),at.dispatchEvent(new Event("valueChange")),at.dispatchEvent(new Event("change"))};let Ue=ie.get("fontFamily"),Ze=this.allFonts[Ue];if(Ze){let{loaded:Ye}=Ze;Ye?Be(Ue):WebFont.load({google:{families:[Ue]},active:function(){Ze.loaded=!0,p.loadedFonts[Ue]=Ze,ie.set("fontFamily",Ue),Be(Ue),p.canvas.renderAll()}})}querySelect("#letter-spacing-slider").value=Math.round(ie.charSpacing),querySelect("#l_spacing_value").value=Math.round(ie.charSpacing)||0,ie.fontSize&&(querySelect("#font_size_title").value=Math.round(ie.fontSize)+"px",querySelect("#font_size_range").value=Math.round(ie.fontSize))}this.canvas.requestRenderAll()};this.canvas.on("selection:created",V),this.canvas.on("selection:updated",V);const Y=({text:ee,fontFamily:ie="ABeeZee",fontSize:le=32,fill:de="#000000"})=>new fabric$1.fabric.Text(ee,{fontFamily:ie,fontSize:le,fill:de,selectable:!0,hasRotatingPoint:!1,diameter:500,left:50,top:50,flipped:!0});var U=Y({text:this.logoName}),Q=Y({text:this.sloganName});querySelect("#logoMainField").addEventListener("input",ee=>{const ie=ee.target.value;this.canvas.getObjects().filter(Ne=>Ne.text)[0].set("text",ie),this.canvas.renderAll()}),querySelect("#sloganNameField").addEventListener("input",ee=>{const ie=ee.target.value;this.canvas.getObjects().filter(Ne=>Ne.text)[1].set("text",ie),this.canvas.renderAll()});const te=ee=>ee===ee.toUpperCase()?"Uppercase":ee===ee.toLowerCase()?"Lowercase":ee===ee.charAt(0).toUpperCase()+ee.slice(1).toLowerCase()?"Sentence Case":"Title Case";U.on("mousedblclick",()=>{const ee=querySelect("#logoMainField");ee&&(ee.focus(),ee.select())}),Q.on("mousedblclick",()=>{const ee=document.querySelector("#sloganNameField");ee&&(ee.focus(),ee.select())});const se=(ee,ie)=>{let le=ee?"var(--gold-darker)":"var(--gold)";ie.style.background=le,ee||this.updateActiveNavbar()};this.backgroundMode.addEventListener("mouseover",()=>se(!0,this.backgroundMode)),this.backgroundMode.addEventListener("mouseleave",()=>se(!1,this.backgroundMode)),this.textMode.addEventListener("mouseover",()=>se(!0,this.textMode)),this.textMode.addEventListener("mouseleave",()=>se(!1,this.textMode)),this.logoMode.addEventListener("mouseover",()=>se(!0,this.logoMode)),this.uploadsMode.addEventListener("mouseover",()=>se(!0,this.uploadsMode)),this.logoMode.addEventListener("mouseleave",()=>se(!1,this.logoMode)),this.previewMode.addEventListener("mouseover",()=>se(!0,this.previewMode)),this.previewMode.addEventListener("mouseleave",()=>se(!1,this.previewMode)),this.uploadSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.textMode.addEventListener("click",()=>{this.activeNavbarSetting="text",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="grid",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",this.canvas.renderAll()}),this.logoMode.addEventListener("click",()=>{this.activeNavbarSetting="logo",this.updateActiveNavbar(),this.logoSettingsContainer.style.display="grid",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="none",this.uploadSettingsContainer.style.display="none",this.canvas.renderAll()}),this.backgroundMode.addEventListener("click",()=>{this.backgroundSettingsContainer.style.display="none",this.logoSettingsContainer.style.display="none",this.textSettingsContainer.style.display="none",this.backgroundSettingsContainer.style.display="grid",this.uploadSettingsContainer.style.display="none",this.activeNavbarSetting="background",this.updateActiveNavbar()}),this.uploadsMode.addEventListener("click",()=>{querySelect("#upload-file").click()}),this.previewMode.addEventListener("click",()=>{this.transparentLoader();const ee=this.canvas.get("backgroundColor");setTimeout(()=>{ee===this.canvasBG&&this.canvas.setBackgroundColor(null,this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="block";const le=this.canvas.toDataURL({format:"png",multiplier:3});le&&(querySelect("#fixed_preview").src=le,querySelect("#loader_font").style.display="none")},1e3)}),this.letterSpacingSlider.addEventListener("input",ee=>{this.letterSpacing=ee.target.value;const ie=this.canvas.getActiveObject();if(ie.type=="curved-text"){ie.set("charSpacing",parseInt(this.letterSpacing));let de=parseInt(this.letterSpacing)/100*3;return de=Math.round(de),de<-1&&(de=-1),ie.set("_cachedCanvas",null),ie.set("kerning",parseInt(de)),querySelect("#l_spacing_value").value=Math.round(ee.target.value/10),this.canvas.requestRenderAll(),!1}const le=ie.getCenterPoint();ie.set("charSpacing",this.letterSpacing),querySelect("#l_spacing_value").value=Math.round(ee.target.value/10),ie.setPositionByOrigin(new fabric$1.fabric.Point(le.x,le.y),"center","center"),ie.setCoords(),this.canvas.requestRenderAll()}),document.querySelector("#l_spacing_value").addEventListener("change",function(ee){let ie=ee.target.value;cl,querySelect("#letter-spacing-slider").value=Math.round(ie*10),querySelect("#letter-spacing-slider").dispatchEvent(new Event("input"))}),querySelect("#letter-spacing-up").addEventListener("click",()=>{let ee=parseInt(querySelect("#letter-spacing-slider").value);ee+=10,querySelect("#letter-spacing-slider").value=Math.round(ee),querySelect("#letter-spacing-slider").dispatchEvent(new Event("input"))}),querySelect("#letter-spacing-down").addEventListener("click",()=>{let ee=parseInt(querySelect("#letter-spacing-slider").value);ee-=10,querySelect("#letter-spacing-slider").value=Math.round(ee),querySelect("#letter-spacing-slider").dispatchEvent(new Event("input"))}),this.letterSpacingSlider.addEventListener("change",ee=>{W(),this.canvas.save()}),(jt=querySelect("#shadow-blur-slider"))==null||jt.addEventListener("input",ee=>{const ie=this.canvas.getActiveObjects(),le=this;querySelect("#shadow_blur_title").innerText=` :${ee.target.value}px`,this.shadowBlur=ee.target.value,ie.forEach(de=>{if(!de.text)return!0;de.set("shadow",{offsetX:le.shadowOffsetX,offsetY:le.shadowOffsetY,blur:le.shadowBlur})}),this.canvas.requestRenderAll()}),(Bt=querySelect("#shadow-blur-slider"))==null||Bt.addEventListener("change",()=>{this.canvas.save()}),querySelect("#logo-shadow-blur-slider").addEventListener("input",ee=>{this.logoShadowBlur=ee.target.value;const ie=this.canvas.getActiveObjects();querySelect("#logo-shadow_blur_title").innerText=` :${ee.target.value}px`,ie.forEach(le=>{le._objects?le._objects.forEach(de=>{de.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:parseInt(this.logoShadowBlur)})}):le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:parseInt(this.logoShadowBlur)})}),this.canvas.requestRenderAll()}),querySelect("#logo-shadow-blur-slider").addEventListener("change",ee=>{W(),this.canvas.save()}),this.shadowOffsetXSlider.addEventListener("input",ee=>{const ie=ee.target.value;this.shadowOffsetX=ie,querySelect("#offset_x_title").innerText=` :${ie}px`;const le=this.canvas.getActiveObjects();let de=this;le.forEach(Ae=>{if(!Ae.text)return!0;Ae.set("shadow",{offsetX:de.shadowOffsetX,offsetY:de.shadowOffsetY,blur:de.shadowBlur})}),this.canvas.requestRenderAll()}),this.logoShadowOffsetXSlider.addEventListener("input",ee=>{this.logoShadowOffsetX=ee.target.value,querySelect("#logo-shadow_offsetX").innerText=` :${ee.target.value}px`,this.canvas.getActiveObjects().forEach(le=>{le._objects?le._objects.forEach(de=>{de.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}):le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}),this.canvas.requestRenderAll()}),this.shadowOffsetXSlider.addEventListener("change",()=>{this.canvas.save()}),this.logoShadowOffsetXSlider.addEventListener("change",()=>{this.canvas.save()}),this.logoShadowOffsetXSlider.addEventListener("change",()=>{W(),this.canvas.save()}),this.shadowOffsetYSlider.addEventListener("change",()=>{W(),this.canvas.save()}),this.shadowOffsetYSlider.addEventListener("input",ee=>{const ie=ee.target.value;this.shadowOffsetY=ie,querySelect("#offset_y_title").innerText=` :${ie}px`;const le=this.canvas.getActiveObjects();let de=this;le.forEach(Ae=>{if(!Ae.text)return!0;Ae.set("shadow",{offsetX:de.shadowOffsetX,offsetY:de.shadowOffsetY,blur:de.shadowBlur})}),this.canvas.requestRenderAll()}),this.logoShadowOffsetYSlider.addEventListener("input",ee=>{this.logoShadowOffsetY=ee.target.value,querySelect("#logo-shadow_offsetY").innerText=` :${ee.target.value}px`,this.canvas.getActiveObjects().forEach(le=>{le._objects?le._objects.forEach(de=>{de.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}):le.set("shadow",{offsetX:this.logoShadowOffsetX,offsetY:this.logoShadowOffsetY,blur:this.logoShadowBlur})}),this.canvas.requestRenderAll()}),this.logoShadowOffsetYSlider.addEventListener("change",()=>{W(),this.canvas.save()}),querySelect("#upload-file").addEventListener("input",ee=>{Se=ee.target.files[0],Te=[],Te.push(Se),Te.forEach(ie=>{let le=URL.createObjectURL(ie);if(ie.type.includes("svg")){const Ne=decodeURIComponent(le);var Ae=this.canvas;fabric$1.fabric.loadSVGFromURL(Ne,(Be,Ue)=>{const Ze=fabric$1.fabric.util.groupSVGElements(Be,Ue);var Ye=new FileReader;Ye.onloadend=function(){Ze.set("dataUrl",Ye.result),Ze.set("layerType","image"),Ze.set("ext","svg"),Ze.scaleToWidth(100),Ze.set({left:Ze.left+100,layerType:"svg"}),Ze.set("id","upload_external_layer_"+xe),Ae.add(Ze),Ae.setActiveObject(Ze),Ae.viewportCenterObjectV(Ze),Ae.requestRenderAll()},Se&&Ye.readAsDataURL(Se)})}else toastNotification("Please select an SVG file")}),ee.target.value=""});const fe=()=>{W()};this.canvas.on("object:added",fe),this.canvas.on("object:removed",fe),this.canvas.on("object:modified",fe);let Se=null,Te=null;document.onkeydown=ee=>{ee.target.tagName!=="INPUT"&&ee.key==="Delete"&&document.querySelector("#removeElement").dispatchEvent(new Event("click"))},document.onmouseup=()=>{this.hideCanvasGuides()};const Re=new iro$1.ColorPicker("#open_picker_text",{display:S,width:210,marginTop:20,color:L,transparency:!1,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]}),je=()=>{U.on("mousedown",async ee=>{var ft,gt,yt,St;ee.e.preventDefault();const ie=U.get("fontWeight"),de=`${U.get("fontFamily")}:${ie}`;await new Promise((pt,xt)=>{WebFont.load({google:{families:[de]},active:pt,inactive:xt})}),ee.target.set("fontWeight",ie),this.canvas.renderAll(),this.textSelectorValue="LogoName",querySelect("#font_style_tag").innerText=Z(U.get("fontStyle")),querySelect("#font_case").innerText=Z(te(U.text));const Ae=!!((ft=U==null?void 0:U.shadow)!=null&&ft.blur);querySelect("#drop-shadow").checked=Ae,Ae?(querySelect("#shadow-adjust").style.display="block",querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block"):(querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none");const Ne=U.get("charSpacing");querySelect("#l_spacing_value").value=Math.round(Ne/10)||0;let Be;const Ue=ee.target.fill;typeof Ue=="object"?Be=Ue.colorStops[0].color:Ue&&Ue.includes("#")?Be=Ue:Be=rgbaToHex(Ue),Re.color.set(Be),querySelect("#HEX2").value=Be;let Ye=hexToRgb(Be).match(/\d+/g);Ye&&Ye.length===3&&(querySelect("#R2").value=Ye[0],querySelect("#G2").value=Ye[1],querySelect("#B2").value=Ye[2]);let ut=hexToHsl(Be).match(/\d+/g);if(ut&&ut.length===3&&(querySelect("#H2").value=ut[0],querySelect("#S2").value=ut[1],querySelect("#L2").value=ut[2]),U.shadow){const pt=(gt=U==null?void 0:U.shadow)==null?void 0:gt.blur,xt=(yt=U==null?void 0:U.shadow)==null?void 0:yt.offsetX,bt=(St=U==null?void 0:U.shadow)==null?void 0:St.offsetY;querySelect("#shadow_blur_title").innerText=pt?` :${pt}px`:" :0px",querySelect("#shadow-blur-slider").value=pt,querySelect("#offset_x_title").innerText=xt?` :${xt}px`:" :0px",querySelect("#shadow-offsetX-slider").value=xt,querySelect("#offset_y_title").innerText=bt?` :${bt}px`:" 0px",querySelect("#shadow-offsetY-slider").value=bt}this.canvas.requestRenderAll(),this.activeNavbarSetting="text",this.updateActiveNavbar(),U.on("mousedblclick",()=>{const pt=document.getElementById("logoMainField");pt&&pt.focus()}),Q.on("mousedblclick",()=>{document.getElementById("sloganNameField").focus()&&Q.focus()})}),Q.on("mousedown",ee=>{var Ye,at,ut,ft;ee.e.preventDefault(),this.textSelectorValue="SloganName",querySelect("#font_style_tag").innerText=Z(Q.get("fontStyle")),querySelect("#font_case").innerText=Z(te(Q.text));const ie=!!((Ye=Q==null?void 0:Q.shadow)!=null&&Ye.blur);querySelect("#drop-shadow").checked=ie,ie?(querySelect("#shadow-adjust").style.display="block",querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block"):(querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none");const le=Q.get("charSpacing");querySelect("#l_spacing_value").value=Math.round(le/10);let de;const Ae=ee.target.fill;typeof Ae=="object"?de=Ae.colorStops[0].color:Ae&&Ae.includes("#")?de=Ae:de=rgbaToHex(Ae),Re.color.set(de),querySelect("#HEX2").value=de;let Be=hexToRgb(de).match(/\d+/g);Be&&Be.length===3&&(querySelect("#R2").value=Be[0],querySelect("#G2").value=Be[1],querySelect("#B2").value=Be[2]);let Ze=hexToHsl(de).match(/\d+/g);if(Ze&&Ze.length===3&&(querySelect("#H2").value=Ze[0],querySelect("#S2").value=Ze[1],querySelect("#L2").value=Ze[2]),Q.shadow){const gt=(at=Q==null?void 0:Q.shadow)==null?void 0:at.blur,yt=(ut=Q==null?void 0:Q.shadow)==null?void 0:ut.offsetX,St=(ft=Q==null?void 0:Q.shadow)==null?void 0:ft.offsetY;querySelect("#shadow_blur_title").innerText=gt?` :${gt}px`:" :0px",querySelect("#shadow-blur-slider").value=gt,querySelect("#offset_x_title").innerText=yt?` :${yt}px`:" :0px",querySelect("#shadow-offsetX-slider").value=yt,querySelect("#offset_y_title").innerText=St?` :${St}px`:" 0px",querySelect("#shadow-offsetY-slider").value=St}this.canvas.requestRenderAll(),this.activeNavbarSetting="text",this.updateActiveNavbar()})};je(),document.addEventListener("keydown",async ee=>{let ie=ee.ctrlKey&&ee.key==="z",le=ee.ctrlKey&&ee.key==="y",de=!1;ie&&!de&&(await this.canvasHistory.undoChanges(),de=!0),le&&!de&&(await this.canvasHistory.redoChanges(),de=!0)}),querySelect("#font_size_range").addEventListener("change",()=>{W(),this.canvas.save()}),querySelect("#font_size_range").addEventListener("input",ee=>{const ie=ee.target.value;if(ie>0){querySelect("#font_size_title").value=`${Math.round(ie)}px`;const le=this.canvas.getActiveObject(),de=ie;if(le.type=="curved-text"){if(le.set("_cachedCanvas",null),de<5)return!1;le.set("fontSize",de)}else le.set("fontSize",de);this.canvas.requestRenderAll()}}),querySelect("#text-curve-range").addEventListener("input",ee=>{let ie=ee.target.value;ve();let le=ie>=2500?(ie-2500)/25:-((2500-ie)/25),de=(le*3.6).toFixed(0);console.log("TEXT CURVE",ie,le,de),querySelect("#curve-text").value=de,this.canvas.requestRenderAll()}),querySelect("#text-curve-up").addEventListener("click",()=>{let ee=querySelect("#curve-text"),ie=parseInt(ee.value)||0;ie+=5,ee.value=ie,querySelect("#curve-text").dispatchEvent(new Event("change"))}),querySelect("#text-curve-down").addEventListener("click",()=>{let ee=querySelect("#curve-text"),ie=parseInt(ee.value)||0;ie-=5,ee.value=ie,querySelect("#curve-text").dispatchEvent(new Event("change"))}),querySelect("#curve-text").addEventListener("keydown",ee=>{ee.key=="ArrowUp"?querySelect("#text-curve-up").dispatchEvent(new Event("click")):ee.key=="ArrowDown"&&querySelect("#text-curve-down").dispatchEvent(new Event("click"))}),querySelect("#l_spacing_value").addEventListener("keydown",ee=>{ee.key=="ArrowUp"?querySelect("#letter-spacing-up").dispatchEvent(new Event("click")):ee.key=="ArrowDown"&&querySelect("#letter-spacing-down").dispatchEvent(new Event("click"))});const He=(ee,ie,le=null)=>{const Ae={...ee.__dimensionAffectingProps,left:ee.left,top:ee.top,scaleX:ee.scaleX,scaleY:ee.scaleY,diameter:parseInt(ie),fill:ee.fill,shadow:ee.shadow,percentage:le};let Ne=parseInt(ee.charSpacing)/100*3;Ne=Ne.toFixed(1),Ne<-1&&(Ne=-1),Ae.kerning=parseInt(Ne);const Be=new fabric$1.fabric.CurvedText(ee.text,Ae);let Ue=this.canvas.getObjects().indexOf(ee);this.canvas.remove(ee),this.canvas.add(Be),Be.text.toLowerCase().includes(querySelect("#logoMainField").value.toLowerCase())?U=Be:Be.text.toLowerCase().includes(querySelect("#sloganNameField").value.toLowerCase())&&(Q=Be),je(),Be.moveTo(Ue),this.canvas.setActiveObject(Be),this.canvas.requestRenderAll()},ve=()=>{let ee=this.canvas.getActiveObject();if(!ee)return;let ie=querySelect("#text-curve-range").value;console.log("CURVE TEXT WORKING VALUE",ie);let le=ie>=2500?(ie-2500)/25:-((2500-ie)/25);le=le.toFixed(0),(le==-0||le=="-0")&&(le=0),le>90&&(le=90,ie=_e(le)),le<-90&&(le=-90,ie=_e(le));const de=le<0,Ae=parseInt(le)!=0;ie>=2500&&(ie=2500-(ie-2500));const Ne=ee.type==="curved-text";if(Ae&&!Ne)console.log("hasCurveApply && !isCurvedText"),He(ee,ie,le);else if(Ae)Ae&&Ne&&(console.log("hasCurveApply && !isCurvedText"),ee.set("_cachedCanvas",null),ee.set("diameter",ie),ee.set("flipped",de),ee.set("percentage",le),ee._updateObj("scaleX",ee.scaleX),ee._updateObj("scaleY",ee.scaleY));else{console.log("!hasCurveApply");let Ue=!0;(ee.text==querySelect("#logoMainField").value||ee.text==querySelect("#sloganNameField").value)&&(Ue=!1);const Ze=new fabric$1.fabric[Ue?"IText":"Text"](ee.text,{...ee,type:"text",percentage:le});let Ye=this.canvas.getObjects().indexOf(ee);this.canvas.remove(ee),this.canvas.add(Ze),Ze.text==querySelect("#logoMainField").value?U=Ze:Ze.text==querySelect("#sloganNameField").value&&(Q=Ze),je(),Ze.moveTo(Ye),this.canvas.setActiveObject(Ze),this.canvas.save()}return this.canvas.renderAll(),(le*3.6).toFixed(0)},_e=ee=>{ee=parseInt(ee)||0;let ie=2500;return ee>0?ie=2500+ee*25:ee<0&&(ie=2500-Math.abs(ee)*25),ie};querySelect("#font_size_title").addEventListener("change",ee=>{let ie=ee.target.value;ie=parseFloat(ie).toFixed(1);const le=Number(ie.split("px")[0]);querySelect("#font_size_range").value=le,W(),this.canvas.save(),this.canvas.requestRenderAll(),querySelect("#font_size_title").value=Math.round(le)+"px"}),querySelect("#font_size_title").addEventListener("input",ee=>{const ie=ee.target.value,le=Number(ie.split("px")[0]),de=this.canvas.getActiveObject();de.fontSize=le,querySelect("#font_size_range").value=Math.round(le),this.canvas.requestRenderAll()});const qe=(ee="increment")=>{const ie=this.canvas.getActiveObject();let le=parseInt(ie.fontSize);le<=1&&(le=2);const de=le+1,Ae=le-1,Ne=ee==="increment"?ie.fontSize=de:ie.fontSize=Ae;querySelect("#font_size_range").value=Ne,querySelect("#font_size_title").value=Math.round(Ne)+"px",this.canvas.requestRenderAll(),W()};querySelect("#font_size_up").addEventListener("click",()=>void qe("increment")),querySelect("#font_size_down").addEventListener("click",()=>void qe("decrement")),querySelect("#font_size_title").addEventListener("keydown",ee=>{if(ee.key==="ArrowUp"){let le=Number(ee.target.value.split("px")[0]);ee.target.value=le+1+"px"}else if(ee.key==="ArrowDown"){let le=Number(ee.target.value.split("px")[0]);ee.target.value=le-1+"px"}const ie=this.canvas.getActiveObject();ie.fontSize=Number(ee.target.value.split("px")[0]),this.canvas.requestRenderAll()}),this.zoomSlider.addEventListener("input",()=>{let ee=this.zoomSlider.value*2;ee<=2?ee-=2.5:ee+=2.5,document.getElementById("magnifier_img").style.scale=ee,document.getElementById("magnifier_img").style.rotate="180deg",this.canvas.zoomToPoint(new fabric$1.fabric.Point(this.canvas.width/2,this.canvas.height/2),1/this.zoomSlider.value),this.canvas.requestRenderAll()}),querySelect("#copyElement").addEventListener("click",()=>{let ee=this.canvas.getActiveObject(),ie=null;if(ee.layerId&&(ie=document.querySelector(`.layer-container[data-id="${ee.layerId}"]`)),ee.id.includes("external_layer_")&&!ee.text){let le=ee.toJSON(["itemId","id","category","cacheWidth","cacheHeight"]);return le.top+=10,le.left+=10,loadExternalLayers$1(JSON.stringify([le])),!1}ee._objects?ee.clone(le=>{le._objects.forEach((de,Ae)=>{if(de.text)return!0;de.duplicate=!0,this.canvas.add(de),ie=document.querySelector(`.layer-container[data-id="${ee._objects[Ae].layerId}"]`);const Ne=new CreateLayerSection(this.layers);let Be=Array.from(this.layers.childNodes).filter(Ue=>Ue.style.display!=="none");Ne.create(de,Be.length,ie),G()}),this.canvas.centerObject(le),le.set("top",100),le.set("left",100),this.canvas.setActiveObject(le),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.canvas.save()}):ee.clone(le=>{if(le.text)return!0;le.set("dublicate",!0),this.canvas.add(le),le.top+=10,le.left+=10;const de=new CreateLayerSection(this.layers);let Ae=Array.from(this.layers.childNodes).filter(Ne=>Ne.style.display!=="none");de.create(le,Ae.length,ie),G(),this.canvas.save()}),this.canvas.requestRenderAll()}),querySelect("#eyeElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let ie=!!ee.get("visible");ie=!ie,ee.set("visible",ie),this.canvas.requestRenderAll(),W(),ee&&this.canvas.save();const le=querySelect("#eyeElement"),Ae=querySelectAll(".specific-setting-label")[1],Ne=ee.visible?"var(--gray-lighter)":"var(--gold)",Be=ee.visible?0:1,Ue=Ne;le.style.color=Ne,Ae.style.opacity=Be,Ae.style.color=Ue}),querySelect("#removeElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject(),ie=this;if(ee){if(ee._objects&&ee._objects.length&&ee._objects.forEach(le=>{if(ie.canvas.remove(le),le.layerId){let de=querySelect(`.layer-container[data-id="${le.layerId}"]`);de.style.display="none"}}),this.canvas.remove(ee),this.canvas.save(),this.canvas.renderAll(),ee.layerId){let le=querySelect(`.layer-container[data-id="${ee.layerId}"]`);le.style.display="none"}G()}setTimeout(()=>{W()},100)}),querySelect("#bringDownElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendBackwards(ee),this.canvas.setActiveObject(ee),this.canvas.requestRenderAll(),this.canvas.save()}),querySelect("#bringUpElement").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.bringForward(ee),this.canvas.setActiveObject(ee),this.canvas.requestRenderAll(),this.canvas.save()}),querySelect("#copyElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();if(!ee)return!1;let ie=!0;ee._objects?ee.clone(le=>{le.getObjects().forEach(de=>{var Ne;let Ae=de.text;if(!((Ne=de.id)!=null&&Ne.includes("external_layer_"))){if(Ae==querySelect("#logoMainField").value||(ie=!0,Ae==querySelect("#sloganNameField").value))return ie=!1,toastNotification("Logo Name or Slogan can not be duplicated");ie=!0}this.canvas.add(de),de.top+=10,de.left+=10})}):ee.clone(le=>{var Ae;let de=le.text;if(!((Ae=le.id)!=null&&Ae.includes("external_layer_"))&&(de==querySelect("#logoMainField").value||de==querySelect("#sloganNameField").value))return ie=!1,toastNotification("Logo Name or Slogan can not be duplicated");this.canvas.add(le),le.top+=10,le.left+=10}),this.canvas.renderAll(),W(),ee&&ie&&this.canvas.save()}),querySelect("#eyeElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let ie=!!ee.get("visible");ie=!ie,ee.set("visible",ie),this.canvas.requestRenderAll(),W(),ee&&this.canvas.save()}),querySelect("#removeElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject(),ie=this;ee&&(this.canvas.save(),ee._objects&&ee._objects.length&&ee._objects.forEach(le=>{ie.canvas.remove(le)}),this.canvas.remove(ee),this.canvas.save(),this.canvas.requestRenderAll())}),querySelect("#bringDownElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendToBack(ee),this.canvas.requestRenderAll(),W(),ee&&this.canvas.save()}),querySelect("#bringUpElement2").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendToFront(ee),this.canvas.requestRenderAll(),W(),ee&&this.canvas.save()}),querySelect("#eyeElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();let ie=ee.visible;ie=!ie,ee.set("visible",ie),this.canvas.requestRenderAll(),ee&&this.canvas.save()}),querySelect("#copyElement-uploads").addEventListener("click",()=>{this.canvas.getActiveObject().clone(ee=>{this.canvas.add(ee),this.canvas.centerObject(ee),this.canvas.requestRenderAll()})}),querySelect("#bringUpElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.bringForward(ee),this.canvas.requestRenderAll(),ee&&this.canvas.save()}),querySelect("#bringDownElement-uploads").addEventListener("click",()=>{const ee=this.canvas.getActiveObject();this.canvas.sendBackwards(ee),this.canvas.requestRenderAll(),ee&&this.canvas.save()});var Xe,Ge;const re=querySelect("#bg-pallete");re.addEventListener("colorChanged",function(ee){[Xe,Ge]=[ee.target.querySelector("#grad-1").value,ee.target.querySelector("#grad-2").value],W(),this.canvas.save()}),re.addEventListener("colorChange",ee=>{const{colorMode:ie,grad1Value:le,grad2Value:de,colorAngle:Ae,solidValue:Ne}=ee.detail;let Be=`${Ae}deg`,Ue=null;ie==="Linear"?Ue=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:this.canvas.width,y2:this.canvas.height,angle:Ae},colorStops:[{offset:0,color:le},{offset:1,color:de}]}):ie==="None"?(setCanvasBackground(),this.canvas.setBackgroundColor("#eeeeee",this.canvas.renderAll.bind(this.canvas)),this.canvas.requestRenderAll()):Ue=Ne,this.canvas.backgroundColor=Ue,querySelect(".color-palette-gradient").style.background=`linear-gradient(${Be}, ${le}, ${de})`;const Ze=new fabric$1.fabric.Rect({left:150,top:100,fill:Ue,width:150,height:250});this.canvas.add(Ze),Ze.center(),this.canvas.remove(Ze),this.canvas.requestRenderAll()});var ce,ue;const he=querySelect("#logo-pallete");he.addEventListener("colorChanged",ee=>{[ce,ue]=[ee.target.querySelector("#grad-1").value,ee.target.querySelector("#grad-2").value],W(),this.canvas.save()}),he.addEventListener("colorChange",ee=>{const ie=this.canvas.getActiveObject(),{colorMode:le,grad1Value:de,grad2Value:Ae,solidValue:Ne}=ee.detail;let Be=null;le!=="Solid"?Be=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:ie.width,y2:ie.height},colorStops:[{offset:0,color:de},{offset:1,color:Ae}]}):Be=Ne,ie&&ie._objects&&ie._objects.forEach(Ue=>{Ue.set("fill",Be)}),ie.set("fill",Be),this.canvas.requestRenderAll()});var pe,oe;const ne=querySelect("#text-pallete");ne.addEventListener("colorChanged",ee=>{[pe,oe]=[ee.target.querySelector("#grad-1").value,ee.target.querySelector("#grad-2").value],W(),this.canvas.save()}),document.addEventListener("DOMContentLoaded",()=>{querySelect("#text-pallete .color-palette-gradient").addEventListener("click",()=>{new applyLinearGradient(this.canvas,pe,oe).setColor()}),querySelect("#logo-pallete .color-palette-gradient").addEventListener("click",()=>{new applyLinearGradient(this.canvas,ce,ue).setColor()}),querySelect("#bg-pallete .color-palette-gradient").addEventListener("click",()=>{new applyLinearGradient(this.canvas,Xe,Ge).setColor(!0),W()})}),ne.addEventListener("colorChange",ee=>{const ie=this.canvas.getActiveObject(),{colorMode:le,grad1Value:de,grad2Value:Ae,solidValue:Ne}=ee.detail;this.currentGradiantColors={grad1Value:de,grad2Value:Ae};let Be=null;le!=="Solid"?Be=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:ie==null?void 0:ie.width,y2:ie==null?void 0:ie.height},colorStops:[{offset:0,color:de},{offset:1,color:Ae}]}):Be=Ne,ie.set("fill",Be),this.canvas.requestRenderAll()}),W();let ge=["/static/mug.png","/static/wall.png"],ye=ge.length-1;querySelect("#right-arrow").addEventListener("click",()=>{ye++,ye>=ge.length&&(ye=0);const ee=ge[ye];querySelect(".preview_image_wrapper").style.backgroundImage="url("+ee.toString()+")",querySelect(".preview_image").style.marginTop=ye===0?"100px":"-100px"}),querySelect("#left-arrow").addEventListener("click",()=>{ye===0?ye=ge.length-1:ye--;const ee=ge[ye];querySelect(".preview_image_wrapper").style.backgroundImage="url("+ee.toString()+")",querySelect(".preview_image").style.marginTop=ye===0?"100px":"-100px"}),querySelect("#close_modal").addEventListener("click",()=>{setCanvasBackground(),this.canvas.setBackgroundColor(this.canvasBG,this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="none"}),querySelect("#overlay").addEventListener("click",ee=>{ee.target.classList.contains("overlay")&&(setCanvasBackground(),this.canvas.setBackgroundColor("#eee",this.canvas.renderAll.bind(this.canvas)),querySelect(".preview-modal-bg").style.display="none")}),querySelect("#icon-search-input").addEventListener("input",ee=>{const ie=ee.target.value;querySelectAll("#clip-icon").forEach(le=>{le.getAttribute("data-name").toLowerCase().includes(ie.toLowerCase())?le.style.display="grid":le.style.display="none"})}),querySelect(".popup").addEventListener("click",ee=>{ee.target.classList.contains("popup")&&(querySelect("#popup-parent").style.display="none",querySelect("#popup-parent-icons").style.display="none")}),document.getElementById("close-btn").addEventListener("click",()=>{querySelect("#popup-parent-icons").style.display="none"});function ke(ee,ie=""){const le=new Image;le.classList.add("clip-icon"),le.setAttribute("id","clip-icon"),ee=ee.replace(/(\r\n|\n|\r)/gm,""),le.setAttribute("data-name",ie);const de=new Blob([ee],{type:"image/svg+xml"}),Ae=URL.createObjectURL(de);return le.src=Ae,le.style.width="80px",le.style.height="80px",le.style.objectFit="cover",le}querySelect("#loader_main").style.display="block",zt(this.canvas).then(ee=>{var Ye;this.logoFile=ee.svgData.AllData.svg_data;const ie=ee.svgData.AllData.logo_position;let de=new DOMParser().parseFromString(this.logoFile,"image/svg+xml"),Ae=de.querySelector("image");Ae&&Ae.remove();let Be=new XMLSerializer().serializeToString(de);localStorage.setItem("logo-file",Be),renderCanvas({SVG:Be,fabric:fabric$1.fabric,canvas:this.canvas,logoNameElement:U,sloganNameElement:Q,layers:this.layers,initialRotation:this.initialRotation,isFlipY:this.isFlipY,isFlipX:this.isFlipX,colorPicker:q,refreshLayerNames:G}),updateColorPickers(this.canvas,q);const Ue=ee==null?void 0:ee.brandCase,Ze=ee==null?void 0:ee.sloganCase;if(sessionStorage.getItem("reloaded")||(sessionStorage.setItem("reloaded","true"),location.reload()),(Ye=ee==null?void 0:ee.bg)!=null&&Ye.includes(",")){const at=ee.bg.split(",");let ut=new fabric$1.fabric.Gradient({type:"linear",coords:{x1:0,y1:0,x2:this.canvas.width,y2:this.canvas.height},colorStops:[{offset:0,color:at[0]},{offset:1,color:at[1]}]});this.canvas.setBackgroundColor(ut)}else ee.bg==="transparent"?this.canvas.setBackgroundColor("#ffffff"):this.canvas.setBackgroundColor(ee.bg);this.canvas.renderAll(),this.alignId=+ee.logoPosition,W(),setTimeout(async()=>{var xt,bt,Tt,Et,Pt,Rt;this.canvasHistory=new SaveHistory(this.canvas),querySelect("#loader_main").style.display="none",document.querySelector(`.svg__icon[data-align-id="${ie}"]`).click(),U.set("fontSize",+ee.brandSize),Q.set("fontSize",+ee.sloganSize),ee.brandCurveDiameter&&He(U,ee.brandCurveDiameter,ee.brand_curve_percentage),ee.sloganCurveDiameter&&He(Q,ee.sloganCurveDiameter,ee.slogan_curve_percentage);const ut=(xt=ee==null?void 0:ee.brandNameDropShadow)==null?void 0:xt.split(",")[0],ft=(bt=ee==null?void 0:ee.brandNameDropShadow)==null?void 0:bt.split(",")[1],gt=(Tt=ee==null?void 0:ee.brandNameDropShadow)==null?void 0:Tt.split(",")[2],yt=(Et=ee==null?void 0:ee.sloganDropShadow)==null?void 0:Et.split(",")[0],St=(Pt=ee==null?void 0:ee.sloganDropShadow)==null?void 0:Pt.split(",")[1],pt=(Rt=ee==null?void 0:ee.sloganDropShadow)==null?void 0:Rt.split(",")[2];U.set("shadow",{offsetX:+ft,offsetY:+gt,blur:+ut}),Q.set("shadow",{offsetX:+St,offsetY:+pt,blur:+yt}),U.set("charSpacing",ee.brandCharSpacing),Q.set("charSpacing",ee.sloganCharSpacing),Ue==="Uppercase"?U.text=U.text.toUpperCase():Ue==="Lowercase"?U.text=U.text.toLowerCase():Ue==="Title Case"?U.text=Z(U.text):Ue==="Sentence Case"&&(U.text=M(U.text)),Ze==="Uppercase"?Q.text=Q.text.toUpperCase():Ze==="Lowercase"?Q.text=Q.text.toLowerCase():Ze==="Title Case"?Q.text=Z(Q.text):Ze==="Sentence Case"&&(Q.text=M(Q.text)),ee.brandStyle==="underline"?U.set("underline",!0):(U.set("underline",!1),U.set("fontStyle",ee.brandStyle)),ee.sloganStyle==="underline"?Q.set("underline",!0):(Q.set("underline",!1),Q.set("fontStyle",ee.sloganStyle)),U.centerH(),Q.centerH(),this.canvas.save(),this.canvas.renderAll()},1e3)}),querySelect("#category_type_title").addEventListener("click",ee=>{querySelect("#clip-icons").innerHTML=null;const ie=ee.target.getAttribute("index");this.iconList[ie].Icons.forEach(de=>{de.icon_category_id;const Ae=this.iconList[ie].category.iconcategory_slug,Ne=de.id,Be=ke(de.icon_svg,this.iconList[ie].category.iconcategory_name);Be.setAttribute("data-category",Ae),Be.setAttribute("data-id",Ne),querySelect("#clip-icons").appendChild(Be)})});let xe=0;document.getElementById("clip-icons").addEventListener("click",ee=>{let ie=ee.target;const le=ie.getAttribute("data-id"),de=ie.getAttribute("data-category"),Ae=ie.src,Ne=decodeURIComponent(Ae),Be=this.canvas;fabric$1.fabric.loadSVGFromURL(Ne,(Ue,Ze)=>{const Ye=fabric$1.fabric.util.groupSVGElements(Ue,Ze);Ye.scaleToWidth(100),Ye.set({left:Ye.left+100,layerType:"svg"}),Ye.set("id","external_layer_"+xe),Ye.set("itemId",le),Ye.set("category",de),Be.add(Ye),Be.setActiveObject(Ye),Be.viewportCenterObjectV(Ye),Be.requestRenderAll(),W()}),xe++,document.getElementById("popup-parent-icons").style.display="none",document.querySelector(".close-popup-btn").dispatchEvent(new Event("click")),Be.save()}),querySelect("#add-clip-text").addEventListener("click",()=>{querySelect("#popup-parent").style.display="block",querySelect("#popup-parent-icons").style.display="none"}),querySelect(".close-popup-btn").addEventListener("click",()=>{querySelect("#popup-parent").style.display="none"}),querySelect("#trigger-clip-text").addEventListener("click",()=>{querySelect("#add-clip-text").dispatchEvent(new Event("click"))}),querySelect("#add-icon").addEventListener("click",()=>{querySelect("#popup-parent").style.display="block",querySelect("#popup-parent-icons").style.display="block"}),querySelect(".item-title").addEventListener("click",()=>{const ee=new fabric$1.fabric.IText("New Text",{fontFamily:"Poppins"});this.canvas.add(ee),ee.center(),ee.set("id","external_layer_"+Date.now()),ee.set("left",ee.top+50),ee.set("layerType","text"),ee.set("type","text"),W(),this.canvas.requestRenderAll(),this.canvas.setActiveObject(ee),this.canvas.save(),querySelect("#popup-parent").style.display="none",querySelect("#popup-parent-icons").style.display="none"}),querySelect("#logo-drop-shadow").addEventListener("change",ee=>{const ie=this.canvas.getActiveObject(),le=ee.target;if(ie.text)return!0;if(le.classList.toggle("active"),le.checked){querySelect("#logo-shadow-adjust").style.display="block";const de=querySelect(".settings-view");de.scrollTop=de.scrollHeight,this.logoShadowBlur=1,this.logoShadowOffsetX=0,this.logoShadowOffsetY=2,querySelect("#logo-shadow-blur-slider").value=this.logoShadowBlur,querySelect("#logo-shadow-offsetX-slider").value=this.logoShadowOffsetX,querySelect("#logo-shadow-offsetY-slider").value=this.logoShadowOffsetY,querySelect("#logo-shadow-blur-slider").dispatchEvent(new Event("input")),querySelect("#logo-shadow-offsetX-slider").dispatchEvent(new Event("input")),querySelect("#logo-shadow-offsetY-slider").dispatchEvent(new Event("input")),ie._objects?ie.forEachObject(Ae=>{Ae.set("shadow",{offsetX:0,offsetY:2,blur:5})}):ie.set("shadow",{offsetX:0,offsetY:2,blur:5}),this.canvas.requestRenderAll()}else{querySelect("#logo-shadow-adjust").style.display="none",querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none";const de=this.canvas.getActiveObject();de._objects?de.forEachObject(Ae=>{Ae.set("shadow",{offsetX:0,offsetY:0,blur:0})}):de.set("shadow",{offsetX:0,offsetY:0,blur:0}),this.canvas.requestRenderAll()}W(),ie&&this.canvas.save()});let Fe=!1;querySelect("#logo-shadow-adjust").addEventListener("click",()=>{if(this.canvas.getActiveObject(),Fe=!Fe,Fe){querySelect("#logo-shadow-blur").style.display="block",querySelect("#logo-shadow-offsetX").style.display="block",querySelect("#logo-shadow-offsetY").style.display="block",querySelect("#logo-shadow-border").style.display="block";const ee=querySelect(".settings-view");ee.scrollTop=ee.scrollHeight}else querySelect("#logo-shadow-blur").style.display="none",querySelect("#logo-shadow-offsetX").style.display="none",querySelect("#logo-shadow-offsetY").style.display="none",querySelect("#logo-shadow-border").style.display="none"}),querySelect("#drop-shadow").addEventListener("change",ee=>{const ie=this.canvas.getActiveObject();if(!ie.text)return!0;if(ee.target.checked){querySelect("#shadow-adjust").style.display="block";const le=querySelect(".settings-view");le.scrollTop=le.scrollHeight,this.shadowBlur=1,this.shadowOffsetX=0,this.shadowOffsetY=2,querySelect("#shadow-blur-slider").value=this.shadowBlur,querySelect("#shadow-offsetX-slider").value=this.shadowOffsetX,querySelect("#shadow-offsetY-slider").value=this.shadowOffsetY,querySelect("#shadow-blur-slider").dispatchEvent(new Event("input")),querySelect("#shadow-offsetX-slider").dispatchEvent(new Event("input")),querySelect("#shadow-offsetY-slider").dispatchEvent(new Event("input")),ie._objects?ie.forEachObject(de=>{if(!de.text)return!0;de.set("shadow",{offsetX:0,offsetY:2,blur:1})}):ie.set("shadow",{offsetX:0,offsetY:2,blur:1}),this.canvas.renderAll()}else querySelect("#shadow-adjust").style.display="none",querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none",ie._objects?ie.forEachObject(le=>{le.set("shadow",{offsetX:0,offsetY:0,blur:0})}):ie.set("shadow",{offsetX:0,offsetY:0,blur:0}),this.canvas.requestRenderAll();ie&&this.canvas.save()});let Me=!1;querySelect("#shadow-adjust").addEventListener("click",()=>{if(Me=!Me,Me){querySelect("#shadow-blur").style.display="block",querySelect("#shadow-offsetX").style.display="block",querySelect("#shadow-offsetY").style.display="block";const ee=querySelect(".settings-view");ee.scrollTop=ee.scrollHeight}else querySelect("#shadow-blur").style.display="none",querySelect("#shadow-offsetX").style.display="none",querySelect("#shadow-offsetY").style.display="none"});const ze=querySelect("#solid_color_mode"),we=querySelect("#linear_color_mode"),be=querySelect("#picker_color_mode"),Pe=querySelect("#solid_color_text_mode"),Le=querySelect("#linear_color_text_mode"),Ce=querySelect("#picker_color_text_mode");updateColorPickers(this.canvas,q),q.on("color:init",ee=>{ee.set(L)}),q.on("input:change",ee=>{const ie=this.canvas.getActiveObject();if(!ie)return;if(L=ee.rgbaString,ee.index===0){const de=ee.hsl,Ae=ee.rgb;querySelect("#H").value=de.h,querySelect("#S").value=de.s,querySelect("#L").value=de.l,querySelect("#R").value=Ae.r,querySelect("#G").value=Ae.g,querySelect("#B").value=Ae.b,querySelect("#HEX").value=ee.hexString}ie&&ie._objects&&ie._objects.forEach(de=>{de.set("fill",ee.rgbaString)}),ie.set("fill",ee.rgbaString),querySelectAll("#color-layers-pickers").forEach(de=>de.remove()),updateColorPickers(this.canvas,q),this.canvas.requestRenderAll()}),attachRGBHandlers(q,this.canvas),attachHSLHandlers(q,this.canvas);const De="2";attachRGBHandlers(Re,this.canvas,De),attachHSLHandlers(Re,this.canvas,De);let We=0,et=0;querySelect("#HEX").addEventListener("input",ee=>{let ie=ee.target.value;ie.length>0&&ie[0]!=="#"&&(We>=3?(ie="#"+ie,querySelect("#HEX").value=ie,We=0):We++),q.color.set(ie);const le=this.canvas.getActiveObject();le&&le._objects&&le._objects.forEach(Ye=>{Ye.set("fill",ie)}),le.set("fill",ie);let de=querySelect("#R").value,Ae=querySelect("#G").value,Ne=querySelect("#B").value;q.color.rgb={r:de,g:Ae,b:Ne};let Be=querySelect("#H").value,Ue=querySelect("#S").value,Ze=querySelect("#L").value;q.color.hsl={h:Be,s:Ue,l:Ze},this.canvas.requestRenderAll()}),querySelect("#HEX2").addEventListener("input",ee=>{let ie=ee.target.value;ie.length>0&&ie[0]!=="#"&&(et>=3?(ie="#"+ie,querySelect("#HEX2").value=ie,et=0):et++),Re.color.set(ie);const le=this.canvas.getActiveObject();if(!le)return!0;le._objects&&le._objects.forEach(Ye=>{Ye.set("fill",ie)}),le.set("fill",ie);let de=querySelect("#R2").value,Ae=querySelect("#G2").value,Ne=querySelect("#B2").value;Re.color.rgb={r:de,g:Ae,b:Ne};let Be=querySelect("#H2").value,Ue=querySelect("#S2").value,Ze=querySelect("#L2").value;Re.color.hsl={h:Be,s:Ue,l:Ze},this.canvas.requestRenderAll()});var $e=!0,Oe=!1,Ke=!1;const tt=()=>{$e=!$e,Oe=!1,Ke=!1,$e?(querySelect("#picker_color_mode").classList.remove("category_selected"),querySelect("#solid_color_mode").classList.add("category_selected"),querySelect("#linear_color_mode").classList.remove("category_selected"),querySelect("#solid_color_items").style.display="flex",querySelect("#linear_color_items").style.display="none",querySelect("#picker_color_items").style.display="none",l="none"):(querySelect("#solid_color_items").style.display="none",querySelect("#linear_color_items").style.display="none",querySelect("#picker_color_items").style.display="none",querySelect("#solid_color_mode").classList.remove("category_selected"))},it=()=>{Oe=!Oe,$e=!1,Ke=!1,Oe?(querySelect("#picker_color_mode").classList.remove("category_selected"),querySelect("#linear_color_mode").classList.add("category_selected"),querySelect("#solid_color_mode").classList.remove("category_selected"),querySelect("#linear_color_items").style.display="flex",querySelect("#solid_color_items").style.display="none",querySelect("#picker_color_items").style.display="none",l="none"):(querySelect("#solid_color_items").style.display="none",querySelect("#linear_color_items").style.display="none",querySelect("#picker_color_items").style.display="none",querySelect("#linear_color_mode").classList.remove("category_selected"))},lt=()=>{Ke=!Ke,$e=!1,Oe=!1,Ke?(querySelect("#solid_color_items").style.display="none",querySelect("#picker_color_items").style.display="flex",querySelect("#linear_color_items").style.display="none",querySelect("#linear_color_mode").classList.remove("category_selected"),querySelect("#solid_color_mode").classList.remove("category_selected"),querySelect("#picker_color_mode").classList.add("category_selected"),querySelect("#picker_color_items").style.marginTop="8px",S="block"):(querySelect("#solid_color_items").style.display="none",querySelect("#linear_color_items").style.display="none",querySelect("#picker_color_items").style.display="none",querySelect("#picker_color_mode").classList.remove("category_selected"))};var rt=!0,dt=!1,ct=!1;const vt=()=>{rt=!rt,dt=!1,ct=!1,rt?(querySelect("#picker_color_text_mode").classList.remove("category_selected"),querySelect("#solid_color_text_mode").classList.add("category_selected"),querySelect("#linear_color_text_mode").classList.remove("category_selected"),querySelect("#solid_color_items_text").style.display="flex",querySelect("#linear_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="none",S="none"):(querySelect("#solid_color_items_text").style.display="none",querySelect("#linear_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="none",querySelect("#solid_color_text_mode").classList.remove("category_selected"))},wt=()=>{dt=!dt,rt=!1,ct=!1,dt?(querySelect("#picker_color_text_mode").classList.remove("category_selected"),querySelect("#linear_color_text_mode").classList.add("category_selected"),querySelect("#solid_color_text_mode").classList.remove("category_selected"),querySelect("#linear_color_items_text").style.display="flex",querySelect("#solid_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="none",S="none"):(querySelect("#solid_color_items_text").style.display="none",querySelect("#linear_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="none",querySelect("#linear_color_text_mode").classList.remove("category_selected"))},ae=()=>{ct=!ct,rt=!1,dt=!1,ct?(querySelect("#solid_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="flex",querySelect("#linear_color_items_text").style.display="none",querySelect("#linear_color_text_mode").classList.remove("category_selected"),querySelect("#solid_color_text_mode").classList.remove("category_selected"),querySelect("#picker_color_text_mode").classList.add("category_selected"),querySelect("#picker_color_items_text").style.marginTop="8px",S="block"):(querySelect("#solid_color_items_text").style.display="none",querySelect("#linear_color_items_text").style.display="none",querySelect("#picker_color_items_text").style.display="none",querySelect("#picker_color_text_mode").classList.remove("category_selected"))};let me="block",Ie="#fff",Ee=new iro$1.ColorPicker("#openTextPickerViewBG",{display:me,width:210,marginTop:20,color:Ie,layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]});const Ve=()=>{querySelect("#picker_color_text_modeBG").classList.remove("category_selected"),querySelect("#linear_color_text_modeBG").classList.remove("category_selected"),querySelect("#solid_color_text_modeBG").classList.add("category_selected"),querySelect("#bg_solid_color_items_text").style.display="flex",querySelect("#bg_picker_color_items_text").style.display="none",querySelect("#bg_linear_color_items_text").style.display="none",me="none"},Je=()=>{querySelect("#bg_solid_color_items_text").style.display="none",querySelect("#bg_picker_color_items_text").style.display="flex",querySelect("#bg_linear_color_items_text").style.display="none",querySelect("#solid_color_text_modeBG").classList.remove("category_selected"),querySelect("#linear_color_text_modeBG").classList.remove("category_selected"),querySelect("#picker_color_text_modeBG").classList.add("category_selected"),querySelect("#bg_picker_color_items_text").style.marginTop="8px",me="block"},Qe=()=>{querySelect("#bg_solid_color_items_text").style.display="none",querySelect("#bg_picker_color_items_text").style.display="none",querySelect("#bg_linear_color_items_text").style.display="flex",querySelect("#solid_color_text_modeBG").classList.remove("category_selected"),querySelect("#picker_color_text_modeBG").classList.remove("category_selected"),querySelect("#linear_color_text_modeBG").classList.add("category_selected"),querySelect("#bg_picker_color_items_text").style.marginTop="8px",me="block"};Ve(),querySelect("#solid_color_text_modeBG").addEventListener("click",()=>{Ve()}),querySelect("#picker_color_text_modeBG").addEventListener("click",()=>{Je()}),querySelect("#linear_color_text_modeBG").addEventListener("click",()=>{Qe()}),["#B_BG"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{const ie=querySelect("#R_BG").value,le=querySelect("#G_BG").value,de=querySelect("#B_BG").value;Ee.color.rgb={r:ie,g:le,b:de};const Ae=Ee.color.hexString;this.canvas.setBackgroundColor(Ae),this.canvas.requestRenderAll()})}),["#H_BG","#S_BG","#L_BG"].forEach(ee=>{querySelect(ee).addEventListener("input",()=>{const ie=querySelect("#H_BG").value,le=querySelect("#S_BG").value,de=querySelect("#L_BG").value;Ee.color.hsl={h:ie,s:le,l:de};const Ae=Ee.color.hexString;this.canvas.setBackgroundColor(Ae),this.canvas.requestRenderAll()})}),querySelect("#HEX_BG").addEventListener("input",ee=>{let ie=ee.target.value;ie.length>0&&ie[0]!=="#"&&ie.length>=3&&(ie="#"+ie,querySelect("#HEX_BG").value=ie);const le=querySelect("#R_BG").value,de=querySelect("#G_BG").value,Ae=querySelect("#B_BG").value;Ee.color.rgb={r:le,g:de,b:Ae};const Ne=querySelect("#H_BG").value,Be=querySelect("#S_BG").value,Ue=querySelect("#L_BG").value;Ee.color.hsl={h:Ne,s:Be,l:Ue},Ee.color.set(ie),this.canvas.setBackgroundColor(Ee.color.hexString),this.canvas.requestRenderAll()});const nt=(ee,ie,le,de=!0)=>{de&&document.querySelectorAll(".bg-settings-container .color_mode_title").forEach(Ae=>Ae.classList.remove("active")),querySelect(ie+"_view_BG").classList.remove("color_mode_title-active"),querySelect(ie+"_view_BG").style.display="none",querySelect(le+"_view_BG").classList.remove("color_mode_title-active"),querySelect(le+"_view_BG").style.display="none",querySelect(ee+"_view_BG").classList.add("color_mode_title-active"),querySelect(ee+"_view_BG").style.display="flex"};querySelect("#HSL_mode_BG").addEventListener("click",ee=>{nt("#HSL","#RGB","#HEX"),ee.target.classList.add("active")}),querySelect("#RGB_mode_BG").addEventListener("click",ee=>{nt("#RGB","#HSL","#HEX"),ee.target.classList.add("active")}),querySelect("#HEX_mode_BG").addEventListener("click",ee=>{nt("#HEX","#RGB","#HSL"),ee.target.classList.add("active")}),nt("#HEX","#RGB","#HSL",!1);const st=ee=>{if(Ie=ee.rgbaString,ee.index===0){const ie=ee.hsl,le=ee.rgb;querySelect("#H_BG").value=ie.h,querySelect("#S_BG").value=ie.s,querySelect("#L_BG").value=ie.l,querySelect("#R_BG").value=le.r,querySelect("#G_BG").value=le.g,querySelect("#B_BG").value=le.b,querySelect("#HEX_BG").value=ee.hexString}this.canvas.setBackgroundColor(ee.rgbaString),this.canvas.requestRenderAll()};Ee.on("color:init",ee=>{ee.set(Ie),st(ee)}),Ee.on("input:change",ee=>{st(ee)}),Ee.on("input:end",()=>{W(),this.canvas.save()}),tt(),vt(),ze.addEventListener("click",tt),be.addEventListener("click",lt),we.addEventListener("click",it),Pe.addEventListener("click",vt),Le.addEventListener("click",wt),Ce.addEventListener("click",ae),querySelect("#custom_color_generator").addEventListener("change",ee=>{const ie=ee.target.value,le=document.createElement("div");le.style.backgroundColor=ie,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=ie,le.style.borderRadius="5px",le.addEventListener("click",()=>{const de=this.canvas.getActiveObject();de._objects&&de._objects.forEach(Ze=>Ze.set("fill",ie)),de.set("fill",ie),q.color.set(ie),querySelect("#HEX").value=ie;let Ne=hexToRgb(ie).match(/\d+/g);Ne&&Ne.length===3&&(querySelect("#R").value=Ne[0],querySelect("#G").value=Ne[1],querySelect("#B").value=Ne[2]);let Ue=hexToHsl(ie).match(/\d+/g);Ue&&Ue.length===3&&(querySelect("#H").value=Ue[0],querySelect("#S").value=Ue[1],querySelect("#L").value=Ue[2]),this.canvas.renderAll(),W()}),querySelect("#custom_colors_wrapper").append(le)}),querySelect("#custom_text_color_generator").addEventListener("change",ee=>{const ie=ee.target.value,le=document.createElement("div");le.style.backgroundColor=ie,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=ie,le.style.borderRadius="5px",le.addEventListener("click",()=>{const de=this.canvas.getActiveObject();de._objects&&de._objects.forEach(Ze=>Ze.set("fill",ie)),de.set("fill",ie),Re.color.set(ie),querySelect("#HEX2").value=ie;let Ne=hexToRgb(ie).match(/\d+/g);Ne&&Ne.length===3&&(querySelect("#R2").value=Ne[0],querySelect("#G2").value=Ne[1],querySelect("#B2").value=Ne[2]);let Ue=hexToHsl(ie).match(/\d+/g);Ue&&Ue.length===3&&(querySelect("#H2").value=Ue[0],querySelect("#S2").value=Ue[1],querySelect("#L2").value=Ue[2]),this.canvas.renderAll(),W(),this.canvas.save()}),querySelect("#custom_text_colors_wrapper").append(le)}),querySelect("#custom_bg_color_generator").addEventListener("change",ee=>{const ie=ee.target.value,le=document.createElement("div");le.style.backgroundColor=ie,le.className="color-picker",le.style.width="32px",le.style.height="32px",le.style.borderColor=ie,le.style.borderRadius="5px",le.addEventListener("click",()=>{this.canvas.setBackgroundColor(ie),Ee.color.set(ie),querySelect("#HEX_BG").value=ie;let Ae=hexToRgb(ie).match(/\d+/g);Ae&&Ae.length===3&&(querySelect("#R_BG").value=Ae[0],querySelect("#G_BG").value=Ae[1],querySelect("#B_BG").value=Ae[2]);let Be=hexToHsl(ie).match(/\d+/g);Be&&Be.length===3&&(querySelect("#H_BG").value=Be[0],querySelect("#S_BG").value=Be[1],querySelect("#L_BG").value=Be[2]),this.canvas.renderAll(),W(),this.canvas.save()}),querySelect("#custom_bg_colors_wrapper").append(le)}),querySelectAll("#solid_color").forEach(ee=>{solidColorAction(ee,this.canvas,q,W)});const ht=ee=>{if(L=ee.rgbaString,ee.index===0){const de=ee.hsl,Ae=ee.rgb;querySelect("#H2").value=de.h,querySelect("#S2").value=de.s,querySelect("#L2").value=de.l,querySelect("#R2").value=Ae.r,querySelect("#G2").value=Ae.g,querySelect("#B2").value=Ae.b,querySelect("#HEX2").value=ee.hexString}const ie=this.canvas.getActiveObject();if(!ie)return!1;ie._objects&&ie._objects.forEach(de=>{de.set("fill",ee.rgbaString)}),ie.set("fill",ee.rgbaString),this.canvas.requestRenderAll(),querySelectAll("#color-layers-pickers").forEach(de=>de.remove()),updateColorPickers(this.canvas,q),this.canvas.requestRenderAll()};Re.on("input:change",ht),Re.on("input:move",ht),Re.on("input:end",()=>{W(),this.canvas.save()}),querySelectAll("#solid_color_text").forEach(ee=>{solidColorTextAction(ee,this.canvas,Re,W),ht(Re.color)}),querySelectAll("#solid_color-bg").forEach(ee=>{bgColorAction(ee,this.canvas,W)}),updateColorTextPickers(this.canvas,W),Re.on("color:init",ee=>{ee.set(L)});const ot=(ee,ie,le)=>{querySelect(ie+"_view").classList.remove("color_mode_title-active"),querySelect(ie+"_view").style.display="none",querySelect(le+"_view").classList.remove("color_mode_title-active"),querySelect(le+"_view").style.display="none",querySelect(ee+"_view").classList.add("color_mode_title-active"),querySelect(ee+"_view").style.display="flex"};querySelect("#HSL_mode").addEventListener("click",ee=>{document.querySelectorAll(".setting-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#HSL","#RGB","#HEX"),ee.target.classList.add("active")}),querySelect("#RGB_mode").addEventListener("click",ee=>{document.querySelectorAll(".setting-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#RGB","#HSL","#HEX"),ee.target.classList.add("active")}),querySelect("#HEX_mode").addEventListener("click",ee=>{document.querySelectorAll(".setting-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#HEX","#RGB","#HSL"),ee.target.classList.add("active")}),querySelect("#HSL2_mode").addEventListener("click",ee=>{document.querySelectorAll(".text-settings-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#HSL2","#RGB2","#HEX2"),ee.target.classList.add("active")}),querySelect("#RGB2_mode").addEventListener("click",ee=>{document.querySelectorAll(".text-settings-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#RGB2","#HSL2","#HEX2"),ee.target.classList.add("active")}),querySelect("#HEX2_mode").addEventListener("click",ee=>{document.querySelectorAll(".text-settings-container .color_mode_title").forEach(ie=>ie.classList.remove("active")),ot("#HEX2","#RGB2","#HSL2"),ee.target.classList.add("active")}),ot("#HEX","#RGB","#HSL"),ot("#HEX2","#RGB2","#HSL2");const mt=ee=>{const ie=new fabric$1.fabric.ActiveSelection(this.canvas.getObjects().filter(Ne=>{var Be;return!Ne.text&&!(Ne!=null&&Ne.dublicate)&&!((Be=Ne.id)!=null&&Be.includes("external_layer_"))}),{canvas:this.canvas}),{width:le,height:de}=ie,Ae=Math.min(ee/le,ee/de);ie.scale(Ae),ie.center(),this.canvas.setActiveObject(ie),this.canvas.discardActiveObject(ie),this.canvas.requestRenderAll()};querySelect("#canvas-bg-none").addEventListener("click",()=>{this.canvasBG="#ffffff",this.canvas.setBackgroundColor(this.canvasBG),this.canvas.renderAll(),this.canvas.updatePreview()});const _t=()=>{this.canvas.discardActiveObject(),this.canvas.requestRenderAll()};var Ct,Lt,Dt;async function zt(){var Ht,Xt,Nt;querySelect("#loader_main").style.display="block";const ee=querySelect("#logo_id").value;if(!ee)return toastNotification("Error!! Logo ID Not Found");let ie;querySelect("#api_check").value==="1"?ie=await axios$1.get(`https://www.mybrande.com/api/find/logo/${ee}`):ie=await axios$1.get(`https://www.mybrande.com/api/find/logo/buyer/${ee}`);const de=(Ht=ie==null?void 0:ie.data)==null?void 0:Ht.AllData,Ae=de==null?void 0:de.logo_backgroundcolor;Ct=de==null?void 0:de.logo_position;const Ne=de==null?void 0:de.editor_svg_data,Be=de==null?void 0:de.brandName_letterSpace,Ue=de==null?void 0:de.slogan_letterSpace,Ze=de==null?void 0:de.brandName_fontStyle,Ye=de==null?void 0:de.slogan_fontStyle,at=de==null?void 0:de.brandName_fontSize,ut=de==null?void 0:de.slogan_fontSize,ft=de==null?void 0:de.brandName_letterCase,gt=de==null?void 0:de.slogan_letterCase,yt=de==null?void 0:de.slogan_curve_diameter,St=de==null?void 0:de.brandName_curve_diameter,pt=de==null?void 0:de.brandName_droupShadow,xt=de==null?void 0:de.slogan_droupShadow;Lt=de==null?void 0:de.externalLayerElements,Dt=de==null?void 0:de.externalTextElements,de==null||de.images,loadExternalLayers$1(Lt,Dt);const bt=(Xt=p.allFonts[de==null?void 0:de.brandName_fontFamely])==null?void 0:Xt.family,Tt=(Nt=p.allFonts[de==null?void 0:de.slogan_fontFamely])==null?void 0:Nt.family,Et=[];bt&&Et.push(bt),Tt&&Et.push(Tt),WebFont.load({fontDisplay:"swap",google:{families:Et},active:function(){U.set("fontFamily",bt),Q.set("fontFamily",Tt),p.canvas.renderAll()}}),Ne&&localStorage.setItem("logo-file",Ne);const Pt=Number(Be)*10,Rt=Number(Ue)*10;return{bg:Ae,logoPosition:Ct,svgData:ie.data,brandCharSpacing:Pt,sloganCharSpacing:Rt,brandStyle:Ze,sloganStyle:Ye,brandNameDropShadow:pt,sloganDropShadow:xt,brandSize:at,sloganSize:ut,brandCase:ft,sloganCase:gt,sloganCurveDiameter:yt,brandCurveDiameter:St}}let It={top_bottom_1:200,top_bottom_2:200,top_bottom_3:160,top_bottom_4:200,bottom_top_1:200,bottom_top_2:200,bottom_top_3:160,left_right_1:200,left_right_2:200,left_right_3:160,left_right_4:200,right_left_1:200,right_left_2:160,right_left_3:200,right_left_4:200,curve_1:200,curve_2:200,curve_3:200},Mt=!1;for(const ee in It){let ie=It[ee];querySelect("#"+ee).addEventListener("click",()=>{if(Mt)return!0;_t(),this.alignId=getAttr(`#${ee}`,"data-align-id"),mt(ie),Mt=!0,setlogoPosition(this,{logoPosition:this.alignId,logoNameElement:U,sloganNameElement:Q,scaleLogo:mt}),setTimeout(()=>{W(),this.canvas.save(),Mt=!1},100)})}let kt=0,Ot=20,At=querySelect("#font-family-con .collection");const qt=async ee=>{const ie=ee.slice(kt,kt+Ot);kt+=Ot;let le="";for(const de of ie){const{family:Ae,variants:Ne}=de;p.loadedFonts[Ae]={variants:Ne},p.allFonts[Ae].loaded=!0;const Be=Ne.map(Ue=>`${Ae}:${Ue}`);WebFont.load({google:{families:Be}}),le+=`<li value="${Ae}" class="font-family-item" data-loaded="true">
          <span style="font-family:${Ae}; font-weight: 500" class="text">${Ae}</span></li>`}At.innerHTML+=le,initMultiSelectList()},Wt=ee=>{const ie=ee.slice(kt-Ot,kt);for(const le of ie){const{family:de}=le,Ae=At.querySelector(`li[value="${de}"]`);Ae&&At.removeChild(Ae)}kt-=Ot,initMultiSelectList()};(async()=>{const ee=await this.fetchFonts();await qt(ee),At.addEventListener("wheel",Vt(ie=>{ie.wheelDelta<0?qt(ee):ie.wheelDelta>0&&kt>Ot&&Wt(ee)}),150)})();const Vt=(ee,ie)=>{let le=null;return(...de)=>{clearTimeout(le),le=setTimeout(()=>{ee(...de)},ie)}},Gt=function(ee){let ie=ee.value.toLowerCase(),le=querySelect("#font-family-con .collection");const de=Be=>`<li value="${Be}" class="font-family-item" data-loaded="true">
          <span style="font-family:${Be}; font-weight: 500px" class="text">${Be}</span></li>`;if(!ie.length){le.innerHTML="";let Be=20,Ue="";for(const Ze in p.allFonts){if(Be<=0)break;let Ye=de(Ze);Ue+=Ye,Be--}return At.innerHTML=Ue,!1}let Ae=Object.keys(p.allFonts).filter(Be=>Be.toLowerCase().startsWith(ie)),Ne="";for(const Be of Ae){let Ue=de(Be);Ne+=Ue,p.loadedFonts[Be]=p.allFonts[Be]}try{WebFont.load({google:{families:Ae},active:function(){}})}catch{}le.innerHTML=Ne,initMultiSelectList()};document.addEventListener("keyup",function(ee){ee.target.classList.contains("live-search")&&Gt(ee.target)})}}const editorScreen=new EditorScreen;editorScreen.initialize();const canvas=editorScreen.canvas,fetchedFonts=editorScreen.fetchFonts,mobileBackgroundView=`<div id="mobile-background-view">
<div id="mobile-background-view-categories" class="mobile-category-container" style="justify-content: center; gap: 40px;">
    <!-- Solid Category -->
    <div id="mobile-solid-category" class="mobile-category">
        <i class="fas fa-square mobile-category-icon"></i>
        <p class="mobile-category-text">Solid</p>
    </div>

    <!-- mobile picker category -->
    <div id="mobile-picker-color-category" class="mobile-category">
        <i class="fas fa-palette mobile-category-icon"></i>
        <p class="mobile-category-text">C.Picker</p>
    </div>

    <!-- Linear Category -->
    <div id="mobile-linear-category" class="mobile-category">
        <i class="fas fa-arrows-alt-h mobile-category-icon"></i>
        <p class="mobile-category-text">Linear</p>
    </div>

    <!-- None Category -->
    <div id="mobile-none-category" class="mobile-category">
        <i class="fas fa-ban mobile-category-icon"></i>
        <p class="mobile-category-text">None</p>
    </div>
</div>

<!-- Solid Colors Section -->
<div id="mobile-solid-color-section" style="display: grid; grid-template-colums: repeat(4, 1fr); gap: 5px; justify-content: flex-start; padding: 10px 10px 0px 10px; overflow-x: scroll; display: none;">
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #000000;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #545454;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #737373;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6a6a6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d9d9d9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f5f5f5;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b25d1f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e37627;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fc832b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fd964b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #febb8a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fedfc9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff2e9;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ab2d2d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #de3a3a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f74040;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f85d5d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fcb3b3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fed0d0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffeded;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #8a6e10;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b89e1e;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e5c100;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffdd00;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffea66;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff59d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffe0;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #126f43;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #168a53;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1dbf73;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #62d49f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6eaca;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #c9f4e0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e8faf4;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1b8996;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #25a1b0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3ad0e6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #75dfee;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #afedf7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #cdf5fb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecfcff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #284389;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3f63c8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #4a73e8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #819ef0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #9db4f3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d4defb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f0f4ff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #6731a1;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #984ae8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a866ec;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b881f0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d8b9f7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecddfb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f8f0ff;"></span>
  </div>
</div>

<div id="mobile-linear-color-section" style="display: flex; width: 100svw; align-items: center; height: 90px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
  <mobile-pallete-component id="mobile-bg-pallete"></mobile-pallete-component>
</div>


<div id="mobile-picker-color-section" style="position: absolute; bottom: 0; left: 0; background-color: #fff; display: flex; width: 100svw; align-items: center; height: 160px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
 </div>

<div id="mobile-none-color-section" style="display: flex; gap: 5px; justify-content: flex-start; padding-right: 30px; overflow-x: scroll; display: none;">
  <h1>None</h1> </div>

</div>`,mobileLogoView=`<div id="mobile-logo-view-settings" class="mobile-category-container">
    <!-- Layers Category -->
    <div id="mobile-layers-category" class="mobile-category">
        <i class="fas fa-layer-group mobile-category-icon"></i>
        <p class="mobile-category-text">Layers</p>
    </div>

    <!-- Layer Action Category -->
    <div id="mobile-layer-action-category" class="mobile-category">
        <i class="fas fa-cogs mobile-category-icon"></i>
        <p class="mobile-category-text">Actions</p>
    </div>

    <!-- Colors Category -->
    <div id="mobile-colors-category" class="mobile-category">
        <i class="fas fa-palette mobile-category-icon"></i>
        <p class="mobile-category-text">Colors</p>
    </div>

    <!-- Drop Shadow Category -->
    <div id="mobile-drop-shadow-category" class="mobile-category">
        <i class="fa-brands fa-first-order-alt mobile-category-icon"></i>
        <p class="mobile-category-text">Shadow</p>
    </div>

    <!-- Scale Category -->
    <div id="mobile-scale-category" class="mobile-category">
        <i class="fas fa-expand mobile-category-icon"></i>
        <p class="mobile-category-text">Scale</p>
    </div>

    <!-- Rotate Category -->
    <div id="mobile-rotate-category" class="mobile-category">
        <i class="fas fa-sync-alt mobile-category-icon"></i>
        <p class="mobile-category-text">Rotate</p>
    </div>

    <!-- Flip Horizontal Category -->
    <div id="mobile-flip-horizontal-category" class="mobile-category">
        <i class="fas fa-arrow-left mobile-category-icon"></i>
        <p class="mobile-category-text">FlipX</p>
    </div>

    <!-- Flip Vertical Category -->
    <div id="mobile-flip-vertical-category" class="mobile-category">
        <i class="fas fa-arrow-up mobile-category-icon"></i>
        <p class="mobile-category-text">FlipY</p>
    </div>
</div>`,mobileAddView=`
    <div id="mobile-add-view" style="display: flex; flex-direction: column; gap: 10px; align-items: center; width: 100svw;">
    <div style="display: flex; justify-content: space-around; width: 100%; height: 100%; align-items: center;">
      <div id="mobile-add-item" style="text-align: center;" id="mobile-upload-layer">
          <i class="fa-solid fa-upload" style="font-size: 20px; color: var(--gray-light);"></i>
          <div style="font-size: 12px; color: var(--gray-light);">Upload</div>
      </div>
      <div id="mobile-add-icon" style="text-align: center;" id="mobile-add-icon-layer">
          <i class="fa-solid fa-icons" style="font-size: 20px; color: var(--gray-light);"></i>
          <div style="font-size: 12px; color: var(--gray-light);">Add Icon</div>
      </div>
      <div id="mobile-add-text" style="text-align: center;" id="mobile-add-text-layer">
          <i class="fa-solid fa-font" style="font-size: 20px; color: var(--gray-light);"></i>
          <div style="font-size: 12px; color: var(--gray-light);">Add Text</div>
      </div>
      </div>

      <div id="mobile-add-icon-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255, 255, 255, 0.98); z-index: 2000;
      display: none; justify-content: center; align-items: center;">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 60px">
    <input type="text" style="border-radius: 5px; width: 100%; padding: 5px; outline: none; border: none; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); text-align: center; display: none" placeholder="Search...">
    <div id="mobile-clip-icons" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 60px;"></div>
    <button id="mobile-clip-icon-close" class="btn" style="width: 100%;">Close</button>
  </div>
  </div>
    </div>`;function mobileAddMenu(){const B=document.querySelector("#mobile-add-text"),p=document.querySelector("#mobile-add-icon"),W=document.querySelector("#mobile-add-icon-modal"),G=document.querySelector("#mobile-clip-icon-close"),K=document.querySelector("#mobile-add-item"),J=document.querySelector('.nav-item[data-name="upload"]');p.addEventListener("click",async()=>{W.style.display="flex"}),G==null||G.addEventListener("click",()=>{W.style.display="none"}),K==null||K.addEventListener("click",()=>{J.click()}),B==null||B.addEventListener("click",()=>{document.querySelector(".item-title").click()})}const mobileTextView=`
<div id="mobile-text-view" class="mobile-category-container">
    <!-- Input for Logo and Slogan -->
    <div class="mobile-category" id="mobile-input-category">
        <i class="fas fa-keyboard mobile-category-icon"></i>
        <p class="mobile-category-text">Input</p>
    </div>

    <!-- Layer Actions -->
    <div class="mobile-category" id="mobile-text-layer-actions-category">
        <i class="fas fa-cogs mobile-category-icon"></i>
        <p class="mobile-category-text">Actions</p>
    </div>

    <!-- Layer Colors -->
    <div class="mobile-category" id="mobile-text-layer-colors-category">
        <i class="fas fa-palette mobile-category-icon"></i>
        <p class="mobile-category-text">Colors</p>
    </div>

    <!-- Font Size -->
    <div class="mobile-category" id="mobile-font-size-category">
        <i class="fas fa-text-height mobile-category-icon"></i>
        <p class="mobile-category-text">Size</p>
    </div>

    <!-- Font Family -->
    <div class="mobile-category" id="mobile-font-family-category">
        <i class="fas fa-font mobile-category-icon"></i>
        <p class="mobile-category-text">Family</p>
    </div>

    <!-- Font Weight -->
    <div class="mobile-category" id="mobile-font-weight-category">
        <i class="fas fa-bold mobile-category-icon"></i>
        <p class="mobile-category-text">Weight</p>
    </div>

    <!-- Font Style -->
    <div class="mobile-category" id="mobile-font-style-category">
        <i class="fas fa-italic mobile-category-icon"></i>
        <p class="mobile-category-text">Style</p>
    </div>

    <!-- Letter Case -->
    <div class="mobile-category" id="mobile-letter-case-category">
        <i class="fas fa-text-width mobile-category-icon"></i>
        <p class="mobile-category-text">Case</p>
    </div>

    <!-- Curve Text -->
    <div class="mobile-category" id="mobile-curve-text-category">
        <i class="fas fa-ellipsis-h mobile-category-icon"></i>
        <p class="mobile-category-text">Curve</p>
    </div>

    <!-- Rotate -->
    <div class="mobile-category" id="mobile-rotate-category">
        <i class="fas fa-sync-alt mobile-category-icon"></i>
        <p class="mobile-category-text">Rotate</p>
    </div>

    <!-- Letter Spacing -->
    <div class="mobile-category" id="mobile-letter-spacing-category">
        <i class="fas fa-text-width mobile-category-icon"></i>
        <p class="mobile-category-text">Spacing</p>
    </div>

    <!-- Drop Shadow -->
    <div class="mobile-category" id="mobile-text-drop-shadow-category">
        <i class="fa-brands fa-first-order-alt mobile-category-icon"></i>
        <p class="mobile-category-text">Shadow</p>
    </div>
</div>
`;function mobileBackgroundMenu(){var L,q;const B=document==null?void 0:document.getElementById("mobile-background-view-categories"),p=document==null?void 0:document.getElementById("mobile-solid-category"),W=document==null?void 0:document.getElementById("mobile-linear-category"),G=document==null?void 0:document.getElementById("mobile-none-category"),K=document==null?void 0:document.getElementById("mobile-picker-color-category"),J=document.getElementById("mobile-solid-color-section"),Z=document.getElementById("mobile-linear-color-section"),M=document.getElementById("mobile-picker-color-section"),E=document.getElementById("mobile-none-color-section");p==null||p.addEventListener("click",()=>{B.style.display="none",J.style.display="grid",J.style.gridTemplateColumns="repeat(4, 1fr)",J.style.padding="15px",Z.style.display="none",E.style.display="none"}),(L=document==null?void 0:document.querySelector("#mobile-bg-add-item"))==null||L.addEventListener("click",()=>{document.querySelector("#upload-file").click()}),document.querySelectorAll("#solid_color-bg-mobile").forEach(O=>{bgColorAction(O,canvas,null,!0)}),K==null||K.addEventListener("click",()=>{B.style.display="none",M.style.display="flex",J.style.display="none",Z.style.display="none",E.style.display="none"}),W==null||W.addEventListener("click",()=>{B.style.display="none",J.style.display="none",Z.style.display="flex",E.style.display="none"}),new iro$1.ColorPicker("#mobile-picker-color-section",{width:130,layoutDirection:"horizontal",color:"#ffffff",layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]}).on("color:change",O=>{const X=O.hexString;canvas.setBackgroundColor(X,canvas.renderAll.bind(canvas))});var o,S;const l=document.querySelector("#mobile-bg-pallete");l==null||l.addEventListener("colorChanged",O=>{[o,S]=[O.target.querySelector("#grad-1").value,O.target.querySelector("#grad-2").value]}),l&&((q=l==null?void 0:l.querySelector(".color-palette-gradient"))==null||q.addEventListener("click",()=>{new applyLinearGradient(canvas,o,S,!0).setColor(!0)}),G==null||G.addEventListener("click",()=>{canvas.setBackgroundColor("#fff"),canvas.renderAll()}))}function mobileLogoColorsMenu(B){var q;if(!B)return;const p=document==null?void 0:document.getElementById("mobile-logo-color-categories"),W=document.querySelector("#mobile-logo-solid-category"),G=document.querySelector("#mobile-logo-color-picker-category"),K=document.querySelector("#mobile-logo-linear-category"),J=document.querySelector("#mobile-logo-none-category"),Z=document.getElementById("mobile-logo-solid-color-section"),M=document.getElementById("mobile-logo-picker-color-section"),E=document.getElementById("mobile-logo-linear-color-section"),F=document.getElementById("mobile-logo-none-color-section");W.addEventListener("click",()=>{p.style.display="none",Z.style.display="grid",Z.style.gridTemplateColumns="repeat(4, 1fr)",Z.style.padding="15px",document.querySelector("#content-container").style.height="100px",E.style.display="none",F.style.display="none"}),document.querySelectorAll("#solid_color-bg-mobile").forEach(O=>{O.addEventListener("click",X=>{const V=B.getActiveObject();if(!V)return;const Y=X.target.style.backgroundColor,U=/rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(Y);if(!U)return;const[Q,te,se]=U.slice(1,4).map(Number),fe=convertRGBtoHex(Q,te,se);V._objects?V._objects.forEach(Se=>Se.set("fill",fe)):V.set("fill",fe),B.renderAll(),B.save()})}),G==null||G.addEventListener("click",()=>{p.style.display="none",M.style.display="flex",Z.style.display="none",E.style.display="none",F.style.display="none"}),K==null||K.addEventListener("click",()=>{p.style.display="none",Z.style.display="none",E.style.display="flex",F.style.display="none"});let o,S;const l=document.querySelector("#mobile-bg-pallete");if(l==null||l.addEventListener("colorChanged",({target:O})=>{[o,S]=[O.querySeleor("#grad-1").value,O.querySeleor("#grad-2").value]}),!l)return;(q=l==null?void 0:l.querySelector(".color-palette-gradient"))==null||q.addEventListener("click",()=>{new applyLinearGradient(B,o,S,!1).setColor(!1)}),J==null||J.addEventListener("click",()=>{B.setBackgroundColor("#fff"),B.renderAll()}),new iro$1.ColorPicker("#mobile-logo-picker-color-section",{width:130,layoutDirection:"horizontal",color:"#ffffff",layout:[{component:iro$1.ui.Box},{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"alpha"}}]}).on("color:change",O=>{const X=B.getActiveObject();if(!X)return;const V=O.hexString;X._objects?X._objects.forEach(Y=>Y.set("fill",V)):X.set("fill",V),B.renderAll(),B.save()})}function mobileLogoShadowMenu(B){if(!B)return;[{id:"#blur-mobile-slider",prop:"blur",title:"#blur-value"},{id:"#x-mobile-slider",prop:"offsetX",title:"#x-value"},{id:"#y-mobile-slider",prop:"offsetY",title:"#y-value"}].forEach(({id:W,prop:G,title:K})=>{var J;(J=document.querySelector(W))==null||J.addEventListener("input",Z=>{const M=parseInt(Z.target.value,10);document.querySelector(K).innerText=`${M} px`;const E=B.getActiveObject();if(!E)return;const F=R=>{const o=(R==null?void 0:R.get("shadow"))||{blur:0,offsetX:0,offsetY:0};R==null||R.set("shadow",{...o,[G]:M})};(E==null?void 0:E.type)==="group"?E._objects.forEach(R=>{F(R)}):F(E),B.renderAll()})})}function convertToZeroToTwo(B,p,W){let G=W-p,K=(B-p)/G*2;return Math.min(K,2).toFixed(3)}function mobileLogoScaleMenu(B){const p=B.getActiveObject();if(!p)return;const W=document.getElementById("mobile-scale-slider"),G=document.getElementById("mobile-scale-value");let K;function J(){const Z=p.getScaledWidth();K=(Z-1)*2,W.max=K,W.min=0,W.value=Z-1,W.value=convertToZeroToTwo(Z,0,K)}B.on("selection:updated",J),B.on("selection:created",J),W&&W.addEventListener("input",Z=>{const M=Z.target.value;G.innerText=M/100*2,p.scale(M),B.requestRenderAll()})}function mobileLogoRotateMenu(B){const p=B.getActiveObject();if(!p)return;const W=document.querySelector("#mobile-rotate-slider"),G=document.getElementById("mobile-rotate-value");W==null||W.addEventListener("input",K=>{const J=parseInt(K.target.value,100);p.set("angle",J),B.requestRenderAll(),G.innerText=`Rotate: ${J}`})}function createSubmenu(B,p,...W){const G=document.createElement("div");return G.id="mobile-submenu",G.style.width="100%",G.style.height="100%",G.style.display="none",G.innerHTML=p,B.parentElement.append(G),events(),G}function events(){const B=document.querySelector("#mobile-duplicate-layer"),p=document.querySelector("#mobile-visible-layer"),W=document.querySelector("#mobile-remove-layer"),G=document.querySelector("#mobile-forward-layer"),K=document.querySelector("#mobile-backward-layer");!B||!p||!W||!G||!K||(B.addEventListener("click",()=>{var Z;const J=canvas.getActiveObject();if(J){if((Z=J==null?void 0:J.id)!=null&&Z.includes("external_layer_")&&!(J!=null&&J.text)){let M=J.toJSON(["itemId","id","category","cacheWidth","cacheHeight"]);return M.top+=10,M.left+=10,loadExternalLayers(JSON.stringify([M])),!1}J._objects?J.clone(M=>{M._objects.forEach((E,F)=>{if(E.text)return!0;E.duplicate=!0,canvas.add(E)}),canvas.centerObject(M),M.set("top",100),M.set("left",100),canvas.setActiveObject(M),canvas.requestRenderAll(),canvas.save()}):J.clone(M=>{if(M.text)return!0;M.set("duplicate",!0),canvas.add(M),M.top+=10,M.left+=10,canvas.save()}),canvas.requestRenderAll()}}),p.addEventListener("click",()=>{const J=canvas.getActiveObject();let Z=!!J.get("visible");Z=!Z,J.set("visible",Z),canvas.requestRenderAll(),J&&canvas.save();const M=document.querySelector("#mobile-visible-layer"),F=document.querySelectorAll(".specific-setting-label")[1],R=J.visible?"var(--gray-lighter)":"var(--gold)",o=J.visible?0:1,S=R;M.style.color=R,F.style.opacity=o,F.style.color=S}),W.addEventListener("click",()=>{const J=canvas.getActiveObject();J&&(J._objects&&J._objects.length&&J._objects.forEach(Z=>{canvas.remove(Z)}),canvas.remove(J),canvas.save(),canvas.renderAll())}),K.addEventListener("click",()=>{const J=canvas.getActiveObject();canvas.sendBackwards(J),canvas.setActiveObject(J),canvas.requestRenderAll(),canvas.save()}),G.addEventListener("click",()=>{const J=canvas.getActiveObject();canvas.bringForward(J),canvas.setActiveObject(J),canvas.requestRenderAll(),canvas.save()}))}function mobileLogoMenu(B){if(!B)return;const p=document.querySelector("#mobile-category-content #mobile-logo-view-settings"),W=p.querySelector("#mobile-flip-horizontal-category"),G=p.querySelector("#mobile-flip-vertical-category"),K=p.querySelector("#mobile-rotate-category"),J=p.querySelector("#mobile-scale-category"),Z=p.querySelector("#mobile-drop-shadow-category"),M=p.querySelector("#mobile-colors-category"),E=p.querySelector("#mobile-layers-category"),F=p.querySelector("#mobile-layer-action-category"),R=createSubmenu(p,`<div class="mobile-category-container">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px; 
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-rotate-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Rotate: 0</output>
        <input class="mobile-slider" type="range" id="mobile-rotate-slider" style="width: 90%;" min="0" max="360" value="0" />
      </div>
    </div>`),o=createSubmenu(p,`<div class="mobile-category-container">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px;
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-scale-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Scale: 0</output>
        <input class="mobile-slider" type="range" id="mobile-scale-slider" style="width: 90%;" min="0" max="100" value="50" step="1" />
      </div>
    </div>
`),S=createSubmenu(p,`<div class="mobile-category-container"> 
      <div style="position: absolute; bottom: 0; left: 0; display: flex; flex-direction: column; 
      width: 100svw; background: #ffffff; padding: 20px; gap: 20px;">

        <div>
          <label id="blur-mobile-slider-title" style="font-size: 14px; font-weight: bold; color: var(--gray);">Blur: <span id="blur-value">5</span></label>
          <input class="mobile-slider" type="range" id="blur-mobile-slider" style="width: 90%;" min="0" max="100" value="5" step="1" />
        </div>

        <div>
          <label for="x-mobile-slider" style="font-size: 14px; font-weight: bold; color: var(--gray);">
          X Offset: <span id="x-value">0</span></label>
          <input class="mobile-slider" type="range" id="x-mobile-slider" style="width: 90%;" min="-50" max="50" value="0" step="1" />
        </div>

        <div>
          <label for="y-mobile-slider" style="font-size: 14px; font-weight: bold; color: var(--gray);">
          Y Offset: <span id="y-value">0</span></label>
          <input class="mobile-slider" type="range" id="y-mobile-slider" style="width: 90%;" min="-50" max="50" value="0" step="1" />
        </div>

     </div>
    </div>`),l=createSubmenu(p,`<div class="mobile-category-container" style="padding: 5px 0;">
  <div style="display: flex; justify-content: space-around; width: 100%;">
    <div style="text-align: center;" id="mobile-duplicate-layer">
        <i class="fa-solid fa-copy" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Duplicate</div>
    </div>
    <div style="text-align: center;" id="mobile-visible-layer">
        <i class="fa-solid fa-eye" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Visible</div>
    </div>
    <div style="text-align: center;" id="mobile-forward-layer">
        <i class="fa-solid fa-arrow-up" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Forward</div>
    </div>
    <div style="text-align: center;" id="mobile-backward-layer">
        <i class="fa-solid fa-arrow-down" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Backward</div>
    </div>
    <div style="text-align: center;" id="mobile-remove-layer">
        <i class="fa-solid fa-trash" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Remove</div>
    </div>
    </div>
  </div>
`),L=createSubmenu(p,`<div id="mobile-colors-view" style="height: 100%;">

<div id="mobile-logo-color-categories" class="mobile-category-container" style="justify-content: center">
    <!-- Solid Category -->
    <div id="mobile-logo-solid-category" class="mobile-category">
        <i class="fas fa-square mobile-category-icon"></i>
        <p class="mobile-category-text">Solid</p>
    </div>

    <div id="mobile-logo-color-picker-category" class="mobile-category">
        <i class="fas fa-palette mobile-category-icon"></i>
        <p class="mobile-category-text">C.Picker</p>
    </div>

    <!-- Linear Category -->
    <div id="mobile-logo-linear-category" class="mobile-category">
        <i class="fas fa-arrows-alt-h mobile-category-icon"></i>
        <p class="mobile-category-text">Linear</p>
    </div>

    <!-- None Category -->
    <div id="mobile-logo-none-category" class="mobile-category" style="display: none;">
        <i class="fas fa-ban mobile-category-icon" ></i>
        <p class="mobile-category-text">None</p>
    </div>
</div>

<!-- Solid Colors Section -->
<div id="mobile-logo-solid-color-section" style="display: none; gap: 5px; justify-content: flex-start; padding-inline: 0 0 10px 0; 
  overflow-x: scroll; grid-template-colums: repeat(4, 1fr); width: 100svw;">
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #000000;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #545454;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #737373;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6a6a6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d9d9d9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f5f5f5;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b25d1f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e37627;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fc832b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fd964b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #febb8a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fedfc9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff2e9;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ab2d2d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #de3a3a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f74040;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f85d5d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fcb3b3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fed0d0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffeded;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #8a6e10;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b89e1e;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e5c100;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffdd00;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffea66;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff59d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffe0;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #126f43;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #168a53;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1dbf73;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #62d49f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6eaca;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #c9f4e0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e8faf4;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1b8996;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #25a1b0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3ad0e6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #75dfee;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #afedf7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #cdf5fb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecfcff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #284389;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3f63c8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #4a73e8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #819ef0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #9db4f3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d4defb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f0f4ff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #6731a1;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #984ae8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a866ec;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b881f0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d8b9f7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecddfb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f8f0ff;"></span>
  </div>
</div>

<div id="mobile-logo-linear-color-section" style="display: flex; width: 100svw; align-items: center; height: 90px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
  <mobile-pallete-component id="mobile-bg-pallete"></mobile-pallete-component>
</div>

<div id="mobile-logo-picker-color-section" style="position: absolute; bottom: 0; left: 0; background-color: #fff; display: flex; width: 100svw; align-items: center; height: 160px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
 </div>

<div id="mobile-logo-none-color-section" style="display: flex; gap: 5px; justify-content: flex-start; padding-right: 30px; overflow-x: scroll; display: none;">
  <h1>None</h1> </div>
</div>`),q=createSubmenu(p,`<div id="mobile-layers" class="mobile-category-container" style="gap: 0; padding: 0 10px 0 10px; gap: 10px;">
    </div>`);mobileLogoShadowMenu(B),mobileLogoScaleMenu(B),mobileLogoRotateMenu(B),mobileLogoColorsMenu(B);const O=document.getElementById("mobile-layers"),X=localStorage.getItem("logo-file");fabric.loadSVGFromString(X,Y=>{Y.forEach((U,Q)=>{new CreateLayerSection(O,"mobile").create(U,Q)})}),document.querySelectorAll(".layer-container").forEach(Y=>{const U=parseInt(Y.getAttribute("data_layer"));Y.addEventListener("click",()=>{const Q=B._objects[U];Q&&(B.setActiveObject(Q),B.requestRenderAll())})}),E.addEventListener("click",()=>{history.pushState({category:"logo/layers"},null,"#logo/layers"),p.style.display="none",q.style.display="block"}),K.addEventListener("click",()=>{history.pushState({category:"logo/rotate"},null,"#logo/rotate"),p.style.display="none",R.style.display="block"}),J.addEventListener("click",()=>{history.pushState({category:"logo/scale"},null,"#logo/scale"),p.style.display="none",o.style.display="block"}),Z.addEventListener("click",()=>{history.pushState({category:"logo/shadow"},null,"#logo/shadow"),p.style.display="none",S.style.display="flex"}),M.addEventListener("click",()=>{history.pushState({category:"logo/colors"},null,"#logo/colors"),p.style.display="none",L.style.display="block"}),F.addEventListener("click",()=>{history.pushState({category:"logo/actions"},null,"#logo/actions"),p.style.display="none",l.style.display="flex",l.style.padding="0"}),W.addEventListener("click",()=>{activeObject.set({flipX:!activeObject.flipX}),B.renderAll()}),G.addEventListener("click",()=>{activeObject.set({flipY:!activeObject.flipY}),B.renderAll()})}async function mobileTextMenu(B){if(!B)return;const p=()=>{const pe=B.getActiveObject();if(!pe)return;const oe=pe?pe.get("fontSize"):0,ne=pe.get("charSpacing");document.querySelector("#mobile-font-size-value").innerText=`Font Size: ${oe} px`,document.querySelector("#mobile-spacing-value").innerText=`Spacing: ${ne} px`,document.querySelector("#mobile-text-rotate-value").innerText=`Rotate: ${pe.get("angle")}`};B.on("selection:created",p),B.on("selection:updated",p);const W=document.querySelector("#mobile-category-content #mobile-text-view"),G=createSubmenu(W,'<div id="mobile-fonts" style="display: flex; padding-right: 30px; gap: 30px; overflow-x: scroll; width: 90vw; align-items: center;"></div>'),K=await fetchedFonts(),J=document.querySelector("#mobile-fonts"),Z=createSubmenu(W,`<div class="mobile-category-container">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px; 
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-text-rotate-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Rotate: 0</output>
        <input class="mobile-slider" type="range" id="mobile-rotate-slider" style="width: 90%;" min="0" max="360" value="0" />
      </div>
    </div>`),M=createSubmenu(W,`<div id="mobile-font-style-category" class="mobile-category-container" style="display: flex; justify-content: center; align-items: center; height: 100%; padding: 10px 0;">
          <div id="mobile-font-normal" class="mobile-list mobile-category" value="Normal" style="text-align: center;"><i class="fas fa-font mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px">Normal</san></div>
          <div id="mobile-font-italic" class="mobile-list mobile-category" value="Italic" style="text-align: center;"><i class="fas fa-italic mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px;">Italic</san></div>
          <div id="mobile-font-underline" class="mobile-list mobile-category" value="Underline" style="text-align: center;"><i class="fas fa-underline mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px;">Underline</san></div>
    </div>`),E=createSubmenu(W,`<div id="mobile-font-style-category" class="mobile-category-container" style="display: flex; justify-content: center; align-items: center; height: 100%; padding: 10px 0; overflow-x: scroll;">
          <div id="mobile-font-uppercase" class="mobile-list mobile-category" value="Uppercase" style="text-align: center;"><i class="fas fa-arrow-up mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px">Uppercase</span></div>
          <div id="mobile-font-lowercase" class="mobile-list mobile-category" value="Lowercase" style="text-align: center;"><i class="fas fa-arrow-down mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px;">Lowercase</span></div>
          <div id="mobile-font-titlecase" class="mobile-list mobile-category" value="Title Case" style="text-align: center;"><i class="fas fa-heading mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px;">Title</span></div>
          <div id="mobile-font-sentencecase" class="mobile-list mobile-category" value="Sentence Case" style="text-align: center;"><i class="fas fa-paragraph mobile-category-icon" style="font-size: 20px;"></i><br><span style="font-size: 12px;">Sentence</span></div>
    </div>`),F=createSubmenu(W,`<div id="mobile-font-curve-category" class="mobile-category-container" style="display: flex; justify-content: center; align-items: center; height: 100%; padding: 10px 0; overflow-x: scroll;">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px; 
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-curve-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Curve: 0</output>
        <input class="mobile-slider" type="range" id="mobile-curve-slider" style="width: 90%;" min="0" max="5000" value="0" />
      </div>
    </div>`),R=createSubmenu(W,`<div id="mobile-font-spacing-category" class="mobile-category-container" style="display: flex; justify-content: center; align-items: center; height: 100%; padding: 10px 0; overflow-x: scroll;">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px; 
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-spacing-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Spacing: 0px</output>
        <input class="mobile-slider" type="range" id="mobile-spacing-slider" style="width: 90%;" min="-140" max="500" value="0" />
      </div>
    </div>`),o=createSubmenu(W,`<div id="mobile-font-weight-category" class="mobile-category-container" style="padding: 0px;">
    <div id="mobile-font-weight-list"  style="display: flex; align-items: center; height: 100%; padding: 10px; overflow-x: scroll; gap: 30px;"></div>
    </div>`),S=createSubmenu(W,`<div id="mobile-text-input-category" class="mobile-category-container" style="justify-content: center; height: 80px; background: #ffffff; padding: 8px; position: absolute; bottom: 0">
      <div style="display: flex; flex-direction: column; gap: 8px;">
      <input type="text" id="mobile-logoMainField" placeholder="Logo Name" style="width: 100%; padding: 5px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;" />
      <input type="text" id="mobile-sloganNameField" placeholder="Slogan Name" style="width: 100%; padding: 5px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;" />
      </div>
    </div>
    `),l=createSubmenu(W,`<div id="mobile-font-size-category" class="mobile-category-container" style="display: flex; justify-content: center; align-items: center; height: 100%; padding: 10px 0; overflow-x: scroll;">
      <div style="position: absolute; bottom: 0; left: 0; display: flex; gap: 10px; 
      flex-direction: column; width: 100svw; background: #ffffff; padding: 20px;">
        <output id="mobile-font-size-value" style="display: block; font-size: 14px; font-weight: bold; color: var(--gray);">Font Size: 0px</output>
        <input class="mobile-slider" type="range" id="mobile-font-size-slider" style="width: 90%;" min="0" max="130" value="0" />
      </div>
    </div>`),L=createSubmenu(W,`<div class="mobile-category-container" style="padding: 5px 0;">
  <div style="display: flex; justify-content: space-around; width: 100%;">
    <div style="text-align: center;" id="mobile-duplicate-layer">
        <i class="fa-solid fa-copy" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Duplicate</div>
    </div>
    <div style="text-align: center;" id="mobile-visible-layer">
        <i class="fa-solid fa-eye" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Visible</div>
    </div>
    <div style="text-align: center;" id="mobile-forward-layer">
        <i class="fa-solid fa-arrow-up" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Forward</div>
    </div>
    <div style="text-align: center;" id="mobile-backward-layer">
        <i class="fa-solid fa-arrow-down" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Backward</div>
    </div>
    <div style="text-align: center;" id="mobile-remove-layer">
        <i class="fa-solid fa-trash" style="font-size: 20px; color: var(--gray-light);"></i>
        <div style="font-size: 12px; color: var(--gray-light);">Remove</div>
    </div>
    </div>
  </div>
`),q=createSubmenu(W,`<div id="mobile-colors-view" >

<div id="mobile-logo-color-categories" class="mobile-category-container" style="justify-content: center">
    <!-- Solid Category -->
    <div id="mobile-logo-solid-category" class="mobile-category">
        <i class="fas fa-square mobile-category-icon"></i>
        <p class="mobile-category-text">Solid</p>
    </div>

    <!-- Color Picker Category -->
    <div id="mobile-logo-color-picker-category" class="mobile-category">
        <i class="fas fa-palette mobile-category-icon"></i>
        <p class="mobile-category-text">C.Picker</p>
    </div>

    <!-- Linear Category -->
    <div id="mobile-logo-linear-category" class="mobile-category">
        <i class="fas fa-arrows-alt-h mobile-category-icon"></i>
        <p class="mobile-category-text">Linear</p>
    </div>

    <!-- None Category -->
    <div id="mobile-logo-none-category" class="mobile-category" style="display: none;">
        <i class="fas fa-ban mobile-category-icon" ></i>
        <p class="mobile-category-text">None</p>
    </div>
</div>

<!-- Solid Colors Section -->
<div id="mobile-logo-solid-color-section" style="display: none; gap: 5px; justify-content: flex-start; padding-inline: 0 0 10px 0; overflow-x: scroll; grid-template-colums: repeat(4, 1fr);">
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #000000;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #545454;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #737373;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6a6a6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d9d9d9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f5f5f5;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b25d1f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e37627;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fc832b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fd964b;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #febb8a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fedfc9;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff2e9;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ab2d2d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #de3a3a;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f74040;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f85d5d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fcb3b3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fed0d0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffeded;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #8a6e10;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b89e1e;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e5c100;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffdd00;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffea66;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #fff59d;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ffffe0;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #126f43;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #168a53;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1dbf73;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #62d49f;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a6eaca;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #c9f4e0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #e8faf4;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #1b8996;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #25a1b0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3ad0e6;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #75dfee;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #afedf7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #cdf5fb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecfcff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #284389;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #3f63c8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #4a73e8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #819ef0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #9db4f3;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d4defb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f0f4ff;"></span>
  </div>
  <div style="display: flex;">
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #6731a1;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #984ae8;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #a866ec;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #b881f0;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #d8b9f7;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #ecddfb;"></span>
    <span id="solid_color-bg-mobile" class="color-picker solid_color_section" style="background-color: #f8f0ff;"></span>
  </div>
</div>

<div id="mobile-logo-linear-color-section" style="display: flex; width: 100svw; align-items: center; height: 90px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
  <mobile-pallete-component id="mobile-bg-pallete"></mobile-pallete-component>
</div>

<div id="mobile-logo-picker-color-section" style="position: absolute; bottom: 0; left: 0; background-color: #fff; display: flex; width: 100svw; align-items: center; height: 160px; gap: 5px; justify-content: center; overflow-x: scroll; display: none;">
 </div>

<div id="mobile-logo-none-color-section" style="display: flex; gap: 5px; justify-content: flex-start; padding-right: 30px; overflow-x: scroll; display: none;">
  <h1>None</h1> </div>
</div>`),O=createSubmenu(W,`<div class="mobile-category-container"> 
      <div style="position: absolute; bottom: 0; left: 0; display: flex; flex-direction: column; 
      width: 100svw; background: #ffffff; padding: 20px; gap: 20px;">

        <div>
          <label id="blur-mobile-slider-title" style="font-size: 14px; font-weight: bold; color: var(--gray);">Blur: <span id="blur-value">5</span></label>
          <input class="mobile-slider" type="range" id="blur-mobile-slider" style="width: 90%;" min="0" max="100" value="5" step="1" />
        </div>

        <div>
          <label for="x-mobile-slider" style="font-size: 14px; font-weight: bold; color: var(--gray);">
          X Offset: <span id="x-value">0</span></label>
          <input class="mobile-slider" type="range" id="x-mobile-slider" style="width: 90%;" min="-50" max="50" value="0" step="1" />
        </div>

        <div>
          <label for="y-mobile-slider" style="font-size: 14px; font-weight: bold; color: var(--gray);">
          Y Offset: <span id="y-value">0</span></label>
          <input class="mobile-slider" type="range" id="y-mobile-slider" style="width: 90%;" min="-50" max="50" value="0" step="1" />
        </div>

     </div>
    </div>`);mobileLogoScaleMenu(B),mobileLogoColorsMenu(B),mobileLogoShadowMenu(B);const X=W.querySelector("#mobile-font-family-category"),V=W.querySelector("#mobile-rotate-category"),Y=W.querySelector("#mobile-font-style-category"),U=document.querySelector("#mobile-font-weight-category"),Q=document.querySelector("#mobile-curve-text-category"),te=document.querySelector("#mobile-letter-spacing-category"),se=document.querySelector("#mobile-letter-case-category");document.querySelector("#mobile-text-layer-actions-category");const fe=document.querySelector("#mobile-font-size-category"),Se=document.querySelector("#mobile-text-layer-colors-category"),Te=document.querySelector("#mobile-input-category"),Re=document.querySelector("#mobile-text-drop-shadow-category");function je(pe=0,oe=50){const ne=pe+oe;return K.slice(pe,ne)}function He(pe){const oe=document.createElement("span");oe.className="mobile-font-family-item",oe.style.width="max-content",oe.style.height="max-content",oe.style.fontFamily=pe.family,oe.style.padding="14px",oe.style.fontSize="14px",oe.style.fontWeight="bold",oe.style.alignItems="center",oe.style.justifyContent="center",oe.style.textAlign="center";const ne=pe.family.split(",")[0].replace(/ /g,"");return oe.append(ne),oe}function ve(pe){J&&pe.forEach(oe=>{const ne=He(oe);J.appendChild(ne)})}const _e=je();ve(_e);let qe=0,Xe=1;J==null||J.addEventListener("touchstart",pe=>{Xe=pe.touches[0].clientX}),J.addEventListener("touchmove",pe=>{let oe=[];const ne=pe.touches[0].clientX,ge=J.scrollLeft,ye=J.scrollWidth-J.clientWidth;if(ne>Xe+15&&ge===0){if(qe===0)return;J.innerHTML="",qe=Math.max(qe-50,0),oe=je(qe),J.scrollLeft=ye}else ne<Xe&&ge>=ye&&(J.innerHTML="",qe+=50,oe=je(qe),J.scrollLeft=qe);ve(oe),Xe=ne});function Ge(pe,oe){const ne=document.querySelector("#text-curve-range");ne.value=pe;const ge=new Event("input",{bubbles:!0});ne.dispatchEvent(ge),B.renderAll()}document.querySelector("#mobile-curve-slider").addEventListener("input",pe=>{if(!B.getActiveObject())return;const ne=pe.target.value;Ge(ne)});function re(){var ge;const pe=B.getActiveObject(),oe=document.querySelector("#mobile-font-weight-list");oe.innerHTML="";const ne=pe?(ge=pe.get("fontFamily"))==null?void 0:ge.toLowerCase():"poppins";K.forEach(ye=>{var ke;((ke=ye.family)==null?void 0:ke.toLowerCase())===ne&&ye.variants.forEach(xe=>{const Fe=xe==="regular"?"normal":xe,Me=document.createElement("h3"),[ze,we]=Fe.split(/(\d+)/).filter(Boolean);let be="";we&&(be+=`${we}`),be+=ze,Me.append(be),Me.style.textTransform="capitalize",Me.style.textOverflow="ellipsis",Me.style.fontSize="14px",Me.style.color="var(--gray)",Me.setAttribute("data-value",Fe),Me.className="mobile-font-weight-item",Me.setAttribute("fontFamily",ye.family),oe.append(Me),Me.addEventListener("click",Pe=>{let Le=Pe.target.getAttribute("data-value");Le.includes("italic")?(Le=Le.replace("italic","").trim(),pe.set("fontStyle","italic"),pe.set("fontweightapply",!0)):pe.get("fontweightapply")&&pe.set("fontStyle","normal"),pe.set("fontWeight",Le||"normal"),pe.set("orgFontWeight",Le||"normal"),B.renderAll(),B.save()})})})}document.querySelector("#mobile-text-layer-actions-category").addEventListener("click",()=>{history.pushState({category:"text/actions"},null,"#text/actions"),W.style.display="none",L.style.display="flex",L.style.padding="0"}),X.addEventListener("click",()=>{W.style.display="none",history.pushState({category:"text/fontFamily"},null,"#text/fontFamily"),G.style.display="flex"}),Y.addEventListener("click",()=>{history.pushState({category:"logo/font-style"},null,"#logo/font-style"),W.style.display="none",M.style.display="block"}),fe.addEventListener("click",()=>{history.pushState({category:"text/font-size"},null,"#text/font-size"),W.style.display="none",l.style.display="block"}),V.addEventListener("click",()=>{history.pushState({category:"text/rotate"},null,"#text/rotate"),W.style.display="none",Z.style.display="block"}),se.addEventListener("click",()=>{history.pushState({category:"text/letercase"},null,"#text/lettercase"),W.style.display="none",E.style.display="block"}),U.addEventListener("click",()=>{history.pushState({category:"text/fontweight"},null,"#text/fontweight"),W.style.display="none",o.style.display="block",re()}),te.addEventListener("click",()=>{history.pushState({category:"text/fontspacing"},null,"#text/fontspacing"),W.style.display="none",R.style.display="block"}),Q.addEventListener("click",()=>{history.pushState({category:"text/fontcurve"},null,"#text/fontcurve"),W.style.display="none",F.style.display="block"}),Te.addEventListener("click",()=>{history.pushState({category:"text/inputs"},null,"#text/inputs"),W.style.display="none",S.style.display="block"}),Se.addEventListener("click",()=>{history.pushState({category:"text/colors"},null,"#text/colors"),W.style.display="none",q.style.display="block"}),Re.addEventListener("click",()=>{history.pushState({category:"text/shadow"},null,"#text/shadow"),W.style.display="none",O.style.display="block"}),document.querySelector("#mobile-spacing-slider").addEventListener("input",pe=>{const oe=pe.target.value,ne=document.querySelector("#letter-spacing-slider");ne.value=oe;const ge=new Event("input");ne.dispatchEvent(ge),document.querySelector("#mobile-spacing-value").value=`Spacing: ${oe} px`}),document.querySelector("#mobile-font-size-slider").addEventListener("input",pe=>{const oe=pe.target.value;if(oe>0){document.querySelector("#mobile-font-size-value").value=`Font Size: ${Math.round(oe)}px`;const ne=B.getActiveObject(),ge=oe;if(ne.type=="curved-text"){if(ne.set("_cachedCanvas",null),ge<5)return!1;ne.set("fontSize",ge)}else ne.set("fontSize",ge);B.requestRenderAll()}}),document.querySelector("#mobile-logoMainField").addEventListener("input",pe=>{const oe=pe.target.value;B.getObjects().filter(ke=>ke.text)[0].set("text",oe),B.renderAll()}),document.querySelector("#mobile-rotate-slider").addEventListener("input",pe=>{const oe=B.getActiveObject();if(!oe)return;const ne=parseInt(pe.target.value,10);oe.set("angle",ne),document.querySelector("#mobile-text-rotate-value").innerText=`Rotate: ${oe.get("angle")}`,B.renderAll()}),document.querySelector("#mobile-sloganNameField").addEventListener("input",pe=>{const oe=pe.target.value;B.getObjects().filter(ke=>ke.text)[1].set("text",oe),B.renderAll()});function ce(pe,oe=!1){const ne=B.getActiveObject();ne&&(ne.set("fontStyle_",pe),ne.set("fontStyle",pe),ne.set("underline",oe),B.renderAll(),B.save())}function ue(pe){const oe=B.getActiveObject();if(!oe)return;const ne=oe.text;let ge=ne;switch(pe){case"Uppercase":ge=ne.toUpperCase();break;case"Lowercase":ge=ne.toLowerCase();break;case"Title Case":ge=ne.split(" ").map(ye=>ye.charAt(0).toUpperCase()+ye.slice(1).toLowerCase()).join(" ");break;case"Sentence Case":ge=ne.charAt(0).toUpperCase()+ne.slice(1).toLowerCase();break}oe.set("text",ge),oe.set("letterCase",pe),B.renderAll(),B.save()}document.querySelectorAll(".mobile-font-weight-item").forEach((pe,oe)=>pe.addEventListener("click",ne=>{const ge=B.getActiveObject();console.log("click"),console.log(ge);const ye=ne.target.getAttribute("data-value");activeObject.set("fontWeight",ye||"normal"),activeObject.set("orgFontWeight",ye||"normal"),B.renderAll(),B.save()})),document.querySelector("#mobile-font-normal").addEventListener("click",()=>{ce("normal")}),document.querySelector("#mobile-font-italic").addEventListener("click",()=>{ce("italic")}),document.querySelector("#mobile-font-underline").addEventListener("click",()=>{ce("underline",!0)}),document.querySelector("#mobile-font-uppercase").addEventListener("click",()=>{ue("Uppercase")}),document.querySelector("#mobile-font-lowercase").addEventListener("click",()=>{ue("Lowercase")}),document.querySelector("#mobile-font-titlecase").addEventListener("click",()=>{ue("Title Case")}),document.querySelector("#mobile-font-sentencecase").addEventListener("click",()=>{ue("Sentence Case")})}const navItems=document.querySelectorAll("#mobile-nav-bar [data-name]"),categoryContent=document.querySelector("#mobile-category-content");let category="add";const mainCategoryData={add:mobileAddView,logo:mobileLogoView,text:mobileTextView,background:mobileBackgroundView},menuCategoryData={add:mobileAddMenu,logo:mobileLogoMenu,text:mobileTextMenu,background:mobileBackgroundMenu},saveModal=`
<div style="position: absolute; top: 0; left: 0; gap: 10px; width: 100%; height: 100svh; background: rgba(0, 0, 0, 0.7); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center;">
    <button id="mobile-save-p" class="btn" style="width: 240px;">Save and Preview</button>
    <button id="mobile-save-d" class="btn" style="width: 240px;">Save and Download</button>
    <button id="mobile-close-btn" class="btn" style="width: 240px; background: #ffffff; color: #555;">Close</button>
</div>
`,topBar=`
<div style="display: flex; justify-content: space-around; align-items: center; gap: 10px; width: 100%">
        <div id="mobile-undo">
          <span style="color: var(--gray); font-size: 12px;">
            <i class="fa fa-undo"></i> Undo
          </span>
        </div>
        <div id="mobile-redo">
          <span style="color: var(--gray); font-size: 12px;">
            <i class="fa fa-redo"></i> Redo
          </span>
        </div>
        <div id="mobile-save-btn">
          <span style="color: var(--gray); font-size: 12px;">
            <i class="fa-regular fa-floppy-disk"></i> Save
          </span>
        </div>
    </div>
`;function renderTopBar(){document.querySelector("#mobile-top-bar").innerHTML=topBar,document.querySelector("#mobile-save-btn").addEventListener("click",()=>{renderSaveModal()}),document.querySelector("#mobile-undo").addEventListener("click",()=>{document.querySelector("#undo-btn").click()}),document.querySelector("#mobile-redo").addEventListener("click",()=>{document.querySelector("#redo-btn").click()})}function renderSaveModal(){document.querySelector("#mobile-top-bar").innerHTML=saveModal,document.querySelector("#mobile-close-btn").addEventListener("click",()=>{renderTopBar()}),document.querySelector("#mobile-save-p").addEventListener("click",async()=>{document.querySelector("#save-btn").click()}),document.querySelector("#mobile-save-d").addEventListener("click",()=>{document.querySelector("#save-package").click()})}renderTopBar();navItems.forEach(B=>{B.addEventListener("click",p=>{p.stopPropagation(),category=B.getAttribute("data-name"),history.pushState({category},null,`#${category}`),routeHandler()})});function routeHandler(){var p;const B=(p=history==null?void 0:history.state)==null?void 0:p.category;B&&mainCategoryData[B]?(categoryContent.innerHTML=`
    <div id="content-container" style="z-index: 10; height: 70px; background: #ffffff; position: absolute; bottom: 0; display: flex;">
      ${mainCategoryData[B]}
    </div>`,categoryContent.style.display="block"):categoryContent.style.display="none",menuCategoryData[B]&&menuCategoryData[B](canvas)}routeHandler();window.addEventListener("popstate",routeHandler);function layoutManager(){const B=[".nav",".settings-view",".right-bar","#main_editor_view .header",".canvas-actions",".magnifier-container"],p=querySelect(".editor-container");if(!p)return;navigator.userAgent.includes("Mobile")&&(B.forEach(G=>{const K=querySelect(G);K&&(K.style.display="none")}),p.style.top="-1px",p.style.left="-1px")}layoutManager();const paletteMarkup$1=`
<div class="bg-settings-container">
<div>
  <div id="color-mode" class="color-mode-selector">
    <span id="color-mode-title" class="color-mode-title" style="margin-left: -5px; margin-bottom: 40px;">
      <span style="margin-left: -20px">Linear Colors</span>
      <i class="fa-solid fa-angle-down"  style="visibility: hidden; display: none"></i>
    </span>
        <div id="bg-color-list" class="color-mode-list"></div>
    </div>

    <div id="gradient-panel-viewer" style="position: absolute; left: 50%; transform: translateX(-50%); margin-top: -130px;">
        <div id="color-palette-gradient" class="color-palette-gradient"></div>
    </div>

    <div id="gradient-panel" style="margin-top: 45px;  display: none; justify-content: flex-start; gap: 5px; margin-left: -15px; margin-bottom: 20px;">
        <input type="color" value="#ffffff" class="color-picker" id="grad-1">
        <input type="color" value="#000000" class="color-picker" id="grad-2">
      </div>
      
      <div id="solid-panel" style="margin-top: 60px;">
        <input type="color" value="#000000" class="color-picker" id="grad-solid">
    </div>

    <!-- <h3 id="color-angle-text" style="display: none">0deg</h3> -->
    <div id="slider-container" class="slider-container" style="margin-top: 20px; margin-left: -15px; display: none">
        <input class="slider" id="color-angle" type="range" value="0" min="0" max="360">
    </div>

  </div>
</div>`;let Palette$1=class extends HTMLElement{constructor(){super(),this.innerHTML=paletteMarkup$1;const $=B=>this.querySelector(B);this.colorMode="Linear";const dataList=this.getAttribute("data-list"),mainDataList=eval(dataList);mainDataList.forEach(B=>{const p=document.createElement("li");p.textContent=B,p.style.fontWeight=500,$("#bg-color-list").append(p)}),$("#color-angle").style.display="block",$("#gradient-panel").style.display="flex",$("#solid-panel").style.display="none",$("#color-palette-gradient").style.background="linear-gradient(0deg, rgb(255, 255, 255), rgb(0, 0, 0))"}connectedCallback(){const B=this.querySelector("#grad-1"),p=this.querySelector("#grad-2"),W=this.querySelector("#grad-solid"),G=this.querySelector("#color-angle"),K=()=>{this.dispatchEvent(new CustomEvent("colorChange",{detail:{grad1Value:B.value,grad2Value:p.value,colorAngle:G.value,solidValue:W.value,colorMode:this.colorMode}}))},J=E=>document.querySelector(E),Z=this.querySelector("#bg-color-list");Z.addEventListener("click",E=>{this.colorMode=E.target.innerText;const F=this.colorMode;F==="Solid"?(J("#gradient-panel").style.display="none",J("#color-angle").style.display="none",J("#solid-panel").style.display="block",J("#solid-panel").style.opacity=1,J("#solid-panel").style.visibility="visible",J("#solid-panel").style.marginTop="60px",J("#color-palette-gradient").style.background="#000000"):F==="Linear"?(J("#color-angle").style.display="block",J("#gradient-panel").style.display="flex",J("#solid-panel").style.display="none",J("#color-palette-gradient").style.background="#000000"):F==="Transparent"?(J("#gradient-panel").style.display="none",J("#solid-panel").style.opacity=0,J("#solid-panel").style.visibility="hidden",J("#solid-panel").style.marginTop="-10px",J("#color-angle").style.display="none",J("#color-palette-gradient").style.background="url(https://t3.ftcdn.net/jpg/03/76/74/78/240_F_376747823_L8il80K6c2CM1lnPYJhhJZQNl6ynX1yj.jpg)"):F==="None"&&K(),Z.classList.remove("show"),colorModeTitle.innerText=F;const R=document.createElement("i");R.className="fa-solid fa-angle-down",colorModeTitle.append(R),M.dispatchEvent(new CustomEvent("colorChanged",{detail:{color:item.value}}))}),B.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(0deg, ${B.value}, ${p.value})`,K()}),p.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(0deg, ${B.value}, ${p.value})`,K()}),W.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=W.value,K()});let M=this;[W,B,p].forEach(E=>{E.addEventListener("change",()=>{M.dispatchEvent(new CustomEvent("colorChanged",{detail:{color:E.value}}))})})}};customElements.define("pallete-component",Palette$1);const paletteMarkup=`
<div style="display: flex; flex-direction: column; height: 100%; align-items: center; gap: 10px;">
    <div id="color-mode" class="color-mode-selector" style="display: flex; flex-direction: row-reverse; height: 100%; justify-content: space-around; gap: 30px; align-items: center;">
      <div id="gradient-panel-viewer" style="display: flex; flex-direction: column; align-items: center;">
        <div id="color-palette-gradient" class="color-palette-gradient" style="height: 30px; width: 200px; border: none; transform: rotate(180deg); background: linear-gradient(-90deg, #ffffff, #000000);"></div>
          <!-- <div style="text-align: center; font-size: 12px; color: var(--gray-light);">Linear Gradient Panel</div> -->
      </div>

      <div id="gradient-panel" style="display: flex; justify-content: center; gap: 20px; width: 100%;">
        <div style="display: flex; flex-direction: column; align-items: center;">
          <input type="color" value="#ffffff" id="grad-1" style="width: 40px; height: 30px; border: none; outline: none; background: #ffffff;">
          <!-- <div style="text-align: center; font-size: 12px; color: var(--gray-light);">Color 1</div> -->
        </div>
        <div style="display: flex; flex-direction: column; align-items: center;">
          <input type="color" value="#000000" id="grad-2" style="width: 40px; height: 30px; border: none; outline: none; background: #ffffff">
          <!-- <div style="text-align: center; font-size: 12px; color: var(--gray-light);">Color 2</div> -->
        </div>
      </div>
  </div>
</div>`;class Palette extends HTMLElement{constructor(){super(),this.innerHTML=paletteMarkup}connectedCallback(){const p=this.querySelector("#grad-1"),W=this.querySelector("#grad-2"),G=()=>{this.dispatchEvent(new CustomEvent("colorChange",{detail:{grad1Value:p.value,grad2Value:W.value}}))};p.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(-90deg, ${p.value}, ${W.value})`,G()}),W.addEventListener("input",()=>{this.querySelector("#color-palette-gradient").style.background=`linear-gradient(-90deg, ${p.value}, ${W.value})`,G()}),[p,W].forEach(K=>{K.addEventListener("change",()=>{this.dispatchEvent(new CustomEvent("colorChanged",{detail:{color:K.value}}))})})}}customElements.define("mobile-pallete-component",Palette);
